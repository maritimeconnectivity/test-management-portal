(self.webpackChunkmanagement_portal_clr=self.webpackChunkmanagement_portal_clr||[]).push([[660],{1748:(It,L,j)=>{"use strict";j.d(L,{Y:()=>A});const n=[{code:"AF",code3:"AFG",title:"Afghanistan",value:"Afghanistan"},{code:"AL",code3:"ALB",title:"Albania",value:"Albania"},{code:"DZ",code3:"DZA",title:"Algeria",value:"Algeria"},{code:"AS",code3:"ASM",title:"American Samoa",value:"American Samoa"},{code:"AD",code3:"AND",title:"Andorra",value:"Andorra"},{code:"AO",code3:"AGO",title:"Angola",value:"Angola"},{code:"AI",code3:"AIA",title:"Anguilla",value:"Anguilla"},{code:"AQ",code3:"ATA",title:"Antarctica",value:"Antarctica"},{code:"AG",code3:"ATG",title:"Antigua and Barbuda",value:"Antigua and Barbuda"},{code:"AR",code3:"ARG",title:"Argentina",value:"Argentina"},{code:"AM",code3:"ARM",title:"Armenia",value:"Armenia"},{code:"AW",code3:"ABW",title:"Aruba",value:"Aruba"},{code:"AU",code3:"AUS",title:"Australia",value:"Australia"},{code:"AT",code3:"AUT",title:"Austria",value:"Austria"},{code:"AZ",code3:"AZE",title:"Azerbaijan",value:"Azerbaijan"},{code:"BS",code3:"BHS",title:"Bahamas (the)",value:"Bahamas (the)"},{code:"BH",code3:"BHR",title:"Bahrain",value:"Bahrain"},{code:"BD",code3:"BGD",title:"Bangladesh",value:"Bangladesh"},{code:"BB",code3:"BRB",title:"Barbados",value:"Barbados"},{code:"BY",code3:"BLR",title:"Belarus",value:"Belarus"},{code:"BE",code3:"BEL",title:"Belgium",value:"Belgium"},{code:"BZ",code3:"BLZ",title:"Belize",value:"Belize"},{code:"BJ",code3:"BEN",title:"Benin",value:"Benin"},{code:"BM",code3:"BMU",title:"Bermuda",value:"Bermuda"},{code:"BT",code3:"BTN",title:"Bhutan",value:"Bhutan"},{code:"BO",code3:"BOL",title:"Bolivia (Plurinational State of)",value:"Bolivia (Plurinational State of)"},{code:"BQ",code3:"BES",title:"Bonaire, Sint Eustatius and Saba",value:"Bonaire, Sint Eustatius and Saba"},{code:"BA",code3:"BIH",title:"Bosnia and Herzegovina",value:"Bosnia and Herzegovina"},{code:"BW",code3:"BWA",title:"Botswana",value:"Botswana"},{code:"BV",code3:"BVT",title:"Bouvet Island",value:"Bouvet Island"},{code:"BR",code3:"BRA",title:"Brazil",value:"Brazil"},{code:"IO",code3:"IOT",title:"British Indian Ocean Territory (the)",value:"British Indian Ocean Territory (the)"},{code:"BN",code3:"BRN",title:"Brunei Darussalam",value:"Brunei Darussalam"},{code:"BG",code3:"BGR",title:"Bulgaria",value:"Bulgaria"},{code:"BF",code3:"BFA",title:"Burkina Faso",value:"Burkina Faso"},{code:"BI",code3:"BDI",title:"Burundi",value:"Burundi"},{code:"CV",code3:"CPV",title:"Cabo Verde",value:"Cabo Verde"},{code:"KH",code3:"KHM",title:"Cambodia",value:"Cambodia"},{code:"CM",code3:"CMR",title:"Cameroon",value:"Cameroon"},{code:"CA",code3:"CAN",title:"Canada",value:"Canada"},{code:"KY",code3:"CYM",title:"Cayman Islands (the)",value:"Cayman Islands (the)"},{code:"CF",code3:"CAF",title:"Central African Republic (the)",value:"Central African Republic (the)"},{code:"TD",code3:"TCD",title:"Chad",value:"Chad"},{code:"CL",code3:"CHL",title:"Chile",value:"Chile"},{code:"CN",code3:"CHN",title:"China",value:"China"},{code:"CX",code3:"CXR",title:"Christmas Island",value:"Christmas Island"},{code:"CC",code3:"CCK",title:"Cocos (Keeling) Islands (the)",value:"Cocos (Keeling) Islands (the)"},{code:"CO",code3:"COL",title:"Colombia",value:"Colombia"},{code:"KM",code3:"COM",title:"Comoros (the)",value:"Comoros (the)"},{code:"CD",code3:"COD",title:"Congo (the Democratic Republic of the)",value:"Congo (the Democratic Republic of the)"},{code:"CG",code3:"COG",title:"Congo (the)",value:"Congo (the)"},{code:"CK",code3:"COK",title:"Cook Islands (the)",value:"Cook Islands (the)"},{code:"CR",code3:"CRI",title:"Costa Rica",value:"Costa Rica"},{code:"HR",code3:"HRV",title:"Croatia",value:"Croatia"},{code:"CU",code3:"CUB",title:"Cuba",value:"Cuba"},{code:"CW",code3:"CUW",title:"Cura\xe7ao",value:"Cura\xe7ao"},{code:"CY",code3:"CYP",title:"Cyprus",value:"Cyprus"},{code:"CZ",code3:"CZE",title:"Czechia",value:"Czechia"},{code:"CI",code3:"CIV",title:"C\xf4te d'Ivoire",value:"C\xf4te d'Ivoire"},{code:"DK",code3:"DNK",title:"Denmark",value:"Denmark"},{code:"DJ",code3:"DJI",title:"Djibouti",value:"Djibouti"},{code:"DM",code3:"DMA",title:"Dominica",value:"Dominica"},{code:"DO",code3:"DOM",title:"Dominican Republic (the)",value:"Dominican Republic (the)"},{code:"EC",code3:"ECU",title:"Ecuador",value:"Ecuador"},{code:"EG",code3:"EGY",title:"Egypt",value:"Egypt"},{code:"SV",code3:"SLV",title:"El Salvador",value:"El Salvador"},{code:"GQ",code3:"GNQ",title:"Equatorial Guinea",value:"Equatorial Guinea"},{code:"ER",code3:"ERI",title:"Eritrea",value:"Eritrea"},{code:"EE",code3:"EST",title:"Estonia",value:"Estonia"},{code:"SZ",code3:"SWZ",title:"Eswatini",value:"Eswatini"},{code:"ET",code3:"ETH",title:"Ethiopia",value:"Ethiopia"},{code:"FK",code3:"FLK",title:"Falkland Islands (the) [Malvinas]",value:"Falkland Islands (the) [Malvinas]"},{code:"FO",code3:"FRO",title:"Faroe Islands (the)",value:"Faroe Islands (the)"},{code:"FJ",code3:"FJI",title:"Fiji",value:"Fiji"},{code:"FI",code3:"FIN",title:"Finland",value:"Finland"},{code:"FR",code3:"FRA",title:"France",value:"France"},{code:"GF",code3:"GUF",title:"French Guiana",value:"French Guiana"},{code:"PF",code3:"PYF",title:"French Polynesia",value:"French Polynesia"},{code:"TF",code3:"ATF",title:"French Southern Territories (the)",value:"French Southern Territories (the)"},{code:"GA",code3:"GAB",title:"Gabon",value:"Gabon"},{code:"GM",code3:"GMB",title:"Gambia (the)",value:"Gambia (the)"},{code:"GE",code3:"GEO",title:"Georgia",value:"Georgia"},{code:"DE",code3:"DEU",title:"Germany",value:"Germany"},{code:"GH",code3:"GHA",title:"Ghana",value:"Ghana"},{code:"GI",code3:"GIB",title:"Gibraltar",value:"Gibraltar"},{code:"GR",code3:"GRC",title:"Greece",value:"Greece"},{code:"GL",code3:"GRL",title:"Greenland",value:"Greenland"},{code:"GD",code3:"GRD",title:"Grenada",value:"Grenada"},{code:"GP",code3:"GLP",title:"Guadeloupe",value:"Guadeloupe"},{code:"GU",code3:"GUM",title:"Guam",value:"Guam"},{code:"GT",code3:"GTM",title:"Guatemala",value:"Guatemala"},{code:"GG",code3:"GGY",title:"Guernsey",value:"Guernsey"},{code:"GN",code3:"GIN",title:"Guinea",value:"Guinea"},{code:"GW",code3:"GNB",title:"Guinea-Bissau",value:"Guinea-Bissau"},{code:"GY",code3:"GUY",title:"Guyana",value:"Guyana"},{code:"HT",code3:"HTI",title:"Haiti",value:"Haiti"},{code:"HM",code3:"HMD",title:"Heard Island and McDonald Islands",value:"Heard Island and McDonald Islands"},{code:"VA",code3:"VAT",title:"Holy See (the)",value:"Holy See (the)"},{code:"HN",code3:"HND",title:"Honduras",value:"Honduras"},{code:"HK",code3:"HKG",title:"Hong Kong",value:"Hong Kong"},{code:"HU",code3:"HUN",title:"Hungary",value:"Hungary"},{code:"IS",code3:"ISL",title:"Iceland",value:"Iceland"},{code:"IN",code3:"IND",title:"India",value:"India"},{code:"ID",code3:"IDN",title:"Indonesia",value:"Indonesia"},{code:"IR",code3:"IRN",title:"Iran (Islamic Republic of)",value:"Iran (Islamic Republic of)"},{code:"IQ",code3:"IRQ",title:"Iraq",value:"Iraq"},{code:"IE",code3:"IRL",title:"Ireland",value:"Ireland"},{code:"IM",code3:"IMN",title:"Isle of Man",value:"Isle of Man"},{code:"IL",code3:"ISR",title:"Israel",value:"Israel"},{code:"IT",code3:"ITA",title:"Italy",value:"Italy"},{code:"JM",code3:"JAM",title:"Jamaica",value:"Jamaica"},{code:"JP",code3:"JPN",title:"Japan",value:"Japan"},{code:"JE",code3:"JEY",title:"Jersey",value:"Jersey"},{code:"JO",code3:"JOR",title:"Jordan",value:"Jordan"},{code:"KZ",code3:"KAZ",title:"Kazakhstan",value:"Kazakhstan"},{code:"KE",code3:"KEN",title:"Kenya",value:"Kenya"},{code:"KI",code3:"KIR",title:"Kiribati",value:"Kiribati"},{code:"KP",code3:"PRK",title:"Korea (the Democratic People's Republic of)",value:"Korea (the Democratic People's Republic of)"},{code:"KR",code3:"KOR",title:"Korea (the Republic of)",value:"Korea (the Republic of)"},{code:"KW",code3:"KWT",title:"Kuwait",value:"Kuwait"},{code:"KG",code3:"KGZ",title:"Kyrgyzstan",value:"Kyrgyzstan"},{code:"LA",code3:"LAO",title:"Lao People's Democratic Republic (the)",value:"Lao People's Democratic Republic (the)"},{code:"LV",code3:"LVA",title:"Latvia",value:"Latvia"},{code:"LB",code3:"LBN",title:"Lebanon",value:"Lebanon"},{code:"LS",code3:"LSO",title:"Lesotho",value:"Lesotho"},{code:"LR",code3:"LBR",title:"Liberia",value:"Liberia"},{code:"LY",code3:"LBY",title:"Libya",value:"Libya"},{code:"LI",code3:"LIE",title:"Liechtenstein",value:"Liechtenstein"},{code:"LT",code3:"LTU",title:"Lithuania",value:"Lithuania"},{code:"LU",code3:"LUX",title:"Luxembourg",value:"Luxembourg"},{code:"MO",code3:"MAC",title:"Macao",value:"Macao"},{code:"MG",code3:"MDG",title:"Madagascar",value:"Madagascar"},{code:"MW",code3:"MWI",title:"Malawi",value:"Malawi"},{code:"MY",code3:"MYS",title:"Malaysia",value:"Malaysia"},{code:"MV",code3:"MDV",title:"Maldives",value:"Maldives"},{code:"ML",code3:"MLI",title:"Mali",value:"Mali"},{code:"MT",code3:"MLT",title:"Malta",value:"Malta"},{code:"MH",code3:"MHL",title:"Marshall Islands (the)",value:"Marshall Islands (the)"},{code:"MQ",code3:"MTQ",title:"Martinique",value:"Martinique"},{code:"MR",code3:"MRT",title:"Mauritania",value:"Mauritania"},{code:"MU",code3:"MUS",title:"Mauritius",value:"Mauritius"},{code:"YT",code3:"MYT",title:"Mayotte",value:"Mayotte"},{code:"MX",code3:"MEX",title:"Mexico",value:"Mexico"},{code:"FM",code3:"FSM",title:"Micronesia (Federated States of)",value:"Micronesia (Federated States of)"},{code:"MD",code3:"MDA",title:"Moldova (the Republic of)",value:"Moldova (the Republic of)"},{code:"MC",code3:"MCO",title:"Monaco",value:"Monaco"},{code:"MN",code3:"MNG",title:"Mongolia",value:"Mongolia"},{code:"ME",code3:"MNE",title:"Montenegro",value:"Montenegro"},{code:"MS",code3:"MSR",title:"Montserrat",value:"Montserrat"},{code:"MA",code3:"MAR",title:"Morocco",value:"Morocco"},{code:"MZ",code3:"MOZ",title:"Mozambique",value:"Mozambique"},{code:"MM",code3:"MMR",title:"Myanmar",value:"Myanmar"},{code:"NA",code3:"NAM",title:"Namibia",value:"Namibia"},{code:"NR",code3:"NRU",title:"Nauru",value:"Nauru"},{code:"NP",code3:"NPL",title:"Nepal",value:"Nepal"},{code:"NL",code3:"NLD",title:"Netherlands (the)",value:"Netherlands (the)"},{code:"NC",code3:"NCL",title:"New Caledonia",value:"New Caledonia"},{code:"NZ",code3:"NZL",title:"New Zealand",value:"New Zealand"},{code:"NI",code3:"NIC",title:"Nicaragua",value:"Nicaragua"},{code:"NE",code3:"NER",title:"Niger (the)",value:"Niger (the)"},{code:"NG",code3:"NGA",title:"Nigeria",value:"Nigeria"},{code:"NU",code3:"NIU",title:"Niue",value:"Niue"},{code:"NF",code3:"NFK",title:"Norfolk Island",value:"Norfolk Island"},{code:"MP",code3:"MNP",title:"Northern Mariana Islands (the)",value:"Northern Mariana Islands (the)"},{code:"NO",code3:"NOR",title:"Norway",value:"Norway"},{code:"OM",code3:"OMN",title:"Oman",value:"Oman"},{code:"PK",code3:"PAK",title:"Pakistan",value:"Pakistan"},{code:"PW",code3:"PLW",title:"Palau",value:"Palau"},{code:"PS",code3:"PSE",title:"Palestine, State of",value:"Palestine, State of"},{code:"PA",code3:"PAN",title:"Panama",value:"Panama"},{code:"PG",code3:"PNG",title:"Papua New Guinea",value:"Papua New Guinea"},{code:"PY",code3:"PRY",title:"Paraguay",value:"Paraguay"},{code:"PE",code3:"PER",title:"Peru",value:"Peru"},{code:"PH",code3:"PHL",title:"Philippines (the)",value:"Philippines (the)"},{code:"PN",code3:"PCN",title:"Pitcairn",value:"Pitcairn"},{code:"PL",code3:"POL",title:"Poland",value:"Poland"},{code:"PT",code3:"PRT",title:"Portugal",value:"Portugal"},{code:"PR",code3:"PRI",title:"Puerto Rico",value:"Puerto Rico"},{code:"QA",code3:"QAT",title:"Qatar",value:"Qatar"},{code:"MK",code3:"MKD",title:"Republic of North Macedonia",value:"Republic of North Macedonia"},{code:"RO",code3:"ROU",title:"Romania",value:"Romania"},{code:"RU",code3:"RUS",title:"Russian Federation (the)",value:"Russian Federation (the)"},{code:"RW",code3:"RWA",title:"Rwanda",value:"Rwanda"},{code:"RE",code3:"REU",title:"R\xe9union",value:"R\xe9union"},{code:"BL",code3:"BLM",title:"Saint Barth\xe9lemy",value:"Saint Barth\xe9lemy"},{code:"SH",code3:"SHN",title:"Saint Helena, Ascension and Tristan da Cunha",value:"Saint Helena, Ascension and Tristan da Cunha"},{code:"KN",code3:"KNA",title:"Saint Kitts and Nevis",value:"Saint Kitts and Nevis"},{code:"LC",code3:"LCA",title:"Saint Lucia",value:"Saint Lucia"},{code:"MF",code3:"MAF",title:"Saint Martin (French part)",value:"Saint Martin (French part)"},{code:"PM",code3:"SPM",title:"Saint Pierre and Miquelon",value:"Saint Pierre and Miquelon"},{code:"VC",code3:"VCT",title:"Saint Vincent and the Grenadines",value:"Saint Vincent and the Grenadines"},{code:"WS",code3:"WSM",title:"Samoa",value:"Samoa"},{code:"SM",code3:"SMR",title:"San Marino",value:"San Marino"},{code:"ST",code3:"STP",title:"Sao Tome and Principe",value:"Sao Tome and Principe"},{code:"SA",code3:"SAU",title:"Saudi Arabia",value:"Saudi Arabia"},{code:"SN",code3:"SEN",title:"Senegal",value:"Senegal"},{code:"RS",code3:"SRB",title:"Serbia",value:"Serbia"},{code:"SC",code3:"SYC",title:"Seychelles",value:"Seychelles"},{code:"SL",code3:"SLE",title:"Sierra Leone",value:"Sierra Leone"},{code:"SG",code3:"SGP",title:"Singapore",value:"Singapore"},{code:"SX",code3:"SXM",title:"Sint Maarten (Dutch part)",value:"Sint Maarten (Dutch part)"},{code:"SK",code3:"SVK",title:"Slovakia",value:"Slovakia"},{code:"SI",code3:"SVN",title:"Slovenia",value:"Slovenia"},{code:"SB",code3:"SLB",title:"Solomon Islands",value:"Solomon Islands"},{code:"SO",code3:"SOM",title:"Somalia",value:"Somalia"},{code:"ZA",code3:"ZAF",title:"South Africa",value:"South Africa"},{code:"GS",code3:"SGS",title:"South Georgia and the South Sandwich Islands",value:"South Georgia and the South Sandwich Islands"},{code:"SS",code3:"SSD",title:"South Sudan",value:"South Sudan"},{code:"ES",code3:"ESP",title:"Spain",value:"Spain"},{code:"LK",code3:"LKA",title:"Sri Lanka",value:"Sri Lanka"},{code:"SD",code3:"SDN",title:"Sudan (the)",value:"Sudan (the)"},{code:"SR",code3:"SUR",title:"Surititle",value:"Surititle"},{code:"SJ",code3:"SJM",title:"Svalbard and Jan Mayen",value:"Svalbard and Jan Mayen"},{code:"SE",code3:"SWE",title:"Sweden",value:"Sweden"},{code:"CH",code3:"CHE",title:"Switzerland",value:"Switzerland"},{code:"SY",code3:"SYR",title:"Syrian Arab Republic",value:"Syrian Arab Republic"},{code:"TW",code3:"TWN",title:"Taiwan",value:"Taiwan"},{code:"TJ",code3:"TJK",title:"Tajikistan",value:"Tajikistan"},{code:"TZ",code3:"TZA",title:"Tanzania, United Republic of",value:"Tanzania, United Republic of"},{code:"TH",code3:"THA",title:"Thailand",value:"Thailand"},{code:"TL",code3:"TLS",title:"Timor-Leste",value:"Timor-Leste"},{code:"TG",code3:"TGO",title:"Togo",value:"Togo"},{code:"TK",code3:"TKL",title:"Tokelau",value:"Tokelau"},{code:"TO",code3:"TON",title:"Tonga",value:"Tonga"},{code:"TT",code3:"TTO",title:"Trinidad and Tobago",value:"Trinidad and Tobago"},{code:"TN",code3:"TUN",title:"Tunisia",value:"Tunisia"},{code:"TR",code3:"TUR",title:"Turkey",value:"Turkey"},{code:"TM",code3:"TKM",title:"Turkmenistan",value:"Turkmenistan"},{code:"TC",code3:"TCA",title:"Turks and Caicos Islands (the)",value:"Turks and Caicos Islands (the)"},{code:"TV",code3:"TUV",title:"Tuvalu",value:"Tuvalu"},{code:"UG",code3:"UGA",title:"Uganda",value:"Uganda"},{code:"UA",code3:"UKR",title:"Ukraine",value:"Ukraine"},{code:"AE",code3:"ARE",title:"United Arab Emirates (the)",value:"United Arab Emirates (the)"},{code:"GB",code3:"GBR",title:"United Kingdom of Great Britain and Northern Ireland (the)",value:"United Kingdom of Great Britain and Northern Ireland (the)"},{code:"UM",code3:"UMI",title:"United States Minor Outlying Islands (the)",value:"United States Minor Outlying Islands (the)"},{code:"US",code3:"USA",title:"United States of America (the)",value:"United States of America (the)"},{code:"UY",code3:"URY",title:"Uruguay",value:"Uruguay"},{code:"UZ",code3:"UZB",title:"Uzbekistan",value:"Uzbekistan"},{code:"VU",code3:"VUT",title:"Vanuatu",value:"Vanuatu"},{code:"VE",code3:"VEN",title:"Venezuela (Bolivarian Republic of)",value:"Venezuela (Bolivarian Republic of)"},{code:"VN",code3:"VNM",title:"Viet Nam",value:"Viet Nam"},{code:"VG",code3:"VGB",title:"Virgin Islands (British)",value:"Virgin Islands (British)"},{code:"VI",code3:"VIR",title:"Virgin Islands (U.S.)",value:"Virgin Islands (U.S.)"},{code:"WF",code3:"WLF",title:"Wallis and Futuna",value:"Wallis and Futuna"},{code:"EH",code3:"ESH",title:"Western Sahara",value:"Western Sahara"},{code:"YE",code3:"YEM",title:"Yemen",value:"Yemen"},{code:"ZM",code3:"ZMB",title:"Zambia",value:"Zambia"},{code:"ZW",code3:"ZWE",title:"Zimbabwe",value:"Zimbabwe"},{code:"AX",code3:"ALA",title:"\xc5land Islands",value:"\xc5land Islands"}];var c=j(1066);const A={device:{id:{title:"ID",type:"number",description:"identifier"},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"device",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>:<unique_id>'"},name:{title:"Name",type:"string",description:"Name of device",visibleFrom:["detail","list","edit","edit-new"],required:!0},permissions:{title:"Permissions",type:"string",description:"List of permissions assigned by the organization",visibleFrom:["edit","detail","edit","edit-new"]},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},organization:{id:{title:"ID",type:"number"},logo:{title:"Logo",type:"image",allowedExtensions:[".jpg",".png"],visibleFrom:["detail","edit"]},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"organization",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>'"},name:{title:"Name",type:"string",description:"Name of organization",visibleFrom:["detail","list","edit","edit-new"],required:!0},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},email:{title:"e-mail",type:"string",description:"Contact e-mail",visibleFrom:["detail","edit","edit-new"],required:!0},url:{title:"URL",type:"string",description:"URL of organization",visibleFrom:["detail","edit","edit-new"],required:!0},address:{title:"Address",type:"string",description:"Address of organization",visibleFrom:["detail","edit","edit-new"],required:!0},country:{title:"Country",type:"string",description:"Country that organization belongs to",visibleFrom:["detail","list","edit","edit-new"],options:n,required:!0},federationType:{title:"Federation type",type:"string",description:"OpenID Connect federation type",visibleFrom:["detail","edit","edit-new"],immutable:!0},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},service:{id:{title:"ID",type:"number"},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"service",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>:<unique_id>'"},name:{title:"Name",type:"string",description:"Name of service",visibleFrom:["detail","list","edit","edit-new"],required:!0},permissions:{title:"Permissions",type:"string",description:"List of permissions assigned by the organization",visibleFrom:["edit","detail","edit","edit-new"]},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},instanceVersion:{title:"Instance version",type:"string",description:"Version of service instance",immutable:!0},certDomainName:{title:"Certificate domain name",type:"string",description:"The domain name the service will be available on. Used in the issued certificates for the service.",visibleFrom:["detail","edit","edit-new"]},oidcClientId:{title:"OIDC client ID",type:"string",description:"OpenID Connect client ID",visibleFrom:["detail","edit"]},oidcClientSecret:{title:"OIDC client secret",type:"string",description:"OpenID Connect client secret",visibleFrom:["detail","edit"]},oidcAccessType:{title:"Access type",type:"string",description:"OpenID Connect access type",options:[{title:"public",value:"public",showField:{key:"oidcRedirectUri",value:!0}},{title:"bearer-only",value:"bearer-only",showField:{key:"oidcRedirectUri",value:!1}},{title:"confidential",value:"confidential",showField:{key:"oidcRedirectUri",value:!0}}],visibleFrom:["detail","edit"]},oidcRedirectUri:{title:"OIDC redirect URI",type:"string",description:"OpenID Connect client redirect URI",visibleFrom:["detail","edit"]},vessel:{title:"Vessel",type:"vessel",description:"Correlated vessel",visibleFrom:["detail","edit"]},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},user:{id:{title:"ID",type:"number"},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"user",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>:<unique_id>'"},firstName:{title:"First name",type:"string",visibleFrom:["detail","list","edit","edit-new"],required:!0},lastName:{title:"Last name",type:"string",visibleFrom:["detail","list","edit","edit-new"],required:!0},email:{title:"e-mail",type:"string",description:"Contact e-mail",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0},permissions:{title:"Permissions",type:"string",description:"List of permissions assigned by the organization",visibleFrom:["detail","list","edit","edit-new"]},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},vessel:{id:{title:"ID",type:"number"},logo:{title:"Logo",type:"image",allowedExtensions:[".jpg",".png"],visibleFrom:["detail","edit"]},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"vessel",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>:<unique_id>'"},name:{title:"Name",type:"string",description:"Name of device",visibleFrom:["detail","list","edit","edit-new"],required:!0},permissions:{title:"Permissions",type:"string",description:"List of permissions assigned by the organization",visibleFrom:["detail","edit","edit-new"]},imoNumber:{title:"IMO number",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},mmsiNumber:{title:"MMSI number",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},callsign:{title:"Call sign",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},flagstate:{title:"Flag state",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},aisClass:{title:"AIS class",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},portOfRegister:{title:"Port of register",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},role:{id:{title:"ID",type:"number"},permission:{title:"Permission",type:"string",visibleFrom:["detail","list","edit","edit-new"],required:!0},roleName:{title:"Role name",type:"string",visibleFrom:["detail","list","edit","edit-new"],options:[{title:"ROLE_SITE_ADMIN",value:"ROLE_SITE_ADMIN"},{title:"ROLE_ORG_ADMIN",value:"ROLE_ORG_ADMIN"},{title:"ROLE_USER",value:"ROLE_USER"},{title:"ROLE_ENTITY_ADMIN",value:"ROLE_ENTITY_ADMIN"},{title:"ROLE_USER_ADMIN",value:"ROLE_USER_ADMIN"},{title:"ROLE_VESSEL_ADMIN",value:"ROLE_VESSEL_ADMIN"},{title:"ROLE_SERVICE_ADMIN",value:"ROLE_SERVICE_ADMIN"},{title:"ROLE_APPROVE_ORG",value:"ROLE_APPROVE_ORG"},{title:"ROLE_DEVICE_ADMIN",value:"ROLE_DEVICE_ADMIN"},{title:"ROLE_MMS_ADMIN",value:"ROLE_MMS_ADMIN"}],required:!0},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},orgcandidate:{id:{title:"ID",type:"number"},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],shortIdType:"organization",immutable:!0,required:!0,error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>'"},name:{title:"Name",type:"string",description:"Name of organization",visibleFrom:["detail","list","edit","edit-new"],required:!0},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},email:{title:"e-mail",type:"string",description:"Contact e-mail",visibleFrom:["detail","list","edit","edit-new"],required:!0},url:{title:"URL",type:"string",description:"URL of organization",visibleFrom:["detail","list","edit","edit-new"],required:!0},address:{title:"Address",type:"string",description:"Address of organization",visibleFrom:["detail","edit","edit-new"],required:!0},country:{title:"Country",type:"string",description:"Country that organization belongs to",visibleFrom:["detail","list","edit","edit-new"],options:n,required:!0},federationType:{title:"Federation type",type:"string",description:"OpenID Connect federation type",visibleFrom:["detail","edit"],immutable:!0},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},instance:{id:{title:"ID",type:"number"},instanceId:{title:"Instance ID",type:"string",description:"MCP MRN as unique identifer",placeholder:"urn:mrn:",visibleFrom:["detail","edit","edit-new"],required:!0},name:{title:"Name",type:"string",description:"Name of service instance",visibleFrom:["detail","list","edit","edit-new"],required:!0},version:{title:"Version",type:"string",description:"Version of service instance",visibleFrom:["detail","list","edit","edit-new"],required:!0},comment:{title:"Comment",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},serviceType:{title:"Service type",type:"stringArray",options:[{title:"MS 1 - VTS Information service (INS)",value:"VTSInformationService"},{title:"MS 2 - VTS Navigational assistance service (NAS)",value:"VTSNavigationalAssistanceService"},{title:"MS 3 - Traffic organization service (TOS)",value:"TrafficOrganizationService"},{title:"MS 4 - Port support service (PSS)",value:"PortSupportService"},{title:"MS 5 - Maritime safety information (MSI) service",value:"MaritimeSafetyInformationService"},{title:"MS 6 - Pilotage service",value:"PilotageService"},{title:"MS 7 - Tug service",value:"TugService"},{title:"MS 8 - Vessel shore reporting",value:"VesselShoreReporting"},{title:"MS 9 - Telemedical assistance service (TMAS)",value:"TelemedicalAssistanceService"},{title:"MS 10 - Maritime assistance service (MAS)",value:"MaritimeAssistanceService"},{title:"MS 11 - Nautical chart service",value:"NauticalChartService"},{title:"MS 12 - Nautical publications service",value:"NauticalPublicationsService"},{title:"MS 13 - Ice navigation service",value:"IceNavigationService"},{title:"MS 14 - Meteorological information service",value:"MeteorologicalInformationService"},{title:"MS 15 - Real-time hydrographic and environmental information services",value:"RealTimeHydrographicAndEnvironmentalInformationServices"},{title:"MS 16 - Search and rescue (SAR) service",value:"SearchAndRescueService"},{title:"Other",value:"other:etc"}],description:"The service type shall reflect the associated operational service type provided according to defined types",visibleFrom:["detail","list","edit","edit-new"]},dataProductType:{title:"Data product type",type:"stringArray",options:[{title:"S-57 Electronic Navigational Chart (ENC)",value:"S57"},{title:"S-101 Electronic Navigational Chart (ENC)",value:"S101"},{title:"S-102 Bathymetric Surface",value:"S102"},{title:"S-104 Water Level Information for Surface Navigation",value:"S104"},{title:"S-111 Surface Currents",value:"S111"},{title:"S-122 Marine Protected Areas (MPAs)",value:"S122"},{title:"S-123 Marine Radio Services",value:"S123"},{title:"S-124 Navigational Warnings",value:"S124"},{title:"S-125 Marine Navigational Services",value:"S125"},{title:"S-126 Marine Physical Environment",value:"S126"},{title:"S-127 Marine Traffic Management",value:"S127"},{title:"S-128 Catalogue of Nautical Products",value:"S128"},{title:"S-129 Under Keel Clearance Management (UKCM)",value:"S129"},{title:"S-131 Marine Harbour Infrastructure",value:"S131"},{title:"S-210 Inter-VTS Exchange Format",value:"S210"},{title:"S-211 Port Call Message Format",value:"S211"},{title:"S-212 VTS Digital Information Service",value:"S212"},{title:"S-401 Inland ENC",value:"S401"},{title:"S-402 Bathymetric Contour Overlay for Inland ENC",value:"S402"},{title:"S-411 Sea Ice Information",value:"S411"},{title:"S-412 Weather Overlay",value:"S412"},{title:"S-413 Marine Weather Conditions",value:"S413"},{title:"S-414 Marine Weather Observations",value:"S414"},{title:"S-421 Route Plan",value:"S421"},{title:"Route Plan",value:"RTZ"},{title:"Electronic Port Clearance",value:"EPC"},{title:"Other data types not covered in this table",value:"OTHER"}],description:"Data product type defined in IEC 63173-2 SECOM standard",visibleFrom:["detail","list","edit","edit-new"]},status:{title:"Status",type:"string",options:[{title:"Provisional",value:"PROVISIONAL"},{title:"Released",value:"RELEASED"},{title:"Deprecated",value:"DEPRECATED"},{title:"Deleted",value:"DELETED"}],visibleFrom:["detail","list","edit","edit-new"],required:!0},endpointUri:{title:"Endpoint URI",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},endpointType:{title:"Endpoint type",type:"string",visibleFrom:["detail","edit","edit-new"]},organizationId:{title:"Organization ID",type:"string",visibleFrom:["detail","edit","edit-new"],immutable:!0},keywords:{title:"Keywords",type:"stringArray",placeholder:"Please enter keyword",visibleFrom:["detail","list","edit","edit-new"]},implementsServiceDesign:{title:"Technical design ID",type:"string",description:"MCP MRN as unique identifer",placeholder:"urn:mrn:",visibleFrom:["detail","edit","edit-new"]},implementsServiceDesignVersion:{title:"Technical design version",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","edit","edit-new"]},geometryContentType:{title:"Geometry content type",type:"string",visibleFrom:["detail","edit","edit-new"]},geometry:{title:"Geometry",type:"object",visibleFrom:[]},unlocode:{title:"Unlocode",type:"stringArray",placeholder:"Please enter UN/LOCODE",visibleFrom:["detail","edit","edit-new"]},mmsi:{title:"MMSI",type:"string",visibleFrom:["detail","edit","edit-new"]},imo:{title:"IMO number",type:"string",visibleFrom:["detail","edit","edit-new"]},instanceAsXml:{title:"Instance as XML",type:"xml",notShowOnEdit:!0,visibleFrom:["detail","edit","edit-new"]},instanceAsDocId:{title:"Instance as DocId",type:"number"},instanceAsDoc:{title:"Instance as document",type:"file",visibleFrom:["detail","edit","edit-new"]},ledgerRequestId:{title:"Ledger Request ID",type:"number"},ledgerRequestStatus:{title:"Ledger Request status",type:"string",options:[{title:"Inactive",value:"INACTIVE"},{title:"Created",value:"CREATED"},{title:"Vetting",value:"VETTING"},{title:"Vetted",value:"VETTED"},{title:"Requesting",value:"REQUESTING"},{title:"Succeeded",value:"SUCCEEDED"},{title:"Failed",value:"FAILED"},{title:"Rejected",value:"REJECTED"}],visibleFrom:["detail","edit","edit-new"]},docIds:{title:"Related documents",type:"fileArray",filter:!1,visibleFrom:["detail","edit","edit-new"]},publishedAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","edit","edit-new"]},lastUpdatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]}},newOrganization:{orgMrn:{title:"Maritime Resource Name (MRN) for organization",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","edit","edit-new"],required:!0,shortIdType:"organization"},orgName:{title:"Organization name",type:"string",description:"Name of organization",visibleFrom:["detail","edit","edit-new"],required:!0},orgEmail:{title:"Organization contact e-mail",type:"string",description:"Contact e-mail",placeholder:"non-personal email, e.g., info@example.org",visibleFrom:["detail","edit","edit-new"],required:!0},orgUrl:{title:"URL of organization",type:"string",description:"URL of organization",visibleFrom:["detail","edit","edit-new"],required:!0},orgAddress:{title:"Address of organization",type:"string",description:"Address of organization",visibleFrom:["detail","edit","edit-new"],required:!0},orgCountry:{title:"Country of organization",type:"string",description:"Country that organization belongs to",visibleFrom:["detail","edit","edit-new"],options:n,required:!0}},ledgerInstance:{name:{title:"Name",type:"string",description:"Name of service instance",visibleFrom:["list"]},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["list"]},version:{title:"Version",type:"string",description:"Version of service instance",visibleFrom:["list"]},keywords:{title:"Keywords",type:"string",visibleFrom:["list"]},coverageArea:{title:"Coverage ",type:"string"},status:{title:"Status",type:"string",options:[{title:"Provisional",value:"PROVISIONAL"},{title:"Released",value:"RELEASED"},{title:"Deprecated",value:"DEPRECATED"},{title:"Deleted",value:"DELETED"}],visibleFrom:["list"]},implementsDesignMRN:{title:"Technical design ID",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["list"],shortIdType:"design",immutable:!0},implementsDesignVersion:{title:"Technical design version",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["list"]},msrName:{title:"MSR Name of register",type:"string",visibleFrom:["list"]},msrUrl:{title:"MSR URL of register",type:"string",visibleFrom:["list"]}}}},1224:(It,L,j)=>{"use strict";j.d(L,{$l:()=>c,BY:()=>A,kB:()=>n});const n=p=>Object.fromEntries(Object.entries(p).filter(([C,V])=>void 0!==V&&V.toString().length>0)),c=(p,C)=>{const V={...p};for(const U in C)V.hasOwnProperty(U)&&C[U]!==V[U]&&(V[U]=C[U]);return V},A=p=>({...p,...p.attributes.reduce((C,V)=>({...C,[V.attributeName.replace(/-([a-z])/g,function(U){return U[1].toUpperCase()})]:V.attributeValue}),{})})},2170:(It,L,j)=>{"use strict";j.d(L,{c:()=>n,e:()=>c});const n=["en-GB","ko-KR"],c=[{code:"en-GB",name:"English"},{code:"ko-KR",name:"\ud55c\uad6d\uc5b4"}]},58:(It,L,j)=>{"use strict";j.d(L,{G:()=>p});var n=j(2047),c=j(9380),A=j(5950);let p=(()=>{class C{static#e=this.\u0275fac=function(P){return new(P||C)};static#t=this.\u0275mod=A.$C({type:C});static#s=this.\u0275inj=A.G2t({imports:[n.MD,n.MD,c.h]})}return C})()},1066:(It,L,j)=>{"use strict";j.d(L,{t:()=>n});const n=c=>new Date(c).toLocaleString()},3987:(It,L,j)=>{"use strict";j.d(L,{Xo:()=>C,lk:()=>p,rR:()=>A,xs:()=>c});var n=j(2170);const c=V=>{V.addLangs(n.c)},A=V=>{const U=localStorage.getItem("locale"),P=U&&n.c.includes(U)?localStorage.getItem("locale"):"en-GB";if(null!==P)return V.setDefaultLang(P),V.use(P),P;throw new Error("Locale not found")},p=(V,U)=>{V.use(U),V.setDefaultLang(U),localStorage.setItem("locale",U)},C=V=>n.e.find(U=>U.code===V)?.name||"English"},9850:(It,L,j)=>{"use strict";j.d(L,{h:()=>H});var n=j(2047),c=j(58),A=j(3585),p=j(698),C=j(3685),V=j(2537),U=j(3426),P=j(5950);let H=(()=>{class w{static#e=this.\u0275fac=function(E){return new(E||w)};static#t=this.\u0275mod=P.$C({type:w});static#s=this.\u0275inj=P.G2t({imports:[n.MD,c.G,A.PuD,p.j,C.Y,V.B,U.d]})}return w})()},698:(It,L,j)=>{"use strict";j.d(L,{j:()=>ve});var n=j(5950),c=j(7882),A=j(3585),p=j(1748),C=j(1224),V=j(5166),P=j(58),H=j(5004),w=j(6482),B=j(5189),y=j(9380),E=j(2047);function g(he,J){if(1&he&&n.EFF(0),2&he){const M=n.XpG();n.SpI(" New ",M.capitalize(M.itemType)," ")}}function S(he,J){if(1&he&&n.EFF(0),2&he){const M=n.XpG();n.Lme(" ",M.capitalize(M.itemType)," edit - ",M.item.mrn," ")}}function _(he,J){if(1&he&&(n.j41(0,"clr-control-error"),n.EFF(1),n.k0s()),2&he){const M=n.XpG(2).$implicit;n.R7$(),n.JRh(M.value.error)}}function k(he,J){1&he&&(n.j41(0,"clr-control-error"),n.EFF(1,"Please enter a value"),n.k0s())}function b(he,J){if(1&he){const M=n.RV6();n.j41(0,"clr-input-container")(1,"label"),n.EFF(2),n.k0s(),n.j41(3,"input",12),n.bIt("ngModelChange",function(Ce){n.eBV(M);const ke=n.XpG(2);return n.Njj(ke.onMrnChange(Ce))})("keydown",function(Ce){n.eBV(M);const ke=n.XpG(2);return n.Njj(ke.onMrnKeyDown(Ce))}),n.k0s(),n.j41(4,"clr-control-helper"),n.EFF(5),n.k0s(),n.DNE(6,_,2,1,"clr-control-error")(7,k,2,0,"clr-control-error"),n.k0s()}if(2&he){const M=n.XpG().$implicit,Ne=n.XpG();n.R7$(2),n.JRh(M.value.title),n.R7$(),n.xc7("width",400,"px"),n.Y8G("type",M.value.type)("formControlName",M.key)("required",!0===M.value.required)("placeholder",Ne.mrnPrefix),n.R7$(2),n.JRh(M.value.description),n.R7$(),n.vxM(M.value.error?6:7)}}function Z(he,J){if(1&he&&(n.j41(0,"option",15),n.EFF(1),n.k0s()),2&he){const M=J.$implicit;n.Y8G("value",M.value),n.R7$(),n.JRh(M.title)}}function l(he,J){if(1&he&&(n.j41(0,"clr-control-error"),n.EFF(1),n.k0s()),2&he){const M=n.XpG(2).$implicit;n.R7$(),n.JRh(M.value.error)}}function we(he,J){1&he&&(n.j41(0,"clr-control-error"),n.EFF(1,"Please enter a value"),n.k0s())}function te(he,J){if(1&he&&(n.j41(0,"clr-select-container")(1,"label"),n.EFF(2),n.k0s(),n.j41(3,"select",13),n.DNE(4,Z,2,2,"option",14),n.k0s(),n.j41(5,"clr-control-helper"),n.EFF(6),n.k0s(),n.DNE(7,l,2,1,"clr-control-error")(8,we,2,0,"clr-control-error"),n.k0s()),2&he){const M=n.XpG().$implicit;n.R7$(2),n.Lme("",M.value.title," ",M.key,""),n.R7$(),n.xc7("width",400,"px"),n.Y8G("formControlName",M.key)("required",!0===M.value.required),n.R7$(),n.Y8G("ngForOf",M.value.options),n.R7$(2),n.JRh(M.value.description),n.R7$(),n.vxM(M.value.error?7:8)}}function be(he,J){if(1&he&&(n.j41(0,"option",15),n.EFF(1),n.k0s()),2&he){const M=J.$implicit;n.Y8G("value",M.permission),n.R7$(),n.JRh(M.permission)}}function Oe(he,J){if(1&he&&(n.j41(0,"clr-control-error"),n.EFF(1),n.k0s()),2&he){const M=n.XpG(2).$implicit;n.R7$(),n.JRh(M.value.error)}}function R(he,J){1&he&&(n.j41(0,"clr-control-error"),n.EFF(1,"Please enter a value"),n.k0s())}function $(he,J){if(1&he&&(n.j41(0,"clr-select-container")(1,"label"),n.EFF(2),n.k0s(),n.j41(3,"select",13),n.DNE(4,be,2,2,"option",14),n.k0s(),n.j41(5,"clr-control-helper"),n.EFF(6),n.k0s(),n.DNE(7,Oe,2,1,"clr-control-error")(8,R,2,0,"clr-control-error"),n.k0s()),2&he){const M=n.XpG().$implicit,Ne=n.XpG();n.R7$(2),n.JRh(M.value.title),n.R7$(),n.xc7("width",400,"px"),n.Y8G("formControlName",M.key)("required",!0===M.value.required),n.R7$(),n.Y8G("ngForOf",Ne.roles),n.R7$(2),n.JRh(M.value.description),n.R7$(),n.vxM(M.value.error?7:8)}}function d(he,J){if(1&he&&(n.j41(0,"clr-control-error"),n.EFF(1),n.k0s()),2&he){const M=n.XpG(2).$implicit;n.R7$(),n.JRh(M.value.error)}}function D(he,J){1&he&&(n.j41(0,"clr-control-error"),n.EFF(1,"Please enter a value"),n.k0s())}function ie(he,J){if(1&he&&(n.j41(0,"clr-input-container")(1,"label"),n.EFF(2),n.k0s(),n.nrm(3,"input",16),n.j41(4,"clr-control-helper"),n.EFF(5),n.k0s(),n.DNE(6,d,2,1,"clr-control-error")(7,D,2,0,"clr-control-error"),n.k0s()),2&he){const M=n.XpG().$implicit;n.R7$(2),n.JRh(M.value.title),n.R7$(),n.xc7("width",400,"px"),n.Y8G("type",M.value.type)("formControlName",M.key)("required",!0===M.value.required),n.R7$(2),n.JRh(M.value.description),n.R7$(),n.vxM(M.value.error?6:7)}}function W(he,J){if(1&he&&(n.j41(0,"div"),n.DNE(1,b,8,9,"clr-input-container")(2,te,9,9,"clr-select-container")(3,$,9,8,"clr-select-container")(4,ie,8,8,"clr-input-container"),n.k0s()),2&he){const M=J.$implicit;n.R7$(),n.vxM("mrn"===M.key?1:"roleName"===M.key?2:"permissions"===M.key?3:4)}}function Be(he,J){if(1&he){const M=n.RV6();n.j41(0,"button",17),n.bIt("click",function(){n.eBV(M);const Ce=n.XpG();return n.Njj(Ce.cancel())}),n.EFF(1,"Cancel"),n.k0s()}}let ve=(()=>{class he{constructor(M,Ne,Ce,ke,re){this.formBuilder=M,this.roleService=Ne,this.authService=Ce,this.notifierService=ke,this.translate=re,this.itemType=V.SP.None,this.isForNew=!1,this.item={},this.mrnPrefix="urn:mrn:",this.onCancel=new n.bkB,this.onSubmit=new n.bkB,this.viewContext="edit",this.itemForm=new c.gE({}),this.columnForMenu={},this.isEditing=!1,this.roles=[],this.id="",this.submit=()=>{if(!this.itemForm.valid)return this.itemForm.markAllAsTouched(),this.clrForm?.markAsTouched(),void this.notifierService.notify("error",this.translate.instant("error.form.invalid"));if(this.itemForm.value.mrn===this.mrnPrefix)return void this.notifierService.notify("error",this.translate.instant("error.form.invalidmrn"));const ze=(0,C.kB)(this.itemForm.value);if(this.isForNew)this.onSubmit.emit(ze);else{const $e=(0,C.$l)(this.item,ze);this.onSubmit.emit($e)}},this.resetForm=()=>{this.setForm(),this.isForNew?this.itemType!==V.SP.Role&&(this.item={mrn:this.mrnPrefix},this.itemForm.patchValue(this.item)):this.itemForm.patchValue(this.item)},this.cancel=()=>{this.onCancel.emit()},this.setForm=()=>{let ze={};Object.entries(p.Y[this.itemType.toString()]).map(([$e,Ke])=>{if(Ke.visibleFrom&&(!Ke.visibleFrom||Ke.visibleFrom.includes(this.viewContext))){if("mrn"===$e){const pt=new RegExp("urn:mrn:mcp:(device|org|user|vessel|service|mms):([a-z0-9]([a-z0-9]|-){0,20}[a-z0-9]):((([-._a-z0-9]|~)|%[0-9a-f][0-9a-f]|([!$&'()*+,;=])|:|@)((([-._a-z0-9]|~)|%[0-9a-f][0-9a-f]|([!$&'()*+,;=])|:|@)|)*)$");ze[$e]=["",[c.k0.required,c.k0.pattern(pt)]]}else ze[$e]=["",Ke.required?c.k0.required:void 0];this.columnForMenu[$e]=Ke}}),this.itemForm=this.formBuilder.group(ze)},this.needShortId=ze=>void 0!==this.getShortIdType(ze),this.getShortIdType=ze=>this.columnForMenu[ze]?this.columnForMenu[ze].shortIdType:void 0,this.sortColumnForMenu=(ze,$e)=>ze.order>$e.order?-1:1,this.capitalize=ze=>ze[0].toUpperCase()+ze.slice(1)}ngOnInit(){this.itemType!==V.SP.OrgCandidate&&this.authService.getOrgMrn().then(M=>{this.roleService.getRoles(M).subscribe(Ne=>{this.roles=Ne})})}ngOnChanges(M){this.isForNew&&(this.viewContext="edit-new"),this.itemType!==V.SP.None&&(this.setForm(),this.item&&this.itemForm.patchValue(this.item))}onMrnKeyDown(M){const Ne=M.target.value;Ne.includes(this.mrnPrefix)?this.item.mrn=Ne:M.target.value=this.mrnPrefix}onMrnChange(M){this.item.mrn=M.startsWith(this.mrnPrefix)?M:this.mrnPrefix}static#e=this.\u0275fac=function(Ne){return new(Ne||he)(n.rXU(c.ok),n.rXU(H.Ky),n.rXU(w.u),n.rXU(B.iJ),n.rXU(y.c$))};static#t=this.\u0275cmp=n.VBU({type:he,selectors:[["app-item-form"]],viewQuery:function(Ne,Ce){if(1&Ne&&n.GBs(A.mDd,7),2&Ne){let ke;n.mGM(ke=n.lsd())&&(Ce.clrForm=ke.first)}},inputs:{itemType:"itemType",isForNew:"isForNew",item:"item",mrnPrefix:"mrnPrefix"},outputs:{onCancel:"onCancel",onSubmit:"onSubmit"},standalone:!0,features:[n.OA$,n.aNF],decls:17,vars:7,consts:[[1,"clr-row"],[1,"clr-col-lg-12","clr-col-md-8","clr-col-12"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"card-text"],["clrForm","",1,"ng-untouched",3,"formGroup"],[4,"ngFor","ngForOf"],[1,"card-footer"],["type","submit",1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"btn","btn-danger"],["clrInput","",3,"ngModelChange","keydown","type","formControlName","required","placeholder"],["clrSelect","",3,"formControlName","required"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["clrInput","",3,"type","formControlName","required"],[1,"btn","btn-danger",3,"click"]],template:function(Ne,Ce){1&Ne&&(n.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),n.DNE(4,g,1,1)(5,S,1,2),n.k0s(),n.j41(6,"div",4)(7,"div",5)(8,"form",6),n.DNE(9,W,5,1,"div",7),n.nI1(10,"keyvalue"),n.k0s()()(),n.j41(11,"div",8)(12,"button",9),n.bIt("click",function(){return Ce.submit()}),n.EFF(13,"Submit"),n.k0s(),n.j41(14,"button",10),n.bIt("click",function(){return Ce.resetForm()}),n.EFF(15,"Reset"),n.k0s(),n.DNE(16,Be,2,0,"button",11),n.k0s()()()()),2&Ne&&(n.R7$(4),n.vxM(Ce.isForNew?4:5),n.R7$(4),n.Y8G("formGroup",Ce.itemForm),n.R7$(),n.Y8G("ngForOf",n.i5U(10,4,Ce.columnForMenu,Ce.sortColumnForMenu)),n.R7$(7),n.vxM(Ce.isForNew?-1:16))},dependencies:[P.G,E.Sq,E.lG,A.t5G,A.aZZ,A.Hpg,A.bnk,A.mDd,A.icl,A.Xu5,A.Yf6,A.hTQ,c.YN,c.qT,c.xH,c.y7,c.me,c.wz,c.BC,c.cb,c.YS,c.X1,c.j4,c.JD]})}return he})()},3685:(It,L,j)=>{"use strict";j.d(L,{Y:()=>Pw});var n=j(5950),c=j(5166),A=j(2537),p=j(1066);const C={serialNumber:{title:"Serial number",type:"string"},start:{title:"Valid from",type:"string",valuePrepareFunction:s=>(0,p.t)(s)},end:{title:"Valid until",type:"string",valuePrepareFunction:s=>(0,p.t)(s)}},V={serialNumber:{title:"Serial number",type:"string"},revokedAt:{title:"Revoked from",type:"string",valuePrepareFunction:s=>(0,p.t)(s)},revokeReason:{title:"Reason",type:"string"}};function U(s,i){if(1&s&&n.nrm(0,"app-smart-table",0),2&s){const e=n.XpG();n.Y8G("labels",e.columnsForActive)("data",e.data)("onDelete",e.revoke)("onDownload",e.download)("onAdd",e.add)("itemType",e.itemType)}}function P(s,i){if(1&s&&n.nrm(0,"app-smart-table",1),2&s){const e=n.XpG();n.Y8G("labels",e.columnsForRevoked)("data",e.data)("itemType",e.itemType)}}function H(s,i){if(1&s&&(n.j41(0,"h1"),n.EFF(1),n.k0s()),2&s){const e=n.XpG();n.R7$(),n.SpI("The given context is wrong! : ",e.context,"")}}let w=(()=>{class s{constructor(){this.context="active",this.data=[],this.onAdd=new n.bkB,this.onDownload=new n.bkB,this.onRevoke=new n.bkB,this.itemType=c.SP.Certificate,this.download=e=>{this.onDownload.emit(e)},this.add=()=>{this.onAdd.emit()},this.revoke=e=>{this.onRevoke.emit(e)},this.empty=[],this.columnsForActive=C,this.columnsForRevoked=V}static#e=this.\u0275fac=function(t){return new(t||s)};static#t=this.\u0275cmp=n.VBU({type:s,selectors:[["app-cert-table"]],inputs:{context:"context",data:"data"},outputs:{onAdd:"onAdd",onDownload:"onDownload",onRevoke:"onRevoke"},standalone:!0,features:[n.aNF],decls:3,vars:1,consts:[["deleteText","Revoke","placeholder","There is no issued certificate.",3,"labels","data","onDelete","onDownload","onAdd","itemType"],["placeholder","There is no revoked certificate.",3,"labels","data","itemType"]],template:function(t,r){1&t&&n.DNE(0,U,1,6,"app-smart-table",0)(1,P,1,3,"app-smart-table",1)(2,H,2,1,"h1"),2&t&&n.vxM("active"===r.context?0:"revoked"===r.context?1:2)},dependencies:[A.B]})}return s})();var B=j(1748),y=j(7882),g=j(2047),S=j(58),_=j(3585),k=j(6994),b=j(153);function l(s,i,e){var t;return s instanceof Object&&null!==(t=s[i])&&void 0!==t?t:e}function we(s,i=0,e=s.byteLength-i,t=!1){let r="";for(const a of new Uint8Array(s,i,e)){const o=a.toString(16).toUpperCase();1===o.length&&(r+="0"),r+=o,t&&(r+=" ")}return r.trim()}function be(s,i){let e=0;if(1===s.length)return s[0];for(let t=s.length-1;t>=0;t--)e+=s[s.length-1-t]*Math.pow(2,i*t);return e}function Oe(s,i,e=-1){const t=e;let r=s,a=0,o=Math.pow(2,i);for(let u=1;u<8;u++){if(s<o){let h;if(t<0)h=new ArrayBuffer(u),a=u;else{if(t<u)return new ArrayBuffer(0);h=new ArrayBuffer(t),a=t}const m=new Uint8Array(h);for(let N=u-1;N>=0;N--){const T=Math.pow(2,N*i);m[a-N-1]=Math.floor(r/T),r-=m[a-N-1]*T}return h}o*=Math.pow(2,i)}return new ArrayBuffer(0)}function R(...s){let i=0,e=0;for(const a of s)i+=a.byteLength;const t=new ArrayBuffer(i),r=new Uint8Array(t);for(const a of s)r.set(new Uint8Array(a),e),e+=a.byteLength;return t}function $(...s){let i=0,e=0;for(const a of s)i+=a.length;const t=new ArrayBuffer(i),r=new Uint8Array(t);for(const a of s)r.set(a,e),e+=a.length;return r}function d(){const s=new Uint8Array(this.valueHex);this.valueHex.byteLength>=2&&(255===s[0]&&128&s[1]||0===s[0]&&!(128&s[1]))&&this.warnings.push("Needlessly long format");const i=new ArrayBuffer(this.valueHex.byteLength),e=new Uint8Array(i);for(let u=0;u<this.valueHex.byteLength;u++)e[u]=0;e[0]=128&s[0];const t=be(e,8),r=new ArrayBuffer(this.valueHex.byteLength),a=new Uint8Array(r);for(let u=0;u<this.valueHex.byteLength;u++)a[u]=s[u];return a[0]&=127,be(a,8)-t}function ie(s,i){if(s.byteLength!==i.byteLength)return!1;const e=new Uint8Array(s),t=new Uint8Array(i);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function W(s,i){const e=s.toString(10);if(i<e.length)return"";const t=i-e.length,r=new Array(t);for(let o=0;o<t;o++)r[o]="0";return r.join("").concat(e)}const Be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function he(s,i=!1,e=!1,t=!1){let r=0,a=0,o=0,u="";const h=i?ve:Be;if(t){let m=0;for(let N=0;N<s.length;N++)if(0!==s.charCodeAt(N)){m=N;break}s=s.slice(m)}for(;r<s.length;){const m=s.charCodeAt(r++);r>=s.length&&(a=1);const N=s.charCodeAt(r++);r>=s.length&&(o=1);const T=s.charCodeAt(r++),K=m>>2,F=(3&m)<<4|N>>4;let se=(15&N)<<2|T>>6,Ee=63&T;1===a?se=Ee=64:1===o&&(Ee=64),u+=e?64===se?`${h.charAt(K)}${h.charAt(F)}`:64===Ee?`${h.charAt(K)}${h.charAt(F)}${h.charAt(se)}`:`${h.charAt(K)}${h.charAt(F)}${h.charAt(se)}${h.charAt(Ee)}`:`${h.charAt(K)}${h.charAt(F)}${h.charAt(se)}${h.charAt(Ee)}`}return u}function J(s,i=!1,e=!1){const t=i?ve:Be;function r(h){for(let m=0;m<64;m++)if(t.charAt(m)===h)return m;return 64}function a(h){return 64===h?0:h}let o=0,u="";for(;o<s.length;){const h=r(s.charAt(o++)),m=o>=s.length?0:r(s.charAt(o++)),N=o>=s.length?0:r(s.charAt(o++)),T=o>=s.length?0:r(s.charAt(o++)),K=a(h)<<2|a(m)>>4,F=(15&a(m))<<4|a(N)>>2,se=(3&a(N))<<6|a(T);u+=String.fromCharCode(K),64!==N&&(u+=String.fromCharCode(F)),64!==T&&(u+=String.fromCharCode(se))}if(e){let m=-1;for(let N=u.length-1;N>=0;N--)if(0!==u.charCodeAt(N)){m=N;break}u=-1!==m?u.slice(0,m+1):""}return u}function M(s){let i="";const e=new Uint8Array(s);for(const t of e)i+=String.fromCharCode(t);return i}function Ne(s){const i=s.length,e=new ArrayBuffer(i),t=new Uint8Array(e);for(let r=0;r<i;r++)t[r]=s.charCodeAt(r);return e}const Ce=Math.log(2);function ke(s){const i=Math.log(s)/Ce,e=Math.floor(i),t=Math.round(i);return e===t?e:t}function re(s,i){for(const e of i)delete s[e]}function ze(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function $e(s){let i=0,e=0;for(let r=0;r<s.length;r++)i+=s[r].byteLength;const t=new Uint8Array(i);for(let r=0;r<s.length;r++){const a=s[r];t.set(new Uint8Array(a),e),e+=a.byteLength}return t.buffer}function Ke(s,i,e,t){return i instanceof Uint8Array?i.byteLength?e<0?(s.error="Wrong parameter: inputOffset less than zero",!1):t<0?(s.error="Wrong parameter: inputLength less than zero",!1):!(i.byteLength-e-t<0&&(s.error="End of input reached before message was fully decoded (inconsistent offset and length values)",1)):(s.error="Wrong parameter: inputBuffer has zero length",!1):(s.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class pt{constructor(){this.items=[]}write(i){this.items.push(i)}final(){return $e(this.items)}}const at=[new Uint8Array([1])],Lt="0123456789",Pt="name",f="valueHexView",Ie=new ArrayBuffer(0),_e=new Uint8Array(0),Ue="EndOfContent",it="OCTET STRING",Qe="BIT STRING";function Et(s){var i;return(i=class extends s{constructor(...t){var r;super(...t);const a=t[0]||{};this.isHexOnly=null!==(r=a.isHexOnly)&&void 0!==r&&r,this.valueHexView=a.valueHex?b._H.toUint8Array(a.valueHex):_e}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(t){this.valueHexView=new Uint8Array(t)}fromBER(t,r,a){const o=t instanceof ArrayBuffer?new Uint8Array(t):t;if(!Ke(this,o,r,a))return-1;const u=r+a;return this.valueHexView=o.subarray(r,u),this.valueHexView.length?(this.blockLength=a,u):(this.warnings.push("Zero buffer length"),r)}toBER(t=!1){return this.isHexOnly?t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Ie)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:b.U$.ToHex(this.valueHexView)}}}).NAME="hexBlock",i}let $t=(()=>{class s{constructor({blockLength:e=0,error:t="",warnings:r=[],valueBeforeDecode:a=_e}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=b._H.toUint8Array(a)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:b.U$.ToHex(this.valueBeforeDecodeView)}}}return s.NAME="baseBlock",s})(),vt=(()=>{class s extends $t{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}return s.NAME="valueBlock",s})(),Sr=(()=>{class s extends(Et($t)){constructor({idBlock:e={}}={}){var t,r,a,o;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?b._H.toUint8Array(e.valueHex):_e,this.tagClass=null!==(r=e.tagClass)&&void 0!==r?r:-1,this.tagNumber=null!==(a=e.tagNumber)&&void 0!==a?a:-1,this.isConstructed=null!==(o=e.isConstructed)&&void 0!==o&&o):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",Ie}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const a=new Uint8Array(1);if(!e){let o=this.tagNumber;o&=31,t|=o,a[0]=t}return a.buffer}if(!this.isHexOnly){const a=Oe(this.tagNumber,7),o=new Uint8Array(a),u=a.byteLength,h=new Uint8Array(u+1);if(h[0]=31|t,!e){for(let m=0;m<u-1;m++)h[m+1]=128|o[m];h[u]=o[u-1]}return h.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){const a=this.valueHexView;for(let o=0;o<a.length-1;o++)r[o+1]=128|a[o];r[this.valueHexView.byteLength]=a[a.length-1]}return r.buffer}fromBER(e,t,r){const a=b._H.toUint8Array(e);if(!Ke(this,a,t,r))return-1;const o=a.subarray(t,t+r);if(0===o.length)return this.error="Zero buffer length",-1;switch(192&o[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=!(32&~o[0]),this.isHexOnly=!1;const h=31&o[0];if(31!==h)this.tagNumber=h,this.blockLength=1;else{let m=1,N=this.valueHexView=new Uint8Array(255),T=255;for(;128&o[m];){if(N[m-1]=127&o[m],m++,m>=o.length)return this.error="End of input reached before message was fully decoded",-1;if(m===T){T+=255;const F=new Uint8Array(T);for(let se=0;se<N.length;se++)F[se]=N[se];N=this.valueHexView=new Uint8Array(T)}}this.blockLength=m+1,N[m-1]=127&o[m];const K=new Uint8Array(m);for(let F=0;F<m;F++)K[F]=N[F];N=this.valueHexView=new Uint8Array(m),N.set(K),this.blockLength<=9?this.tagNumber=be(N,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}return s.NAME="identificationBlock",s})(),St=(()=>{class s extends $t{constructor({lenBlock:e={}}={}){var t,r,a;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(r=e.longFormUsed)&&void 0!==r&&r,this.length=null!==(a=e.length)&&void 0!==a?a:0}fromBER(e,t,r){const a=b._H.toUint8Array(e);if(!Ke(this,a,t,r))return-1;const o=a.subarray(t,t+r);if(0===o.length)return this.error="Zero buffer length",-1;if(255===o[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===o[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&o[0]),!1===this.longFormUsed)return this.length=o[0],this.blockLength=1,t+this.blockLength;const u=127&o[0];if(u>8)return this.error="Too big integer",-1;if(u+1>o.length)return this.error="End of input reached before message was fully decoded",-1;const h=t+1,m=a.subarray(h,h+u);return 0===m[u-1]&&this.warnings.push("Needlessly long encoded length"),this.length=be(m,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=u+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed){const a=Oe(this.length,8);if(a.byteLength>127)return this.error="Too big length",Ie;if(t=new ArrayBuffer(a.byteLength+1),e)return t;const o=new Uint8Array(a);r=new Uint8Array(t),r[0]=128|a.byteLength;for(let u=0;u<a.byteLength;u++)r[u+1]=o[u];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}return s.NAME="lengthBlock",s})();const Re={};let Nt=(()=>{class s extends $t{constructor({name:e="",optional:t=!1,primitiveSchema:r,...a}={},o){super(a),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new Sr(a),this.lenBlock=new St(a),this.valueBlock=o?new o(a):new vt(a)}fromBER(e,t,r){const a=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===a?(this.error=this.valueBlock.error,a):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),a)}toBER(e,t){const r=t||new pt;t||Kt(this);const a=this.idBlock.toBER(e);if(r.write(a),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const o=this.valueBlock.toBER(e);this.lenBlock.length=o.byteLength;const u=this.lenBlock.toBER(e);r.write(u),r.write(o)}return t?Ie:r.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():b.U$.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${b.U$.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){return this===e||e instanceof this.constructor&&ie(this.toBER(),e.toBER())}}return s.NAME="BaseBlock",s})();function Kt(s){if(s instanceof Re.Constructed)for(const i of s.valueBlock.value)Kt(i)&&(s.lenBlock.isIndefiniteForm=!0);return!!s.lenBlock.isIndefiniteForm}let xl=(()=>{class s extends Nt{constructor({value:e="",...t}={},r){super(t,r),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,r){const a=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===a?(this.error=this.valueBlock.error,a):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),a)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}return s.NAME="BaseStringBlock",s})(),eu=(()=>{class s extends(Et(vt)){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}return s.NAME="PrimitiveValueBlock",s})();class Le extends Nt{constructor(i={}){super(i,eu),this.idBlock.isConstructed=!1}}function Gt(s,i=0,e=s.length){const t=i;let r=new Nt({},vt);const a=new $t;if(!Ke(a,s,i,e))return r.error=a.error,{offset:-1,result:r};if(!s.subarray(i,i+e).length)return r.error="Zero buffer length",{offset:-1,result:r};let u=r.idBlock.fromBER(s,i,e);if(r.idBlock.warnings.length&&r.warnings.concat(r.idBlock.warnings),-1===u)return r.error=r.idBlock.error,{offset:-1,result:r};if(u=r.lenBlock.fromBER(s,i=u,e-=r.idBlock.blockLength),r.lenBlock.warnings.length&&r.warnings.concat(r.lenBlock.warnings),-1===u)return r.error=r.lenBlock.error,{offset:-1,result:r};if(i=u,e-=r.lenBlock.blockLength,!r.idBlock.isConstructed&&r.lenBlock.isIndefiniteForm)return r.error="Indefinite length form used for primitive encoding form",{offset:-1,result:r};let h=Nt;if(1===r.idBlock.tagClass){if(r.idBlock.tagNumber>=37&&!1===r.idBlock.isHexOnly)return r.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:r};switch(r.idBlock.tagNumber){case 0:if(r.idBlock.isConstructed&&r.lenBlock.length>0)return r.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:r};h=Re.EndOfContent;break;case 1:h=Re.Boolean;break;case 2:h=Re.Integer;break;case 3:h=Re.BitString;break;case 4:h=Re.OctetString;break;case 5:h=Re.Null;break;case 6:h=Re.ObjectIdentifier;break;case 10:h=Re.Enumerated;break;case 12:h=Re.Utf8String;break;case 13:h=Re.RelativeObjectIdentifier;break;case 14:h=Re.TIME;break;case 15:return r.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:r};case 16:h=Re.Sequence;break;case 17:h=Re.Set;break;case 18:h=Re.NumericString;break;case 19:h=Re.PrintableString;break;case 20:h=Re.TeletexString;break;case 21:h=Re.VideotexString;break;case 22:h=Re.IA5String;break;case 23:h=Re.UTCTime;break;case 24:h=Re.GeneralizedTime;break;case 25:h=Re.GraphicString;break;case 26:h=Re.VisibleString;break;case 27:h=Re.GeneralString;break;case 28:h=Re.UniversalString;break;case 29:h=Re.CharacterString;break;case 30:h=Re.BmpString;break;case 31:h=Re.DATE;break;case 32:h=Re.TimeOfDay;break;case 33:h=Re.DateTime;break;case 34:h=Re.Duration;break;default:{const m=r.idBlock.isConstructed?new Re.Constructed:new Re.Primitive;m.idBlock=r.idBlock,m.lenBlock=r.lenBlock,m.warnings=r.warnings,r=m}}}else h=r.idBlock.isConstructed?Re.Constructed:Re.Primitive;return r=function Ol(s,i){if(s instanceof i)return s;const e=new i;return e.idBlock=s.idBlock,e.lenBlock=s.lenBlock,e.warnings=s.warnings,e.valueBeforeDecodeView=s.valueBeforeDecodeView,e}(r,h),u=r.fromBER(s,i,r.lenBlock.isIndefiniteForm?e:r.lenBlock.length),r.valueBeforeDecodeView=s.subarray(t,t+r.blockLength),{offset:u,result:r}}function ct(s){if(!s.byteLength){const i=new Nt({},vt);return i.error="Input buffer has zero length",{offset:-1,result:i}}return Gt(b._H.toUint8Array(s).slice(),0,s.byteLength)}function im(s,i){return s?1:i}Re.Primitive=Le,Le.NAME="PRIMITIVE";let br=(()=>{class s extends vt{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){const a=b._H.toUint8Array(e);if(!Ke(this,a,t,r))return-1;if(this.valueBeforeDecodeView=a.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let o=t;for(;im(this.isIndefiniteForm,r)>0;){const u=Gt(a,o,r);if(-1===u.offset)return this.error=u.result.error,this.warnings.concat(u.result.warnings),-1;if(o=u.offset,this.blockLength+=u.result.blockLength,r-=u.result.blockLength,this.value.push(u.result),this.isIndefiniteForm&&u.result.constructor.NAME===Ue)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===Ue?this.value.pop():this.warnings.push("No EndOfContent block encoded")),o}toBER(e,t){const r=t||new pt;for(let a=0;a<this.value.length;a++)this.value[a].toBER(e,r);return t?Ie:r.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}return s.NAME="ConstructedValueBlock",s})();class q extends Nt{constructor(i={}){super(i,br),this.idBlock.isConstructed=!0}fromBER(i,e,t){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const r=this.valueBlock.fromBER(i,e,this.lenBlock.isIndefiniteForm?t:this.lenBlock.length);return-1===r?(this.error=this.valueBlock.error,r):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),r)}onAsciiEncoding(){const i=[];for(const t of this.valueBlock.value)i.push(t.toString("ascii").split("\n").map(r=>`  ${r}`).join("\n"));const e=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return i.length?`${e} :\n${i.join("\n")}`:`${e} :`}}Re.Constructed=q,q.NAME="CONSTRUCTED";let nm=(()=>{class s extends vt{fromBER(e,t,r){return t}toBER(e){return Ie}}return s.override="EndOfContentValueBlock",s})();class Yh extends Nt{constructor(i={}){super(i,nm),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}Re.EndOfContent=Yh,Yh.NAME=Ue;class kt extends Nt{constructor(i={}){super(i,vt),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(i,e,t){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=t,e+t>i.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):e+t}toBER(i,e){const t=new ArrayBuffer(2);if(!i){const r=new Uint8Array(t);r[0]=5,r[1]=0}return e&&e.write(t),t}onAsciiEncoding(){return`${this.constructor.NAME}`}}Re.Null=kt,kt.NAME="NULL";let am=(()=>{class s extends(Et(vt)){constructor({value:e,...t}={}){super(t),this.valueHexView=t.valueHex?b._H.toUint8Array(t.valueHex):new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,r){const a=b._H.toUint8Array(e);return Ke(this,a,t,r)?(this.valueHexView=a.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,d.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}return s.NAME="BooleanValueBlock",s})();class ks extends Nt{constructor(i={}){super(i,am),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(i){this.valueBlock.value=i}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}Re.Boolean=ks,ks.NAME="BOOLEAN";let om=(()=>{class s extends(Et(br)){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let a=0;if(this.isConstructed){if(this.isHexOnly=!1,a=br.prototype.fromBER.call(this,e,t,r),-1===a)return a;for(let o=0;o<this.value.length;o++){const u=this.value[o].constructor.NAME;if(u===Ue){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(u!==it)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,a=super.fromBER(e,t,r),this.blockLength=r;return a}toBER(e,t){return this.isConstructed?br.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}return s.NAME="OctetStringValueBlock",s})();class de extends Nt{constructor({idBlock:i={},lenBlock:e={},...t}={}){var r,a;null!==(r=t.isConstructed)&&void 0!==r||(t.isConstructed=!(null===(a=t.value)||void 0===a||!a.length)),super({idBlock:{isConstructed:t.isConstructed,...i},lenBlock:{...e,isIndefiniteForm:!!t.isIndefiniteForm},...t},om),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(i,e,t){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===t)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),e;if(!this.valueBlock.isConstructed){const a=(i instanceof ArrayBuffer?new Uint8Array(i):i).subarray(e,e+t);try{if(a.byteLength){const o=Gt(a,0,a.byteLength);-1!==o.offset&&o.offset===t&&(this.valueBlock.value=[o.result])}}catch{}}return super.fromBER(i,e,t)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?q.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${b.U$.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const i=[];for(const e of this.valueBlock.value)e instanceof de&&i.push(e.valueBlock.valueHexView);return b._H.concat(i)}}Re.OctetString=de,de.NAME=it;let lm=(()=>{class s extends(Et(br)){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let a=-1;if(this.isConstructed){if(a=br.prototype.fromBER.call(this,e,t,r),-1===a)return a;for(const h of this.value){const m=h.constructor.NAME;if(m===Ue){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(m!==Qe)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const N=h.valueBlock;if(this.unusedBits>0&&N.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=N.unusedBits}return a}const o=b._H.toUint8Array(e);if(!Ke(this,o,t,r))return-1;const u=o.subarray(t,t+r);if(this.unusedBits=u[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const h=u.subarray(1);try{if(h.byteLength){const m=Gt(h,0,h.byteLength);-1!==m.offset&&m.offset===r-1&&(this.value=[m.result])}}catch{}}return this.valueHexView=u.subarray(1),this.blockLength=u.length,t+r}toBER(e,t){if(this.isConstructed)return br.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Ie;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}return s.NAME="BitStringValueBlock",s})();var tf;class et extends Nt{constructor({idBlock:i={},lenBlock:e={},...t}={}){var r,a;null!==(r=t.isConstructed)&&void 0!==r||(t.isConstructed=!(null===(a=t.value)||void 0===a||!a.length)),super({idBlock:{isConstructed:t.isConstructed,...i},lenBlock:{...e,isIndefiniteForm:!!t.isIndefiniteForm},...t},lm),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(i,e,t){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(i,e,t)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return q.prototype.onAsciiEncoding.call(this);{const i=[],e=this.valueBlock.valueHexView;for(const r of e)i.push(r.toString(2).padStart(8,"0"));const t=i.join("");return`${this.constructor.NAME} : ${t.substring(0,t.length-this.valueBlock.unusedBits)}`}}}function cm(s,i){const e=new Uint8Array([0]),t=new Uint8Array(s),r=new Uint8Array(i);let a=t.slice(0);const o=a.length-1,u=r.slice(0),h=u.length-1;let m=0,T=0;for(let K=h<o?o:h;K>=0;K--,T++)m=1==T<u.length?a[o-T]+u[h-T]+e[0]:a[o-T]+e[0],e[0]=m/10,1==T>=a.length?a=$(new Uint8Array([m%10]),a):a[o-T]=m%10;return e[0]>0&&(a=$(e,a)),a}function sf(s){if(s>=at.length)for(let i=at.length;i<=s;i++){const e=new Uint8Array([0]);let t=at[i-1].slice(0);for(let r=t.length-1;r>=0;r--){const a=new Uint8Array([(t[r]<<1)+e[0]]);e[0]=a[0]/10,t[r]=a[0]%10}e[0]>0&&(t=$(e,t)),at.push(t)}return at[s]}function um(s,i){let e=0;const t=new Uint8Array(s),r=new Uint8Array(i),a=t.slice(0),o=a.length-1,u=r.slice(0),h=u.length-1;let m,N=0;for(let T=h;T>=0;T--,N++)m=a[o-N]-u[h-N]-e,1==m<0?(e=1,a[o-N]=m+10):(e=0,a[o-N]=m);if(e>0)for(let T=o-h+1;T>=0;T--,N++){if(m=a[o-N]-e,!(m<0)){e=0,a[o-N]=m;break}e=1,a[o-N]=m+10}return a.slice()}Re.BitString=et,et.NAME=Qe;class tu extends(Et(vt)){constructor({value:i,...e}={}){super(e),this._valueDec=0,e.valueHex&&this.setValueHex(),void 0!==i&&(this.valueDec=i)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=d.call(this)))}set valueDec(i){this._valueDec=i,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function D(s){const i=s<0?-1*s:s;let e=128;for(let t=1;t<8;t++){if(i<=e){if(s<0){const u=Oe(e-i,8,t);return new Uint8Array(u)[0]|=128,u}let r=Oe(i,8,t),a=new Uint8Array(r);if(128&a[0]){const o=r.slice(0),u=new Uint8Array(o);r=new ArrayBuffer(r.byteLength+1),a=new Uint8Array(r);for(let h=0;h<o.byteLength;h++)a[h+1]=u[h];a[0]=0}return r}e*=Math.pow(2,8)}return new ArrayBuffer(0)}(i))}get valueDec(){return this._valueDec}fromDER(i,e,t,r=0){const a=this.fromBER(i,e,t);if(-1===a)return a;const o=this.valueHexView;return 0===o[0]&&128&o[1]?this.valueHexView=o.subarray(1):0!==r&&o.length<r&&(r-o.length>1&&(r=o.length+1),this.valueHexView=o.subarray(r-o.length)),a}toDER(i=!1){const e=this.valueHexView;switch(!0){case!!(128&e[0]):{const t=new Uint8Array(this.valueHexView.length+1);t[0]=0,t.set(e,1),this.valueHexView=t}break;case 0===e[0]&&!(128&e[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(i)}fromBER(i,e,t){const r=super.fromBER(i,e,t);return-1===r||this.setValueHex(),r}toBER(i){return i?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const i=8*this.valueHexView.length-1;let r,e=new Uint8Array(8*this.valueHexView.length/3),t=0;const a=this.valueHexView;let o="",u=!1;for(let h=a.byteLength-1;h>=0;h--){r=a[h];for(let m=0;m<8;m++)1&~r||(t===i?(e=um(sf(t),e),o="-"):e=cm(e,sf(t))),t++,r>>=1}for(let h=0;h<e.length;h++)e[h]&&(u=!0),u&&(o+=Lt.charAt(e[h]));return!1===u&&(o+=Lt.charAt(0)),o}}tf=tu,tu.NAME="IntegerValueBlock",Object.defineProperty(tf.prototype,"valueHex",{set:function(s){this.valueHexView=new Uint8Array(s),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class Y extends Nt{constructor(i={}){super(i,tu),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return ze(),BigInt(this.valueBlock.toString())}static fromBigInt(i){ze();const e=BigInt(i),t=new pt,r=e.toString(16).replace(/^-/,""),a=new Uint8Array(b.U$.FromHex(r));if(e<0){const u=new Uint8Array(a.length+(128&a[0]?1:0));u[0]|=128;const m=BigInt(`0x${b.U$.ToHex(u)}`)+e,N=b._H.toUint8Array(b.U$.FromHex(m.toString(16)));N[0]|=128,t.write(N)}else 128&a[0]&&t.write(new Uint8Array([0])),t.write(a);return new Y({valueHex:t.final()})}convertToDER(){const i=new Y({valueHex:this.valueBlock.valueHexView});return i.valueBlock.toDER(),i}convertFromDER(){return new Y({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}Re.Integer=Y,Y.NAME="INTEGER";class ua extends Y{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}Re.Enumerated=ua,ua.NAME="ENUMERATED";let af=(()=>{class s extends(Et(vt)){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;const a=b._H.toUint8Array(e);if(!Ke(this,a,t,r))return-1;const o=a.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let h=0;h<r&&(this.valueHexView[h]=127&o[h],this.blockLength++,128&o[h]);h++);const u=new Uint8Array(this.blockLength);for(let h=0;h<this.blockLength;h++)u[h]=this.valueHexView[h];return this.valueHexView=u,128&o[this.blockLength-1]?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=be(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){ze();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let a=0;a<r.length;a++)r[a]=parseInt(t.slice(7*a,7*a+7),2)+(a+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const a=this.valueHexView,o=new Uint8Array(this.blockLength);for(let u=0;u<this.blockLength-1;u++)o[u]=128|a[u];return o[this.blockLength-1]=a[this.blockLength-1],o.buffer}const t=Oe(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Ie;const r=new Uint8Array(t.byteLength);if(!e){const a=new Uint8Array(t),o=t.byteLength-1;for(let u=0;u<o;u++)r[u]=128|a[u];r[o]=a[o]}return r}toString(){let e="";if(this.isHexOnly)e=b.U$.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}return s.NAME="sidBlock",s})(),hm=(()=>{class s extends vt{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let a=t;for(;r>0;){const o=new af;if(a=o.fromBER(e,a,r),-1===a)return this.blockLength=0,this.error=o.error,a;0===this.value.length&&(o.isFirstSid=!0),this.blockLength+=o.blockLength,r-=o.blockLength,this.value.push(o)}return a}toBER(e){const t=[];for(let r=0;r<this.value.length;r++){const a=this.value[r].toBER(e);if(0===a.byteLength)return this.error=this.value[r].error,Ie;t.push(a)}return $e(t)}fromString(e){this.value=[];let t=0,r=0,a="",o=!1;do{if(r=e.indexOf(".",t),a=-1===r?e.substring(t):e.substring(t,r),t=r+1,o){const u=this.value[0];let h=0;switch(u.valueDec){case 0:break;case 1:h=40;break;case 2:h=80;break;default:return void(this.value=[])}const m=parseInt(a,10);if(isNaN(m))return;u.valueDec=m+h,o=!1}else{const u=new af;if(a>Number.MAX_SAFE_INTEGER){ze();const h=BigInt(a);u.valueBigInt=h}else if(u.valueDec=parseInt(a,10),isNaN(u.valueDec))return;this.value.length||(u.isFirstSid=!0,o=!0),this.value.push(u)}}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let a=this.value[r].toString();0!==r&&(e=`${e}.`),t?(a=`{${a}}`,this.value[r].isFirstSid?e=`2.{${a} - 80}`:e+=a):e+=a}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}return s.NAME="ObjectIdentifierValueBlock",s})();class Ve extends Nt{constructor(i={}){super(i,hm),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(i){this.valueBlock.fromString(i)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Re.ObjectIdentifier=Ve,Ve.NAME="OBJECT IDENTIFIER";let lf=(()=>{class s extends(Et($t)){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;const a=b._H.toUint8Array(e);if(!Ke(this,a,t,r))return-1;const o=a.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let h=0;h<r&&(this.valueHexView[h]=127&o[h],this.blockLength++,128&o[h]);h++);const u=new Uint8Array(this.blockLength);for(let h=0;h<this.blockLength;h++)u[h]=this.valueHexView[h];return this.valueHexView=u,128&o[this.blockLength-1]?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=be(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const a=this.valueHexView,o=new Uint8Array(this.blockLength);for(let u=0;u<this.blockLength-1;u++)o[u]=128|a[u];return o[this.blockLength-1]=a[this.blockLength-1],o.buffer}const t=Oe(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Ie;const r=new Uint8Array(t.byteLength);if(!e){const a=new Uint8Array(t),o=t.byteLength-1;for(let u=0;u<o;u++)r[u]=128|a[u];r[o]=a[o]}return r.buffer}toString(){let e="";return e=this.isHexOnly?b.U$.ToHex(this.valueHexView):this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}return s.NAME="relativeSidBlock",s})(),fm=(()=>{class s extends vt{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let a=t;for(;r>0;){const o=new lf;if(a=o.fromBER(e,a,r),-1===a)return this.blockLength=0,this.error=o.error,a;this.blockLength+=o.blockLength,r-=o.blockLength,this.value.push(o)}return a}toBER(e,t){const r=[];for(let a=0;a<this.value.length;a++){const o=this.value[a].toBER(e);if(0===o.byteLength)return this.error=this.value[a].error,Ie;r.push(o)}return $e(r)}fromString(e){this.value=[];let t=0,r=0,a="";do{r=e.indexOf(".",t),a=-1===r?e.substring(t):e.substring(t,r),t=r+1;const o=new lf;if(o.valueDec=parseInt(a,10),isNaN(o.valueDec))return!0;this.value.push(o)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let a=this.value[r].toString();0!==r&&(e=`${e}.`),t&&(a=`{${a}}`),e+=a}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}return s.NAME="RelativeObjectIdentifierValueBlock",s})();class uf extends Nt{constructor(i={}){super(i,fm),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(i){this.valueBlock.fromString(i)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Re.RelativeObjectIdentifier=uf,uf.NAME="RelativeObjectIdentifier";class O extends q{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}Re.Sequence=O,O.NAME="SEQUENCE";class _t extends q{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}Re.Set=_t,_t.NAME="SET";let dm=(()=>{class s extends(Et(vt)){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=""}toJSON(){return{...super.toJSON(),value:this.value}}}return s.NAME="StringValueBlock",s})(),mm=(()=>{class s extends dm{}return s.NAME="SimpleStringValueBlock",s})(),Jt=(()=>{class s extends xl{constructor({...e}={}){super(e,mm)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,b._H.toUint8Array(e))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let a=0;a<t;a++)r[a]=e.charCodeAt(a);this.valueBlock.value=e}}return s.NAME="SIMPLE STRING",s})(),gm=(()=>{class s extends Jt{fromBuffer(e){this.valueBlock.valueHexView=b._H.toUint8Array(e);try{this.valueBlock.value=b.U$.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=b.U$.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(b.U$.FromUtf8String(e)),this.valueBlock.value=e}}return s.NAME="Utf8StringValueBlock",s})();class rs extends gm{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Re.Utf8String=rs,rs.NAME="UTF8String";let pm=(()=>{class s extends Jt{fromBuffer(e){this.valueBlock.value=b.U$.ToUtf16String(e),this.valueBlock.valueHexView=b._H.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(b.U$.FromUtf16String(e))}}return s.NAME="BmpStringValueBlock",s})();class Xt extends pm{constructor({...i}={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}Re.BmpString=Xt,Xt.NAME="BMPString";let vm=(()=>{class s extends Jt{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let a=0;a<r.length;a+=4)r[a]=r[a+3],r[a+1]=r[a+2],r[a+2]=0,r[a+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let a=0;a<t;a++){const o=Oe(e.charCodeAt(a),8),u=new Uint8Array(o);if(u.length>4)continue;const h=4-u.length;for(let m=u.length-1;m>=0;m--)r[4*a+m+h]=u[m]}this.valueBlock.value=e}}return s.NAME="UniversalStringValueBlock",s})();class ha extends vm{constructor({...i}={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}Re.UniversalString=ha,ha.NAME="UniversalString";class Ui extends Jt{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}Re.NumericString=Ui,Ui.NAME="NumericString";class qt extends Jt{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}Re.PrintableString=qt,qt.NAME="PrintableString";class fa extends Jt{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}Re.TeletexString=fa,fa.NAME="TeletexString";class su extends Jt{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}Re.VideotexString=su,su.NAME="VideotexString";class Pl extends Jt{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}Re.IA5String=Pl,Pl.NAME="IA5String";class ru extends Jt{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}Re.GraphicString=ru,ru.NAME="GraphicString";class Dl extends Jt{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}Re.VisibleString=Dl,Dl.NAME="VisibleString";class iu extends Jt{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}Re.GeneralString=iu,iu.NAME="GeneralString";class nu extends Jt{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}Re.CharacterString=nu,nu.NAME="CharacterString";class Mi extends Dl{constructor({value:i,valueDate:e,...t}={}){if(super(t),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,i){this.fromString(i),this.valueBlock.valueHexView=new Uint8Array(i.length);for(let r=0;r<i.length;r++)this.valueBlock.valueHexView[r]=i.charCodeAt(r)}e&&(this.fromDate(e),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(i){this.fromString(String.fromCharCode.apply(null,b._H.toUint8Array(i)))}toBuffer(){const i=this.toString(),e=new ArrayBuffer(i.length),t=new Uint8Array(e);for(let r=0;r<i.length;r++)t[r]=i.charCodeAt(r);return e}fromDate(i){this.year=i.getUTCFullYear(),this.month=i.getUTCMonth()+1,this.day=i.getUTCDate(),this.hour=i.getUTCHours(),this.minute=i.getUTCMinutes(),this.second=i.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(i){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(i);if(null===t)return void(this.error="Wrong input string for conversion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(i="iso"){if("iso"===i){const e=new Array(7);return e[0]=W(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=W(this.month,2),e[2]=W(this.day,2),e[3]=W(this.hour,2),e[4]=W(this.minute,2),e[5]=W(this.second,2),e[6]="Z",e.join("")}return super.toString(i)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}Re.UTCTime=Mi,Mi.NAME="UTCTime";class ht extends Mi{constructor(i={}){var e;super(i),null!==(e=this.millisecond)&&void 0!==e||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(i){super.fromDate(i),this.millisecond=i.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(i){let o,e=!1,t="",r="",a=0,u=0,h=0;if("Z"===i[i.length-1])t=i.substring(0,i.length-1),e=!0;else{const T=new Number(i[i.length-1]);if(isNaN(T.valueOf()))throw new Error("Wrong input string for conversion");t=i}if(e){if(-1!==t.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==t.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let T=1,K=t.indexOf("+"),F="";if(-1===K&&(K=t.indexOf("-"),T=-1),-1!==K){if(F=t.substring(K+1),t=t.substring(0,K),2!==F.length&&4!==F.length)throw new Error("Wrong input string for conversion");let se=parseInt(F.substring(0,2),10);if(isNaN(se.valueOf()))throw new Error("Wrong input string for conversion");if(u=T*se,4===F.length){if(se=parseInt(F.substring(2,4),10),isNaN(se.valueOf()))throw new Error("Wrong input string for conversion");h=T*se}}}let m=t.indexOf(".");if(-1===m&&(m=t.indexOf(",")),-1!==m){const T=new Number(`0${t.substring(m)}`);if(isNaN(T.valueOf()))throw new Error("Wrong input string for conversion");a=T.valueOf(),r=t.substring(0,m)}else r=t;switch(!0){case 8===r.length:if(o=/(\d{4})(\d{2})(\d{2})/gi,-1!==m)throw new Error("Wrong input string for conversion");break;case 10===r.length:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==m){let T=60*a;this.minute=Math.floor(T),T=60*(T-this.minute),this.second=Math.floor(T),T=1e3*(T-this.second),this.millisecond=Math.floor(T)}break;case 12===r.length:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==m){let T=60*a;this.second=Math.floor(T),T=1e3*(T-this.second),this.millisecond=Math.floor(T)}break;case 14===r.length:o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==m&&(this.millisecond=Math.floor(1e3*a));break;default:throw new Error("Wrong input string for conversion")}const N=o.exec(r);if(null===N)throw new Error("Wrong input string for conversion");for(let T=1;T<N.length;T++)switch(T){case 1:this.year=parseInt(N[T],10);break;case 2:this.month=parseInt(N[T],10);break;case 3:this.day=parseInt(N[T],10);break;case 4:this.hour=parseInt(N[T],10)+u;break;case 5:this.minute=parseInt(N[T],10)+h;break;case 6:this.second=parseInt(N[T],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===e){const T=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=T.getUTCFullYear(),this.month=T.getUTCMonth(),this.day=T.getUTCDay(),this.hour=T.getUTCHours(),this.minute=T.getUTCMinutes(),this.second=T.getUTCSeconds(),this.millisecond=T.getUTCMilliseconds()}}toString(i="iso"){if("iso"===i){const e=[];return e.push(W(this.year,4)),e.push(W(this.month,2)),e.push(W(this.day,2)),e.push(W(this.hour,2)),e.push(W(this.minute,2)),e.push(W(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(W(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(i)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}Re.GeneralizedTime=ht,ht.NAME="GeneralizedTime";class If extends rs{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}Re.DATE=If,If.NAME="DATE";class Rf extends rs{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}Re.TimeOfDay=Rf,Rf.NAME="TimeOfDay";class xf extends rs{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}Re.DateTime=xf,xf.NAME="DateTime";class Of extends rs{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}Re.Duration=Of,Of.NAME="Duration";class Df extends rs{constructor(i={}){super(i),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}Re.TIME=Df,Df.NAME="TIME";class Fe{constructor({name:i="",optional:e=!1}={}){this.name=i,this.optional=e}}class ft extends Fe{constructor({value:i=[],...e}={}){super(e),this.value=i}}class Ge extends Fe{constructor({value:i=new Fe,local:e=!1,...t}={}){super(t),this.value=i,this.local=e}}class Ul{constructor({data:i=_e}={}){this.dataView=b._H.toUint8Array(i)}get data(){return this.dataView.slice().buffer}set data(i){this.dataView=b._H.toUint8Array(i)}fromBER(i,e,t){const r=e+t;return this.dataView=b._H.toUint8Array(i).subarray(e,r),r}toBER(i){return this.dataView.slice().buffer}}function ue(s,i,e){if(e instanceof ft){for(let a=0;a<e.value.length;a++)if(ue(s,i,e.value[a]).verified)return{verified:!0,result:s};{const a={verified:!1,result:{error:"Wrong values for Choice type"}};return e.hasOwnProperty(Pt)&&(a.name=e.name),a}}if(e instanceof Fe)return e.hasOwnProperty(Pt)&&(s[e.name]=i),{verified:!0,result:s};if(!(s instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(i instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!("idBlock"in e))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!("fromBER"in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!("toBER"in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const t=e.idBlock.toBER(!1);if(0===t.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===e.idBlock.fromBER(t,0,t.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===e.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagClass!==i.idBlock.tagClass)return{verified:!1,result:s};if(!1===e.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagNumber!==i.idBlock.tagNumber)return{verified:!1,result:s};if(!1===e.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isConstructed!==i.idBlock.isConstructed)return{verified:!1,result:s};if(!("isHexOnly"in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isHexOnly!==i.idBlock.isHexOnly)return{verified:!1,result:s};if(e.idBlock.isHexOnly){if(!(f in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const a=e.idBlock.valueHexView,o=i.idBlock.valueHexView;if(a.length!==o.length)return{verified:!1,result:s};for(let u=0;u<a.length;u++)if(a[u]!==o[1])return{verified:!1,result:s}}if(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&(s[e.name]=i)),e instanceof Re.Constructed){let a=0,o={verified:!1,result:{error:"Unknown error"}},u=e.valueBlock.value.length;if(u>0&&e.valueBlock.value[0]instanceof Ge&&(u=i.valueBlock.value.length),0===u)return{verified:!0,result:s};if(0===i.valueBlock.value.length&&0!==e.valueBlock.value.length){let h=!0;for(let m=0;m<e.valueBlock.value.length;m++)h=h&&(e.valueBlock.value[m].optional||!1);return h?{verified:!0,result:s}:(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&delete s[e.name]),s.error="Inconsistent object length",{verified:!1,result:s})}for(let h=0;h<u;h++)if(h-a>=i.valueBlock.value.length){if(!1===e.valueBlock.value[h].optional){const m={verified:!1,result:s};return s.error="Inconsistent length between ASN.1 data and schema",e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&(delete s[e.name],m.name=e.name)),m}}else if(e.valueBlock.value[0]instanceof Ge){if(o=ue(s,i.valueBlock.value[h],e.valueBlock.value[0].value),!1===o.verified){if(!e.valueBlock.value[0].optional)return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&delete s[e.name]),o;a++}if(Pt in e.valueBlock.value[0]&&e.valueBlock.value[0].name.length>0){let m={};m="local"in e.valueBlock.value[0]&&e.valueBlock.value[0].local?i:s,typeof m[e.valueBlock.value[0].name]>"u"&&(m[e.valueBlock.value[0].name]=[]),m[e.valueBlock.value[0].name].push(i.valueBlock.value[h])}}else if(o=ue(s,i.valueBlock.value[h-a],e.valueBlock.value[h]),!1===o.verified){if(!e.valueBlock.value[h].optional)return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&delete s[e.name]),o;a++}if(!1===o.verified){const h={verified:!1,result:s};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&(delete s[e.name],h.name=e.name)),h}return{verified:!0,result:s}}if(e.primitiveSchema&&f in i.valueBlock){const a=Gt(i.valueBlock.valueHexView);if(-1===a.offset){const o={verified:!1,result:a.result};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&(delete s[e.name],o.name=e.name)),o}return ue(s,a.result,e.primitiveSchema)}return{verified:!0,result:s}}class wt{constructor(i={}){if("view"in i)this.fromUint8Array(i.view);else if("buffer"in i)this.fromArrayBuffer(i.buffer);else if("string"in i)this.fromString(i.string);else if("hexstring"in i)this.fromHexString(i.hexstring);else if("length"in i&&i.length>0){if(this.length=i.length,i.stub)for(let e=0;e<this._view.length;e++)this._view[e]=i.stub}else this.length=0}set buffer(i){this._buffer=i,this._view=new Uint8Array(this._buffer)}get buffer(){return this._buffer}set view(i){this._buffer=new ArrayBuffer(i.length),this._view=new Uint8Array(this._buffer),this._view.set(i)}get view(){return this._view}get length(){return this.view.byteLength}set length(i){this._buffer=new ArrayBuffer(i),this._view=new Uint8Array(this._buffer)}clear(){this._buffer=new ArrayBuffer(0),this._view=new Uint8Array(this._buffer)}fromArrayBuffer(i){this._buffer=i,this._view=new Uint8Array(this._buffer)}fromUint8Array(i){this.fromArrayBuffer(new Uint8Array(i).buffer)}fromString(i){const e=i.length;this.length=e;for(let t=0;t<e;t++)this.view[t]=i.charCodeAt(t)}toString(i=0,e=this.view.length-i){let t="";(i>=this.view.length||i<0)&&(i=0),(e>=this.view.length||e<0)&&(e=this.view.length-i);for(let r=i;r<i+e;r++)t+=String.fromCharCode(this.view[r]);return t}fromHexString(i){const e=i.length;this.buffer=new ArrayBuffer(e>>1),this.view=new Uint8Array(this.buffer);const t=new Map;t.set("0",0),t.set("1",1),t.set("2",2),t.set("3",3),t.set("4",4),t.set("5",5),t.set("6",6),t.set("7",7),t.set("8",8),t.set("9",9),t.set("A",10),t.set("a",10),t.set("B",11),t.set("b",11),t.set("C",12),t.set("c",12),t.set("D",13),t.set("d",13),t.set("E",14),t.set("e",14),t.set("F",15),t.set("f",15);let r=0,a=0;for(let o=0;o<e;o++)o%2?(a|=t.get(i.charAt(o)),this.view[r]=a,r++):a=t.get(i.charAt(o))<<4}toHexString(i=0,e=this.view.length-i){let t="";(i>=this.view.length||i<0)&&(i=0),(e>=this.view.length||e<0)&&(e=this.view.length-i);for(let r=i;r<i+e;r++){const a=this.view[r].toString(16).toUpperCase();t=t+(1==a.length?"0":"")+a}return t}copy(i=0,e=this.length-i){if(!i&&!this.length)return new wt;if(i<0||i>this.length-1)throw new Error(`Wrong start position: ${i}`);return new wt({buffer:this._buffer.slice(i,i+e)})}slice(i=0,e=this.length){if(!i&&!this.length)return new wt;if(i<0||i>this.length-1)throw new Error(`Wrong start position: ${i}`);return new wt({buffer:this._buffer.slice(i,e)})}realloc(i){const e=new ArrayBuffer(i);new Uint8Array(e).set(i>this._view.length?this._view:new Uint8Array(this._buffer,0,i)),this._buffer=e,this._view=new Uint8Array(this._buffer)}append(i){const e=this.length,t=i.length,r=i._view.subarray();this.realloc(e+t),this._view.set(r,e)}insert(i,e=0,t=this.length-e){return!(e>this.length-1||(t>this.length-e&&(t=this.length-e),t>i.length&&(t=i.length),this._view.set(t==i.length?i._view:i._view.subarray(0,t),e),0))}isEqual(i){if(this.length!=i.length)return!1;for(let e=0;e<i.length;e++)if(this.view[e]!=i.view[e])return!1;return!0}isEqualView(i){if(i.length!=this.view.length)return!1;for(let e=0;e<i.length;e++)if(this.view[e]!=i[e])return!1;return!0}findPattern(i,e,t,r){const{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,r),h=i.length;if(h>o)return-1;const m=[];for(let N=0;N<h;N++)m.push(i.view[N]);for(let N=0;N<=o-h;N++){let T=!0;const K=u?a-h-N:a+N;for(let F=0;F<h;F++)if(this.view[F+K]!=m[F]){T=!1;break}if(T)return u?a-h-N:a+h+N}return-1}findFirstIn(i,e,t,r){const{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,r),h={id:-1,position:u?0:a+o,length:0};for(let m=0;m<i.length;m++){const N=this.findPattern(i[m],a,o,u);if(-1!=N){let T=!1;const K=i[m].length;u?N-K>=h.position-h.length&&(T=!0):N-K<=h.position-h.length&&(T=!0),T&&(h.position=N,h.id=m,h.length=K)}}return h}findAllIn(i,e,t){let{start:r,length:a}=this.prepareFindParameters(e,t);const o=[];let u={id:-1,position:r};for(;;){const h=u.position;if(u=this.findFirstIn(i,u.position,a),-1==u.id)break;a-=u.position-h,o.push({id:u.id,position:u.position})}return o}findAllPatternIn(i,e,t){const{start:r,length:a}=this.prepareFindParameters(e,t),o=[],u=i.length;if(u>a)return-1;const h=Array.from(i.view);for(let m=0;m<=a-u;m++){let N=!0;const T=r+m;for(let K=0;K<u;K++)if(this.view[K+T]!=h[K]){N=!1;break}N&&(o.push(r+u+m),m+=u-1)}return o}findFirstNotIn(i,e,t,r){let{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,r);const h={left:{id:-1,position:a},right:{id:-1,position:0},value:new wt};let m=o;for(;m>0;){if(h.right=this.findFirstIn(i,u?a-o+m:a+o-m,m,u),-1==h.right.id){o=m,u?a-=o:a=h.left.position,h.value=new wt({buffer:this._buffer.slice(a,a+o)});break}if(h.right.position!=(u?h.left.position-i[h.right.id].length:h.left.position+i[h.right.id].length)){u?(a=h.right.position+i[h.right.id].length,o=h.left.position-h.right.position-i[h.right.id].length):(a=h.left.position,o=h.right.position-h.left.position-i[h.right.id].length),h.value=new wt({buffer:this._buffer.slice(a,a+o)});break}h.left=h.right,m-=i[h.right.id].length}if(u){const N=h.right;h.right=h.left,h.left=N}return h}findAllNotIn(i,e,t){let{start:r,length:a}=this.prepareFindParameters(e,t);const o=[];let u={left:{id:-1,position:r},right:{id:-1,position:r},value:new wt};do{const h=u.right.position;u=this.findFirstNotIn(i,u.right.position,a),a-=u.right.position-h,o.push({left:{id:u.left.id,position:u.left.position},right:{id:u.right.id,position:u.right.position},value:u.value})}while(-1!=u.right.id);return o}findFirstSequence(i,e,t,r){let{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,r);const h=this.skipNotPatterns(i,a,o,u);if(-1==h)return{position:-1,value:new wt};const m=this.skipPatterns(i,h,o-(u?a-h:h-a),u);return u?(a=m,o=h-m):(a=h,o=m-h),{position:m,value:new wt({buffer:this._buffer.slice(a,a+o)})}}findAllSequences(i,e,t){let{start:r,length:a}=this.prepareFindParameters(e,t);const o=[];let u={position:r,value:new wt};do{const h=u.position;u=this.findFirstSequence(i,u.position,a),-1!=u.position&&(a-=u.position-h,o.push({position:u.position,value:u.value}))}while(-1!=u.position);return o}findPairedPatterns(i,e,t,r){const a=[];if(i.isEqual(e))return a;const{start:o,length:u}=this.prepareFindParameters(t,r);let h=0;const m=this.findAllPatternIn(i,o,u);if(!Array.isArray(m)||0==m.length)return a;const N=this.findAllPatternIn(e,o,u);if(!Array.isArray(N)||0==N.length)return a;for(;h<m.length&&0!=N.length;)if(m[0]!=N[0]){if(m[h]>N[0])break;for(;m[h]<N[0]&&(h++,!(h>=m.length)););a.push({left:m[h-1],right:N[0]}),m.splice(h-1,1),N.splice(0,1),h=0}else a.push({left:m[0],right:N[0]}),m.splice(0,1),N.splice(0,1);return a.sort((T,K)=>T.left-K.left),a}findPairedArrays(i,e,t,r){const{start:a,length:o}=this.prepareFindParameters(t,r),u=[];let h=0;const m=this.findAllIn(i,a,o);if(0==m.length)return u;const N=this.findAllIn(e,a,o);if(0==N.length)return u;for(;h<m.length&&0!=N.length;)if(m[0].position!=N[0].position){if(m[h].position>N[0].position)break;for(;m[h].position<N[0].position&&(h++,!(h>=m.length)););u.push({left:m[h-1],right:N[0]}),m.splice(h-1,1),N.splice(0,1),h=0}else u.push({left:m[0],right:N[0]}),m.splice(0,1),N.splice(0,1);return u.sort((T,K)=>T.left.position-K.left.position),u}replacePattern(i,e,t,r,a=null){let u,o=[];const h={status:-1,searchPatternPositions:[],replacePatternPositions:[]},{start:m,length:N}=this.prepareFindParameters(t,r);if(null==a){if(o=this.findAllIn([i],m,N),0==o.length)return h}else o=a;h.searchPatternPositions.push(...Array.from(o,se=>se.position));const T=i.length-e.length,K=new ArrayBuffer(this.view.length-o.length*T),F=new Uint8Array(K);for(F.set(new Uint8Array(this.buffer,0,m)),u=0;u<o.length;u++){const se=0==u?m:o[u-1].position;F.set(new Uint8Array(this.buffer,se,o[u].position-i.length-se),se-u*T),F.set(e.view,o[u].position-i.length-u*T),h.replacePatternPositions.push(o[u].position-i.length-u*T)}return u--,F.set(new Uint8Array(this.buffer,o[u].position,this.length-o[u].position),o[u].position-i.length+e.length-u*T),this.buffer=K,this.view=new Uint8Array(this.buffer),h.status=1,h}skipPatterns(i,e,t,r){const{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,r);let h=a;for(let m=0;m<i.length;m++){const N=i[m].length,T=u?h-N:h;let K=!0;for(let F=0;F<N;F++)if(this.view[F+T]!=i[m].view[F]){K=!1;break}if(K)if(m=-1,u){if(h-=N,h<=0)return h}else if(h+=N,h>=a+o)return h}return h}skipNotPatterns(i,e,t,r){const{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,r);let h=-1;for(let m=0;m<o;m++){for(let N=0;N<i.length;N++){const T=i[N].length,K=u?a-m-T:a+m;let F=!0;for(let se=0;se<T;se++)if(this.view[se+K]!=i[N].view[se]){F=!1;break}if(F){h=u?a-m:a+m;break}}if(-1!=h)break}return h}prepareFindParameters(i=null,e=null,t=!1){return null===i&&(i=t?this.length:0),i>this.length&&(i=this.length),t?(null===e&&(e=i),e>i&&(e=i)):(null===e&&(e=this.length-i),e>this.length-i&&(e=this.length-i)),{start:i,length:e,backward:t}}}let da=(()=>{class s{constructor(e={}){this._stream=new wt,this._length=0,this._start=0,this.backward=!1,this.appendBlock=0,this.prevLength=0,this.prevStart=0,this.stream="view"in e?new wt({view:e.view}):"buffer"in e?new wt({buffer:e.buffer}):"string"in e?new wt({string:e.string}):"hexstring"in e?new wt({hexstring:e.hexstring}):"stream"in e?e.stream.slice():new wt,"backward"in e&&e.backward&&(this.backward=e.backward,this._start=this.stream.length),"length"in e&&e.length>0&&(this._length=e.length),"start"in e&&e.start&&e.start>0&&(this._start=e.start),"appendBlock"in e&&e.appendBlock&&e.appendBlock>0&&(this.appendBlock=e.appendBlock)}set stream(e){this._stream=e,this.prevLength=this._length,this._length=e.length,this.prevStart=this._start,this._start=0}get stream(){return this._stream}set length(e){this.prevLength=this._length,this._length=e}get length(){return this.appendBlock?this.start:this._length}set start(e){e>this.stream.length||(this.prevStart=this._start,this.prevLength=this._length,this._length-=this.backward?this._start-e:e-this._start,this._start=e)}get start(){return this._start}get buffer(){return this._stream.buffer.slice(0,this._length)}resetPosition(){this._start=this.prevStart,this._length=this.prevLength}findPattern(e,t=null){(null==t||t>this.length)&&(t=this.length);const r=this.stream.findPattern(e,this.start,this.length,this.backward);if(-1==r)return r;if(this.backward){if(r<this.start-e.length-t)return-1}else if(r>this.start+e.length+t)return-1;return this.start=r,r}findFirstIn(e,t=null){(null==t||t>this.length)&&(t=this.length);const r=this.stream.findFirstIn(e,this.start,this.length,this.backward);if(-1==r.id)return r;if(this.backward){if(r.position<this.start-e[r.id].length-t)return{id:-1,position:this.backward?0:this.start+this.length}}else if(r.position>this.start+e[r.id].length+t)return{id:-1,position:this.backward?0:this.start+this.length};return this.start=r.position,r}findAllIn(e){return this.stream.findAllIn(e,this.backward?this.start-this.length:this.start,this.length)}findFirstNotIn(e,t=null){(null==t||t>this._length)&&(t=this._length);const r=this._stream.findFirstNotIn(e,this._start,this._length,this.backward);if(-1==r.left.id&&-1==r.right.id)return r;if(this.backward){if(-1!=r.right.id&&r.right.position<this._start-e[r.right.id].length-t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new wt}}else if(-1!=r.left.id&&r.left.position>this._start+e[r.left.id].length+t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new wt};return this.start=this.backward?-1==r.left.id?0:r.left.position:-1==r.right.id?this._start+this._length:r.right.position,r}findAllNotIn(e){return this._stream.findAllNotIn(e,this.backward?this._start-this._length:this._start,this._length)}findFirstSequence(e,t=null,r=null){(null==t||t>this._length)&&(t=this._length),(null==r||r>t)&&(r=t);const a=this._stream.findFirstSequence(e,this._start,t,this.backward);if(0==a.value.length)return a;if(this.backward){if(a.position<this._start-a.value.length-r)return{position:-1,value:new wt}}else if(a.position>this._start+a.value.length+r)return{position:-1,value:new wt};return this.start=a.position,a}findAllSequences(e){return this.stream.findAllSequences(e,this.backward?this.start-this.length:this.start,this.length)}findPairedPatterns(e,t,r=null){(null==r||r>this.length)&&(r=this.length);const o=this.stream.findPairedPatterns(e,t,this.backward?this.start-this.length:this.start,this.length);if(o.length)if(this.backward){if(o[0].right<this.start-t.length-r)return[]}else if(o[0].left>this.start+e.length+r)return[];return o}findPairedArrays(e,t,r=null){(null==r||r>this.length)&&(r=this.length);const o=this.stream.findPairedArrays(e,t,this.backward?this.start-this.length:this.start,this.length);if(o.length)if(this.backward){if(o[0].right.position<this.start-t[o[0].right.id].length-r)return[]}else if(o[0].left.position>this.start+e[o[0].left.id].length+r)return[];return o}replacePattern(e,t){return this.stream.replacePattern(e,t,this.backward?this.start-this.length:this.start,this.length)}skipPatterns(e){const t=this.stream.skipPatterns(e,this.start,this.length,this.backward);return this.start=t,t}skipNotPatterns(e){const t=this.stream.skipNotPatterns(e,this.start,this.length,this.backward);return-1==t?-1:(this.start=t,t)}append(e){this.beforeAppend(e.length),this._stream.view.set(e.view,this._start),this._length+=2*e.length,this.start=this._start+e.length,this.prevLength-=2*e.length}appendView(e){this.beforeAppend(e.length),this._stream.view.set(e,this._start),this._length+=2*e.length,this.start=this._start+e.length,this.prevLength-=2*e.length}appendChar(e){this.beforeAppend(1),this._stream.view[this._start]=e,this._length+=2,this.start=this._start+1,this.prevLength-=2}appendUint16(e){this.beforeAppend(2);const t=new Uint16Array([e]),r=new Uint8Array(t.buffer);this.stream.view[this._start]=r[1],this._stream.view[this._start+1]=r[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendUint24(e){this.beforeAppend(3);const t=new Uint32Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[2],this._stream.view[this._start+1]=r[1],this._stream.view[this._start+2]=r[0],this._length+=6,this.start=this._start+3,this.prevLength-=6}appendUint32(e){this.beforeAppend(4);const t=new Uint32Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[3],this._stream.view[this._start+1]=r[2],this._stream.view[this._start+2]=r[1],this._stream.view[this._start+3]=r[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}appendInt16(e){this.beforeAppend(2);const t=new Int16Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[1],this._stream.view[this._start+1]=r[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendInt32(e){this.beforeAppend(4);const t=new Int32Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[3],this._stream.view[this._start+1]=r[2],this._stream.view[this._start+2]=r[1],this._stream.view[this._start+3]=r[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}getBlock(e,t=!0){if(this._length<=0)return new Uint8Array(0);let r;if(this._length<e&&(e=this._length),this.backward){const a=this._stream.view.subarray(this._length-e,this._length);r=new Uint8Array(e);for(let o=0;o<e;o++)r[e-1-o]=a[o]}else r=this._stream.view.subarray(this._start,this._start+e);return t&&(this.start+=this.backward?-1*e:e),r}getUint16(e=!0){const t=this.getBlock(2,e);return t.length<2?0:t[0]<<8|t[1]}getInt16(e=!0){const t=this.getUint16(e),r=32768;return t&r?-(r-(t^r)):t}getUint24(e=!0){const t=this.getBlock(4,e);return t.length<3?0:t[0]<<16|t[1]<<8|t[2]}getUint32(e=!0){const t=this.getBlock(4,e);return t.length<4?0:16777216*t[0]+(t[1]<<16)+(t[2]<<8)+t[3]}getInt32(e=!0){const t=this.getUint32(e),r=2147483648;return t&r?-(r-(t^r)):t}beforeAppend(e){this._start+e>this._stream.length&&(e>this.appendBlock&&(this.appendBlock=e+s.APPEND_BLOCK),this._stream.realloc(this._stream.length+this.appendBlock))}}return s.APPEND_BLOCK=1e3,s})();function ou(s,...i){if(!function Sm(s){return s instanceof Uint8Array||null!=s&&"object"==typeof s&&"Uint8Array"===s.constructor.name}(s))throw new Error("Uint8Array expected");if(i.length>0&&!i.includes(s.length))throw new Error(`Uint8Array expected of length ${i}, not of length=${s.length}`)}function lu(s,i=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(i&&s.finished)throw new Error("Hash#digest() has already been called")}const cu=s=>new DataView(s.buffer,s.byteOffset,s.byteLength),is=(s,i)=>s<<32-i|s>>>i,uu=(s,i)=>s<<i|s>>>32-i>>>0;function Ml(s){return"string"==typeof s&&(s=function _m(s){if("string"!=typeof s)throw new Error("utf8ToBytes expected string, got "+typeof s);return new Uint8Array((new TextEncoder).encode(s))}(s)),ou(s),s}new Uint8Array(new Uint32Array([287454020]).buffer);class Cm{clone(){return this._cloneInto()}}function Ll(s){const i=t=>s().update(Ml(t)).digest(),e=s();return i.outputLen=e.outputLen,i.blockLen=e.blockLen,i.create=()=>s(),i}const Lf=(s,i,e)=>s&i^~s&e,Ff=(s,i,e)=>s&i^s&e^i&e;class fu extends Cm{constructor(i,e,t,r){super(),this.blockLen=i,this.outputLen=e,this.padOffset=t,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(i),this.view=cu(this.buffer)}update(i){lu(this);const{view:e,buffer:t,blockLen:r}=this,a=(i=Ml(i)).length;for(let o=0;o<a;){const u=Math.min(r-this.pos,a-o);if(u!==r)t.set(i.subarray(o,o+u),this.pos),this.pos+=u,o+=u,this.pos===r&&(this.process(e,0),this.pos=0);else{const h=cu(i);for(;r<=a-o;o+=r)this.process(h,o)}}return this.length+=i.length,this.roundClean(),this}digestInto(i){lu(this),function Uf(s,i){ou(s);const e=i.outputLen;if(s.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}(i,this),this.finished=!0;const{buffer:e,view:t,blockLen:r,isLE:a}=this;let{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(t,0),o=0);for(let T=o;T<r;T++)e[T]=0;(function Im(s,i,e,t){if("function"==typeof s.setBigUint64)return s.setBigUint64(i,e,t);const r=BigInt(32),a=BigInt(4294967295),o=Number(e>>r&a),u=Number(e&a),m=t?0:4;s.setUint32(i+(t?4:0),o,t),s.setUint32(i+m,u,t)})(t,r-8,BigInt(8*this.length),a),this.process(t,0);const u=cu(i),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const m=h/4,N=this.get();if(m>N.length)throw new Error("_sha2: outputLen bigger than state");for(let T=0;T<m;T++)u.setUint32(4*T,N[T],a)}digest(){const{buffer:i,outputLen:e}=this;this.digestInto(i);const t=i.slice(0,e);return this.destroy(),t}_cloneInto(i){i||(i=new this.constructor),i.set(...this.get());const{blockLen:e,buffer:t,length:r,finished:a,destroyed:o,pos:u}=this;return i.length=r,i.pos=u,i.finished=a,i.destroyed=o,r%e&&i.buffer.set(t),i}}const ma=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),_s=new Uint32Array(80);class Bm extends fu{constructor(){super(64,20,8,!1),this.A=0|ma[0],this.B=0|ma[1],this.C=0|ma[2],this.D=0|ma[3],this.E=0|ma[4]}get(){const{A:i,B:e,C:t,D:r,E:a}=this;return[i,e,t,r,a]}set(i,e,t,r,a){this.A=0|i,this.B=0|e,this.C=0|t,this.D=0|r,this.E=0|a}process(i,e){for(let h=0;h<16;h++,e+=4)_s[h]=i.getUint32(e,!1);for(let h=16;h<80;h++)_s[h]=uu(_s[h-3]^_s[h-8]^_s[h-14]^_s[h-16],1);let{A:t,B:r,C:a,D:o,E:u}=this;for(let h=0;h<80;h++){let m,N;h<20?(m=Lf(r,a,o),N=1518500249):h<40?(m=r^a^o,N=1859775393):h<60?(m=Ff(r,a,o),N=2400959708):(m=r^a^o,N=3395469782);const T=uu(t,5)+m+u+N+_s[h]|0;u=o,o=a,a=uu(r,30),r=t,t=T}t=t+this.A|0,r=r+this.B|0,a=a+this.C|0,o=o+this.D|0,u=u+this.E|0,this.set(t,r,a,o,u)}roundClean(){_s.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}const Rm=Ll(()=>new Bm),Tm=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Cs=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ns=new Uint32Array(64);class Hf extends fu{constructor(){super(64,32,8,!1),this.A=0|Cs[0],this.B=0|Cs[1],this.C=0|Cs[2],this.D=0|Cs[3],this.E=0|Cs[4],this.F=0|Cs[5],this.G=0|Cs[6],this.H=0|Cs[7]}get(){const{A:i,B:e,C:t,D:r,E:a,F:o,G:u,H:h}=this;return[i,e,t,r,a,o,u,h]}set(i,e,t,r,a,o,u,h){this.A=0|i,this.B=0|e,this.C=0|t,this.D=0|r,this.E=0|a,this.F=0|o,this.G=0|u,this.H=0|h}process(i,e){for(let T=0;T<16;T++,e+=4)Ns[T]=i.getUint32(e,!1);for(let T=16;T<64;T++){const K=Ns[T-15],F=Ns[T-2],se=is(K,7)^is(K,18)^K>>>3,Ee=is(F,17)^is(F,19)^F>>>10;Ns[T]=Ee+Ns[T-7]+se+Ns[T-16]|0}let{A:t,B:r,C:a,D:o,E:u,F:h,G:m,H:N}=this;for(let T=0;T<64;T++){const F=N+(is(u,6)^is(u,11)^is(u,25))+Lf(u,h,m)+Tm[T]+Ns[T]|0,Ee=(is(t,2)^is(t,13)^is(t,22))+Ff(t,r,a)|0;N=m,m=h,h=u,u=o+F|0,o=a,a=r,r=t,t=F+Ee|0}t=t+this.A|0,r=r+this.B|0,a=a+this.C|0,o=o+this.D|0,u=u+this.E|0,h=h+this.F|0,m=m+this.G|0,N=N+this.H|0,this.set(t,r,a,o,u,h,m,N)}roundClean(){Ns.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const xm=Ll(()=>new Hf),Fl=BigInt(2**32-1),du=BigInt(32);function jf(s,i=!1){return i?{h:Number(s&Fl),l:Number(s>>du&Fl)}:{h:0|Number(s>>du&Fl),l:0|Number(s&Fl)}}const qe_split=function Vm(s,i=!1){let e=new Uint32Array(s.length),t=new Uint32Array(s.length);for(let r=0;r<s.length;r++){const{h:a,l:o}=jf(s[r],i);[e[r],t[r]]=[a,o]}return[e,t]},qe_shrSH=(s,i,e)=>s>>>e,qe_shrSL=(s,i,e)=>s<<32-e|i>>>e,qe_rotrSH=(s,i,e)=>s>>>e|i<<32-e,qe_rotrSL=(s,i,e)=>s<<32-e|i>>>e,qe_rotrBH=(s,i,e)=>s<<64-e|i>>>e-32,qe_rotrBL=(s,i,e)=>s>>>e-32|i<<64-e,qe_add=function qm(s,i,e,t){const r=(i>>>0)+(t>>>0);return{h:s+e+(r/2**32|0)|0,l:0|r}},qe_add3L=(s,i,e)=>(s>>>0)+(i>>>0)+(e>>>0),qe_add3H=(s,i,e,t)=>i+e+t+(s/2**32|0)|0,qe_add4L=(s,i,e,t)=>(s>>>0)+(i>>>0)+(e>>>0)+(t>>>0),qe_add4H=(s,i,e,t,r)=>i+e+t+r+(s/2**32|0)|0,qe_add5H=(s,i,e,t,r,a)=>i+e+t+r+a+(s/2**32|0)|0,qe_add5L=(s,i,e,t,r)=>(s>>>0)+(i>>>0)+(e>>>0)+(t>>>0)+(r>>>0),[Wm,zm]=qe_split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(s=>BigInt(s))),Is=new Uint32Array(80),Bs=new Uint32Array(80);class Hl extends fu{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:i,Al:e,Bh:t,Bl:r,Ch:a,Cl:o,Dh:u,Dl:h,Eh:m,El:N,Fh:T,Fl:K,Gh:F,Gl:se,Hh:Ee,Hl:ye}=this;return[i,e,t,r,a,o,u,h,m,N,T,K,F,se,Ee,ye]}set(i,e,t,r,a,o,u,h,m,N,T,K,F,se,Ee,ye){this.Ah=0|i,this.Al=0|e,this.Bh=0|t,this.Bl=0|r,this.Ch=0|a,this.Cl=0|o,this.Dh=0|u,this.Dl=0|h,this.Eh=0|m,this.El=0|N,this.Fh=0|T,this.Fl=0|K,this.Gh=0|F,this.Gl=0|se,this.Hh=0|Ee,this.Hl=0|ye}process(i,e){for(let ne=0;ne<16;ne++,e+=4)Is[ne]=i.getUint32(e),Bs[ne]=i.getUint32(e+=4);for(let ne=16;ne<80;ne++){const oe=0|Is[ne-15],pe=0|Bs[ne-15],Ae=qe_rotrSH(oe,pe,1)^qe_rotrSH(oe,pe,8)^qe_shrSH(oe,pe,7),Te=qe_rotrSL(oe,pe,1)^qe_rotrSL(oe,pe,8)^qe_shrSL(oe,pe,7),xe=0|Is[ne-2],Me=0|Bs[ne-2],Ye=qe_rotrSH(xe,Me,19)^qe_rotrBH(xe,Me,61)^qe_shrSH(xe,Me,6),At=qe_rotrSL(xe,Me,19)^qe_rotrBL(xe,Me,61)^qe_shrSL(xe,Me,6),Xe=qe_add4L(Te,At,Bs[ne-7],Bs[ne-16]),lt=qe_add4H(Xe,Ae,Ye,Is[ne-7],Is[ne-16]);Is[ne]=0|lt,Bs[ne]=0|Xe}let{Ah:t,Al:r,Bh:a,Bl:o,Ch:u,Cl:h,Dh:m,Dl:N,Eh:T,El:K,Fh:F,Fl:se,Gh:Ee,Gl:ye,Hh:ee,Hl:Se}=this;for(let ne=0;ne<80;ne++){const oe=qe_rotrSH(T,K,14)^qe_rotrSH(T,K,18)^qe_rotrBH(T,K,41),pe=qe_rotrSL(T,K,14)^qe_rotrSL(T,K,18)^qe_rotrBL(T,K,41),Ae=T&F^~T&Ee,xe=qe_add5L(Se,pe,K&se^~K&ye,zm[ne],Bs[ne]),Me=qe_add5H(xe,ee,oe,Ae,Wm[ne],Is[ne]),Ye=0|xe,At=qe_rotrSH(t,r,28)^qe_rotrBH(t,r,34)^qe_rotrBH(t,r,39),Xe=qe_rotrSL(t,r,28)^qe_rotrBL(t,r,34)^qe_rotrBL(t,r,39),lt=t&a^t&u^a&u,jt=r&o^r&h^o&h;ee=0|Ee,Se=0|ye,Ee=0|F,ye=0|se,F=0|T,se=0|K,({h:T,l:K}=qe_add(0|m,0|N,0|Me,0|Ye)),m=0|u,N=0|h,u=0|a,h=0|o,a=0|t,o=0|r;const Ot=qe_add3L(Ye,Xe,jt);t=qe_add3H(Ot,Me,At,lt),r=0|Ot}({h:t,l:r}=qe_add(0|this.Ah,0|this.Al,0|t,0|r)),({h:a,l:o}=qe_add(0|this.Bh,0|this.Bl,0|a,0|o)),({h:u,l:h}=qe_add(0|this.Ch,0|this.Cl,0|u,0|h)),({h:m,l:N}=qe_add(0|this.Dh,0|this.Dl,0|m,0|N)),({h:T,l:K}=qe_add(0|this.Eh,0|this.El,0|T,0|K)),({h:F,l:se}=qe_add(0|this.Fh,0|this.Fl,0|F,0|se)),({h:Ee,l:ye}=qe_add(0|this.Gh,0|this.Gl,0|Ee,0|ye)),({h:ee,l:Se}=qe_add(0|this.Hh,0|this.Hl,0|ee,0|Se)),this.set(t,r,a,o,u,h,m,N,T,K,F,se,Ee,ye,ee,Se)}roundClean(){Is.fill(0),Bs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Ym extends Hl{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const Xm=Ll(()=>new Hl),Qm=Ll(()=>new Ym),Ct=new ArrayBuffer(0),v="";let ot=(()=>{class s extends TypeError{constructor(){super(...arguments),this.name=s.NAME}static isType(e,t){if("string"==typeof t){if("Array"===t&&Array.isArray(e))return!0;if("ArrayBuffer"===t&&e instanceof ArrayBuffer)return!0;if("ArrayBufferView"===t&&ArrayBuffer.isView(e))return!0;if(typeof e===t)return!0}else if(e instanceof t)return!0;return!1}static assert(e,t,...r){for(const o of r)if(this.isType(e,o))return;const a=r.map(o=>o instanceof Function&&"name"in o?o.name:`${o}`);throw new s(`Parameter '${t}' is not of type ${a.length>1?`(${a.join(" or ")})`:a[0]}`)}}return s.NAME="ArgumentError",s})(),tt=(()=>{class s extends TypeError{static assert(...e){let r,a,t=null;"string"==typeof e[0]?(t=e[0],r=e[1],a=e.slice(2)):(r=e[0],a=e.slice(1)),ot.assert(r,"parameters","object");for(const o of a)if(null==r[o])throw new s(o,t)}static assertEmpty(e,t,r){if(null==e)throw new s(t,r)}constructor(e,t=null,r){super(),this.name=s.NAME,this.field=e,t&&(this.target=t),this.message=r||`Absent mandatory parameter '${e}' ${t?` in '${t}'`:v}`}}return s.NAME="ParameterError",s})();class ae extends Error{static assertSchema(i,e){if(!i.verified)throw new Error(`Object's schema was not verified against input data for ${e}`)}static assert(i,e){if(-1===i.offset)throw new ae(`Error during parsing of ASN.1 data. Data is not correct for '${e}'.`)}constructor(i){super(i),this.name="AsnError"}}let fe=(()=>{class s{static blockName(){return this.CLASS_NAME}static fromBER(e){const t=ct(e);ae.assert(t,this.name);try{return new this({schema:t.result})}catch{throw new ae(`Cannot create '${this.CLASS_NAME}' from ASN.1 object`)}}static defaultValues(e){throw new Error(`Invalid member name for ${this.CLASS_NAME} class: ${e}`)}static schema(e={}){throw new Error(`Method '${this.CLASS_NAME}.schema' should be overridden`)}get className(){return this.constructor.CLASS_NAME}toString(e="hex"){let t;try{t=this.toSchema()}catch{t=this.toSchema(!0)}return b.U$.ToString(t.toBER(),e)}}return s.CLASS_NAME="PkiObject",s})();function Rs(s){let i=!1,e=v;const t=s.trim();for(let r=0;r<t.length;r++)32===t.charCodeAt(r)?!1===i&&(i=!0):(i&&(e+=" ",i=!1),e+=t[r]);return e.toLowerCase()}const ga="type",mu="value";let gu=(()=>{class s extends fe{constructor(e={}){super(),this.type=l(e,ga,s.defaultValues(ga)),this.value=l(e,mu,s.defaultValues(mu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ga:return v;case mu:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.type||v}),new Fe({name:t.value||v})]})}fromSchema(e){re(e,[ga,"typeValue"]);const t=ue(e,e,s.schema({names:{type:ga,value:"typeValue"}}));ae.assertSchema(t,this.className),this.type=t.result.type.valueBlock.toString(),this.value=t.result.typeValue}toSchema(){return new O({value:[new Ve({value:this.type}),this.value]})}toJSON(){const e={type:this.type};return e.value=0!==Object.keys(this.value).length?this.value.toJSON():this.value,e}isEqual(e){const t=[rs.blockName(),Xt.blockName(),ha.blockName(),Ui.blockName(),qt.blockName(),fa.blockName(),su.blockName(),Pl.blockName(),ru.blockName(),Dl.blockName(),iu.blockName(),nu.blockName()];if(e instanceof ArrayBuffer)return b._H.isEqual(this.value.valueBeforeDecodeView,e);if(e.constructor.blockName()===s.blockName()){if(this.type!==e.type)return!1;const r=[!1,!1],a=this.value.constructor.blockName();for(const u of t)a===u&&(r[0]=!0),e.value.constructor.blockName()===u&&(r[1]=!0);if(r[0]!==r[1])return!1;if(r[0]&&r[1]){const u=Rs(this.value.valueBlock.value),h=Rs(e.value.valueBlock.value);if(0!==u.localeCompare(h))return!1}else if(!b._H.isEqual(this.value.valueBeforeDecodeView,e.value.valueBeforeDecodeView))return!1;return!0}return!1}}return s.CLASS_NAME="AttributeTypeAndValue",s})();const Ar="typesAndValues",jl="valueBeforeDecode";let dt=(()=>{class s extends fe{constructor(e={}){super(),this.typesAndValues=l(e,Ar,s.defaultValues(Ar)),this.valueBeforeDecode=l(e,jl,s.defaultValues(jl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ar:return[];case jl:return Ct;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ar:return 0===t.length;case jl:return 0===t.byteLength;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ge({name:t.repeatedSequence||v,value:new _t({value:[new Ge({name:t.repeatedSet||v,value:gu.schema(t.typeAndValue||{})})]})})]})}fromSchema(e){re(e,["RDN",Ar]);const t=ue(e,e,s.schema({names:{blockName:"RDN",repeatedSet:Ar}}));ae.assertSchema(t,this.className),Ar in t.result&&(this.typesAndValues=Array.from(t.result.typesAndValues,r=>new gu({schema:r}))),this.valueBeforeDecode=t.result.RDN.valueBeforeDecodeView.slice().buffer}toSchema(){if(0===this.valueBeforeDecode.byteLength)return new O({value:[new _t({value:Array.from(this.typesAndValues,t=>t.toSchema())})]});const e=ct(this.valueBeforeDecode);if(ae.assert(e,"RelativeDistinguishedNames"),!(e.result instanceof O))throw new Error("ASN.1 result should be SEQUENCE");return e.result}toJSON(){return{typesAndValues:Array.from(this.typesAndValues,e=>e.toJSON())}}isEqual(e){if(e instanceof s){if(this.typesAndValues.length!==e.typesAndValues.length)return!1;for(const[t,r]of this.typesAndValues.entries())if(!1===r.isEqual(e.typesAndValues[t]))return!1;return!0}return e instanceof ArrayBuffer&&ie(this.valueBeforeDecode,e)}}return s.CLASS_NAME="RelativeDistinguishedNames",s})();const pa="type",va="value";function Zm(s={},i=!1){const e=l(s,"names",{});return new O({optional:i,value:[new q({optional:!0,idBlock:{tagClass:2,tagNumber:1},name:e.country_name||v,value:[new ft({value:[new Ui,new qt]})]}),new q({optional:!0,idBlock:{tagClass:2,tagNumber:2},name:e.administration_domain_name||v,value:[new ft({value:[new Ui,new qt]})]}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:0},name:e.network_address||v,isHexOnly:!0}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:1},name:e.terminal_identifier||v,isHexOnly:!0}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:2},name:e.private_domain_name||v,value:[new ft({value:[new Ui,new qt]})]}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:3},name:e.organization_name||v,isHexOnly:!0}),new Le({optional:!0,name:e.numeric_user_identifier||v,idBlock:{tagClass:3,tagNumber:4},isHexOnly:!0}),new q({optional:!0,name:e.personal_name||v,idBlock:{tagClass:3,tagNumber:5},value:[new Le({idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:1},isHexOnly:!0}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:2},isHexOnly:!0}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:3},isHexOnly:!0})]}),new q({optional:!0,name:e.organizational_unit_names||v,idBlock:{tagClass:3,tagNumber:6},value:[new Ge({value:new qt})]})]})}function eg(s=!1){return new O({optional:s,value:[new qt,new qt]})}function tg(s=!1){return new _t({optional:s,value:[new Le({optional:!0,idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Fe]})]})}let bt=(()=>{class s extends fe{constructor(e={}){super(),this.type=l(e,pa,s.defaultValues(pa)),this.value=l(e,va,s.defaultValues(va)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case pa:return 9;case va:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case pa:return t===s.defaultValues(e);case va:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new ft({value:[new q({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||v,value:[new Ve,new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe]})]}),new Le({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:1}}),new Le({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:2}}),new q({idBlock:{tagClass:3,tagNumber:3},name:t.blockName||v,value:[Zm(t.builtInStandardAttributes||{},!1),eg(!0),tg(!0)]}),new q({idBlock:{tagClass:3,tagNumber:4},name:t.blockName||v,value:[dt.schema(t.directoryName||{})]}),new q({idBlock:{tagClass:3,tagNumber:5},name:t.blockName||v,value:[new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ft({value:[new fa,new qt,new ha,new rs,new Xt]})]}),new q({idBlock:{tagClass:3,tagNumber:1},value:[new ft({value:[new fa,new qt,new ha,new rs,new Xt]})]})]}),new Le({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:6}}),new Le({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:7}}),new Le({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:8}})]})}fromSchema(e){re(e,["blockName","otherName","rfc822Name","dNSName","x400Address","directoryName","ediPartyName","uniformResourceIdentifier","iPAddress","registeredID"]);const t=ue(e,e,s.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));switch(ae.assertSchema(t,this.className),this.type=t.result.blockName.idBlock.tagNumber,this.type){case 0:case 3:this.value=t.result.blockName;break;case 1:case 2:case 6:{const r=t.result.blockName;r.idBlock.tagClass=1,r.idBlock.tagNumber=22;const o=ct(r.toBER(!1));ae.assert(o,"GeneralName value"),this.value=o.result.valueBlock.value}break;case 4:this.value=new dt({schema:t.result.directoryName});break;case 5:this.value=t.result.ediPartyName;break;case 7:this.value=new de({valueHex:t.result.blockName.valueBlock.valueHex});break;case 8:{const r=t.result.blockName;r.idBlock.tagClass=1,r.idBlock.tagNumber=6;const o=ct(r.toBER(!1));ae.assert(o,"GeneralName registeredID"),this.value=o.result.valueBlock.toString()}}}toSchema(){switch(this.type){case 0:case 3:case 5:return new q({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:{const e=new Pl({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 4:return new q({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:{const e=this.value;return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 8:{const e=new Ve({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}default:return s.schema()}}toJSON(){const e={type:this.type,value:v};if("string"==typeof this.value)e.value=this.value;else try{e.value=this.value.toJSON()}catch{}return e}}return s.CLASS_NAME="GeneralName",s})();const wa="accessMethod",ya="accessLocation",sg=[wa,ya];let Kf=(()=>{class s extends fe{constructor(e={}){super(),this.accessMethod=l(e,wa,s.defaultValues(wa)),this.accessLocation=l(e,ya,s.defaultValues(ya)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wa:return v;case ya:return new bt;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.accessMethod||v}),bt.schema(t.accessLocation||{})]})}fromSchema(e){re(e,sg);const t=ue(e,e,s.schema({names:{accessMethod:wa,accessLocation:{names:{blockName:ya}}}}));ae.assertSchema(t,this.className),this.accessMethod=t.result.accessMethod.valueBlock.toString(),this.accessLocation=new bt({schema:t.result.accessLocation})}toSchema(){return new O({value:[new Ve({value:this.accessMethod}),this.accessLocation.toSchema()]})}toJSON(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}return s.CLASS_NAME="AccessDescription",s})();const Ts="seconds",xs="millis",Vs="micros";let Li=(()=>{class s extends fe{constructor(e={}){super(),Ts in e&&(this.seconds=l(e,Ts,s.defaultValues(Ts))),xs in e&&(this.millis=l(e,xs,s.defaultValues(xs))),Vs in e&&(this.micros=l(e,Vs,s.defaultValues(Vs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ts:case xs:case Vs:return 0;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ts:case xs:case Vs:return t===s.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,optional:!0,value:[new Y({optional:!0,name:t.seconds||v}),new Le({name:t.millis||v,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Le({name:t.micros||v,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){re(e,[Ts,xs,Vs]);const t=ue(e,e,s.schema({names:{seconds:Ts,millis:xs,micros:Vs}}));if(ae.assertSchema(t,this.className),"seconds"in t.result&&(this.seconds=t.result.seconds.valueBlock.valueDec),"millis"in t.result){const r=new Y({valueHex:t.result.millis.valueBlock.valueHex});this.millis=r.valueBlock.valueDec}if("micros"in t.result){const r=new Y({valueHex:t.result.micros.valueBlock.valueHex});this.micros=r.valueBlock.valueDec}}toSchema(){const e=[];if(void 0!==this.seconds&&e.push(new Y({value:this.seconds})),void 0!==this.millis){const t=new Y({value:this.millis});e.push(new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:t.valueBlock.valueHexView}))}if(void 0!==this.micros){const t=new Y({value:this.micros});e.push(new Le({idBlock:{tagClass:3,tagNumber:1},valueHex:t.valueBlock.valueHexView}))}return new O({value:e})}toJSON(){const e={};return void 0!==this.seconds&&(e.seconds=this.seconds),void 0!==this.millis&&(e.millis=this.millis),void 0!==this.micros&&(e.micros=this.micros),e}}return s.CLASS_NAME="Accuracy",s})();const $l="algorithmId",Sa="algorithmParams",Gf="algorithm",pu="params",rg=[Gf,pu];let X=(()=>{class s extends fe{constructor(e={}){super(),this.algorithmId=l(e,$l,s.defaultValues($l)),Sa in e&&(this.algorithmParams=l(e,Sa,s.defaultValues(Sa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $l:return v;case Sa:return new Fe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case $l:return t===v;case Sa:return t instanceof Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,optional:t.optional||!1,value:[new Ve({name:t.algorithmIdentifier||v}),new Fe({name:t.algorithmParams||v,optional:!0})]})}fromSchema(e){re(e,rg);const t=ue(e,e,s.schema({names:{algorithmIdentifier:Gf,algorithmParams:pu}}));ae.assertSchema(t,this.className),this.algorithmId=t.result.algorithm.valueBlock.toString(),pu in t.result&&(this.algorithmParams=t.result.params)}toSchema(){const e=[];return e.push(new Ve({value:this.algorithmId})),this.algorithmParams&&!(this.algorithmParams instanceof Fe)&&e.push(this.algorithmParams),new O({value:e})}toJSON(){const e={algorithmId:this.algorithmId};return this.algorithmParams&&!(this.algorithmParams instanceof Fe)&&(e.algorithmParams=this.algorithmParams.toJSON()),e}isEqual(e){return e instanceof s&&this.algorithmId===e.algorithmId&&(this.algorithmParams?!!e.algorithmParams&&JSON.stringify(this.algorithmParams)===JSON.stringify(e.algorithmParams):!e.algorithmParams)}}return s.CLASS_NAME="AlgorithmIdentifier",s})();const Fi="altNames",ig=[Fi];let Jf=(()=>{class s extends fe{constructor(e={}){super(),this.altNames=l(e,Fi,s.defaultValues(Fi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Fi?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ge({name:t.altNames||v,value:bt.schema()})]})}fromSchema(e){re(e,ig);const t=ue(e,e,s.schema({names:{altNames:Fi}}));ae.assertSchema(t,this.className),Fi in t.result&&(this.altNames=Array.from(t.result.altNames,r=>new bt({schema:r})))}toSchema(){return new O({value:Array.from(this.altNames,e=>e.toSchema())})}toJSON(){return{altNames:Array.from(this.altNames,e=>e.toJSON())}}}return s.CLASS_NAME="AltName",s})();const Hi="type",ji="values",ng=[Hi,ji];let st=(()=>{class s extends fe{constructor(e={}){super(),this.type=l(e,Hi,s.defaultValues(Hi)),this.values=l(e,ji,s.defaultValues(ji)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Hi:return v;case ji:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Hi:return t===v;case ji:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.type||v}),new _t({name:t.setName||v,value:[new Ge({name:t.values||v,value:new Fe})]})]})}fromSchema(e){re(e,ng);const t=ue(e,e,s.schema({names:{type:Hi,values:ji}}));ae.assertSchema(t,this.className),this.type=t.result.type.valueBlock.toString(),this.values=t.result.values}toSchema(){return new O({value:[new Ve({value:this.type}),new _t({value:this.values})]})}toJSON(){return{type:this.type,values:Array.from(this.values,e=>e.toJSON())}}}return s.CLASS_NAME="Attribute",s})();const ba="notBeforeTime",Aa="notAfterTime",ag=[ba,Aa];let $i=(()=>{class s extends fe{constructor(e={}){super(),this.notBeforeTime=l(e,ba,s.defaultValues(ba)),this.notAfterTime=l(e,Aa,s.defaultValues(Aa)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ba:case Aa:return new Date(0,0,0);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new ht({name:t.notBeforeTime||v}),new ht({name:t.notAfterTime||v})]})}fromSchema(e){re(e,ag);const t=ue(e,e,s.schema({names:{notBeforeTime:ba,notAfterTime:Aa}}));ae.assertSchema(t,this.className),this.notBeforeTime=t.result.notBeforeTime.toDate(),this.notAfterTime=t.result.notAfterTime.toDate()}toSchema(){return new O({value:[new ht({valueDate:this.notBeforeTime}),new ht({valueDate:this.notAfterTime})]})}toJSON(){return{notBeforeTime:this.notBeforeTime,notAfterTime:this.notAfterTime}}}return s.CLASS_NAME="AttCertValidityPeriod",s})();const Ea="names",qf="generalNames";let Bt=(()=>{class s extends fe{constructor(e={}){super(),this.names=l(e,Ea,s.defaultValues(Ea)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return"names"===e?[]:super.defaultValues(e)}static schema(e={},t=!1){const r=l(e,Ea,{});return new O({optional:t,name:r.blockName||v,value:[new Ge({name:r.generalNames||v,value:bt.schema()})]})}fromSchema(e){re(e,[Ea,qf]);const t=ue(e,e,s.schema({names:{blockName:Ea,generalNames:qf}}));ae.assertSchema(t,this.className),this.names=Array.from(t.result.generalNames,r=>new bt({schema:r}))}toSchema(){return new O({value:Array.from(this.names,e=>e.toSchema())})}toJSON(){return{names:Array.from(this.names,e=>e.toJSON())}}}return s.CLASS_NAME="GeneralNames",s})();const Wf="2.5.29.17",zf="2.5.29.18",vu="2.5.29.19",Yf="2.5.29.28",Xf="2.5.29.29",Qf="2.5.29.30",Zf="2.5.29.31",wu="2.5.29.46",ed="2.5.29.32",Wt="2.5.29.32.0",td="2.5.29.33",yu="2.5.29.35",sd="2.5.29.36",Su="1.3.6.1.5.5.7.1.1",bu="1.2.840.113549.1.7.1",id="1.2.840.113549.1.7.3",nd="1.2.840.113549.1.7.6",ad="1.2.840.113549.1.9.22.1",od="1.2.840.113549.1.9.22.3",ld="1.2.840.113549.1.9.23.1",Er="keyIdentifier",kr="authorityCertIssuer",_r="authorityCertSerialNumber",Cg=[Er,kr,_r];let cd=(()=>{class s extends fe{constructor(e={}){super(),Er in e&&(this.keyIdentifier=l(e,Er,s.defaultValues(Er))),kr in e&&(this.authorityCertIssuer=l(e,kr,s.defaultValues(kr))),_r in e&&(this.authorityCertSerialNumber=l(e,_r,s.defaultValues(_r))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Er:return new de;case kr:return[];case _r:return new Y;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Le({name:t.keyIdentifier||v,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Ge({name:t.authorityCertIssuer||v,value:bt.schema()})]}),new Le({name:t.authorityCertSerialNumber||v,optional:!0,idBlock:{tagClass:3,tagNumber:2}})]})}fromSchema(e){re(e,Cg);const t=ue(e,e,s.schema({names:{keyIdentifier:Er,authorityCertIssuer:kr,authorityCertSerialNumber:_r}}));ae.assertSchema(t,this.className),Er in t.result&&(this.keyIdentifier=new de({valueHex:t.result.keyIdentifier.valueBlock.valueHex})),kr in t.result&&(this.authorityCertIssuer=Array.from(t.result.authorityCertIssuer,r=>new bt({schema:r}))),_r in t.result&&(this.authorityCertSerialNumber=new Y({valueHex:t.result.authorityCertSerialNumber.valueBlock.valueHex}))}toSchema(){const e=[];return this.keyIdentifier&&e.push(new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:this.keyIdentifier.valueBlock.valueHexView})),this.authorityCertIssuer&&e.push(new q({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.authorityCertIssuer,t=>t.toSchema())})),this.authorityCertSerialNumber&&e.push(new Le({idBlock:{tagClass:3,tagNumber:2},valueHex:this.authorityCertSerialNumber.valueBlock.valueHexView})),new O({value:e})}toJSON(){const e={};return this.keyIdentifier&&(e.keyIdentifier=this.keyIdentifier.toJSON()),this.authorityCertIssuer&&(e.authorityCertIssuer=Array.from(this.authorityCertIssuer,t=>t.toJSON())),this.authorityCertSerialNumber&&(e.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),e}}return s.CLASS_NAME="AuthorityKeyIdentifier",s})();const Cr="pathLenConstraint",Nr="cA";let ud=(()=>{class s extends fe{constructor(e={}){super(),this.cA=l(e,Nr,!1),Cr in e&&(this.pathLenConstraint=l(e,Cr,0)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e!==Nr&&super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new ks({optional:!0,name:t.cA||v}),new Y({optional:!0,name:t.pathLenConstraint||v})]})}fromSchema(e){re(e,[Nr,Cr]);const t=ue(e,e,s.schema({names:{cA:Nr,pathLenConstraint:Cr}}));ae.assertSchema(t,this.className),Nr in t.result&&(this.cA=t.result.cA.valueBlock.value),Cr in t.result&&(this.pathLenConstraint=t.result.pathLenConstraint.valueBlock.isHexOnly?t.result.pathLenConstraint:t.result.pathLenConstraint.valueBlock.valueDec)}toSchema(){const e=[];return this.cA!==s.defaultValues(Nr)&&e.push(new ks({value:this.cA})),Cr in this&&e.push(this.pathLenConstraint instanceof Y?this.pathLenConstraint:new Y({value:this.pathLenConstraint})),new O({value:e})}toJSON(){const e={};return this.cA!==s.defaultValues(Nr)&&(e.cA=this.cA),Cr in this&&(e.pathLenConstraint=this.pathLenConstraint instanceof Y?this.pathLenConstraint.toJSON():this.pathLenConstraint),e}}return s.CLASS_NAME="BasicConstraints",s})();const Au="certificateIndex",Eu="keyIndex";let Ng=(()=>{class s extends fe{constructor(e={}){super(),this.certificateIndex=l(e,Au,s.defaultValues(Au)),this.keyIndex=l(e,Eu,s.defaultValues(Eu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Au:case Eu:return 0;default:return super.defaultValues(e)}}static schema(){return new Y}fromSchema(e){if(e.constructor.blockName()!==Y.blockName())throw new Error("Object's schema was not verified against input data for CAVersion");let t=e.valueBlock.valueHex.slice(0);const r=new Uint8Array(t);switch(!0){case t.byteLength<4:{const K=new ArrayBuffer(4);new Uint8Array(K).set(r,4-t.byteLength),t=K.slice(0)}break;case t.byteLength>4:{const K=new ArrayBuffer(4);new Uint8Array(K).set(r.slice(0,4)),t=K.slice(0)}}const a=t.slice(0,2),o=new Uint8Array(a);let u=o[0];o[0]=o[1],o[1]=u;const h=new Uint16Array(a);this.keyIndex=h[0];const m=t.slice(2),N=new Uint8Array(m);u=N[0],N[0]=N[1],N[1]=u;const T=new Uint16Array(m);this.certificateIndex=T[0]}toSchema(){const e=new ArrayBuffer(2);new Uint16Array(e)[0]=this.certificateIndex;const r=new Uint8Array(e);let a=r[0];r[0]=r[1],r[1]=a;const o=new ArrayBuffer(2);new Uint16Array(o)[0]=this.keyIndex;const h=new Uint8Array(o);return a=h[0],h[0]=h[1],h[1]=a,new Y({valueHex:R(o,e)})}toJSON(){return{certificateIndex:this.certificateIndex,keyIndex:this.keyIndex}}}return s.CLASS_NAME="CAVersion",s})();const ka="policyQualifierId",_a="qualifier",Ig=[ka,_a];let hd=(()=>{class s extends fe{constructor(e={}){super(),this.policyQualifierId=l(e,ka,s.defaultValues(ka)),this.qualifier=l(e,_a,s.defaultValues(_a)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ka:return v;case _a:return new Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.policyQualifierId||v}),new Fe({name:t.qualifier||v})]})}fromSchema(e){re(e,Ig);const t=ue(e,e,s.schema({names:{policyQualifierId:ka,qualifier:_a}}));ae.assertSchema(t,this.className),this.policyQualifierId=t.result.policyQualifierId.valueBlock.toString(),this.qualifier=t.result.qualifier}toSchema(){return new O({value:[new Ve({value:this.policyQualifierId}),this.qualifier]})}toJSON(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}return s.CLASS_NAME="PolicyQualifierInfo",s})();const Ca="policyIdentifier",Ir="policyQualifiers",Bg=[Ca,Ir];let fd=(()=>{class s extends fe{constructor(e={}){super(),this.policyIdentifier=l(e,Ca,s.defaultValues(Ca)),Ir in e&&(this.policyQualifiers=l(e,Ir,s.defaultValues(Ir))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ca:return v;case Ir:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.policyIdentifier||v}),new O({optional:!0,value:[new Ge({name:t.policyQualifiers||v,value:hd.schema()})]})]})}fromSchema(e){re(e,Bg);const t=ue(e,e,s.schema({names:{policyIdentifier:Ca,policyQualifiers:Ir}}));ae.assertSchema(t,this.className),this.policyIdentifier=t.result.policyIdentifier.valueBlock.toString(),Ir in t.result&&(this.policyQualifiers=Array.from(t.result.policyQualifiers,r=>new hd({schema:r})))}toSchema(){const e=[];return e.push(new Ve({value:this.policyIdentifier})),this.policyQualifiers&&e.push(new O({value:Array.from(this.policyQualifiers,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={policyIdentifier:this.policyIdentifier};return this.policyQualifiers&&(e.policyQualifiers=Array.from(this.policyQualifiers,t=>t.toJSON())),e}}return s.CLASS_NAME="PolicyInformation",s})();const Na="certificatePolicies",Rg=[Na];let dd=(()=>{class s extends fe{constructor(e={}){super(),this.certificatePolicies=l(e,Na,s.defaultValues(Na)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Na?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ge({name:t.certificatePolicies||v,value:fd.schema()})]})}fromSchema(e){re(e,Rg);const t=ue(e,e,s.schema({names:{certificatePolicies:Na}}));ae.assertSchema(t,this.className),this.certificatePolicies=Array.from(t.result.certificatePolicies,r=>new fd({schema:r}))}toSchema(){return new O({value:Array.from(this.certificatePolicies,e=>e.toSchema())})}toJSON(){return{certificatePolicies:Array.from(this.certificatePolicies,e=>e.toJSON())}}}return s.CLASS_NAME="CertificatePolicies",s})();const Ia="templateID",cs="templateMajorVersion",us="templateMinorVersion",Tg=[Ia,cs,us];class Ki extends fe{constructor(i={}){super(),this.templateID=l(i,Ia,Ki.defaultValues(Ia)),cs in i&&(this.templateMajorVersion=l(i,cs,Ki.defaultValues(cs))),us in i&&(this.templateMinorVersion=l(i,us,Ki.defaultValues(us))),i.schema&&this.fromSchema(i.schema)}static defaultValues(i){switch(i){case Ia:return v;case cs:case us:return 0;default:return super.defaultValues(i)}}static schema(i={}){const e=l(i,"names",{});return new O({name:e.blockName||v,value:[new Ve({name:e.templateID||v}),new Y({name:e.templateMajorVersion||v,optional:!0}),new Y({name:e.templateMinorVersion||v,optional:!0})]})}fromSchema(i){re(i,Tg);const e=ue(i,i,Ki.schema({names:{templateID:Ia,templateMajorVersion:cs,templateMinorVersion:us}}));ae.assertSchema(e,this.className),this.templateID=e.result.templateID.valueBlock.toString(),cs in e.result&&(this.templateMajorVersion=e.result.templateMajorVersion.valueBlock.valueDec),us in e.result&&(this.templateMinorVersion=e.result.templateMinorVersion.valueBlock.valueDec)}toSchema(){const i=[];return i.push(new Ve({value:this.templateID})),cs in this&&i.push(new Y({value:this.templateMajorVersion})),us in this&&i.push(new Y({value:this.templateMinorVersion})),new O({value:i})}toJSON(){const i={templateID:this.templateID};return cs in this&&(i.templateMajorVersion=this.templateMajorVersion),us in this&&(i.templateMinorVersion=this.templateMinorVersion),i}}const Br="distributionPoint",md="distributionPointNames",Rr="reasons",Tr="cRLIssuer",gd="cRLIssuerNames",xg=[Br,md,Rr,Tr,gd];let pd=(()=>{class s extends fe{constructor(e={}){super(),Br in e&&(this.distributionPoint=l(e,Br,s.defaultValues(Br))),Rr in e&&(this.reasons=l(e,Rr,s.defaultValues(Rr))),Tr in e&&(this.cRLIssuer=l(e,Tr,s.defaultValues(Tr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Br:return[];case Rr:return new et;case Tr:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ft({value:[new q({name:t.distributionPoint||v,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ge({name:t.distributionPointNames||v,value:bt.schema()})]}),new q({name:t.distributionPoint||v,optional:!0,idBlock:{tagClass:3,tagNumber:1},value:dt.schema().valueBlock.value})]})]}),new Le({name:t.reasons||v,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new q({name:t.cRLIssuer||v,optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[new Ge({name:t.cRLIssuerNames||v,value:bt.schema()})]})]})}fromSchema(e){re(e,xg);const t=ue(e,e,s.schema({names:{distributionPoint:Br,distributionPointNames:md,reasons:Rr,cRLIssuer:Tr,cRLIssuerNames:gd}}));ae.assertSchema(t,this.className),Br in t.result&&(0===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=Array.from(t.result.distributionPointNames,r=>new bt({schema:r}))),1===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=new dt({schema:new O({value:t.result.distributionPoint.valueBlock.value})}))),Rr in t.result&&(this.reasons=new et({valueHex:t.result.reasons.valueBlock.valueHex})),Tr in t.result&&(this.cRLIssuer=Array.from(t.result.cRLIssuerNames,r=>new bt({schema:r})))}toSchema(){const e=[];if(this.distributionPoint){let t;t=new q(this.distributionPoint instanceof Array?{idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,r=>r.toSchema())}:{idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]}),e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}return this.reasons&&e.push(new Le({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHexView})),this.cRLIssuer&&e.push(new q({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={};return this.distributionPoint&&(e.distributionPoint=this.distributionPoint instanceof Array?Array.from(this.distributionPoint,t=>t.toJSON()):this.distributionPoint.toJSON()),this.reasons&&(e.reasons=this.reasons.toJSON()),this.cRLIssuer&&(e.cRLIssuer=Array.from(this.cRLIssuer,t=>t.toJSON())),e}}return s.CLASS_NAME="DistributionPoint",s})();const Ba="distributionPoints",Vg=[Ba];let vd=(()=>{class s extends fe{constructor(e={}){super(),this.distributionPoints=l(e,Ba,s.defaultValues(Ba)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Ba?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ge({name:t.distributionPoints||v,value:pd.schema()})]})}fromSchema(e){re(e,Vg);const t=ue(e,e,s.schema({names:{distributionPoints:Ba}}));ae.assertSchema(t,this.className),this.distributionPoints=Array.from(t.result.distributionPoints,r=>new pd({schema:r}))}toSchema(){return new O({value:Array.from(this.distributionPoints,e=>e.toSchema())})}toJSON(){return{distributionPoints:Array.from(this.distributionPoints,e=>e.toJSON())}}}return s.CLASS_NAME="CRLDistributionPoints",s})();const Ra="keyPurposes",Og=[Ra];let Pg=(()=>{class s extends fe{constructor(e={}){super(),this.keyPurposes=l(e,Ra,s.defaultValues(Ra)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Ra?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ge({name:t.keyPurposes||v,value:new Ve})]})}fromSchema(e){re(e,Og);const t=ue(e,e,s.schema({names:{keyPurposes:Ra}}));ae.assertSchema(t,this.className),this.keyPurposes=Array.from(t.result.keyPurposes,r=>r.valueBlock.toString())}toSchema(){return new O({value:Array.from(this.keyPurposes,e=>new Ve({value:e}))})}toJSON(){return{keyPurposes:Array.from(this.keyPurposes)}}}return s.CLASS_NAME="ExtKeyUsage",s})();const Ta="accessDescriptions";let wd=(()=>{class s extends fe{constructor(e={}){super(),this.accessDescriptions=l(e,Ta,s.defaultValues(Ta)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Ta?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ge({name:t.accessDescriptions||v,value:Kf.schema()})]})}fromSchema(e){re(e,[Ta]);const t=ue(e,e,s.schema({names:{accessDescriptions:Ta}}));ae.assertSchema(t,this.className),this.accessDescriptions=Array.from(t.result.accessDescriptions,r=>new Kf({schema:r}))}toSchema(){return new O({value:Array.from(this.accessDescriptions,e=>e.toSchema())})}toJSON(){return{accessDescriptions:Array.from(this.accessDescriptions,e=>e.toJSON())}}}return s.CLASS_NAME="InfoAccess",s})();const xr="distributionPoint",yd="distributionPointNames",Os="onlyContainsUserCerts",Ps="onlyContainsCACerts",Ds="onlySomeReasons",Us="indirectCRL",Ms="onlyContainsAttributeCerts",Dg=[xr,yd,Os,Ps,Ds,Us,Ms];let Ug=(()=>{class s extends fe{constructor(e={}){super(),xr in e&&(this.distributionPoint=l(e,xr,s.defaultValues(xr))),this.onlyContainsUserCerts=l(e,Os,s.defaultValues(Os)),this.onlyContainsCACerts=l(e,Ps,s.defaultValues(Ps)),Ds in e&&(this.onlySomeReasons=l(e,Ds,s.defaultValues(Ds))),this.indirectCRL=l(e,Us,s.defaultValues(Us)),this.onlyContainsAttributeCerts=l(e,Ms,s.defaultValues(Ms)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xr:return[];case Os:case Ps:return!1;case Ds:return 0;case Us:case Ms:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ft({value:[new q({name:t.distributionPoint||v,idBlock:{tagClass:3,tagNumber:0},value:[new Ge({name:t.distributionPointNames||v,value:bt.schema()})]}),new q({name:t.distributionPoint||v,idBlock:{tagClass:3,tagNumber:1},value:dt.schema().valueBlock.value})]})]}),new Le({name:t.onlyContainsUserCerts||v,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Le({name:t.onlyContainsCACerts||v,optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new Le({name:t.onlySomeReasons||v,optional:!0,idBlock:{tagClass:3,tagNumber:3}}),new Le({name:t.indirectCRL||v,optional:!0,idBlock:{tagClass:3,tagNumber:4}}),new Le({name:t.onlyContainsAttributeCerts||v,optional:!0,idBlock:{tagClass:3,tagNumber:5}})]})}fromSchema(e){re(e,Dg);const t=ue(e,e,s.schema({names:{distributionPoint:xr,distributionPointNames:yd,onlyContainsUserCerts:Os,onlyContainsCACerts:Ps,onlySomeReasons:Ds,indirectCRL:Us,onlyContainsAttributeCerts:Ms}}));if(ae.assertSchema(t,this.className),xr in t.result)switch(!0){case 0===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=Array.from(t.result.distributionPointNames,r=>new bt({schema:r}));break;case 1===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=new dt({schema:new O({value:t.result.distributionPoint.valueBlock.value})});break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}if(Os in t.result){const r=new Uint8Array(t.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=0!==r[0]}if(Ps in t.result){const r=new Uint8Array(t.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=0!==r[0]}if(Ds in t.result){const r=new Uint8Array(t.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=r[0]}if(Us in t.result){const r=new Uint8Array(t.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=0!==r[0]}if(Ms in t.result){const r=new Uint8Array(t.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=0!==r[0]}}toSchema(){const e=[];if(this.distributionPoint){let t;this.distributionPoint instanceof Array?t=new q({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,r=>r.toSchema())}):(t=this.distributionPoint.toSchema(),t.idBlock.tagClass=3,t.idBlock.tagNumber=1),e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(this.onlyContainsUserCerts!==s.defaultValues(Os)&&e.push(new Le({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsCACerts!==s.defaultValues(Ps)&&e.push(new Le({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer})),void 0!==this.onlySomeReasons){const t=new ArrayBuffer(1);new Uint8Array(t)[0]=this.onlySomeReasons,e.push(new Le({idBlock:{tagClass:3,tagNumber:3},valueHex:t}))}return this.indirectCRL!==s.defaultValues(Us)&&e.push(new Le({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsAttributeCerts!==s.defaultValues(Ms)&&e.push(new Le({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer})),new O({value:e})}toJSON(){const e={};return this.distributionPoint&&(e.distributionPoint=this.distributionPoint instanceof Array?Array.from(this.distributionPoint,t=>t.toJSON()):this.distributionPoint.toJSON()),this.onlyContainsUserCerts!==s.defaultValues(Os)&&(e.onlyContainsUserCerts=this.onlyContainsUserCerts),this.onlyContainsCACerts!==s.defaultValues(Ps)&&(e.onlyContainsCACerts=this.onlyContainsCACerts),Ds in this&&(e.onlySomeReasons=this.onlySomeReasons),this.indirectCRL!==s.defaultValues(Us)&&(e.indirectCRL=this.indirectCRL),this.onlyContainsAttributeCerts!==s.defaultValues(Ms)&&(e.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),e}}return s.CLASS_NAME="IssuingDistributionPoint",s})();const xa="base",Gi="minimum",Ls="maximum",Mg=[xa,Gi,Ls];let Kl=(()=>{class s extends fe{constructor(e={}){super(),this.base=l(e,xa,s.defaultValues(xa)),this.minimum=l(e,Gi,s.defaultValues(Gi)),Ls in e&&(this.maximum=l(e,Ls,s.defaultValues(Ls))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xa:return new bt;case Gi:case Ls:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[bt.schema(t.base||{}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Y({name:t.minimum||v})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Y({name:t.maximum||v})]})]})}fromSchema(e){re(e,Mg);const t=ue(e,e,s.schema({names:{base:{names:{blockName:xa}},minimum:Gi,maximum:Ls}}));ae.assertSchema(t,this.className),this.base=new bt({schema:t.result.base}),Gi in t.result&&(this.minimum=t.result.minimum.valueBlock.isHexOnly?t.result.minimum:t.result.minimum.valueBlock.valueDec),Ls in t.result&&(this.maximum=t.result.maximum.valueBlock.isHexOnly?t.result.maximum:t.result.maximum.valueBlock.valueDec)}toSchema(){const e=[];if(e.push(this.base.toSchema()),0!==this.minimum){let t=0;t=this.minimum instanceof Y?this.minimum:new Y({value:this.minimum}),e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(Ls in this){let t=0;t=this.maximum instanceof Y?this.maximum:new Y({value:this.maximum}),e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[t]}))}return new O({value:e})}toJSON(){const e={base:this.base.toJSON()};return 0!==this.minimum&&(e.minimum="number"==typeof this.minimum?this.minimum:this.minimum.toJSON()),void 0!==this.maximum&&(e.maximum="number"==typeof this.maximum?this.maximum:this.maximum.toJSON()),e}}return s.CLASS_NAME="GeneralSubtree",s})();const Vr="permittedSubtrees",Or="excludedSubtrees",Lg=[Vr,Or];let Fg=(()=>{class s extends fe{constructor(e={}){super(),Vr in e&&(this.permittedSubtrees=l(e,Vr,s.defaultValues(Vr))),Or in e&&(this.excludedSubtrees=l(e,Or,s.defaultValues(Or))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Vr:case Or:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ge({name:t.permittedSubtrees||v,value:Kl.schema()})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Ge({name:t.excludedSubtrees||v,value:Kl.schema()})]})]})}fromSchema(e){re(e,Lg);const t=ue(e,e,s.schema({names:{permittedSubtrees:Vr,excludedSubtrees:Or}}));ae.assertSchema(t,this.className),Vr in t.result&&(this.permittedSubtrees=Array.from(t.result.permittedSubtrees,r=>new Kl({schema:r}))),Or in t.result&&(this.excludedSubtrees=Array.from(t.result.excludedSubtrees,r=>new Kl({schema:r})))}toSchema(){const e=[];return this.permittedSubtrees&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.permittedSubtrees,t=>t.toSchema())})),this.excludedSubtrees&&e.push(new q({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.excludedSubtrees,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={};return this.permittedSubtrees&&(e.permittedSubtrees=Array.from(this.permittedSubtrees,t=>t.toJSON())),this.excludedSubtrees&&(e.excludedSubtrees=Array.from(this.excludedSubtrees,t=>t.toJSON())),e}}return s.CLASS_NAME="NameConstraints",s})();const hs="requireExplicitPolicy",fs="inhibitPolicyMapping",Hg=[hs,fs];let jg=(()=>{class s extends fe{constructor(e={}){super(),hs in e&&(this.requireExplicitPolicy=l(e,hs,s.defaultValues(hs))),fs in e&&(this.inhibitPolicyMapping=l(e,fs,s.defaultValues(fs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hs:case fs:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Le({name:t.requireExplicitPolicy||v,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Le({name:t.inhibitPolicyMapping||v,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){re(e,Hg);const t=ue(e,e,s.schema({names:{requireExplicitPolicy:hs,inhibitPolicyMapping:fs}}));if(ae.assertSchema(t,this.className),hs in t.result){const r=t.result.requireExplicitPolicy;r.idBlock.tagClass=1,r.idBlock.tagNumber=2;const o=ct(r.toBER(!1));ae.assert(o,"Integer"),this.requireExplicitPolicy=o.result.valueBlock.valueDec}if(fs in t.result){const r=t.result.inhibitPolicyMapping;r.idBlock.tagClass=1,r.idBlock.tagNumber=2;const o=ct(r.toBER(!1));ae.assert(o,"Integer"),this.inhibitPolicyMapping=o.result.valueBlock.valueDec}}toSchema(){const e=[];if(hs in this){const t=new Y({value:this.requireExplicitPolicy});t.idBlock.tagClass=3,t.idBlock.tagNumber=0,e.push(t)}if(fs in this){const t=new Y({value:this.inhibitPolicyMapping});t.idBlock.tagClass=3,t.idBlock.tagNumber=1,e.push(t)}return new O({value:e})}toJSON(){const e={};return hs in this&&(e.requireExplicitPolicy=this.requireExplicitPolicy),fs in this&&(e.inhibitPolicyMapping=this.inhibitPolicyMapping),e}}return s.CLASS_NAME="PolicyConstraints",s})();const Va="issuerDomainPolicy",Oa="subjectDomainPolicy",$g=[Va,Oa];let Sd=(()=>{class s extends fe{constructor(e={}){super(),this.issuerDomainPolicy=l(e,Va,s.defaultValues(Va)),this.subjectDomainPolicy=l(e,Oa,s.defaultValues(Oa)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Va:case Oa:return v;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.issuerDomainPolicy||v}),new Ve({name:t.subjectDomainPolicy||v})]})}fromSchema(e){re(e,$g);const t=ue(e,e,s.schema({names:{issuerDomainPolicy:Va,subjectDomainPolicy:Oa}}));ae.assertSchema(t,this.className),this.issuerDomainPolicy=t.result.issuerDomainPolicy.valueBlock.toString(),this.subjectDomainPolicy=t.result.subjectDomainPolicy.valueBlock.toString()}toSchema(){return new O({value:[new Ve({value:this.issuerDomainPolicy}),new Ve({value:this.subjectDomainPolicy})]})}toJSON(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}return s.CLASS_NAME="PolicyMapping",s})();const Pa="mappings",Kg=[Pa];let Gg=(()=>{class s extends fe{constructor(e={}){super(),this.mappings=l(e,Pa,s.defaultValues(Pa)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Pa?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ge({name:t.mappings||v,value:Sd.schema()})]})}fromSchema(e){re(e,Kg);const t=ue(e,e,s.schema({names:{mappings:Pa}}));ae.assertSchema(t,this.className),this.mappings=Array.from(t.result.mappings,r=>new Sd({schema:r}))}toSchema(){return new O({value:Array.from(this.mappings,e=>e.toSchema())})}toJSON(){return{mappings:Array.from(this.mappings,e=>e.toJSON())}}}return s.CLASS_NAME="PolicyMappings",s})();const Fs="notBefore",Hs="notAfter",Jg=[Fs,Hs];let qg=(()=>{class s extends fe{constructor(e={}){super(),Fs in e&&(this.notBefore=l(e,Fs,s.defaultValues(Fs))),Hs in e&&(this.notAfter=l(e,Hs,s.defaultValues(Hs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fs:case Hs:return new Date;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Le({name:t.notBefore||v,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Le({name:t.notAfter||v,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){re(e,Jg);const t=ue(e,e,s.schema({names:{notBefore:Fs,notAfter:Hs}}));if(ae.assertSchema(t,this.className),Fs in t.result){const r=new ht;r.fromBuffer(t.result.notBefore.valueBlock.valueHex),this.notBefore=r.toDate()}if(Hs in t.result){const r=new ht({valueHex:t.result.notAfter.valueBlock.valueHex});r.fromBuffer(t.result.notAfter.valueBlock.valueHex),this.notAfter=r.toDate()}}toSchema(){const e=[];return Fs in this&&e.push(new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:new ht({valueDate:this.notBefore}).valueBlock.valueHexView})),Hs in this&&e.push(new Le({idBlock:{tagClass:3,tagNumber:1},valueHex:new ht({valueDate:this.notAfter}).valueBlock.valueHexView})),new O({value:e})}toJSON(){const e={};return this.notBefore&&(e.notBefore=this.notBefore),this.notAfter&&(e.notAfter=this.notAfter),e}}return s.CLASS_NAME="PrivateKeyUsagePeriod",s})();const Ji="id",ds="type",qi="values",Wg=[Ji,ds],zg=[qi];let bd=(()=>{class s extends fe{constructor(e={}){super(),this.id=l(e,Ji,s.defaultValues(Ji)),ds in e&&(this.type=l(e,ds,s.defaultValues(ds))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ji:return v;case ds:return new kt;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ji:return t===v;case ds:return t instanceof kt;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.id||v}),new Fe({name:t.type||v,optional:!0})]})}fromSchema(e){re(e,Wg);const t=ue(e,e,s.schema({names:{id:Ji,type:ds}}));ae.assertSchema(t,this.className),this.id=t.result.id.valueBlock.toString(),ds in t.result&&(this.type=t.result.type)}toSchema(){const e=[new Ve({value:this.id})];return ds in this&&e.push(this.type),new O({value:e})}toJSON(){const e={id:this.id};return this.type&&(e.type=this.type.toJSON()),e}}return s.CLASS_NAME="QCStatement",s})(),Yg=(()=>{class s extends fe{constructor(e={}){super(),this.values=l(e,qi,s.defaultValues(qi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===qi?[]:super.defaultValues(e)}static compareWithDefault(e,t){return e===qi?0===t.length:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ge({name:t.values||v,value:bd.schema(t.value||{})})]})}fromSchema(e){re(e,zg);const t=ue(e,e,s.schema({names:{values:qi}}));ae.assertSchema(t,this.className),this.values=Array.from(t.result.values,r=>new bd({schema:r}))}toSchema(){return new O({value:Array.from(this.values,e=>e.toSchema())})}toJSON(){return{values:Array.from(this.values,e=>e.toJSON())}}}return s.CLASS_NAME="QCStatements",s})();var Pr;class js{static register(i,e,t){this.namedCurves[i.toLowerCase()]=this.namedCurves[e]={name:i,id:e,size:t}}static find(i){return this.namedCurves[i.toLowerCase()]||null}}Pr=js,js.namedCurves={},Pr.register("P-256","1.2.840.10045.3.1.7",32),Pr.register("P-384","1.3.132.0.34",48),Pr.register("P-521","1.3.132.0.35",66),Pr.register("brainpoolP256r1","1.3.36.3.3.2.8.1.1.7",32),Pr.register("brainpoolP384r1","1.3.36.3.3.2.8.1.1.11",48),Pr.register("brainpoolP512r1","1.3.36.3.3.2.8.1.1.13",64);const ql="namedCurve";let $s=(()=>{class s extends fe{constructor(e={}){super(),this.x=l(e,"x",s.defaultValues("x")),this.y=l(e,"y",s.defaultValues("y")),this.namedCurve=l(e,ql,s.defaultValues(ql)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"x":case"y":return Ct;case ql:return v;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"x":case"y":return t instanceof ArrayBuffer&&ie(t,s.defaultValues(e));case ql:return"string"==typeof t&&t===s.defaultValues(e);default:return super.defaultValues(e)}}static schema(){return new Ul}fromSchema(e){const t=b._H.toUint8Array(e);if(4!==t[0])throw new Error("Object's schema was not verified against input data for ECPublicKey");const r=js.find(this.namedCurve);if(!r)throw new Error(`Incorrect curve OID: ${this.namedCurve}`);const a=r.size;if(t.byteLength!==2*a+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.namedCurve=r.name,this.x=t.slice(1,a+1).buffer,this.y=t.slice(1+a,2*a+1).buffer}toSchema(){return new Ul({data:R(new Uint8Array([4]).buffer,this.x,this.y)})}toJSON(){const e=js.find(this.namedCurve);return{crv:e?e.name:this.namedCurve,x:he(M(this.x),!0,!0,!1),y:he(M(this.y),!0,!0,!1)}}fromJSON(e){tt.assert("json",e,"crv","x","y");let t=0;const r=js.find(e.crv);r&&(this.namedCurve=r.id,t=r.size);const a=Ne(J(e.x,!0));if(a.byteLength<t){this.x=new ArrayBuffer(t);const u=new Uint8Array(this.x),h=new Uint8Array(a);u.set(h,1)}else this.x=a.slice(0,t);const o=Ne(J(e.y,!0));if(o.byteLength<t){this.y=new ArrayBuffer(t);const u=new Uint8Array(this.y),h=new Uint8Array(o);u.set(h,1)}else this.y=o.slice(0,t)}}return s.CLASS_NAME="ECPublicKey",s})();const Da="modulus",Ua="publicExponent",Xg=[Da,Ua];let Ad=(()=>{class s extends fe{constructor(e={}){super(),this.modulus=l(e,Da,s.defaultValues(Da)),this.publicExponent=l(e,Ua,s.defaultValues(Ua)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Da:case Ua:return new Y;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.modulus||v}),new Y({name:t.publicExponent||v})]})}fromSchema(e){re(e,Xg);const t=ue(e,e,s.schema({names:{modulus:Da,publicExponent:Ua}}));ae.assertSchema(t,this.className),this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent}toSchema(){return new O({value:[this.modulus.convertToDER(),this.publicExponent]})}toJSON(){return{n:b.U$.ToBase64Url(this.modulus.valueBlock.valueHexView),e:b.U$.ToBase64Url(this.publicExponent.valueBlock.valueHexView)}}fromJSON(e){tt.assert("json",e,"n","e");const t=Ne(J(e.n,!0));this.modulus=new Y({valueHex:t.slice(0,Math.pow(2,ke(t.byteLength)))}),this.publicExponent=new Y({valueHex:Ne(J(e.e,!0)).slice(0,3)})}}return s.CLASS_NAME="RSAPublicKey",s})();const Ma="algorithm",La="subjectPublicKey",Qg=[Ma,La];let ns=(()=>{class s extends fe{get parsedKey(){if(void 0===this._parsedKey){switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":if("algorithmParams"in this.algorithm&&this.algorithm.algorithmParams.constructor.blockName()===Ve.blockName())try{this._parsedKey=new $s({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHexView})}catch{}break;case"1.2.840.113549.1.1.1":{const e=ct(this.subjectPublicKey.valueBlock.valueHexView);if(-1!==e.offset)try{this._parsedKey=new Ad({schema:e.result})}catch{}}}this._parsedKey||(this._parsedKey=null)}return this._parsedKey||void 0}set parsedKey(e){this._parsedKey=e}constructor(e={}){super(),this.algorithm=l(e,Ma,s.defaultValues(Ma)),this.subjectPublicKey=l(e,La,s.defaultValues(La));const t=l(e,"parsedKey",null);t&&(this.parsedKey=t),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ma:return new X;case La:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[X.schema(t.algorithm||{}),new et({name:t.subjectPublicKey||v})]})}fromSchema(e){re(e,Qg);const t=ue(e,e,s.schema({names:{algorithm:{names:{blockName:Ma}},subjectPublicKey:La}}));ae.assertSchema(t,this.className),this.algorithm=new X({schema:t.result.algorithm}),this.subjectPublicKey=t.result.subjectPublicKey}toSchema(){return new O({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}toJSON(){if(!this.parsedKey)return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()};const e={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();return Object.assign(e,t),e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new $s({json:e}),this.algorithm=new X({algorithmId:"1.2.840.10045.2.1",algorithmParams:new Ve({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new Ad({json:e}),this.algorithm=new X({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new kt});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.subjectPublicKey=new et({valueHex:this.parsedKey.toSchema().toBER(!1)})}}importKey(e,t=Je(!0)){var r=this;return(0,k.A)(function*(){try{if(!e)throw new Error("Need to provide publicKey input parameter");const o=ct(yield t.exportKey("spki",e));try{r.fromSchema(o.result)}catch{throw new Error("Error during initializing object from schema")}}catch(a){const o=a instanceof Error?a.message:`${a}`;throw new Error(`Error during exporting public key: ${o}`)}})()}}return s.CLASS_NAME="PublicKeyInfo",s})();const Wi="version",zi="privateKey",Qt="namedCurve",Ks="publicKey",Zg=[Wi,zi,Qt,Ks];let Ed=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,Wi,s.defaultValues(Wi)),this.privateKey=l(e,zi,s.defaultValues(zi)),Qt in e&&(this.namedCurve=l(e,Qt,s.defaultValues(Qt))),Ks in e&&(this.publicKey=l(e,Ks,s.defaultValues(Ks))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Wi:return 1;case zi:return new de;case Qt:return v;case Ks:return new $s;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Wi:return t===s.defaultValues(e);case zi:return t.isEqual(s.defaultValues(e));case Qt:return t===v;case Ks:return $s.compareWithDefault(Qt,t.namedCurve)&&$s.compareWithDefault("x",t.x)&&$s.compareWithDefault("y",t.y);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.version||v}),new de({name:t.privateKey||v}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ve({name:t.namedCurve||v})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new et({name:t.publicKey||v})]})]})}fromSchema(e){re(e,Zg);const t=ue(e,e,s.schema({names:{version:Wi,privateKey:zi,namedCurve:Qt,publicKey:Ks}}));if(ae.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.privateKey=t.result.privateKey,Qt in t.result&&(this.namedCurve=t.result.namedCurve.valueBlock.toString()),Ks in t.result){const r={schema:t.result.publicKey.valueBlock.valueHex};Qt in this&&(r.namedCurve=this.namedCurve),this.publicKey=new $s(r)}}toSchema(){const e=[new Y({value:this.version}),this.privateKey];return this.namedCurve&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[new Ve({value:this.namedCurve})]})),this.publicKey&&e.push(new q({idBlock:{tagClass:3,tagNumber:1},value:[new et({valueHex:this.publicKey.toSchema().toBER(!1)})]})),new O({value:e})}toJSON(){if(!this.namedCurve||s.compareWithDefault(Qt,this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');const e=js.find(this.namedCurve),t={crv:e?e.name:this.namedCurve,d:b.U$.ToBase64Url(this.privateKey.valueBlock.valueHexView)};if(this.publicKey){const r=this.publicKey.toJSON();t.x=r.x,t.y=r.y}return t}fromJSON(e){tt.assert("json",e,"crv","d");let t=0;const r=js.find(e.crv);r&&(this.namedCurve=r.id,t=r.size);const a=b.U$.FromBase64Url(e.d);if(a.byteLength<t){const o=new ArrayBuffer(t),u=new Uint8Array(o),h=new Uint8Array(a);u.set(h,1),this.privateKey=new de({valueHex:o})}else this.privateKey=new de({valueHex:a.slice(0,t)});e.x&&e.y&&(this.publicKey=new $s({json:e}))}}return s.CLASS_NAME="ECPrivateKey",s})();const Fa="prime",Ha="exponent",ja="coefficient",ep=[Fa,Ha,ja];let ku=(()=>{class s extends fe{constructor(e={}){super(),this.prime=l(e,Fa,s.defaultValues(Fa)),this.exponent=l(e,Ha,s.defaultValues(Ha)),this.coefficient=l(e,ja,s.defaultValues(ja)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fa:case Ha:case ja:return new Y;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.prime||v}),new Y({name:t.exponent||v}),new Y({name:t.coefficient||v})]})}fromSchema(e){re(e,ep);const t=ue(e,e,s.schema({names:{prime:Fa,exponent:Ha,coefficient:ja}}));ae.assertSchema(t,this.className),this.prime=t.result.prime.convertFromDER(),this.exponent=t.result.exponent.convertFromDER(),this.coefficient=t.result.coefficient.convertFromDER()}toSchema(){return new O({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}toJSON(){return{r:b.U$.ToBase64Url(this.prime.valueBlock.valueHexView),d:b.U$.ToBase64Url(this.exponent.valueBlock.valueHexView),t:b.U$.ToBase64Url(this.coefficient.valueBlock.valueHexView)}}fromJSON(e){tt.assert("json",e,"r","d","r"),this.prime=new Y({valueHex:b.U$.FromBase64Url(e.r)}),this.exponent=new Y({valueHex:b.U$.FromBase64Url(e.d)}),this.coefficient=new Y({valueHex:b.U$.FromBase64Url(e.t)})}}return s.CLASS_NAME="OtherPrimeInfo",s})();const $a="version",Ka="modulus",Ga="publicExponent",Ja="privateExponent",qa="prime1",Wa="prime2",za="exponent1",Ya="exponent2",Xa="coefficient",Dr="otherPrimeInfos",tp=[$a,Ka,Ga,Ja,qa,Wa,za,Ya,Xa,Dr];let kd=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,$a,s.defaultValues($a)),this.modulus=l(e,Ka,s.defaultValues(Ka)),this.publicExponent=l(e,Ga,s.defaultValues(Ga)),this.privateExponent=l(e,Ja,s.defaultValues(Ja)),this.prime1=l(e,qa,s.defaultValues(qa)),this.prime2=l(e,Wa,s.defaultValues(Wa)),this.exponent1=l(e,za,s.defaultValues(za)),this.exponent2=l(e,Ya,s.defaultValues(Ya)),this.coefficient=l(e,Xa,s.defaultValues(Xa)),Dr in e&&(this.otherPrimeInfos=l(e,Dr,s.defaultValues(Dr))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $a:return 0;case Ka:case Ga:case Ja:case qa:case Wa:case za:case Ya:case Xa:return new Y;case Dr:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.version||v}),new Y({name:t.modulus||v}),new Y({name:t.publicExponent||v}),new Y({name:t.privateExponent||v}),new Y({name:t.prime1||v}),new Y({name:t.prime2||v}),new Y({name:t.exponent1||v}),new Y({name:t.exponent2||v}),new Y({name:t.coefficient||v}),new O({optional:!0,value:[new Ge({name:t.otherPrimeInfosName||v,value:ku.schema(t.otherPrimeInfo||{})})]})]})}fromSchema(e){re(e,tp);const t=ue(e,e,s.schema({names:{version:$a,modulus:Ka,publicExponent:Ga,privateExponent:Ja,prime1:qa,prime2:Wa,exponent1:za,exponent2:Ya,coefficient:Xa,otherPrimeInfo:{names:{blockName:Dr}}}}));ae.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent,this.privateExponent=t.result.privateExponent.convertFromDER(256),this.prime1=t.result.prime1.convertFromDER(128),this.prime2=t.result.prime2.convertFromDER(128),this.exponent1=t.result.exponent1.convertFromDER(128),this.exponent2=t.result.exponent2.convertFromDER(128),this.coefficient=t.result.coefficient.convertFromDER(128),Dr in t.result&&(this.otherPrimeInfos=Array.from(t.result.otherPrimeInfos,r=>new ku({schema:r})))}toSchema(){const e=[];return e.push(new Y({value:this.version})),e.push(this.modulus.convertToDER()),e.push(this.publicExponent),e.push(this.privateExponent.convertToDER()),e.push(this.prime1.convertToDER()),e.push(this.prime2.convertToDER()),e.push(this.exponent1.convertToDER()),e.push(this.exponent2.convertToDER()),e.push(this.coefficient.convertToDER()),this.otherPrimeInfos&&e.push(new O({value:Array.from(this.otherPrimeInfos,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={n:b.U$.ToBase64Url(this.modulus.valueBlock.valueHexView),e:b.U$.ToBase64Url(this.publicExponent.valueBlock.valueHexView),d:b.U$.ToBase64Url(this.privateExponent.valueBlock.valueHexView),p:b.U$.ToBase64Url(this.prime1.valueBlock.valueHexView),q:b.U$.ToBase64Url(this.prime2.valueBlock.valueHexView),dp:b.U$.ToBase64Url(this.exponent1.valueBlock.valueHexView),dq:b.U$.ToBase64Url(this.exponent2.valueBlock.valueHexView),qi:b.U$.ToBase64Url(this.coefficient.valueBlock.valueHexView)};return this.otherPrimeInfos&&(e.oth=Array.from(this.otherPrimeInfos,t=>t.toJSON())),e}fromJSON(e){tt.assert("json",e,"n","e","d","p","q","dp","dq","qi"),this.modulus=new Y({valueHex:b.U$.FromBase64Url(e.n)}),this.publicExponent=new Y({valueHex:b.U$.FromBase64Url(e.e)}),this.privateExponent=new Y({valueHex:b.U$.FromBase64Url(e.d)}),this.prime1=new Y({valueHex:b.U$.FromBase64Url(e.p)}),this.prime2=new Y({valueHex:b.U$.FromBase64Url(e.q)}),this.exponent1=new Y({valueHex:b.U$.FromBase64Url(e.dp)}),this.exponent2=new Y({valueHex:b.U$.FromBase64Url(e.dq)}),this.coefficient=new Y({valueHex:b.U$.FromBase64Url(e.qi)}),e.oth&&(this.otherPrimeInfos=Array.from(e.oth,t=>new ku({json:t})))}}return s.CLASS_NAME="RSAPrivateKey",s})();const Qa="version",Za="privateKeyAlgorithm",eo="privateKey",Ur="attributes",Wl="parsedKey",sp=[Qa,Za,eo,Ur];let Yi=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,Qa,s.defaultValues(Qa)),this.privateKeyAlgorithm=l(e,Za,s.defaultValues(Za)),this.privateKey=l(e,eo,s.defaultValues(eo)),Ur in e&&(this.attributes=l(e,Ur,s.defaultValues(Ur))),Wl in e&&(this.parsedKey=l(e,Wl,s.defaultValues(Wl))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qa:return 0;case Za:return new X;case eo:return new de;case Ur:return[];case Wl:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.version||v}),X.schema(t.privateKeyAlgorithm||{}),new de({name:t.privateKey||v}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ge({name:t.attributes||v,value:st.schema()})]})]})}fromSchema(e){re(e,sp);const t=ue(e,e,s.schema({names:{version:Qa,privateKeyAlgorithm:{names:{blockName:Za}},privateKey:eo,attributes:Ur}}));switch(ae.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.privateKeyAlgorithm=new X({schema:t.result.privateKeyAlgorithm}),this.privateKey=t.result.privateKey,Ur in t.result&&(this.attributes=Array.from(t.result.attributes,r=>new st({schema:r}))),this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":{const r=ct(this.privateKey.valueBlock.valueHexView);-1!==r.offset&&(this.parsedKey=new kd({schema:r.result}))}break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm&&this.privateKeyAlgorithm.algorithmParams instanceof Ve){const r=ct(this.privateKey.valueBlock.valueHexView);-1!==r.offset&&(this.parsedKey=new Ed({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:r.result}))}}}toSchema(){const e=[new Y({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];return this.attributes&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,t=>t.toSchema())})),new O({value:e})}toJSON(){if(!this.parsedKey){const r={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};return this.attributes&&(r.attributes=Array.from(this.attributes,a=>a.toJSON())),r}const e={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();return Object.assign(e,t),e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new Ed({json:e}),this.privateKeyAlgorithm=new X({algorithmId:"1.2.840.10045.2.1",algorithmParams:new Ve({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new kd({json:e}),this.privateKeyAlgorithm=new X({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new kt});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.privateKey=new de({valueHex:this.parsedKey.toSchema().toBER(!1)})}}}return s.CLASS_NAME="PrivateKeyInfo",s})();const Xi="contentType",Qi="contentEncryptionAlgorithm",Mr="encryptedContent",rp=[Xi,Qi,Mr];let Dt=(()=>{class s extends fe{constructor(e={}){if(super(),this.contentType=l(e,Xi,s.defaultValues(Xi)),this.contentEncryptionAlgorithm=l(e,Qi,s.defaultValues(Qi)),Mr in e&&e.encryptedContent&&(this.encryptedContent=e.encryptedContent,1===this.encryptedContent.idBlock.tagClass&&4===this.encryptedContent.idBlock.tagNumber&&!1===this.encryptedContent.idBlock.isConstructed&&!e.disableSplit)){const t=new de({idBlock:{isConstructed:!0},isConstructed:!0});let r=0;const a=this.encryptedContent.valueBlock.valueHexView.slice().buffer;let o=a.byteLength;for(;o>0;){const u=new Uint8Array(a,r,r+1024>a.byteLength?a.byteLength-r:1024),h=new ArrayBuffer(u.length),m=new Uint8Array(h);for(let N=0;N<m.length;N++)m[N]=u[N];t.valueBlock.value.push(new de({valueHex:h})),o-=u.length,r+=u.length}this.encryptedContent=t}e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Xi:return v;case Qi:return new X;case Mr:return new de;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Xi:return t===v;case Qi:return t.algorithmId===v&&!("algorithmParams"in t);case Mr:return t.isEqual(s.defaultValues(Mr));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.contentType||v}),X.schema(t.contentEncryptionAlgorithm||{}),new ft({value:[new q({name:t.encryptedContent||v,idBlock:{tagClass:3,tagNumber:0},value:[new Ge({value:new de})]}),new Le({name:t.encryptedContent||v,idBlock:{tagClass:3,tagNumber:0}})]})]})}fromSchema(e){re(e,rp);const t=ue(e,e,s.schema({names:{contentType:Xi,contentEncryptionAlgorithm:{names:{blockName:Qi}},encryptedContent:Mr}}));ae.assertSchema(t,this.className),this.contentType=t.result.contentType.valueBlock.toString(),this.contentEncryptionAlgorithm=new X({schema:t.result.contentEncryptionAlgorithm}),Mr in t.result&&(this.encryptedContent=t.result.encryptedContent,this.encryptedContent.idBlock.tagClass=1,this.encryptedContent.idBlock.tagNumber=4)}toSchema(){const e={isIndefiniteForm:!1},t=[];if(t.push(new Ve({value:this.contentType})),t.push(this.contentEncryptionAlgorithm.toSchema()),this.encryptedContent){e.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;const r=this.encryptedContent;r.idBlock.tagClass=3,r.idBlock.tagNumber=0,r.lenBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed,t.push(r)}return new O({lenBlock:e,value:t})}toJSON(){const e={contentType:this.contentType,contentEncryptionAlgorithm:this.contentEncryptionAlgorithm.toJSON()};return this.encryptedContent&&(e.encryptedContent=this.encryptedContent.toJSON()),e}getEncryptedContent(){if(!this.encryptedContent)throw new Error("Parameter 'encryptedContent' is undefined");return de.prototype.getValue.call(this.encryptedContent)}}return s.CLASS_NAME="EncryptedContentInfo",s})();const Gs="hashAlgorithm",Js="maskGenAlgorithm",qs="saltLength",Ws="trailerField",ip=[Gs,Js,qs,Ws];let _u=(()=>{class s extends fe{constructor(e={}){super(),this.hashAlgorithm=l(e,Gs,s.defaultValues(Gs)),this.maskGenAlgorithm=l(e,Js,s.defaultValues(Js)),this.saltLength=l(e,qs,s.defaultValues(qs)),this.trailerField=l(e,Ws,s.defaultValues(Ws)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Gs:return new X({algorithmId:"1.3.14.3.2.26",algorithmParams:new kt});case Js:return new X({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new X({algorithmId:"1.3.14.3.2.26",algorithmParams:new kt}).toSchema()});case qs:return 20;case Ws:return 1;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[X.schema(t.hashAlgorithm||{})]}),new q({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[X.schema(t.maskGenAlgorithm||{})]}),new q({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[new Y({name:t.saltLength||v})]}),new q({idBlock:{tagClass:3,tagNumber:3},optional:!0,value:[new Y({name:t.trailerField||v})]})]})}fromSchema(e){re(e,ip);const t=ue(e,e,s.schema({names:{hashAlgorithm:{names:{blockName:Gs}},maskGenAlgorithm:{names:{blockName:Js}},saltLength:qs,trailerField:Ws}}));ae.assertSchema(t,this.className),Gs in t.result&&(this.hashAlgorithm=new X({schema:t.result.hashAlgorithm})),Js in t.result&&(this.maskGenAlgorithm=new X({schema:t.result.maskGenAlgorithm})),qs in t.result&&(this.saltLength=t.result.saltLength.valueBlock.valueDec),Ws in t.result&&(this.trailerField=t.result.trailerField.valueBlock.valueDec)}toSchema(){const e=[];return this.hashAlgorithm.isEqual(s.defaultValues(Gs))||e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(s.defaultValues(Js))||e.push(new q({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.saltLength!==s.defaultValues(qs)&&e.push(new q({idBlock:{tagClass:3,tagNumber:2},value:[new Y({value:this.saltLength})]})),this.trailerField!==s.defaultValues(Ws)&&e.push(new q({idBlock:{tagClass:3,tagNumber:3},value:[new Y({value:this.trailerField})]})),new O({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(s.defaultValues(Gs))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(s.defaultValues(Js))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.saltLength!==s.defaultValues(qs)&&(e.saltLength=this.saltLength),this.trailerField!==s.defaultValues(Ws)&&(e.trailerField=this.trailerField),e}}return s.CLASS_NAME="RSASSAPSSParams",s})();const Zi="salt",to="iterationCount",Zt="keyLength",ms="prf",np=[Zi,to,Zt,ms];let so=(()=>{class s extends fe{constructor(e={}){super(),this.salt=l(e,Zi,s.defaultValues(Zi)),this.iterationCount=l(e,to,s.defaultValues(to)),Zt in e&&(this.keyLength=l(e,Zt,s.defaultValues(Zt))),ms in e&&(this.prf=l(e,ms,s.defaultValues(ms))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Zi:return{};case to:return-1;case Zt:return 0;case ms:return new X({algorithmId:"1.3.14.3.2.26",algorithmParams:new kt});default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new ft({value:[new de({name:t.saltPrimitive||v}),X.schema(t.saltConstructed||{})]}),new Y({name:t.iterationCount||v}),new Y({name:t.keyLength||v,optional:!0}),X.schema(t.prf||{names:{optional:!0}})]})}fromSchema(e){re(e,np);const t=ue(e,e,s.schema({names:{saltPrimitive:Zi,saltConstructed:{names:{blockName:Zi}},iterationCount:to,keyLength:Zt,prf:{names:{blockName:ms,optional:!0}}}}));ae.assertSchema(t,this.className),this.salt=t.result.salt,this.iterationCount=t.result.iterationCount.valueBlock.valueDec,Zt in t.result&&(this.keyLength=t.result.keyLength.valueBlock.valueDec),ms in t.result&&(this.prf=new X({schema:t.result.prf}))}toSchema(){const e=[];return e.push(this.salt),e.push(new Y({value:this.iterationCount})),Zt in this&&s.defaultValues(Zt)!==this.keyLength&&e.push(new Y({value:this.keyLength})),this.prf&&!1===s.defaultValues(ms).isEqual(this.prf)&&e.push(this.prf.toSchema()),new O({value:e})}toJSON(){const e={salt:this.salt.toJSON(),iterationCount:this.iterationCount};return Zt in this&&s.defaultValues(Zt)!==this.keyLength&&(e.keyLength=this.keyLength),this.prf&&!1===s.defaultValues(ms).isEqual(this.prf)&&(e.prf=this.prf.toJSON()),e}}return s.CLASS_NAME="PBKDF2Params",s})();const ro="keyDerivationFunc",io="encryptionScheme",ap=[ro,io];let Cd=(()=>{class s extends fe{constructor(e={}){super(),this.keyDerivationFunc=l(e,ro,s.defaultValues(ro)),this.encryptionScheme=l(e,io,s.defaultValues(io)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ro:case io:return new X;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[X.schema(t.keyDerivationFunc||{}),X.schema(t.encryptionScheme||{})]})}fromSchema(e){re(e,ap);const t=ue(e,e,s.schema({names:{keyDerivationFunc:{names:{blockName:ro}},encryptionScheme:{names:{blockName:io}}}}));ae.assertSchema(t,this.className),this.keyDerivationFunc=new X({schema:t.result.keyDerivationFunc}),this.encryptionScheme=new X({schema:t.result.encryptionScheme})}toSchema(){return new O({value:[this.keyDerivationFunc.toSchema(),this.encryptionScheme.toSchema()]})}toJSON(){return{keyDerivationFunc:this.keyDerivationFunc.toJSON(),encryptionScheme:this.encryptionScheme.toJSON()}}}return s.CLASS_NAME="PBES2Params",s})();class op{constructor(i){this.crypto=i.crypto,this.subtle="webkitSubtle"in i.crypto?i.crypto.webkitSubtle:i.crypto.subtle,this.name=l(i,"name",v)}encrypt(...i){var e=this;return(0,k.A)(function*(){return e.subtle.encrypt(...i)})()}decrypt(...i){var e=this;return(0,k.A)(function*(){return e.subtle.decrypt(...i)})()}sign(...i){return this.subtle.sign(...i)}verify(...i){var e=this;return(0,k.A)(function*(){return e.subtle.verify(...i)})()}digest(...i){var e=this;return(0,k.A)(function*(){return e.subtle.digest(...i)})()}generateKey(...i){var e=this;return(0,k.A)(function*(){return e.subtle.generateKey(...i)})()}deriveKey(...i){var e=this;return(0,k.A)(function*(){return e.subtle.deriveKey(...i)})()}deriveBits(...i){var e=this;return(0,k.A)(function*(){return e.subtle.deriveBits(...i)})()}wrapKey(...i){var e=this;return(0,k.A)(function*(){return e.subtle.wrapKey(...i)})()}unwrapKey(...i){var e=this;return(0,k.A)(function*(){return e.subtle.unwrapKey(...i)})()}exportKey(...i){return this.subtle.exportKey(...i)}importKey(...i){return this.subtle.importKey(...i)}getRandomValues(i){return this.crypto.getRandomValues(i)}}function Nd(s,i,e,t,r){return Cu.apply(this,arguments)}function Cu(){return(Cu=(0,k.A)(function*(s,i,e,t,r){let a,o,u;switch(s.toUpperCase()){case"SHA-1":a=20,o=64,u=Rm;break;case"SHA-256":a=32,o=64,u=xm;break;case"SHA-384":a=48,o=128,u=Qm;break;case"SHA-512":a=64,o=128,u=Xm;break;default:throw new Error("Unsupported hashing algorithm")}const h=new Uint8Array(e);let m=(new TextDecoder).decode(e);(new TextEncoder).encode(m).some((oe,pe)=>oe!==h[pe])&&(m=String.fromCharCode(...h));const T=new Uint8Array(2*m.length+2),K=new DataView(T.buffer);for(let oe=0;oe<m.length;oe++)K.setUint16(2*oe,m.charCodeAt(oe),!1);K.setUint16(2*m.length,0,!1);const F=new Uint8Array(o).fill(3),se=new Uint8Array(t),Ee=new Uint8Array(o*Math.ceil(se.length/o)).map((oe,pe)=>se[pe%se.length]),ye=new Uint8Array(o*Math.ceil(T.length/o)).map((oe,pe)=>T[pe%T.length]);let ee=new Uint8Array(Ee.length+ye.length);ee.set(Ee),ee.set(ye,Ee.length);const Se=Math.ceil((i>>3)/a),ne=[];for(let oe=0;oe<Se;oe++){let pe=new Uint8Array(F.length+ee.length);pe.set(F),pe.set(ee,F.length);for(let Me=0;Me<r;Me++)pe=u(pe);const Ae=new Uint8Array(o).map((Me,Ye)=>pe[Ye%pe.length]),Te=Math.ceil(se.length/o)+Math.ceil(T.length/o),xe=[];for(let Me=0;Me<Te;Me++){const Ye=Array.from(ee.slice(Me*o,(Me+1)*o));let At=511;for(let Xe=Ae.length-1;Xe>=0;Xe--)At>>=8,At+=Ae[Xe]+(Ye[Xe]||0),Ye[Xe]=255&At;xe.push(...Ye)}ee=new Uint8Array(xe),ne.push(...pe)}return new Uint8Array(ne.slice(0,i>>3)).buffer})).apply(this,arguments)}function Id(s){const i="string"==typeof s?{name:s}:s;return"hash"in i?{...i,hash:Id(i.hash)}:i}class zl extends op{importKey(i,e,t,r,a){var o=this;return(0,k.A)(function*(){var u,h,m,N,T,K;let F={};const se=Id(t);switch(i.toLowerCase()){case"raw":return o.subtle.importKey("raw",e,t,r,a);case"spki":{const Ee=ct(b._H.toArrayBuffer(e));ae.assert(Ee,"keyData");const ye=new ns;try{ye.fromSchema(Ee.result)}catch{throw new ot("Incorrect keyData")}switch(se.name.toUpperCase()){case"RSA-PSS":if(!se.hash)throw new tt("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(se.hash.name.toUpperCase()){case"SHA-1":F.alg="PS1";break;case"SHA-256":F.alg="PS256";break;case"SHA-384":F.alg="PS384";break;case"SHA-512":F.alg="PS512";break;default:throw new Error(`Incorrect hash algorithm: ${se.hash.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(a=["verify"],F.kty="RSA",F.ext=r,F.key_ops=a,"1.2.840.113549.1.1.1"!==ye.algorithm.algorithmId)throw new Error(`Incorrect public key algorithm: ${ye.algorithm.algorithmId}`);if(!F.alg){if(!se.hash)throw new tt("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(se.hash.name.toUpperCase()){case"SHA-1":F.alg="RS1";break;case"SHA-256":F.alg="RS256";break;case"SHA-384":F.alg="RS384";break;case"SHA-512":F.alg="RS512";break;default:throw new Error(`Incorrect hash algorithm: ${se.hash.name.toUpperCase()}`)}}const ee=ye.toJSON();Object.assign(F,ee)}break;case"ECDSA":a=["verify"];case"ECDH":{if(F={kty:"EC",ext:r,key_ops:a},"1.2.840.10045.2.1"!==ye.algorithm.algorithmId)throw new Error(`Incorrect public key algorithm: ${ye.algorithm.algorithmId}`);const ee=ye.toJSON();Object.assign(F,ee)}break;case"RSA-OAEP":{if(F.kty="RSA",F.ext=r,F.key_ops=a,"safari"===o.name.toLowerCase())F.alg="RSA-OAEP";else{if(!se.hash)throw new tt("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(se.hash.name.toUpperCase()){case"SHA-1":F.alg="RSA-OAEP";break;case"SHA-256":F.alg="RSA-OAEP-256";break;case"SHA-384":F.alg="RSA-OAEP-384";break;case"SHA-512":F.alg="RSA-OAEP-512";break;default:throw new Error(`Incorrect hash algorithm: ${se.hash.name.toUpperCase()}`)}}const ee=ye.toJSON();Object.assign(F,ee)}break;case"RSAES-PKCS1-V1_5":{F.kty="RSA",F.ext=r,F.key_ops=a,F.alg="PS1";const ee=ye.toJSON();Object.assign(F,ee)}break;default:throw new Error(`Incorrect algorithm name: ${se.name.toUpperCase()}`)}}break;case"pkcs8":{const Ee=new Yi,ye=ct(b._H.toArrayBuffer(e));ae.assert(ye,"keyData");try{Ee.fromSchema(ye.result)}catch{throw new Error("Incorrect keyData")}if(!Ee.parsedKey)throw new Error("Incorrect keyData");switch(se.name.toUpperCase()){case"RSA-PSS":switch(null===(u=se.hash)||void 0===u?void 0:u.name.toUpperCase()){case"SHA-1":F.alg="PS1";break;case"SHA-256":F.alg="PS256";break;case"SHA-384":F.alg="PS384";break;case"SHA-512":F.alg="PS512";break;default:throw new Error(`Incorrect hash algorithm: ${null===(h=se.hash)||void 0===h?void 0:h.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(a=["sign"],F.kty="RSA",F.ext=r,F.key_ops=a,"1.2.840.113549.1.1.1"!==Ee.privateKeyAlgorithm.algorithmId)throw new Error(`Incorrect private key algorithm: ${Ee.privateKeyAlgorithm.algorithmId}`);if(!("alg"in F))switch(null===(m=se.hash)||void 0===m?void 0:m.name.toUpperCase()){case"SHA-1":F.alg="RS1";break;case"SHA-256":F.alg="RS256";break;case"SHA-384":F.alg="RS384";break;case"SHA-512":F.alg="RS512";break;default:throw new Error(`Incorrect hash algorithm: ${null===(N=se.hash)||void 0===N?void 0:N.name.toUpperCase()}`)}const ee=Ee.toJSON();Object.assign(F,ee)}break;case"ECDSA":a=["sign"];case"ECDH":{if(F={kty:"EC",ext:r,key_ops:a},"1.2.840.10045.2.1"!==Ee.privateKeyAlgorithm.algorithmId)throw new Error(`Incorrect algorithm: ${Ee.privateKeyAlgorithm.algorithmId}`);const ee=Ee.toJSON();Object.assign(F,ee)}break;case"RSA-OAEP":{if(F.kty="RSA",F.ext=r,F.key_ops=a,"safari"===o.name.toLowerCase())F.alg="RSA-OAEP";else switch(null===(T=se.hash)||void 0===T?void 0:T.name.toUpperCase()){case"SHA-1":F.alg="RSA-OAEP";break;case"SHA-256":F.alg="RSA-OAEP-256";break;case"SHA-384":F.alg="RSA-OAEP-384";break;case"SHA-512":F.alg="RSA-OAEP-512";break;default:throw new Error(`Incorrect hash algorithm: ${null===(K=se.hash)||void 0===K?void 0:K.name.toUpperCase()}`)}const ee=Ee.toJSON();Object.assign(F,ee)}break;case"RSAES-PKCS1-V1_5":{a=["decrypt"],F.kty="RSA",F.ext=r,F.key_ops=a,F.alg="PS1";const ee=Ee.toJSON();Object.assign(F,ee)}break;default:throw new Error(`Incorrect algorithm name: ${se.name.toUpperCase()}`)}}break;case"jwk":F=e;break;default:throw new Error(`Incorrect format: ${i}`)}if("safari"===o.name.toLowerCase())try{return o.subtle.importKey("jwk",Ne(JSON.stringify(F)),t,r,a)}catch{return o.subtle.importKey("jwk",F,t,r,a)}return o.subtle.importKey("jwk",F,t,r,a)})()}exportKey(i,e){var t=this;return(0,k.A)(function*(){let r=yield t.subtle.exportKey("jwk",e);switch("safari"===t.name.toLowerCase()&&r instanceof ArrayBuffer&&(r=JSON.parse(M(r))),i.toLowerCase()){case"raw":return t.subtle.exportKey("raw",e);case"spki":{const a=new ns;try{a.fromJSON(r)}catch{throw new Error("Incorrect key data")}return a.toSchema().toBER(!1)}case"pkcs8":{const a=new Yi;try{a.fromJSON(r)}catch{throw new Error("Incorrect key data")}return a.toSchema().toBER(!1)}case"jwk":return r;default:throw new Error(`Incorrect format: ${i}`)}})()}convert(i,e,t,r,a,o){var u=this;return(0,k.A)(function*(){if(i.toLowerCase()===e.toLowerCase())return t;const h=yield u.importKey(i,t,r,a,o);return u.exportKey(e,h)})()}getAlgorithmByOID(i,e=!1,t){switch(i){case"1.2.840.113549.1.1.1":return{name:"RSAES-PKCS1-v1_5"};case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"}}if(e)throw new Error(`Unsupported algorithm identifier ${t?`for ${t} `:v}: ${i}`);return{}}getOIDByAlgorithm(i,e=!1,t){let r=v;switch(i.name.toUpperCase()){case"RSAES-PKCS1-V1_5":r="1.2.840.113549.1.1.1";break;case"RSASSA-PKCS1-V1_5":switch(i.hash.name.toUpperCase()){case"SHA-1":r="1.2.840.113549.1.1.5";break;case"SHA-256":r="1.2.840.113549.1.1.11";break;case"SHA-384":r="1.2.840.113549.1.1.12";break;case"SHA-512":r="1.2.840.113549.1.1.13"}break;case"RSA-PSS":r="1.2.840.113549.1.1.10";break;case"RSA-OAEP":r="1.2.840.113549.1.1.7";break;case"ECDSA":switch(i.hash.name.toUpperCase()){case"SHA-1":r="1.2.840.10045.4.1";break;case"SHA-256":r="1.2.840.10045.4.3.2";break;case"SHA-384":r="1.2.840.10045.4.3.3";break;case"SHA-512":r="1.2.840.10045.4.3.4"}break;case"ECDH":switch(i.kdf.toUpperCase()){case"SHA-1":r="1.3.133.16.840.63.0.2";break;case"SHA-256":r="1.3.132.1.11.1";break;case"SHA-384":r="1.3.132.1.11.2";break;case"SHA-512":r="1.3.132.1.11.3"}break;case"AES-CTR":case"AES-CMAC":case"CONCAT":case"HKDF":break;case"AES-CBC":switch(i.length){case 128:r="2.16.840.1.101.3.4.1.2";break;case 192:r="2.16.840.1.101.3.4.1.22";break;case 256:r="2.16.840.1.101.3.4.1.42"}break;case"AES-GCM":switch(i.length){case 128:r="2.16.840.1.101.3.4.1.6";break;case 192:r="2.16.840.1.101.3.4.1.26";break;case 256:r="2.16.840.1.101.3.4.1.46"}break;case"AES-CFB":switch(i.length){case 128:r="2.16.840.1.101.3.4.1.4";break;case 192:r="2.16.840.1.101.3.4.1.24";break;case 256:r="2.16.840.1.101.3.4.1.44"}break;case"AES-KW":switch(i.length){case 128:r="2.16.840.1.101.3.4.1.5";break;case 192:r="2.16.840.1.101.3.4.1.25";break;case 256:r="2.16.840.1.101.3.4.1.45"}break;case"HMAC":switch(i.hash.name.toUpperCase()){case"SHA-1":r="1.2.840.113549.2.7";break;case"SHA-256":r="1.2.840.113549.2.9";break;case"SHA-384":r="1.2.840.113549.2.10";break;case"SHA-512":r="1.2.840.113549.2.11"}break;case"DH":r="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":r="1.3.14.3.2.26";break;case"SHA-256":r="2.16.840.1.101.3.4.2.1";break;case"SHA-384":r="2.16.840.1.101.3.4.2.2";break;case"SHA-512":r="2.16.840.1.101.3.4.2.3";break;case"PBKDF2":r="1.2.840.113549.1.5.12";break;case"P-256":r="1.2.840.10045.3.1.7";break;case"P-384":r="1.3.132.0.34";break;case"P-521":r="1.3.132.0.35"}if(!r&&e)throw new Error(`Unsupported algorithm ${t?`for ${t} `:v}: ${i.name}`);return r}getAlgorithmParameters(i,e){let t={algorithm:{},usages:[]};switch(i.toUpperCase()){case"RSAES-PKCS1-V1_5":case"RSASSA-PKCS1-V1_5":switch(e.toLowerCase()){case"generatekey":t={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":t={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(e.toLowerCase()){case"sign":case"verify":t={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":t={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":t={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(e.toLowerCase()){case"encrypt":case"decrypt":t={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":t={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":t={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(e.toLowerCase()){case"generatekey":t={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":t={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":t={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(e.toLowerCase()){case"exportkey":case"importkey":case"generatekey":t={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":t={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(e.toLowerCase()){case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":t={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(e.toLowerCase()){case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":t={algorithm:{name:"AES-CBC",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(e.toLowerCase()){case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":t={algorithm:{name:"AES-GCM",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(e.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":t={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(e.toLowerCase()){case"sign":case"verify":t={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":if("derivekey"!==e.toLowerCase())return{algorithm:{name:"HKDF"},usages:[]};t={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;case"PBKDF2":if("derivekey"!==e.toLowerCase())return{algorithm:{name:"PBKDF2"},usages:[]};t={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e4},usages:["encrypt","decrypt"]}}return t}getHashAlgorithm(i){let e=v;switch(i.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":e="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":e="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":e="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":e="SHA-512";break;case"1.2.840.113549.1.1.10":try{const t=new _u({schema:i.algorithmParams});if(t.hashAlgorithm){const r=this.getAlgorithmByOID(t.hashAlgorithm.algorithmId);if(!("name"in r))return v;e=r.name}else e="SHA-1"}catch{}}return e}encryptEncryptedContentInfo(i){var e=this;return(0,k.A)(function*(){tt.assert(i,"password","contentEncryptionAlgorithm","hmacHashAlgorithm","iterationCount","contentToEncrypt","contentToEncrypt","contentType");const t=e.getOIDByAlgorithm(i.contentEncryptionAlgorithm,!0,"contentEncryptionAlgorithm"),r=e.getOIDByAlgorithm({name:"PBKDF2"},!0,"PBKDF2"),a=e.getOIDByAlgorithm({name:"HMAC",hash:{name:i.hmacHashAlgorithm}},!0,"hmacHashAlgorithm"),o=new ArrayBuffer(16),u=new Uint8Array(o);e.getRandomValues(u);const h=new ArrayBuffer(64),m=new Uint8Array(h);e.getRandomValues(m);const N=new Uint8Array(i.contentToEncrypt),T=new so({salt:new de({valueHex:h}),iterationCount:i.iterationCount,prf:new X({algorithmId:a,algorithmParams:new kt})}),K=new Uint8Array(i.password),F=yield e.importKey("raw",K,"PBKDF2",!1,["deriveKey"]),se=yield e.deriveKey({name:"PBKDF2",hash:{name:i.hmacHashAlgorithm},salt:m,iterations:i.iterationCount},F,i.contentEncryptionAlgorithm,!1,["encrypt"]),Ee=yield e.encrypt({name:i.contentEncryptionAlgorithm.name,iv:u},se,N),ye=new Cd({keyDerivationFunc:new X({algorithmId:r,algorithmParams:T.toSchema()}),encryptionScheme:new X({algorithmId:t,algorithmParams:new de({valueHex:o})})});return new Dt({contentType:i.contentType,contentEncryptionAlgorithm:new X({algorithmId:"1.2.840.113549.1.5.13",algorithmParams:ye.toSchema()}),encryptedContent:new de({valueHex:Ee})})})()}decryptEncryptedContentInfo(i){var e=this;return(0,k.A)(function*(){if(tt.assert(i,"password","encryptedContentInfo"),"1.2.840.113549.1.5.13"!==i.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId)throw new Error(`Unknown "contentEncryptionAlgorithm": ${i.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId}`);let t,r;try{t=new Cd({schema:i.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams})}catch{throw new Error('Incorrectly encoded "pbes2Parameters"')}try{r=new so({schema:t.keyDerivationFunc.algorithmParams})}catch{throw new Error('Incorrectly encoded "pbkdf2Params"')}const a=e.getAlgorithmByOID(t.encryptionScheme.algorithmId,!0),u=new Uint8Array(t.encryptionScheme.algorithmParams.valueBlock.valueHex),m=new Uint8Array(r.salt.valueBlock.valueHex),N=r.iterationCount;let T="SHA-1";r.prf&&(T=e.getAlgorithmByOID(r.prf.algorithmId,!0).hash.name);const K=yield e.importKey("raw",i.password,"PBKDF2",!1,["deriveKey"]),F=yield e.deriveKey({name:"PBKDF2",hash:{name:T},salt:m,iterations:N},K,a,!1,["decrypt"]),se=i.encryptedContentInfo.getEncryptedContent();return e.decrypt({name:a.name,iv:u},F,se)})()}stampDataWithPassword(i){var e=this;return(0,k.A)(function*(){if(!(i instanceof Object))throw new Error('Parameters must have type "Object"');let t;switch(tt.assert(i,"password","hashAlgorithm","iterationCount","salt","contentToStamp"),i.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:throw new Error(`Incorrect "parameters.hashAlgorithm" parameter: ${i.hashAlgorithm}`)}const r={name:"HMAC",length:t,hash:{name:i.hashAlgorithm}},a=yield Nd(i.hashAlgorithm,t,i.password,i.salt,i.iterationCount),o=yield e.importKey("raw",new Uint8Array(a),r,!1,["sign"]);return e.sign(r,o,new Uint8Array(i.contentToStamp))})()}verifyDataStampedWithPassword(i){var e=this;return(0,k.A)(function*(){tt.assert(i,"password","hashAlgorithm","salt","iterationCount","contentToVerify","signatureToVerify");let t=0;switch(i.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:throw new Error(`Incorrect "parameters.hashAlgorithm" parameter: ${i.hashAlgorithm}`)}const r={name:"HMAC",length:t,hash:{name:i.hashAlgorithm}},a=yield Nd(i.hashAlgorithm,t,i.password,i.salt,i.iterationCount),o=yield e.importKey("raw",new Uint8Array(a),r,!1,["verify"]);return e.verify(r,o,new Uint8Array(i.signatureToVerify),new Uint8Array(i.contentToVerify))})()}getSignatureParameters(i,e="SHA-1"){var t=this;return(0,k.A)(function*(){t.getOIDByAlgorithm({name:e},!0,"hashAlgorithm");const r=new X,a=t.getAlgorithmParameters(i.algorithm.name,"sign");if(!Object.keys(a.algorithm).length)throw new Error("Parameter 'algorithm' is empty");const o=a.algorithm;switch(o.hash.name="hash"in i.algorithm&&i.algorithm.hash&&i.algorithm.hash.name?i.algorithm.hash.name:e,i.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":r.algorithmId=t.getOIDByAlgorithm(o,!0);break;case"RSA-PSS":{switch(o.hash.name.toUpperCase()){case"SHA-256":o.saltLength=32;break;case"SHA-384":o.saltLength=48;break;case"SHA-512":o.saltLength=64}const u={};if("SHA-1"!==o.hash.name.toUpperCase()){const m=t.getOIDByAlgorithm({name:o.hash.name},!0,"hashAlgorithm");u.hashAlgorithm=new X({algorithmId:m,algorithmParams:new kt}),u.maskGenAlgorithm=new X({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:u.hashAlgorithm.toSchema()})}20!==o.saltLength&&(u.saltLength=o.saltLength);const h=new _u(u);r.algorithmId="1.2.840.113549.1.1.10",r.algorithmParams=h.toSchema()}break;default:throw new Error(`Unsupported signature algorithm: ${i.algorithm.name}`)}return{signatureAlgorithm:r,parameters:a}})()}signWithPrivateKey(i,e,t){var r=this;return(0,k.A)(function*(){const a=yield r.sign(t.algorithm,e,i);return"ECDSA"===t.algorithm.name?function cp(s){if(s.byteLength%2!=0)return Ct;const i=s.byteLength/2,e=new ArrayBuffer(i);new Uint8Array(e).set(new Uint8Array(s,0,i));const r=new Y({valueHex:e}),a=new ArrayBuffer(i);new Uint8Array(a).set(new Uint8Array(s,i,i));const u=new Y({valueHex:a});return new O({value:[r.convertToDER(),u.convertToDER()]}).toBER(!1)}(a):a})()}fillPublicKeyParameters(i,e){const t={},r=this.getHashAlgorithm(e);if(r===v)throw new Error(`Unsupported signature algorithm: ${e.algorithmId}`);let a;a="1.2.840.113549.1.1.10"===e.algorithmId?e.algorithmId:i.algorithm.algorithmId;const o=this.getAlgorithmByOID(a,!0);if(t.algorithm=this.getAlgorithmParameters(o.name,"importKey"),"hash"in t.algorithm.algorithm&&(t.algorithm.algorithm.hash.name=r),"ECDSA"===o.name){const u=i.algorithm;if(!u.algorithmParams)throw new Error("Algorithm parameters for ECDSA public key are missed");const h=u.algorithmParams;if("idBlock"in u.algorithmParams&&(1!==h.idBlock.tagClass||6!==h.idBlock.tagNumber))throw new Error("Incorrect type for ECDSA public key parameters");const m=this.getAlgorithmByOID(h.valueBlock.toString(),!0);t.algorithm.algorithm.namedCurve=m.name}return t}getPublicKey(i,e,t){var r=this;return(0,k.A)(function*(){t||(t=r.fillPublicKeyParameters(i,e));const a=i.toSchema().toBER(!1);return r.importKey("spki",a,t.algorithm.algorithm,!0,t.algorithm.usages)})()}verifyWithPublicKey(i,e,t,r,a){var o=this;return(0,k.A)(function*(){let u;if(a){const N={};let T;T="1.2.840.113549.1.1.10"===r.algorithmId?r.algorithmId:t.algorithm.algorithmId;const K=o.getAlgorithmByOID(T,!0);if(N.algorithm=o.getAlgorithmParameters(K.name,"importKey"),"hash"in N.algorithm.algorithm&&(N.algorithm.algorithm.hash.name=a),"ECDSA"===K.name){let F=!1;if("algorithmParams"in t.algorithm&&"idBlock"in t.algorithm.algorithmParams&&1===t.algorithm.algorithmParams.idBlock.tagClass&&6===t.algorithm.algorithmParams.idBlock.tagNumber&&(F=!0),!1===F)throw new Error("Incorrect type for ECDSA public key parameters");const se=o.getAlgorithmByOID(t.algorithm.algorithmParams.valueBlock.toString(),!0);N.algorithm.algorithm.namedCurve=se.name}u=yield o.getPublicKey(t,null,N)}else{if(!(a=o.getHashAlgorithm(r)))throw new Error(`Unsupported signature algorithm: ${r.algorithmId}`);u=yield o.getPublicKey(t,r)}const h=o.getAlgorithmParameters(u.algorithm.name,"verify");"hash"in h.algorithm&&(h.algorithm.hash.name=a);let m=e.valueBlock.valueHexView;if("ECDSA"===u.algorithm.name){const N=js.find(u.algorithm.namedCurve);if(!N)throw new Error("Unsupported named curve in use");const T=ct(m);ae.assert(T,"Signature value"),m=function up(s,i){if(!(s instanceof O&&2===s.valueBlock.value.length&&s.valueBlock.value[0]instanceof Y&&s.valueBlock.value[1]instanceof Y))return Ct;const e=s.valueBlock.value[0].convertFromDER().valueBlock.valueHexView,t=s.valueBlock.value[1].convertFromDER().valueBlock.valueHexView,r=new Uint8Array(2*i);return r.set(e,i-e.byteLength),r.set(t,2*i-t.byteLength),r.buffer}(T.result,N.size)}if("RSA-PSS"===u.algorithm.name){const N=new _u({schema:r.algorithmParams});h.algorithm.saltLength="saltLength"in N?N.saltLength:20;let T="SHA-1";"hashAlgorithm"in N&&(T=o.getAlgorithmByOID(N.hashAlgorithm.algorithmId,!0).name),h.algorithm.hash.name=T}return o.verify(h.algorithm,u,m,i)})()}}let Bd={name:"none",crypto:null};function Rd(s){return!(!s||"object"!=typeof s||!("crypto"in s))}function Td(s,...i){let e=null;if(i.length<2)e=i.length?i[0]:typeof self<"u"&&self.crypto?new zl({name:"browser",crypto:self.crypto}):null;else{const t=i[0],r=i[1];Rd(r)?e=r:Rd(t)?e=t:"subtle"in t&&"getRandomValues"in t&&(e=new zl({crypto:t}))}if(typeof process<"u"&&"pid"in process&&typeof global<"u"&&typeof window>"u"){if(typeof global[process.pid]>"u")global[process.pid]={};else if("object"!=typeof global[process.pid])throw new Error(`Name global.${process.pid} already exists and it is not an object`);if(typeof global[process.pid].pkijs>"u")global[process.pid].pkijs={};else if("object"!=typeof global[process.pid].pkijs)throw new Error(`Name global.${process.pid}.pkijs already exists and it is not an object`);global[process.pid].pkijs.engine={name:s,crypto:e}}else Bd={name:s,crypto:e}}function Je(s=!1){const i=function lp(){if(typeof process<"u"&&"pid"in process&&typeof global<"u"&&typeof window>"u"){let s;try{s=global[process.pid].pkijs.engine}catch{throw new Error("Please call 'setEngine' before call to 'getEngine'")}return s}return Bd}();if(!i.crypto&&s)throw new Error("Unable to create WebCrypto object");return i.crypto}function Nu(s){return Je(!0).getRandomValues(s)}function hp(s,i,e,t,r){return Iu.apply(this,arguments)}function Iu(){return(Iu=(0,k.A)(function*(s,i,e,t,r){switch(s.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;default:throw new ot(`Unknown hash function: ${s}`)}if(ot.assert(i,"zBuffer","ArrayBuffer"),0===i.byteLength)throw new ot("'zBuffer' has zero length, error");if(ot.assert(t,"SharedInfo","ArrayBuffer"),e>255)throw new ot("Please set 'Counter' argument to value less or equal to 255");const a=new ArrayBuffer(4),o=new Uint8Array(a);o[0]=0,o[1]=0,o[2]=0,o[3]=e;let u=Ct;return u=R(u,i),u=R(u,a),u=R(u,t),{counter:e,result:yield r.digest({name:s},u)}})).apply(this,arguments)}function xd(s,i,e,t){return Bu.apply(this,arguments)}function Bu(){return(Bu=(0,k.A)(function*(s,i,e,t,r=Je(!0)){let a=0,o=1;switch(s.toUpperCase()){case"SHA-1":a=160;break;case"SHA-256":a=256;break;case"SHA-384":a=384;break;case"SHA-512":a=512;break;default:throw new ot(`Unknown hash function: ${s}`)}if(ot.assert(i,"Zbuffer","ArrayBuffer"),0===i.byteLength)throw new ot("'Zbuffer' has zero length, error");ot.assert(t,"SharedInfo","ArrayBuffer");const u=e/a;Math.floor(u)>0&&(o=Math.floor(u),u-o>0&&o++);const h=[];for(let K=1;K<=o;K++)h.push(yield hp(s,i,K,t,r));let m=Ct,N=1,T=!0;for(;T;){T=!1;for(const K of h)if(K.counter===N){m=R(m,K.result),T=!0;break}N++}if(m.byteLength>(e>>=3)){const K=new ArrayBuffer(e),F=new Uint8Array(K),se=new Uint8Array(m);for(let Ee=0;Ee<e;Ee++)F[Ee]=se[Ee];return K}return m})).apply(this,arguments)}const Ru="version",Tu="logID",xu="extensions",Vu="timestamp",Ou="hashAlgorithm",Pu="signatureAlgorithm",Du="signature",Fd="anonymous";let fp=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,Ru,s.defaultValues(Ru)),this.logID=l(e,Tu,s.defaultValues(Tu)),this.timestamp=l(e,Vu,s.defaultValues(Vu)),this.extensions=l(e,xu,s.defaultValues(xu)),this.hashAlgorithm=l(e,Ou,s.defaultValues(Ou)),this.signatureAlgorithm=l(e,Pu,s.defaultValues(Pu)),this.signature=l(e,Du,s.defaultValues(Du)),"stream"in e&&e.stream&&this.fromStream(e.stream),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ru:return 0;case Tu:case xu:return Ct;case Vu:return new Date(0);case Ou:case Pu:return v;case Du:return new Fe;default:return super.defaultValues(e)}}fromSchema(e){if(!(e instanceof Ul))throw new Error("Object's schema was not verified against input data for SignedCertificateTimestamp");const t=new da({stream:new wt({buffer:e.data})});this.fromStream(t)}fromStream(e){const t=e.getUint16();if(this.version=e.getBlock(1)[0],0===this.version){this.logID=new Uint8Array(e.getBlock(32)).buffer.slice(0),this.timestamp=new Date(be(new Uint8Array(e.getBlock(8)),8));const r=e.getUint16();switch(this.extensions=new Uint8Array(e.getBlock(r)).buffer.slice(0),e.getBlock(1)[0]){case 0:this.hashAlgorithm="none";break;case 1:this.hashAlgorithm="md5";break;case 2:this.hashAlgorithm="sha1";break;case 3:this.hashAlgorithm="sha224";break;case 4:this.hashAlgorithm="sha256";break;case 5:this.hashAlgorithm="sha384";break;case 6:this.hashAlgorithm="sha512";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}switch(e.getBlock(1)[0]){case 0:this.signatureAlgorithm=Fd;break;case 1:this.signatureAlgorithm="rsa";break;case 2:this.signatureAlgorithm="dsa";break;case 3:this.signatureAlgorithm="ecdsa";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}const a=e.getUint16(),u=ct(new Uint8Array(e.getBlock(a)).buffer.slice(0));if(ae.assert(u,"SignedCertificateTimestamp"),this.signature=u.result,t!==47+r+a)throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}}toSchema(){const e=this.toStream();return new Ul({data:e.stream.buffer})}toStream(){const e=new da;e.appendUint16(47+this.extensions.byteLength+this.signature.valueBeforeDecodeView.byteLength),e.appendChar(this.version),e.appendView(new Uint8Array(this.logID));const t=new ArrayBuffer(8),r=new Uint8Array(t),a=Oe(this.timestamp.valueOf(),8);let o,u;switch(r.set(new Uint8Array(a),8-a.byteLength),e.appendView(r),e.appendUint16(this.extensions.byteLength),this.extensions.byteLength&&e.appendView(new Uint8Array(this.extensions)),this.hashAlgorithm.toLowerCase()){case"none":o=0;break;case"md5":o=1;break;case"sha1":o=2;break;case"sha224":o=3;break;case"sha256":o=4;break;case"sha384":o=5;break;case"sha512":o=6;break;default:throw new Error(`Incorrect data for hashAlgorithm: ${this.hashAlgorithm}`)}switch(e.appendChar(o),this.signatureAlgorithm.toLowerCase()){case Fd:u=0;break;case"rsa":u=1;break;case"dsa":u=2;break;case"ecdsa":u=3;break;default:throw new Error(`Incorrect data for signatureAlgorithm: ${this.signatureAlgorithm}`)}e.appendChar(u);const h=this.signature.toBER(!1);return e.appendUint16(h.byteLength),e.appendView(new Uint8Array(h)),e}toJSON(){return{version:this.version,logID:we(this.logID),timestamp:this.timestamp,extensions:we(this.extensions),hashAlgorithm:this.hashAlgorithm,signatureAlgorithm:this.signatureAlgorithm,signature:this.signature.toJSON()}}verify(e,t,r=0,a=Je(!0)){var o=this;return(0,k.A)(function*(){const u=he(M(o.logID));let h=null;const m=new da;for(const Ee of e)if(Ee.log_id===u){h=Ee.key;break}if(!h)throw new Error(`Public key not found for CT with logId: ${u}`);const N=Ne(J(h)),T=ns.fromBER(N);m.appendChar(0),m.appendChar(0);const K=new ArrayBuffer(8),F=new Uint8Array(K),se=Oe(o.timestamp.valueOf(),8);return F.set(new Uint8Array(se),8-se.byteLength),m.appendView(F),m.appendUint16(r),0===r&&m.appendUint24(t.byteLength),m.appendView(new Uint8Array(t)),m.appendUint16(o.extensions.byteLength),0!==o.extensions.byteLength&&m.appendView(new Uint8Array(o.extensions)),a.verifyWithPublicKey(m.buffer.slice(0,m.length),new de({valueHex:o.signature.toBER(!1)}),T,{algorithmId:v},"SHA-256")})()}}return s.CLASS_NAME="SignedCertificateTimestamp",s})();const Yl="timestamps";let dp=(()=>{class s extends fe{constructor(e={}){super(),this.timestamps=l(e,Yl,s.defaultValues(Yl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Yl?[]:super.defaultValues(e)}static compareWithDefault(e,t){return e===Yl?0===t.length:super.defaultValues(e)}static schema(e={}){var t;const r=l(e,"names",{});return null!==(t=r.optional)&&void 0!==t||(r.optional=!1),new de({name:r.blockName||"SignedCertificateTimestampList",optional:r.optional})}fromSchema(e){if(!(e instanceof de))throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");const t=new da({stream:new wt({buffer:e.valueBlock.valueHex})});if(t.getUint16()!==t.length)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");for(;t.length;)this.timestamps.push(new fp({stream:t}))}toSchema(){const e=new da;let t=0;const r=[];for(const a of this.timestamps){const o=a.toStream();r.push(o),t+=o.stream.buffer.byteLength}e.appendUint16(t);for(const a of r)e.appendView(a.stream.view);return new de({valueHex:e.stream.buffer.slice(0)})}toJSON(){return{timestamps:Array.from(this.timestamps,e=>e.toJSON())}}}return s.CLASS_NAME="SignedCertificateTimestampList",s})();const no="attributes",mp=[no];let gp=(()=>{class s extends fe{constructor(e={}){super(),this.attributes=l(e,no,s.defaultValues(no)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===no?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ge({name:t.attributes||v,value:st.schema()})]})}fromSchema(e){re(e,mp);const t=ue(e,e,s.schema({names:{attributes:no}}));ae.assertSchema(t,this.className),this.attributes=Array.from(t.result.attributes,r=>new st({schema:r}))}toSchema(){return new O({value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){return{attributes:Array.from(this.attributes,e=>e.toJSON())}}}return s.CLASS_NAME="SubjectDirectoryAttributes",s})();class yt{static getItems(){return this.types||(this.types={},yt.register(Wf,"SubjectAltName",Jf),yt.register(zf,"IssuerAltName",Jf),yt.register(yu,"AuthorityKeyIdentifier",cd),yt.register(vu,"BasicConstraints",ud),yt.register("1.3.6.1.4.1.311.21.1","MicrosoftCaVersion",Ng),yt.register(ed,"CertificatePolicies",dd),yt.register("1.3.6.1.4.1.311.21.10","CertificatePoliciesMicrosoft",dd),yt.register("1.3.6.1.4.1.311.21.7","MicrosoftCertTemplateV2",Ki),yt.register(Zf,"CRLDistributionPoints",vd),yt.register(wu,"FreshestCRL",vd),yt.register("2.5.29.37","ExtKeyUsage",Pg),yt.register(Xf,"CertificateIssuer",Bt),yt.register(Su,"AuthorityInfoAccess",wd),yt.register("1.3.6.1.5.5.7.1.11","SubjectInfoAccess",wd),yt.register(Yf,"IssuingDistributionPoint",Ug),yt.register(Qf,"NameConstraints",Fg),yt.register(sd,"PolicyConstraints",jg),yt.register(td,"PolicyMappings",Gg),yt.register("2.5.29.16","PrivateKeyUsagePeriod",qg),yt.register("1.3.6.1.5.5.7.1.3","QCStatements",Yg),yt.register("1.3.6.1.4.1.11129.2.4.2","SignedCertificateTimestampList",dp),yt.register("2.5.29.9","SubjectDirectoryAttributes",gp)),this.types}static fromBER(i,e){const t=ct(e);if(-1===t.offset)return null;const r=this.find(i);if(r)try{return new r.type({schema:t.result})}catch{const o=new r.type;return o.parsingError=`Incorrectly formatted value of extension ${r.name} (${i})`,o}return t.result}static find(i){return this.getItems()[i]||null}static register(i,e,t){this.getItems()[i]={name:e,type:t}}}const ao="extnID",zs="critical",oo="extnValue",Xl="parsedValue",pp=[ao,zs,oo];let Lr=(()=>{class s extends fe{get parsedValue(){if(void 0===this._parsedValue){const e=yt.fromBER(this.extnID,this.extnValue.valueBlock.valueHexView);this._parsedValue=e}return this._parsedValue||void 0}set parsedValue(e){this._parsedValue=e}constructor(e={}){super(),this.extnID=l(e,ao,s.defaultValues(ao)),this.critical=l(e,zs,s.defaultValues(zs)),this.extnValue=oo in e?new de({valueHex:e.extnValue}):s.defaultValues(oo),Xl in e&&(this.parsedValue=l(e,Xl,s.defaultValues(Xl))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ao:return v;case zs:return!1;case oo:return new de;case Xl:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.extnID||v}),new ks({name:t.critical||v,optional:!0}),new de({name:t.extnValue||v})]})}fromSchema(e){re(e,pp);const t=ue(e,e,s.schema({names:{extnID:ao,critical:zs,extnValue:oo}}));ae.assertSchema(t,this.className),this.extnID=t.result.extnID.valueBlock.toString(),zs in t.result&&(this.critical=t.result.critical.valueBlock.value),this.extnValue=t.result.extnValue}toSchema(){const e=[];return e.push(new Ve({value:this.extnID})),this.critical!==s.defaultValues(zs)&&e.push(new ks({value:this.critical})),e.push(this.extnValue),new O({value:e})}toJSON(){const e={extnID:this.extnID,extnValue:this.extnValue.toJSON()};return this.critical!==s.defaultValues(zs)&&(e.critical=this.critical),this.parsedValue&&this.parsedValue.toJSON&&(e.parsedValue=this.parsedValue.toJSON()),e}}return s.CLASS_NAME="Extension",s})();const lo="extensions",vp=[lo];let Rt=(()=>{class s extends fe{constructor(e={}){super(),this.extensions=l(e,lo,s.defaultValues(lo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===lo?[]:super.defaultValues(e)}static schema(e={},t=!1){const r=l(e,"names",{});return new O({optional:t,name:r.blockName||v,value:[new Ge({name:r.extensions||v,value:Lr.schema(r.extension||{})})]})}fromSchema(e){re(e,vp);const t=ue(e,e,s.schema({names:{extensions:lo}}));ae.assertSchema(t,this.className),this.extensions=Array.from(t.result.extensions,r=>new Lr({schema:r}))}toSchema(){return new O({value:Array.from(this.extensions,e=>e.toSchema())})}toJSON(){return{extensions:this.extensions.map(e=>e.toJSON())}}}return s.CLASS_NAME="Extensions",s})();const co="issuer",uo="serialNumber",Fr="issuerUID",wp=[co,uo,Fr];let gs=(()=>{class s extends fe{constructor(e={}){super(),this.issuer=l(e,co,s.defaultValues(co)),this.serialNumber=l(e,uo,s.defaultValues(uo)),Fr in e&&(this.issuerUID=l(e,Fr,s.defaultValues(Fr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case co:return new Bt;case uo:return new Y;case Fr:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Bt.schema(t.issuer||{}),new Y({name:t.serialNumber||v}),new et({optional:!0,name:t.issuerUID||v})]})}fromSchema(e){re(e,wp);const t=ue(e,e,s.schema({names:{issuer:{names:{blockName:co}},serialNumber:uo,issuerUID:Fr}}));ae.assertSchema(t,this.className),this.issuer=new Bt({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber,Fr in t.result&&(this.issuerUID=t.result.issuerUID)}toSchema(){const e=new O({value:[this.issuer.toSchema(),this.serialNumber]});return this.issuerUID&&e.valueBlock.value.push(this.issuerUID),e}toJSON(){const e={issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()};return this.issuerUID&&(e.issuerUID=this.issuerUID.toJSON()),e}}return s.CLASS_NAME="IssuerSerial",s})();const ho="version",Hr="baseCertificateID",jr="subjectName",fo="issuer",mo="signature",go="serialNumber",po="attrCertValidityPeriod",vo="attributes",$r="issuerUniqueID",Kr="extensions",yp=[ho,Hr,jr,fo,mo,go,po,vo,$r,Kr];let Mu=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,ho,s.defaultValues(ho)),Hr in e&&(this.baseCertificateID=l(e,Hr,s.defaultValues(Hr))),jr in e&&(this.subjectName=l(e,jr,s.defaultValues(jr))),this.issuer=l(e,fo,s.defaultValues(fo)),this.signature=l(e,mo,s.defaultValues(mo)),this.serialNumber=l(e,go,s.defaultValues(go)),this.attrCertValidityPeriod=l(e,po,s.defaultValues(po)),this.attributes=l(e,vo,s.defaultValues(vo)),$r in e&&(this.issuerUniqueID=l(e,$r,s.defaultValues($r))),Kr in e&&(this.extensions=l(e,Kr,s.defaultValues(Kr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ho:return 0;case Hr:return new gs;case jr:case fo:return new Bt;case mo:return new X;case go:return new Y;case po:return new $i;case vo:return[];case $r:return new et;case Kr:return new Rt;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.version||v}),new ft({value:[new q({name:t.baseCertificateID||v,idBlock:{tagClass:3,tagNumber:0},value:gs.schema().valueBlock.value}),new q({name:t.subjectName||v,idBlock:{tagClass:3,tagNumber:1},value:Bt.schema().valueBlock.value})]}),Bt.schema({names:{blockName:t.issuer||v}}),X.schema(t.signature||{}),new Y({name:t.serialNumber||v}),$i.schema(t.attrCertValidityPeriod||{}),new O({name:t.attributes||v,value:[new Ge({value:st.schema()})]}),new et({optional:!0,name:t.issuerUniqueID||v}),Rt.schema(t.extensions||{},!0)]})}fromSchema(e){re(e,yp);const t=ue(e,e,s.schema({names:{version:ho,baseCertificateID:Hr,subjectName:jr,issuer:fo,signature:{names:{blockName:mo}},serialNumber:go,attrCertValidityPeriod:{names:{blockName:po}},attributes:vo,issuerUniqueID:$r,extensions:{names:{blockName:Kr}}}}));ae.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,Hr in t.result&&(this.baseCertificateID=new gs({schema:new O({value:t.result.baseCertificateID.valueBlock.value})})),jr in t.result&&(this.subjectName=new Bt({schema:new O({value:t.result.subjectName.valueBlock.value})})),this.issuer=t.result.issuer,this.signature=new X({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new $i({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,r=>new st({schema:r})),$r in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),Kr in t.result&&(this.extensions=new Rt({schema:t.result.extensions}))}toSchema(){const e=new O({value:[new Y({value:this.version})]});return this.baseCertificateID&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.subjectName&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:1},value:this.subjectName.toSchema().valueBlock.value})),e.valueBlock.value.push(this.issuer.toSchema()),e.valueBlock.value.push(this.signature.toSchema()),e.valueBlock.value.push(this.serialNumber),e.valueBlock.value.push(this.attrCertValidityPeriod.toSchema()),e.valueBlock.value.push(new O({value:Array.from(this.attributes,t=>t.toSchema())})),this.issuerUniqueID&&e.valueBlock.value.push(this.issuerUniqueID),this.extensions&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version};return this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.subjectName&&(e.subjectName=this.subjectName.toJSON()),e.issuer=this.issuer.toJSON(),e.signature=this.signature.toJSON(),e.serialNumber=this.serialNumber.toJSON(),e.attrCertValidityPeriod=this.attrCertValidityPeriod.toJSON(),e.attributes=Array.from(this.attributes,t=>t.toJSON()),this.issuerUniqueID&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),this.extensions&&(e.extensions=this.extensions.toJSON()),e}}return s.CLASS_NAME="AttributeCertificateInfoV1",s})();const wo="acinfo",yo="signatureAlgorithm",So="signatureValue",Sp=[wo,So,yo];let Lu=(()=>{class s extends fe{constructor(e={}){super(),this.acinfo=l(e,wo,s.defaultValues(wo)),this.signatureAlgorithm=l(e,yo,s.defaultValues(yo)),this.signatureValue=l(e,So,s.defaultValues(So)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wo:return new Mu;case yo:return new X;case So:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Mu.schema(t.acinfo||{}),X.schema(t.signatureAlgorithm||{}),new et({name:t.signatureValue||v})]})}fromSchema(e){re(e,Sp);const t=ue(e,e,s.schema({names:{acinfo:{names:{blockName:wo}},signatureAlgorithm:{names:{blockName:yo}},signatureValue:So}}));ae.assertSchema(t,this.className),this.acinfo=new Mu({schema:t.result.acinfo}),this.signatureAlgorithm=new X({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new O({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}return s.CLASS_NAME="AttributeCertificateV1",s})();const bo="digestedObjectType",Gr="otherObjectTypeID",Ao="digestAlgorithm",Eo="objectDigest",bp=[bo,Gr,Ao,Eo];let en=(()=>{class s extends fe{constructor(e={}){super(),this.digestedObjectType=l(e,bo,s.defaultValues(bo)),Gr in e&&(this.otherObjectTypeID=l(e,Gr,s.defaultValues(Gr))),this.digestAlgorithm=l(e,Ao,s.defaultValues(Ao)),this.objectDigest=l(e,Eo,s.defaultValues(Eo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case bo:return new ua;case Gr:return new Ve;case Ao:return new X;case Eo:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new ua({name:t.digestedObjectType||v}),new Ve({optional:!0,name:t.otherObjectTypeID||v}),X.schema(t.digestAlgorithm||{}),new et({name:t.objectDigest||v})]})}fromSchema(e){re(e,bp);const t=ue(e,e,s.schema({names:{digestedObjectType:bo,otherObjectTypeID:Gr,digestAlgorithm:{names:{blockName:Ao}},objectDigest:Eo}}));ae.assertSchema(t,this.className),this.digestedObjectType=t.result.digestedObjectType,Gr in t.result&&(this.otherObjectTypeID=t.result.otherObjectTypeID),this.digestAlgorithm=new X({schema:t.result.digestAlgorithm}),this.objectDigest=t.result.objectDigest}toSchema(){const e=new O({value:[this.digestedObjectType]});return this.otherObjectTypeID&&e.valueBlock.value.push(this.otherObjectTypeID),e.valueBlock.value.push(this.digestAlgorithm.toSchema()),e.valueBlock.value.push(this.objectDigest),e}toJSON(){const e={digestedObjectType:this.digestedObjectType.toJSON(),digestAlgorithm:this.digestAlgorithm.toJSON(),objectDigest:this.objectDigest.toJSON()};return this.otherObjectTypeID&&(e.otherObjectTypeID=this.otherObjectTypeID.toJSON()),e}}return s.CLASS_NAME="ObjectDigestInfo",s})();const Jr="issuerName",qr="baseCertificateID",Wr="objectDigestInfo",Ap=[Jr,qr,Wr];let Kd=(()=>{class s extends fe{constructor(e={}){super(),Jr in e&&(this.issuerName=l(e,Jr,s.defaultValues(Jr))),qr in e&&(this.baseCertificateID=l(e,qr,s.defaultValues(qr))),Wr in e&&(this.objectDigestInfo=l(e,Wr,s.defaultValues(Wr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Jr:return new Bt;case qr:return new gs;case Wr:return new en;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Bt.schema({names:{blockName:t.issuerName}},!0),new q({optional:!0,name:t.baseCertificateID||v,idBlock:{tagClass:3,tagNumber:0},value:gs.schema().valueBlock.value}),new q({optional:!0,name:t.objectDigestInfo||v,idBlock:{tagClass:3,tagNumber:1},value:en.schema().valueBlock.value})]})}fromSchema(e){re(e,Ap);const t=ue(e,e,s.schema({names:{issuerName:Jr,baseCertificateID:qr,objectDigestInfo:Wr}}));ae.assertSchema(t,this.className),Jr in t.result&&(this.issuerName=new Bt({schema:t.result.issuerName})),qr in t.result&&(this.baseCertificateID=new gs({schema:new O({value:t.result.baseCertificateID.valueBlock.value})})),Wr in t.result&&(this.objectDigestInfo=new en({schema:new O({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new O;return this.issuerName&&e.valueBlock.value.push(this.issuerName.toSchema()),this.baseCertificateID&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.objectDigestInfo&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:1},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return this.issuerName&&(e.issuerName=this.issuerName.toJSON()),this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.objectDigestInfo&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}return s.CLASS_NAME="V2Form",s})();const zr="baseCertificateID",Yr="entityName",Xr="objectDigestInfo",Ep=[zr,Yr,Xr];let Fu=(()=>{class s extends fe{constructor(e={}){super(),zr in e&&(this.baseCertificateID=l(e,zr,s.defaultValues(zr))),Yr in e&&(this.entityName=l(e,Yr,s.defaultValues(Yr))),Xr in e&&(this.objectDigestInfo=l(e,Xr,s.defaultValues(Xr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case zr:return new gs;case Yr:return new Bt;case Xr:return new en;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({optional:!0,name:t.baseCertificateID||v,idBlock:{tagClass:3,tagNumber:0},value:gs.schema().valueBlock.value}),new q({optional:!0,name:t.entityName||v,idBlock:{tagClass:3,tagNumber:1},value:Bt.schema().valueBlock.value}),new q({optional:!0,name:t.objectDigestInfo||v,idBlock:{tagClass:3,tagNumber:2},value:en.schema().valueBlock.value})]})}fromSchema(e){re(e,Ep);const t=ue(e,e,s.schema({names:{baseCertificateID:zr,entityName:Yr,objectDigestInfo:Xr}}));ae.assertSchema(t,this.className),zr in t.result&&(this.baseCertificateID=new gs({schema:new O({value:t.result.baseCertificateID.valueBlock.value})})),Yr in t.result&&(this.entityName=new Bt({schema:new O({value:t.result.entityName.valueBlock.value})})),Xr in t.result&&(this.objectDigestInfo=new en({schema:new O({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new O;return this.baseCertificateID&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.entityName&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:1},value:this.entityName.toSchema().valueBlock.value})),this.objectDigestInfo&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:2},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.entityName&&(e.entityName=this.entityName.toJSON()),this.objectDigestInfo&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}return s.CLASS_NAME="Holder",s})();const ko="version",_o="holder",Co="issuer",No="signature",Io="serialNumber",Bo="attrCertValidityPeriod",Ro="attributes",Qr="issuerUniqueID",Zr="extensions",kp=[ko,_o,Co,No,Io,Bo,Ro,Qr,Zr];let Hu=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,ko,s.defaultValues(ko)),this.holder=l(e,_o,s.defaultValues(_o)),this.issuer=l(e,Co,s.defaultValues(Co)),this.signature=l(e,No,s.defaultValues(No)),this.serialNumber=l(e,Io,s.defaultValues(Io)),this.attrCertValidityPeriod=l(e,Bo,s.defaultValues(Bo)),this.attributes=l(e,Ro,s.defaultValues(Ro)),Qr in e&&(this.issuerUniqueID=l(e,Qr,s.defaultValues(Qr))),Zr in e&&(this.extensions=l(e,Zr,s.defaultValues(Zr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ko:return 1;case _o:return new Fu;case Co:return{};case No:return new X;case Io:return new Y;case Bo:return new $i;case Ro:return[];case Qr:return new et;case Zr:return new Rt;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.version||v}),Fu.schema(t.holder||{}),new ft({value:[Bt.schema({names:{blockName:t.issuer||v}}),new q({name:t.issuer||v,idBlock:{tagClass:3,tagNumber:0},value:Kd.schema().valueBlock.value})]}),X.schema(t.signature||{}),new Y({name:t.serialNumber||v}),$i.schema(t.attrCertValidityPeriod||{}),new O({name:t.attributes||v,value:[new Ge({value:st.schema()})]}),new et({optional:!0,name:t.issuerUniqueID||v}),Rt.schema(t.extensions||{},!0)]})}fromSchema(e){re(e,kp);const t=ue(e,e,s.schema({names:{version:ko,holder:{names:{blockName:_o}},issuer:Co,signature:{names:{blockName:No}},serialNumber:Io,attrCertValidityPeriod:{names:{blockName:Bo}},attributes:Ro,issuerUniqueID:Qr,extensions:{names:{blockName:Zr}}}}));if(3!==(ae.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.holder=new Fu({schema:t.result.holder}),t.result.issuer.idBlock.tagClass))throw new Error("Incorrect value for 'issuer' in AttributeCertificateInfoV2");this.issuer=new Kd({schema:new O({value:t.result.issuer.valueBlock.value})}),this.signature=new X({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new $i({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,r=>new st({schema:r})),Qr in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),Zr in t.result&&(this.extensions=new Rt({schema:t.result.extensions}))}toSchema(){const e=new O({value:[new Y({value:this.version}),this.holder.toSchema(),new q({idBlock:{tagClass:3,tagNumber:0},value:this.issuer.toSchema().valueBlock.value}),this.signature.toSchema(),this.serialNumber,this.attrCertValidityPeriod.toSchema(),new O({value:Array.from(this.attributes,t=>t.toSchema())})]});return this.issuerUniqueID&&e.valueBlock.value.push(this.issuerUniqueID),this.extensions&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version,holder:this.holder.toJSON(),issuer:this.issuer.toJSON(),signature:this.signature.toJSON(),serialNumber:this.serialNumber.toJSON(),attrCertValidityPeriod:this.attrCertValidityPeriod.toJSON(),attributes:Array.from(this.attributes,t=>t.toJSON())};return this.issuerUniqueID&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),this.extensions&&(e.extensions=this.extensions.toJSON()),e}}return s.CLASS_NAME="AttributeCertificateInfoV2",s})();const To="acinfo",xo="signatureAlgorithm",Vo="signatureValue",_p=[To,xo,Vo];let ei=(()=>{class s extends fe{constructor(e={}){super(),this.acinfo=l(e,To,s.defaultValues(To)),this.signatureAlgorithm=l(e,xo,s.defaultValues(xo)),this.signatureValue=l(e,Vo,s.defaultValues(Vo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case To:return new Hu;case xo:return new X;case Vo:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Hu.schema(t.acinfo||{}),X.schema(t.signatureAlgorithm||{}),new et({name:t.signatureValue||v})]})}fromSchema(e){re(e,_p);const t=ue(e,e,s.schema({names:{acinfo:{names:{blockName:To}},signatureAlgorithm:{names:{blockName:xo}},signatureValue:Vo}}));ae.assertSchema(t,this.className),this.acinfo=new Hu({schema:t.result.acinfo}),this.signatureAlgorithm=new X({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new O({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}return s.CLASS_NAME="AttributeCertificateV2",s})();const ti="contentType",tn="content",Cp=[ti,tn];let Ut=(()=>{class s extends fe{constructor(e={}){super(),this.contentType=l(e,ti,s.defaultValues(ti)),this.content=l(e,tn,s.defaultValues(tn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ti:return v;case tn:return new Fe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ti:return"string"==typeof t&&t===this.defaultValues(ti);case tn:return t instanceof Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return"optional"in t||(t.optional=!1),new O({name:t.blockName||"ContentInfo",optional:t.optional,value:[new Ve({name:t.contentType||ti}),new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.content||tn})]})]})}fromSchema(e){re(e,Cp);const t=ue(e,e,s.schema());ae.assertSchema(t,this.className),this.contentType=t.result.contentType.valueBlock.toString(),this.content=t.result.content}toSchema(){return new O({value:[new Ve({value:this.contentType}),new q({idBlock:{tagClass:3,tagNumber:0},value:[this.content]})]})}toJSON(){const e={contentType:this.contentType};return this.content instanceof Fe||(e.content=this.content.toJSON()),e}}return s.CLASS_NAME="ContentInfo",s.DATA=bu,s.SIGNED_DATA="1.2.840.113549.1.7.2",s.ENVELOPED_DATA=id,s.ENCRYPTED_DATA=nd,s})();const ju="type",$u="value",Ku="utcTimeName",Gu="generalTimeName",Np=[Ku,Gu];let Tt=(()=>{class s extends fe{constructor(e={}){super(),this.type=l(e,ju,s.defaultValues(ju)),this.value=l(e,$u,s.defaultValues($u)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ju:return 0;case $u:return new Date(0,0,0);default:return super.defaultValues(e)}}static schema(e={},t=!1){const r=l(e,"names",{});return new ft({optional:t,value:[new Mi({name:r.utcTimeName||v}),new ht({name:r.generalTimeName||v})]})}fromSchema(e){re(e,Np);const t=ue(e,e,s.schema({names:{utcTimeName:Ku,generalTimeName:Gu}}));ae.assertSchema(t,this.className),Ku in t.result&&(this.type=0,this.value=t.result.utcTimeName.toDate()),Gu in t.result&&(this.type=1,this.value=t.result.generalTimeName.toDate())}toSchema(){return 0===this.type?new Mi({valueDate:this.value}):1===this.type?new ht({valueDate:this.value}):{}}toJSON(){return{type:this.type,value:this.value}}}return s.CLASS_NAME="Time",s})();const Ys="version",Ql="serialNumber",Zl="signature",ec="issuer",tc="notBefore",sc="notAfter",rc="subject",ic="subjectPublicKeyInfo",Oo="issuerUniqueID",Po="subjectUniqueID",Do="extensions",Uo="signatureAlgorithm",Mo="signatureValue",Ft="tbsCertificate",nc=`${Ft}.${Ys}`,qu=`${Ft}.${Ql}`,Wu=`${Ft}.${Zl}`,zu=`${Ft}.${ec}`,ac=`${Ft}.${tc}`,oc=`${Ft}.${sc}`,Yu=`${Ft}.${rc}`,Xu=`${Ft}.${ic}`,lc=`${Ft}.${Oo}`,cc=`${Ft}.${Po}`,Lo=`${Ft}.${Do}`,Bp=[Ft,nc,qu,Wu,zu,ac,oc,Yu,Xu,lc,cc,Lo,Uo,Mo];function Rp(s={}){const i=l(s,"names",{});return new O({name:i.blockName||Ft,value:[new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Y({name:i.tbsCertificateVersion||nc})]}),new Y({name:i.tbsCertificateSerialNumber||qu}),X.schema(i.signature||{names:{blockName:Wu}}),dt.schema(i.issuer||{names:{blockName:zu}}),new O({name:i.tbsCertificateValidity||"tbsCertificate.validity",value:[Tt.schema(i.notBefore||{names:{utcTimeName:ac,generalTimeName:ac}}),Tt.schema(i.notAfter||{names:{utcTimeName:oc,generalTimeName:oc}})]}),dt.schema(i.subject||{names:{blockName:Yu}}),ns.schema(i.subjectPublicKeyInfo||{names:{blockName:Xu}}),new Le({name:i.tbsCertificateIssuerUniqueID||lc,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Le({name:i.tbsCertificateSubjectUniqueID||cc,optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[Rt.schema(i.extensions||{names:{blockName:Lo}})]})]})}let zt=(()=>{class s extends fe{get tbs(){return b._H.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(l(e,"tbs",s.defaultValues("tbs"))),this.version=l(e,Ys,s.defaultValues(Ys)),this.serialNumber=l(e,Ql,s.defaultValues(Ql)),this.signature=l(e,Zl,s.defaultValues(Zl)),this.issuer=l(e,ec,s.defaultValues(ec)),this.notBefore=l(e,tc,s.defaultValues(tc)),this.notAfter=l(e,sc,s.defaultValues(sc)),this.subject=l(e,rc,s.defaultValues(rc)),this.subjectPublicKeyInfo=l(e,ic,s.defaultValues(ic)),Oo in e&&(this.issuerUniqueID=l(e,Oo,s.defaultValues(Oo))),Po in e&&(this.subjectUniqueID=l(e,Po,s.defaultValues(Po))),Do in e&&(this.extensions=l(e,Do,s.defaultValues(Do))),this.signatureAlgorithm=l(e,Uo,s.defaultValues(Uo)),this.signatureValue=l(e,Mo,s.defaultValues(Mo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return Ct;case Ys:return 0;case Ql:return new Y;case Zl:return new X;case ec:return new dt;case tc:case sc:return new Tt;case rc:return new dt;case ic:return new ns;case Oo:case Po:return Ct;case Do:return[];case Uo:return new X;case Mo:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Rp(t.tbsCertificate),X.schema(t.signatureAlgorithm||{names:{blockName:Uo}}),new et({name:t.signatureValue||Mo})]})}fromSchema(e){re(e,Bp);const t=ue(e,e,s.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:Lo}}}}}}));ae.assertSchema(t,this.className),this.tbsView=t.result.tbsCertificate.valueBeforeDecodeView,nc in t.result&&(this.version=t.result[nc].valueBlock.valueDec),this.serialNumber=t.result[qu],this.signature=new X({schema:t.result[Wu]}),this.issuer=new dt({schema:t.result[zu]}),this.notBefore=new Tt({schema:t.result[ac]}),this.notAfter=new Tt({schema:t.result[oc]}),this.subject=new dt({schema:t.result[Yu]}),this.subjectPublicKeyInfo=new ns({schema:t.result[Xu]}),lc in t.result&&(this.issuerUniqueID=t.result[lc].valueBlock.valueHex),cc in t.result&&(this.subjectUniqueID=t.result[cc].valueBlock.valueHex),Lo in t.result&&(this.extensions=Array.from(t.result[Lo],r=>new Lr({schema:r}))),this.signatureAlgorithm=new X({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return Ys in this&&this.version!==s.defaultValues(Ys)&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Y({value:this.version})]})),e.push(this.serialNumber),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(new O({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),e.push(this.subject.toSchema()),e.push(this.subjectPublicKeyInfo.toSchema()),this.issuerUniqueID&&e.push(new Le({optional:!0,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID})),this.subjectUniqueID&&e.push(new Le({optional:!0,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID})),this.extensions&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[new O({value:Array.from(this.extensions,t=>t.toSchema())})]})),new O({value:e})}toSchema(e=!1){let t;if(!1===e){if(!this.tbsView.byteLength)return s.schema().value[0];const r=ct(this.tbsView);ae.assert(r,"TBS Certificate"),t=r.result}else t=this.encodeTBS();return new O({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:b.U$.ToHex(this.tbsView),version:this.version,serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return Ys in this&&this.version!==s.defaultValues(Ys)&&(e.version=this.version),this.issuerUniqueID&&(e.issuerUniqueID=b.U$.ToHex(this.issuerUniqueID)),this.subjectUniqueID&&(e.subjectUniqueID=b.U$.ToHex(this.subjectUniqueID)),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}getPublicKey(e,t=Je(!0)){var r=this;return(0,k.A)(function*(){return t.getPublicKey(r.subjectPublicKeyInfo,r.signatureAlgorithm,e)})()}getKeyHash(e="SHA-1",t=Je(!0)){var r=this;return(0,k.A)(function*(){return t.digest({name:e},r.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView)})()}sign(e,t="SHA-1",r=Je(!0)){var a=this;return(0,k.A)(function*(){if(!e)throw new Error("Need to provide a private key for signing");const o=yield r.getSignatureParameters(e,t),u=o.parameters;a.signature=o.signatureAlgorithm,a.signatureAlgorithm=o.signatureAlgorithm,a.tbsView=new Uint8Array(a.encodeTBS().toBER());const h=yield r.signWithPrivateKey(a.tbsView,e,u);a.signatureValue=new et({valueHex:h})})()}verify(e,t=Je(!0)){var r=this;return(0,k.A)(function*(){let a;if(e?a=e.subjectPublicKeyInfo:r.issuer.isEqual(r.subject)&&(a=r.subjectPublicKeyInfo),!(a instanceof ns))throw new Error("Please provide issuer certificate as a parameter");return t.verifyWithPublicKey(r.tbsView,r.signatureValue,a,r.signatureAlgorithm)})()}}return s.CLASS_NAME="Certificate",s})();function Gd(s,i=null){if(i&&s.issuer.isEqual(i.issuer)&&s.serialNumber.isEqual(i.serialNumber))return null;let e=!1;if(s.extensions)for(const t of s.extensions)if(t.extnID===vu&&t.parsedValue instanceof ud&&t.parsedValue.cA){e=!0;break}return e?s:null}const sn="certId",rn="certValue",nn="parsedValue",Tp=[sn,rn];let Qu=(()=>{class s extends fe{constructor(e={}){super(),this.certId=l(e,sn,s.defaultValues(sn)),this.certValue=l(e,rn,s.defaultValues(rn)),nn in e&&(this.parsedValue=l(e,nn,s.defaultValues(nn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case sn:return v;case rn:return new Fe;case nn:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case sn:return t===v;case rn:return t instanceof Fe;case nn:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.id||"id"}),new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.value||"value"})]})]})}fromSchema(e){re(e,Tp);const t=ue(e,e,s.schema({names:{id:sn,value:rn}}));ae.assertSchema(t,this.className),this.certId=t.result.certId.valueBlock.toString(),this.certValue=t.result.certValue;const r=this.certValue.valueBlock.valueHexView;switch(this.certId){case ad:try{this.parsedValue=zt.fromBER(r)}catch{ei.fromBER(r)}break;case od:this.parsedValue=ei.fromBER(r);break;default:throw new Error(`Incorrect CERT_ID value in CertBag: ${this.certId}`)}}toSchema(){return nn in this&&(this.certId="acinfo"in this.parsedValue?od:ad,this.certValue=new de({valueHex:this.parsedValue.toSchema().toBER(!1)})),new O({value:[new Ve({value:this.certId}),new q({idBlock:{tagClass:3,tagNumber:0},value:["toSchema"in this.certValue?this.certValue.toSchema():this.certValue]})]})}toJSON(){return{certId:this.certId,certValue:this.certValue.toJSON()}}}return s.CLASS_NAME="CertBag",s})();const Fo="userCertificate",an="revocationDate",si="crlEntryExtensions",xp=[Fo,an,si];let Vp=(()=>{class s extends fe{constructor(e={}){super(),this.userCertificate=l(e,Fo,s.defaultValues(Fo)),this.revocationDate=l(e,an,s.defaultValues(an)),si in e&&(this.crlEntryExtensions=l(e,si,s.defaultValues(si))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fo:return new Y;case an:return new Tt;case si:return new Rt;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.userCertificate||Fo}),Tt.schema({names:{utcTimeName:t.revocationDate||an,generalTimeName:t.revocationDate||an}}),Rt.schema({names:{blockName:t.crlEntryExtensions||si}},!0)]})}fromSchema(e){re(e,xp);const t=ue(e,e,s.schema());ae.assertSchema(t,this.className),this.userCertificate=t.result.userCertificate,this.revocationDate=new Tt({schema:t.result.revocationDate}),si in t.result&&(this.crlEntryExtensions=new Rt({schema:t.result.crlEntryExtensions}))}toSchema(){const e=[this.userCertificate,this.revocationDate.toSchema()];return this.crlEntryExtensions&&e.push(this.crlEntryExtensions.toSchema()),new O({value:e})}toJSON(){const e={userCertificate:this.userCertificate.toJSON(),revocationDate:this.revocationDate.toJSON()};return this.crlEntryExtensions&&(e.crlEntryExtensions=this.crlEntryExtensions.toJSON()),e}}return s.CLASS_NAME="RevokedCertificate",s})();const Ho="version",eh="signature",th="issuer",sh="thisUpdate",uc="nextUpdate",hc="revokedCertificates",fc="crlExtensions",jo="signatureAlgorithm",$o="signatureValue",ps="tbsCertList",dc=`${ps}.version`,rh=`${ps}.signature`,ih=`${ps}.issuer`,mc=`${ps}.thisUpdate`,Ko=`${ps}.nextUpdate`,gc=`${ps}.revokedCertificates`,pc=`${ps}.extensions`,Op=[ps,dc,rh,ih,mc,Ko,gc,pc,jo,$o];function Pp(s={}){const i=l(s,"names",{});return new O({name:i.blockName||ps,value:[new Y({optional:!0,name:i.tbsCertListVersion||dc,value:2}),X.schema(i.signature||{names:{blockName:rh}}),dt.schema(i.issuer||{names:{blockName:ih}}),Tt.schema(i.tbsCertListThisUpdate||{names:{utcTimeName:mc,generalTimeName:mc}}),Tt.schema(i.tbsCertListNextUpdate||{names:{utcTimeName:Ko,generalTimeName:Ko}},!0),new O({optional:!0,value:[new Ge({name:i.tbsCertListRevokedCertificates||gc,value:new O({value:[new Y,Tt.schema(),Rt.schema({},!0)]})})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[Rt.schema(i.crlExtensions||{names:{blockName:pc}})]})]})}const Dp=[yu,zf,"2.5.29.20","2.5.29.27",Yf,wu,Su,"2.5.29.21","2.5.29.24",Xf];let vc=(()=>{class s extends fe{get tbs(){return b._H.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(l(e,"tbs",s.defaultValues("tbs"))),this.version=l(e,Ho,s.defaultValues(Ho)),this.signature=l(e,eh,s.defaultValues(eh)),this.issuer=l(e,th,s.defaultValues(th)),this.thisUpdate=l(e,sh,s.defaultValues(sh)),uc in e&&(this.nextUpdate=l(e,uc,s.defaultValues(uc))),hc in e&&(this.revokedCertificates=l(e,hc,s.defaultValues(hc))),fc in e&&(this.crlExtensions=l(e,fc,s.defaultValues(fc))),this.signatureAlgorithm=l(e,jo,s.defaultValues(jo)),this.signatureValue=l(e,$o,s.defaultValues($o)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return Ct;case Ho:return 0;case eh:return new X;case th:return new dt;case sh:case uc:return new Tt;case hc:return[];case fc:return new Rt;case jo:return new X;case $o:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||"CertificateList",value:[Pp(e),X.schema(t.signatureAlgorithm||{names:{blockName:jo}}),new et({name:t.signatureValue||$o})]})}fromSchema(e){re(e,Op);const t=ue(e,e,s.schema());ae.assertSchema(t,this.className),this.tbsView=t.result.tbsCertList.valueBeforeDecodeView,dc in t.result&&(this.version=t.result[dc].valueBlock.valueDec),this.signature=new X({schema:t.result[rh]}),this.issuer=new dt({schema:t.result[ih]}),this.thisUpdate=new Tt({schema:t.result[mc]}),Ko in t.result&&(this.nextUpdate=new Tt({schema:t.result[Ko]})),gc in t.result&&(this.revokedCertificates=Array.from(t.result[gc],r=>new Vp({schema:r}))),pc in t.result&&(this.crlExtensions=new Rt({schema:t.result[pc]})),this.signatureAlgorithm=new X({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return this.version!==s.defaultValues(Ho)&&e.push(new Y({value:this.version})),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(this.thisUpdate.toSchema()),this.nextUpdate&&e.push(this.nextUpdate.toSchema()),this.revokedCertificates&&e.push(new O({value:Array.from(this.revokedCertificates,t=>t.toSchema())})),this.crlExtensions&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.crlExtensions.toSchema()]})),new O({value:e})}toSchema(e=!1){let t;if(e)t=this.encodeTBS();else{if(!this.tbsView.byteLength)return s.schema();const r=ct(this.tbsView);ae.assert(r,"TBS Certificate Revocation List"),t=r.result}return new O({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:b.U$.ToHex(this.tbsView),version:this.version,signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),thisUpdate:this.thisUpdate.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return this.version!==s.defaultValues(Ho)&&(e.version=this.version),this.nextUpdate&&(e.nextUpdate=this.nextUpdate.toJSON()),this.revokedCertificates&&(e.revokedCertificates=Array.from(this.revokedCertificates,t=>t.toJSON())),this.crlExtensions&&(e.crlExtensions=this.crlExtensions.toJSON()),e}isCertificateRevoked(e){if(!this.issuer.isEqual(e.issuer)||!this.revokedCertificates)return!1;for(const t of this.revokedCertificates)if(t.userCertificate.isEqual(e.serialNumber))return!0;return!1}sign(e,t="SHA-1",r=Je(!0)){var a=this;return(0,k.A)(function*(){if(!e)throw new Error("Need to provide a private key for signing");const o=yield r.getSignatureParameters(e,t),{parameters:u}=o;a.signature=o.signatureAlgorithm,a.signatureAlgorithm=o.signatureAlgorithm,a.tbsView=new Uint8Array(a.encodeTBS().toBER());const h=yield r.signWithPrivateKey(a.tbsView,e,u);a.signatureValue=new et({valueHex:h})})()}verify(e={},t=Je(!0)){var r=this;return(0,k.A)(function*(){let a;if(e.issuerCertificate&&(a=e.issuerCertificate.subjectPublicKeyInfo,!r.issuer.isEqual(e.issuerCertificate.subject)))return!1;if(e.publicKeyInfo&&(a=e.publicKeyInfo),!a)throw new Error("Issuer's certificate must be provided as an input parameter");if(r.crlExtensions)for(const o of r.crlExtensions.extensions)if(o.critical&&!Dp.includes(o.extnID))return!1;return t.verifyWithPublicKey(r.tbsView,r.signatureValue,a,r.signatureAlgorithm)})()}}return s.CLASS_NAME="CertificateRevocationList",s})();const on="crlId",ln="crlValue",Go="parsedValue",Up=[on,ln];let Mp=(()=>{class s extends fe{constructor(e={}){super(),this.crlId=l(e,on,s.defaultValues(on)),this.crlValue=l(e,ln,s.defaultValues(ln)),Go in e&&(this.parsedValue=l(e,Go,s.defaultValues(Go))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case on:return v;case ln:return new Fe;case Go:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case on:return t===v;case ln:return t instanceof Fe;case Go:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.id||"id"}),new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.value||"value"})]})]})}fromSchema(e){re(e,Up);const t=ue(e,e,s.schema({names:{id:on,value:ln}}));if(ae.assertSchema(t,this.className),this.crlId=t.result.crlId.valueBlock.toString(),this.crlValue=t.result.crlValue,this.crlId!==ld)throw new Error(`Incorrect CRL_ID value in CRLBag: ${this.crlId}`);this.parsedValue=vc.fromBER(this.certValue.valueBlock.valueHex)}toSchema(){return this.parsedValue&&(this.crlId=ld,this.crlValue=new de({valueHex:this.parsedValue.toSchema().toBER(!1)})),new O({value:[new Ve({value:this.crlId}),new q({idBlock:{tagClass:3,tagNumber:0},value:[this.crlValue.toSchema()]})]})}toJSON(){return{crlId:this.crlId,crlValue:this.crlValue.toJSON()}}}return s.CLASS_NAME="CRLBag",s})();const cn="version",un="encryptedContentInfo",Xs="unprotectedAttrs",Lp=[cn,un,Xs];let wc=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,cn,s.defaultValues(cn)),this.encryptedContentInfo=l(e,un,s.defaultValues(un)),Xs in e&&(this.unprotectedAttrs=l(e,Xs,s.defaultValues(Xs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case cn:return 0;case un:return new Dt;case Xs:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case cn:return 0===t;case un:return Dt.compareWithDefault("contentType",t.contentType)&&Dt.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&Dt.compareWithDefault("encryptedContent",t.encryptedContent);case Xs:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.version||v}),Dt.schema(t.encryptedContentInfo||{}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Ge({name:t.unprotectedAttrs||v,value:st.schema()})]})]})}fromSchema(e){re(e,Lp);const t=ue(e,e,s.schema({names:{version:cn,encryptedContentInfo:{names:{blockName:un}},unprotectedAttrs:Xs}}));ae.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.encryptedContentInfo=new Dt({schema:t.result.encryptedContentInfo}),Xs in t.result&&(this.unprotectedAttrs=Array.from(t.result.unprotectedAttrs,r=>new st({schema:r})))}toSchema(){const e=[];return e.push(new Y({value:this.version})),e.push(this.encryptedContentInfo.toSchema()),this.unprotectedAttrs&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={version:this.version,encryptedContentInfo:this.encryptedContentInfo.toJSON()};return this.unprotectedAttrs&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,t=>t.toJSON())),e}encrypt(e,t=Je(!0)){var r=this;return(0,k.A)(function*(){ot.assert(e,"parameters","object");const a={...e,contentType:"1.2.840.113549.1.7.1"};r.encryptedContentInfo=yield t.encryptEncryptedContentInfo(a)})()}decrypt(e,t=Je(!0)){var r=this;return(0,k.A)(function*(){ot.assert(e,"parameters","object");const a={...e,encryptedContentInfo:r.encryptedContentInfo};return t.decryptEncryptedContentInfo(a)})()}}return s.CLASS_NAME="EncryptedData",s})();const ri="encryptionAlgorithm",Qs="encryptedData",Jo="parsedValue",Fp=[ri,Qs];let Jd=(()=>{class s extends fe{constructor(e={}){super(),this.encryptionAlgorithm=l(e,ri,s.defaultValues(ri)),this.encryptedData=l(e,Qs,s.defaultValues(Qs)),Jo in e&&(this.parsedValue=l(e,Jo,s.defaultValues(Jo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ri:return new X;case Qs:return new de;case Jo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ri:return X.compareWithDefault("algorithmId",t.algorithmId)&&!("algorithmParams"in t);case Qs:return t.isEqual(s.defaultValues(e));case Jo:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[X.schema(t.encryptionAlgorithm||{names:{blockName:ri}}),new ft({value:[new de({name:t.encryptedData||Qs}),new de({idBlock:{isConstructed:!0},name:t.encryptedData||Qs})]})]})}fromSchema(e){re(e,Fp);const t=ue(e,e,s.schema({names:{encryptionAlgorithm:{names:{blockName:ri}},encryptedData:Qs}}));ae.assertSchema(t,this.className),this.encryptionAlgorithm=new X({schema:t.result.encryptionAlgorithm}),this.encryptedData=t.result.encryptedData}toSchema(){return new O({value:[this.encryptionAlgorithm.toSchema(),this.encryptedData]})}toJSON(){return{encryptionAlgorithm:this.encryptionAlgorithm.toJSON(),encryptedData:this.encryptedData.toJSON()}}parseInternalValues(e,t=Je(!0)){var r=this;return(0,k.A)(function*(){const o=yield new wc({encryptedContentInfo:new Dt({contentEncryptionAlgorithm:r.encryptionAlgorithm,encryptedContent:r.encryptedData})}).decrypt(e,t);r.parsedValue=Yi.fromBER(o)})()}makeInternalValues(e,t=Je(!0)){var r=this;return(0,k.A)(function*(){if(!r.parsedValue)throw new Error('Please initialize "parsedValue" first');const a=new wc,o={...e,contentToEncrypt:r.parsedValue.toSchema().toBER(!1)};if(yield a.encrypt(o,t),!a.encryptedContentInfo.encryptedContent)throw new Error("The filed `encryptedContent` in EncryptedContentInfo is empty");r.encryptionAlgorithm=a.encryptedContentInfo.contentEncryptionAlgorithm,r.encryptedData=a.encryptedContentInfo.encryptedContent})()}}return s.CLASS_NAME="PKCS8ShroudedKeyBag",s})();const hn="secretTypeId",fn="secretValue",Hp=[hn,fn];let jp=(()=>{class s extends fe{constructor(e={}){super(),this.secretTypeId=l(e,hn,s.defaultValues(hn)),this.secretValue=l(e,fn,s.defaultValues(fn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hn:return v;case fn:return new Fe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case hn:return t===v;case fn:return t instanceof Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.id||"id"}),new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.value||"value"})]})]})}fromSchema(e){re(e,Hp);const t=ue(e,e,s.schema({names:{id:hn,value:fn}}));ae.assertSchema(t,this.className),this.secretTypeId=t.result.secretTypeId.valueBlock.toString(),this.secretValue=t.result.secretValue}toSchema(){return new O({value:[new Ve({value:this.secretTypeId}),new q({idBlock:{tagClass:3,tagNumber:0},value:[this.secretValue.toSchema()]})]})}toJSON(){return{secretTypeId:this.secretTypeId,secretValue:this.secretValue.toJSON()}}}return s.CLASS_NAME="SecretBag",s})();class Zs{static getItems(){return this.items||(this.items={},Zs.register("1.2.840.113549.1.12.10.1.1",Yi),Zs.register("1.2.840.113549.1.12.10.1.2",Jd),Zs.register("1.2.840.113549.1.12.10.1.3",Qu),Zs.register("1.2.840.113549.1.12.10.1.4",Mp),Zs.register("1.2.840.113549.1.12.10.1.5",jp),Zs.register("1.2.840.113549.1.12.10.1.6",ai)),this.items}static register(i,e){this.getItems()[i]=e}static find(i){return this.getItems()[i]||null}}const ii="bagId",ni="bagValue",vs="bagAttributes",$p=[ii,ni,vs];let qo=(()=>{class s extends fe{constructor(e={}){super(),this.bagId=l(e,ii,s.defaultValues(ii)),this.bagValue=l(e,ni,s.defaultValues(ni)),vs in e&&(this.bagAttributes=l(e,vs,s.defaultValues(vs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ii:return v;case ni:return new Fe;case vs:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ii:return t===v;case ni:return t instanceof Fe;case vs:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.bagId||ii}),new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.bagValue||ni})]}),new _t({optional:!0,value:[new Ge({name:t.bagAttributes||vs,value:st.schema()})]})]})}fromSchema(e){re(e,$p);const t=ue(e,e,s.schema({names:{bagId:ii,bagValue:ni,bagAttributes:vs}}));ae.assertSchema(t,this.className),this.bagId=t.result.bagId.valueBlock.toString();const r=Zs.find(this.bagId);if(!r)throw new Error(`Invalid BAG_ID for SafeBag: ${this.bagId}`);this.bagValue=new r({schema:t.result.bagValue}),vs in t.result&&(this.bagAttributes=Array.from(t.result.bagAttributes,a=>new st({schema:a})))}toSchema(){const e=[new Ve({value:this.bagId}),new q({idBlock:{tagClass:3,tagNumber:0},value:[this.bagValue.toSchema()]})];return this.bagAttributes&&e.push(new _t({value:Array.from(this.bagAttributes,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={bagId:this.bagId,bagValue:this.bagValue.toJSON()};return this.bagAttributes&&(e.bagAttributes=Array.from(this.bagAttributes,t=>t.toJSON())),e}}return s.CLASS_NAME="SafeBag",s})();const dn="safeBags";let ai=(()=>{class s extends fe{constructor(e={}){super(),this.safeBags=l(e,dn,s.defaultValues(dn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===dn?[]:super.defaultValues(e)}static compareWithDefault(e,t){return e===dn?0===t.length:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ge({name:t.safeBags||v,value:qo.schema()})]})}fromSchema(e){re(e,[dn]);const t=ue(e,e,s.schema({names:{safeBags:dn}}));ae.assertSchema(t,this.className),this.safeBags=Array.from(t.result.safeBags,r=>new qo({schema:r}))}toSchema(){return new O({value:Array.from(this.safeBags,e=>e.toSchema())})}toJSON(){return{safeBags:Array.from(this.safeBags,e=>e.toJSON())}}}return s.CLASS_NAME="SafeContents",s})();const Wo="otherCertFormat",zo="otherCert",Kp=[Wo,zo];class er extends fe{constructor(i={}){super(),this.otherCertFormat=l(i,Wo,er.defaultValues(Wo)),this.otherCert=l(i,zo,er.defaultValues(zo)),i.schema&&this.fromSchema(i.schema)}static defaultValues(i){switch(i){case Wo:return v;case zo:return new Fe;default:return super.defaultValues(i)}}static schema(i={}){const e=l(i,"names",{});return new O({name:e.blockName||v,value:[new Ve({name:e.otherCertFormat||Wo}),new Fe({name:e.otherCert||zo})]})}fromSchema(i){re(i,Kp);const e=ue(i,i,er.schema());ae.assertSchema(e,this.className),this.otherCertFormat=e.result.otherCertFormat.valueBlock.toString(),this.otherCert=e.result.otherCert}toSchema(){return new O({value:[new Ve({value:this.otherCertFormat}),this.otherCert]})}toJSON(){const i={otherCertFormat:this.otherCertFormat};return this.otherCert instanceof Fe||(i.otherCert=this.otherCert.toJSON()),i}}const Yo="certificates",Gp=[Yo];let mn=(()=>{class s extends fe{constructor(e={}){super(),this.certificates=l(e,Yo,s.defaultValues(Yo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Yo?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new _t({name:t.blockName||v,value:[new Ge({name:t.certificates||Yo,value:new ft({value:[zt.schema(),new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe]}),new q({idBlock:{tagClass:3,tagNumber:1},value:[new O]}),new q({idBlock:{tagClass:3,tagNumber:2},value:ei.schema().valueBlock.value}),new q({idBlock:{tagClass:3,tagNumber:3},value:er.schema().valueBlock.value})]})})]})}fromSchema(e){re(e,Gp);const t=ue(e,e,s.schema());ae.assertSchema(t,this.className),this.certificates=Array.from(t.result.certificates||[],r=>{const a=r.idBlock.tagNumber;if(1===r.idBlock.tagClass)return new zt({schema:r});const o=new O({value:r.valueBlock.value});switch(a){case 1:return 1===o.valueBlock.value[0].valueBlock.value[0].valueBlock.valueDec?new ei({schema:o}):new Lu({schema:o});case 2:return new ei({schema:o});case 3:return new er({schema:o})}return r})}toSchema(){return new _t({value:Array.from(this.certificates,e=>{switch(!0){case e instanceof zt:return e.toSchema();case e instanceof Lu:return new q({idBlock:{tagClass:3,tagNumber:1},value:e.toSchema().valueBlock.value});case e instanceof ei:return new q({idBlock:{tagClass:3,tagNumber:2},value:e.toSchema().valueBlock.value});case e instanceof er:return new q({idBlock:{tagClass:3,tagNumber:3},value:e.toSchema().valueBlock.value})}return e.toSchema()})})}toJSON(){return{certificates:Array.from(this.certificates,e=>e.toJSON())}}}return s.CLASS_NAME="CertificateSet",s})();const Xo="otherRevInfoFormat",Qo="otherRevInfo",Jp=[Xo,Qo];let yc=(()=>{class s extends fe{constructor(e={}){super(),this.otherRevInfoFormat=l(e,Xo,s.defaultValues(Xo)),this.otherRevInfo=l(e,Qo,s.defaultValues(Qo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Xo:return v;case Qo:return new Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.otherRevInfoFormat||Xo}),new Fe({name:t.otherRevInfo||Qo})]})}fromSchema(e){re(e,Jp);const t=ue(e,e,s.schema());ae.assertSchema(t,this.className),this.otherRevInfoFormat=t.result.otherRevInfoFormat.valueBlock.toString(),this.otherRevInfo=t.result.otherRevInfo}toSchema(){return new O({value:[new Ve({value:this.otherRevInfoFormat}),this.otherRevInfo]})}toJSON(){const e={otherRevInfoFormat:this.otherRevInfoFormat};return this.otherRevInfo instanceof Fe||(e.otherRevInfo=this.otherRevInfo.toJSON()),e}}return s.CLASS_NAME="OtherRevocationInfoFormat",s})();const Zo="crls",nh="otherRevocationInfos",qp=[Zo];let Sc=(()=>{class s extends fe{constructor(e={}){super(),this.crls=l(e,Zo,s.defaultValues(Zo)),this.otherRevocationInfos=l(e,nh,s.defaultValues(nh)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Zo:case nh:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new _t({name:t.blockName||v,value:[new Ge({name:t.crls||v,value:new ft({value:[vc.schema(),new q({idBlock:{tagClass:3,tagNumber:1},value:[new Ve,new Fe]})]})})]})}fromSchema(e){re(e,qp);const t=ue(e,e,s.schema({names:{crls:Zo}}));if(ae.assertSchema(t,this.className),t.result.crls)for(const r of t.result.crls)1===r.idBlock.tagClass?this.crls.push(new vc({schema:r})):this.otherRevocationInfos.push(new yc({schema:r}))}toSchema(){const e=[];return e.push(...Array.from(this.crls,t=>t.toSchema())),e.push(...Array.from(this.otherRevocationInfos,t=>{const r=t.toSchema();return r.idBlock.tagClass=3,r.idBlock.tagNumber=1,r})),new _t({value:e})}toJSON(){return{crls:Array.from(this.crls,e=>e.toJSON()),otherRevocationInfos:Array.from(this.otherRevocationInfos,e=>e.toJSON())}}}return s.CLASS_NAME="RevocationInfoChoices",s})();const el="certs",oi="crls",Wp=[el,oi];let ah=(()=>{class s extends fe{constructor(e={}){super(),this.crls=l(e,oi,s.defaultValues(oi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case el:return new mn;case oi:return new Sc;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case el:return 0===t.certificates.length;case oi:return 0===t.crls.length&&0===t.otherRevocationInfos.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({name:t.certs||v,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:mn.schema().valueBlock.value}),new q({name:t.crls||v,optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Sc.schema().valueBlock.value})]})}fromSchema(e){re(e,Wp);const t=ue(e,e,s.schema({names:{certs:el,crls:oi}}));ae.assertSchema(t,this.className),el in t.result&&(this.certs=new mn({schema:new _t({value:t.result.certs.valueBlock.value})})),oi in t.result&&(this.crls=new Sc({schema:new _t({value:t.result.crls.valueBlock.value})}))}toSchema(){const e=[];return this.certs&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:this.certs.toSchema().valueBlock.value})),this.crls&&e.push(new q({idBlock:{tagClass:3,tagNumber:1},value:this.crls.toSchema().valueBlock.value})),new O({value:e})}toJSON(){const e={};return this.certs&&(e.certs=this.certs.toJSON()),this.crls&&(e.crls=this.crls.toJSON()),e}}return s.CLASS_NAME="OriginatorInfo",s})();const tl="issuer",sl="serialNumber",zp=[tl,sl];let xt=(()=>{class s extends fe{constructor(e={}){super(),this.issuer=l(e,tl,s.defaultValues(tl)),this.serialNumber=l(e,sl,s.defaultValues(sl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case tl:return new dt;case sl:return new Y;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[dt.schema(t.issuer||{}),new Y({name:t.serialNumber||v})]})}fromSchema(e){re(e,zp);const t=ue(e,e,s.schema({names:{issuer:{names:{blockName:tl}},serialNumber:sl}}));ae.assertSchema(t,this.className),this.issuer=new dt({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber}toSchema(){return new O({value:[this.issuer.toSchema(),this.serialNumber]})}toJSON(){return{issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()}}}return s.CLASS_NAME="IssuerAndSerialNumber",s})();const bc="variant",rl="value",Yp=["blockName"];let Xp=(()=>{class s extends fe{constructor(e={}){super(),this.variant=l(e,bc,s.defaultValues(bc)),rl in e&&(this.value=l(e,rl,s.defaultValues(rl))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case bc:return-1;case rl:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case bc:return-1===t;case rl:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new ft({value:[xt.schema({names:{blockName:t.blockName||v}}),new Le({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:0}})]})}fromSchema(e){re(e,Yp);const t=ue(e,e,s.schema({names:{blockName:"blockName"}}));ae.assertSchema(t,this.className),1===t.result.blockName.idBlock.tagClass?(this.variant=1,this.value=new xt({schema:t.result.blockName})):(this.variant=2,this.value=new de({valueHex:t.result.blockName.valueBlock.valueHex}))}toSchema(){switch(this.variant){case 1:if(!(this.value instanceof xt))throw new Error("Incorrect type of RecipientIdentifier.value. It should be IssuerAndSerialNumber.");return this.value.toSchema();case 2:if(!(this.value instanceof de))throw new Error("Incorrect type of RecipientIdentifier.value. It should be ASN.1 OctetString.");return new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:this.value.valueBlock.valueHexView});default:return new Fe}}toJSON(){const e={variant:this.variant};return(1===this.variant||2===this.variant)&&this.value&&(e.value=this.value.toJSON()),e}}return s.CLASS_NAME="RecipientIdentifier",s})();const li="version",gn="rid",pn="keyEncryptionAlgorithm",vn="encryptedKey",Ac="recipientCertificate",Qp=[li,gn,pn,vn];let oh=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,li,s.defaultValues(li)),this.rid=l(e,gn,s.defaultValues(gn)),this.keyEncryptionAlgorithm=l(e,pn,s.defaultValues(pn)),this.encryptedKey=l(e,vn,s.defaultValues(vn)),this.recipientCertificate=l(e,Ac,s.defaultValues(Ac)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case li:return-1;case gn:return{};case pn:return new X;case vn:return new de;case Ac:return new zt;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case li:return t===s.defaultValues(li);case gn:return 0===Object.keys(t).length;case pn:case vn:return t.isEqual(s.defaultValues(e));case Ac:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.version||v}),Xp.schema(t.rid||{}),X.schema(t.keyEncryptionAlgorithm||{}),new de({name:t.encryptedKey||v})]})}fromSchema(e){re(e,Qp);const t=ue(e,e,s.schema({names:{version:li,rid:{names:{blockName:gn}},keyEncryptionAlgorithm:{names:{blockName:pn}},encryptedKey:vn}}));ae.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.rid=3===t.result.rid.idBlock.tagClass?new de({valueHex:t.result.rid.valueBlock.valueHex}):new xt({schema:t.result.rid}),this.keyEncryptionAlgorithm=new X({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){const e=[];return this.rid instanceof xt?(this.version=0,e.push(new Y({value:this.version})),e.push(this.rid.toSchema())):(this.version=2,e.push(new Y({value:this.version})),e.push(new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:this.rid.valueBlock.valueHexView}))),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new O({value:e})}toJSON(){return{version:this.version,rid:this.rid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}return s.CLASS_NAME="KeyTransRecipientInfo",s})();const wn="algorithm",yn="publicKey",Zp=[wn,yn];let lh=(()=>{class s extends fe{constructor(e={}){super(),this.algorithm=l(e,wn,s.defaultValues(wn)),this.publicKey=l(e,yn,s.defaultValues(yn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wn:return new X;case yn:return new et;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case wn:case yn:return t.isEqual(s.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[X.schema(t.algorithm||{}),new et({name:t.publicKey||v})]})}fromSchema(e){re(e,Zp);const t=ue(e,e,s.schema({names:{algorithm:{names:{blockName:wn}},publicKey:yn}}));ae.assertSchema(t,this.className),this.algorithm=new X({schema:t.result.algorithm}),this.publicKey=t.result.publicKey}toSchema(){return new O({value:[this.algorithm.toSchema(),this.publicKey]})}toJSON(){return{algorithm:this.algorithm.toJSON(),publicKey:this.publicKey.toJSON()}}}return s.CLASS_NAME="OriginatorPublicKey",s})();const Ec="variant",il="value",ev=["blockName"];let kc=(()=>{class s extends fe{constructor(e={}){super(),this.variant=l(e,Ec,s.defaultValues(Ec)),il in e&&(this.value=l(e,il,s.defaultValues(il))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ec:return-1;case il:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ec:return-1===t;case il:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new ft({value:[xt.schema({names:{blockName:t.blockName||v}}),new Le({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||v}),new q({idBlock:{tagClass:3,tagNumber:1},name:t.blockName||v,value:lh.schema().valueBlock.value})]})}fromSchema(e){re(e,ev);const t=ue(e,e,s.schema({names:{blockName:"blockName"}}));ae.assertSchema(t,this.className),1===t.result.blockName.idBlock.tagClass?(this.variant=1,this.value=new xt({schema:t.result.blockName})):0===t.result.blockName.idBlock.tagNumber?(t.result.blockName.idBlock.tagClass=1,t.result.blockName.idBlock.tagNumber=4,this.variant=2,this.value=t.result.blockName):(this.variant=3,this.value=new lh({schema:new O({value:t.result.blockName.valueBlock.value})}))}toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return this.value.idBlock.tagClass=3,this.value.idBlock.tagNumber=0,this.value;case 3:{const e=this.value.toSchema();return e.idBlock.tagClass=3,e.idBlock.tagNumber=1,e}default:return new Fe}}toJSON(){const e={variant:this.variant};return(1===this.variant||2===this.variant||3===this.variant)&&(e.value=this.value.toJSON()),e}}return s.CLASS_NAME="OriginatorIdentifierOrKey",s})();const Sn="keyAttrId",as="keyAttr",tv=[Sn,as];let bn=(()=>{class s extends fe{constructor(e={}){super(),this.keyAttrId=l(e,Sn,s.defaultValues(Sn)),as in e&&(this.keyAttr=l(e,as,s.defaultValues(as))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Sn:return v;case as:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Sn:return"string"==typeof t&&t===v;case as:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({optional:t.optional||!0,name:t.blockName||v,value:[new Ve({name:t.keyAttrId||v}),new Fe({optional:!0,name:t.keyAttr||v})]})}fromSchema(e){re(e,tv);const t=ue(e,e,s.schema({names:{keyAttrId:Sn,keyAttr:as}}));ae.assertSchema(t,this.className),this.keyAttrId=t.result.keyAttrId.valueBlock.toString(),as in t.result&&(this.keyAttr=t.result.keyAttr)}toSchema(){const e=[];return e.push(new Ve({value:this.keyAttrId})),as in this&&e.push(this.keyAttr),new O({value:e})}toJSON(){const e={keyAttrId:this.keyAttrId};return as in this&&(e.keyAttr=this.keyAttr.toJSON()),e}}return s.CLASS_NAME="OtherKeyAttribute",s})();const ci="subjectKeyIdentifier",tr="date",sr="other",sv=[ci,tr,sr];let ch=(()=>{class s extends fe{constructor(e={}){super(),this.subjectKeyIdentifier=l(e,ci,s.defaultValues(ci)),tr in e&&(this.date=l(e,tr,s.defaultValues(tr))),sr in e&&(this.other=l(e,sr,s.defaultValues(sr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ci:return new de;case tr:return new ht;case sr:return new bn;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ci:return t.isEqual(s.defaultValues(ci));case tr:return 0===t.year&&0===t.month&&0===t.day&&0===t.hour&&0===t.minute&&0===t.second&&0===t.millisecond;case sr:return t.keyAttrId===v&&!("keyAttr"in t);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new de({name:t.subjectKeyIdentifier||v}),new ht({optional:!0,name:t.date||v}),bn.schema(t.other||{})]})}fromSchema(e){re(e,sv);const t=ue(e,e,s.schema({names:{subjectKeyIdentifier:ci,date:tr,other:{names:{blockName:sr}}}}));ae.assertSchema(t,this.className),this.subjectKeyIdentifier=t.result.subjectKeyIdentifier,tr in t.result&&(this.date=t.result.date),sr in t.result&&(this.other=new bn({schema:t.result.other}))}toSchema(){const e=[];return e.push(this.subjectKeyIdentifier),this.date&&e.push(this.date),this.other&&e.push(this.other.toSchema()),new O({value:e})}toJSON(){const e={subjectKeyIdentifier:this.subjectKeyIdentifier.toJSON()};return this.date&&(e.date=this.date.toJSON()),this.other&&(e.other=this.other.toJSON()),e}}return s.CLASS_NAME="RecipientKeyIdentifier",s})();const _c="variant",Cc="value",rv=["blockName"];let nl=(()=>{class s extends fe{constructor(e={}){super(),this.variant=l(e,_c,s.defaultValues(_c)),this.value=l(e,Cc,s.defaultValues(Cc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case _c:return-1;case Cc:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case _c:return-1===t;case Cc:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new ft({value:[xt.schema(t.issuerAndSerialNumber||{names:{blockName:t.blockName||v}}),new q({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:0},value:ch.schema(t.rKeyId||{names:{blockName:t.blockName||v}}).valueBlock.value})]})}fromSchema(e){re(e,rv);const t=ue(e,e,s.schema({names:{blockName:"blockName"}}));ae.assertSchema(t,this.className),1===t.result.blockName.idBlock.tagClass?(this.variant=1,this.value=new xt({schema:t.result.blockName})):(this.variant=2,this.value=new ch({schema:new O({value:t.result.blockName.valueBlock.value})}))}toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return new q({idBlock:{tagClass:3,tagNumber:0},value:this.value.toSchema().valueBlock.value});default:return new Fe}}toJSON(){const e={variant:this.variant};return(1===this.variant||2===this.variant)&&(e.value=this.value.toJSON()),e}}return s.CLASS_NAME="KeyAgreeRecipientIdentifier",s})();const An="rid",ui="encryptedKey",iv=[An,ui];let uh=(()=>{class s extends fe{constructor(e={}){super(),this.rid=l(e,An,s.defaultValues(An)),this.encryptedKey=l(e,ui,s.defaultValues(ui)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case An:return new nl;case ui:return new de;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case An:return-1===t.variant&&!("value"in t);case ui:return t.isEqual(s.defaultValues(ui));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[nl.schema(t.rid||{}),new de({name:t.encryptedKey||v})]})}fromSchema(e){re(e,iv);const t=ue(e,e,s.schema({names:{rid:{names:{blockName:An}},encryptedKey:ui}}));ae.assertSchema(t,this.className),this.rid=new nl({schema:t.result.rid}),this.encryptedKey=t.result.encryptedKey}toSchema(){return new O({value:[this.rid.toSchema(),this.encryptedKey]})}toJSON(){return{rid:this.rid.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}return s.CLASS_NAME="RecipientEncryptedKey",s})();const Nc="encryptedKeys",qd="RecipientEncryptedKeys",nv=[qd];let Ic=(()=>{class s extends fe{constructor(e={}){super(),this.encryptedKeys=l(e,Nc,s.defaultValues(Nc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Nc?[]:super.defaultValues(e)}static compareWithDefault(e,t){return e===Nc?0===t.length:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ge({name:t.RecipientEncryptedKeys||v,value:uh.schema()})]})}fromSchema(e){re(e,nv);const t=ue(e,e,s.schema({names:{RecipientEncryptedKeys:qd}}));ae.assertSchema(t,this.className),this.encryptedKeys=Array.from(t.result.RecipientEncryptedKeys,r=>new uh({schema:r}))}toSchema(){return new O({value:Array.from(this.encryptedKeys,e=>e.toSchema())})}toJSON(){return{encryptedKeys:Array.from(this.encryptedKeys,e=>e.toJSON())}}}return s.CLASS_NAME="RecipientEncryptedKeys",s})();const En="version",kn="originator",ws="ukm",_n="keyEncryptionAlgorithm",Cn="recipientEncryptedKeys",Bc="recipientCertificate",Rc="recipientPublicKey",av=[En,kn,ws,_n,Cn];let hh=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,En,s.defaultValues(En)),this.originator=l(e,kn,s.defaultValues(kn)),ws in e&&(this.ukm=l(e,ws,s.defaultValues(ws))),this.keyEncryptionAlgorithm=l(e,_n,s.defaultValues(_n)),this.recipientEncryptedKeys=l(e,Cn,s.defaultValues(Cn)),this.recipientCertificate=l(e,Bc,s.defaultValues(Bc)),this.recipientPublicKey=l(e,Rc,s.defaultValues(Rc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case En:return 0;case kn:return new kc;case ws:return new de;case _n:return new X;case Cn:return new Ic;case Bc:return new zt;case Rc:return null;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case En:return 0===t;case kn:return-1===t.variant&&!("value"in t);case ws:return t.isEqual(s.defaultValues(ws));case _n:return t.algorithmId===v&&!("algorithmParams"in t);case Cn:return 0===t.encryptedKeys.length;case Bc:case Rc:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.version||v}),new q({idBlock:{tagClass:3,tagNumber:0},value:[kc.schema(t.originator||{})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new de({name:t.ukm||v})]}),X.schema(t.keyEncryptionAlgorithm||{}),Ic.schema(t.recipientEncryptedKeys||{})]})}fromSchema(e){re(e,av);const t=ue(e,e,s.schema({names:{version:En,originator:{names:{blockName:kn}},ukm:ws,keyEncryptionAlgorithm:{names:{blockName:_n}},recipientEncryptedKeys:{names:{blockName:Cn}}}}));ae.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.originator=new kc({schema:t.result.originator}),ws in t.result&&(this.ukm=t.result.ukm),this.keyEncryptionAlgorithm=new X({schema:t.result.keyEncryptionAlgorithm}),this.recipientEncryptedKeys=new Ic({schema:t.result.recipientEncryptedKeys})}toSchema(){const e=[];return e.push(new Y({value:this.version})),e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[this.originator.toSchema()]})),this.ukm&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[this.ukm]})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.recipientEncryptedKeys.toSchema()),new O({value:e})}toJSON(){const e={version:this.version,originator:this.originator.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),recipientEncryptedKeys:this.recipientEncryptedKeys.toJSON()};return this.ukm&&(e.ukm=this.ukm.toJSON()),e}}return s.CLASS_NAME="KeyAgreeRecipientInfo",s})();const hi="keyIdentifier",rr="date",ir="other",ov=[hi,rr,ir];let Tc=(()=>{class s extends fe{constructor(e={}){super(),this.keyIdentifier=l(e,hi,s.defaultValues(hi)),rr in e&&(this.date=l(e,rr,s.defaultValues(rr))),ir in e&&(this.other=l(e,ir,s.defaultValues(ir))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hi:return new de;case rr:return new ht;case ir:return new bn;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case hi:return t.isEqual(s.defaultValues(hi));case rr:return 0===t.year&&0===t.month&&0===t.day&&0===t.hour&&0===t.minute&&0===t.second&&0===t.millisecond;case ir:return t.compareWithDefault("keyAttrId",t.keyAttrId)&&!("keyAttr"in t);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new de({name:t.keyIdentifier||v}),new ht({optional:!0,name:t.date||v}),bn.schema(t.other||{})]})}fromSchema(e){re(e,ov);const t=ue(e,e,s.schema({names:{keyIdentifier:hi,date:rr,other:{names:{blockName:ir}}}}));ae.assertSchema(t,this.className),this.keyIdentifier=t.result.keyIdentifier,rr in t.result&&(this.date=t.result.date),ir in t.result&&(this.other=new bn({schema:t.result.other}))}toSchema(){const e=[];return e.push(this.keyIdentifier),this.date&&e.push(this.date),this.other&&e.push(this.other.toSchema()),new O({value:e})}toJSON(){const e={keyIdentifier:this.keyIdentifier.toJSON()};return this.date&&(e.date=this.date),this.other&&(e.other=this.other.toJSON()),e}}return s.CLASS_NAME="KEKIdentifier",s})();const Nn="version",In="kekid",Bn="keyEncryptionAlgorithm",fi="encryptedKey",xc="preDefinedKEK",lv=[Nn,In,Bn,fi];let fh=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,Nn,s.defaultValues(Nn)),this.kekid=l(e,In,s.defaultValues(In)),this.keyEncryptionAlgorithm=l(e,Bn,s.defaultValues(Bn)),this.encryptedKey=l(e,fi,s.defaultValues(fi)),this.preDefinedKEK=l(e,xc,s.defaultValues(xc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Nn:return 0;case In:return new Tc;case Bn:return new X;case fi:return new de;case xc:return Ct;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"KEKRecipientInfo":return t===s.defaultValues(Nn);case In:return t.compareWithDefault("keyIdentifier",t.keyIdentifier)&&!("date"in t)&&!("other"in t);case Bn:return t.algorithmId===v&&!("algorithmParams"in t);case fi:return t.isEqual(s.defaultValues(fi));case xc:return 0===t.byteLength;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.version||v}),Tc.schema(t.kekid||{}),X.schema(t.keyEncryptionAlgorithm||{}),new de({name:t.encryptedKey||v})]})}fromSchema(e){re(e,lv);const t=ue(e,e,s.schema({names:{version:Nn,kekid:{names:{blockName:In}},keyEncryptionAlgorithm:{names:{blockName:Bn}},encryptedKey:fi}}));ae.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.kekid=new Tc({schema:t.result.kekid}),this.keyEncryptionAlgorithm=new X({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){return new O({value:[new Y({value:this.version}),this.kekid.toSchema(),this.keyEncryptionAlgorithm.toSchema(),this.encryptedKey]})}toJSON(){return{version:this.version,kekid:this.kekid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}return s.CLASS_NAME="KEKRecipientInfo",s})();const Rn="version",nr="keyDerivationAlgorithm",Tn="keyEncryptionAlgorithm",di="encryptedKey",Vc="password",cv=[Rn,nr,Tn,di];let dh=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,Rn,s.defaultValues(Rn)),nr in e&&(this.keyDerivationAlgorithm=l(e,nr,s.defaultValues(nr))),this.keyEncryptionAlgorithm=l(e,Tn,s.defaultValues(Tn)),this.encryptedKey=l(e,di,s.defaultValues(di)),this.password=l(e,Vc,s.defaultValues(Vc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Rn:return-1;case nr:case Tn:return new X;case di:return new de;case Vc:return Ct;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Rn:return-1===t;case nr:case Tn:return t.algorithmId===v&&!("algorithmParams"in t);case di:return t.isEqual(s.defaultValues(di));case Vc:return 0===t.byteLength;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.version||v}),new q({name:t.keyDerivationAlgorithm||v,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:X.schema().valueBlock.value}),X.schema(t.keyEncryptionAlgorithm||{}),new de({name:t.encryptedKey||v})]})}fromSchema(e){re(e,cv);const t=ue(e,e,s.schema({names:{version:Rn,keyDerivationAlgorithm:nr,keyEncryptionAlgorithm:{names:{blockName:Tn}},encryptedKey:di}}));ae.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,nr in t.result&&(this.keyDerivationAlgorithm=new X({schema:new O({value:t.result.keyDerivationAlgorithm.valueBlock.value})})),this.keyEncryptionAlgorithm=new X({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){const e=[];return e.push(new Y({value:this.version})),this.keyDerivationAlgorithm&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:this.keyDerivationAlgorithm.toSchema().valueBlock.value})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new O({value:e})}toJSON(){const e={version:this.version,keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()};return this.keyDerivationAlgorithm&&(e.keyDerivationAlgorithm=this.keyDerivationAlgorithm.toJSON()),e}}return s.CLASS_NAME="PasswordRecipientInfo",s})();const xn="oriType",mi="oriValue",uv=[xn,mi];let Wd=(()=>{class s extends fe{constructor(e={}){super(),this.oriType=l(e,xn,s.defaultValues(xn)),this.oriValue=l(e,mi,s.defaultValues(mi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xn:return v;case mi:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case xn:return t===v;case mi:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.oriType||v}),new Fe({name:t.oriValue||v})]})}fromSchema(e){re(e,uv);const t=ue(e,e,s.schema({names:{oriType:xn,oriValue:mi}}));ae.assertSchema(t,this.className),this.oriType=t.result.oriType.valueBlock.toString(),this.oriValue=t.result.oriValue}toSchema(){return new O({value:[new Ve({value:this.oriType}),this.oriValue]})}toJSON(){const e={oriType:this.oriType};return s.compareWithDefault(mi,this.oriValue)||(e.oriValue=this.oriValue.toJSON()),e}}return s.CLASS_NAME="OtherRecipientInfo",s})();const Oc="variant",al="value",hv=["blockName"];let Vn=(()=>{class s extends fe{constructor(e={}){super(),this.variant=l(e,Oc,s.defaultValues(Oc)),al in e&&(this.value=l(e,al,s.defaultValues(al))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Oc:return-1;case al:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Oc:return t===s.defaultValues(e);case al:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new ft({value:[oh.schema({names:{blockName:t.blockName||v}}),new q({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:1},value:hh.schema().valueBlock.value}),new q({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:2},value:fh.schema().valueBlock.value}),new q({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:3},value:dh.schema().valueBlock.value}),new q({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:4},value:Wd.schema().valueBlock.value})]})}fromSchema(e){re(e,hv);const t=ue(e,e,s.schema({names:{blockName:"blockName"}}));if(ae.assertSchema(t,this.className),1===t.result.blockName.idBlock.tagClass)this.variant=1,this.value=new oh({schema:t.result.blockName});else{const r=new O({value:t.result.blockName.valueBlock.value});switch(t.result.blockName.idBlock.tagNumber){case 1:this.variant=2,this.value=new hh({schema:r});break;case 2:this.variant=3,this.value=new fh({schema:r});break;case 3:this.variant=4,this.value=new dh({schema:r});break;case 4:this.variant=5,this.value=new Wd({schema:r});break;default:throw new Error("Incorrect structure of RecipientInfo block")}}}toSchema(){tt.assertEmpty(this.value,"value","RecipientInfo");const e=this.value.toSchema();switch(this.variant){case 1:return e;case 2:case 3:case 4:return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.variant-1,e;default:return new Fe}}toJSON(){const e={variant:this.variant};return this.value&&this.variant>=1&&this.variant<=4&&(e.value=this.value.toJSON()),e}}return s.CLASS_NAME="RecipientInfo",s})();const ar="hashAlgorithm",or="maskGenAlgorithm",lr="pSourceAlgorithm",fv=[ar,or,lr];let mh=(()=>{class s extends fe{constructor(e={}){super(),this.hashAlgorithm=l(e,ar,s.defaultValues(ar)),this.maskGenAlgorithm=l(e,or,s.defaultValues(or)),this.pSourceAlgorithm=l(e,lr,s.defaultValues(lr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ar:return new X({algorithmId:"1.3.14.3.2.26",algorithmParams:new kt});case or:return new X({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new X({algorithmId:"1.3.14.3.2.26",algorithmParams:new kt}).toSchema()});case lr:return new X({algorithmId:"1.2.840.113549.1.1.9",algorithmParams:new de({valueHex:new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer})});default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[X.schema(t.hashAlgorithm||{})]}),new q({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[X.schema(t.maskGenAlgorithm||{})]}),new q({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[X.schema(t.pSourceAlgorithm||{})]})]})}fromSchema(e){re(e,fv);const t=ue(e,e,s.schema({names:{hashAlgorithm:{names:{blockName:ar}},maskGenAlgorithm:{names:{blockName:or}},pSourceAlgorithm:{names:{blockName:lr}}}}));ae.assertSchema(t,this.className),ar in t.result&&(this.hashAlgorithm=new X({schema:t.result.hashAlgorithm})),or in t.result&&(this.maskGenAlgorithm=new X({schema:t.result.maskGenAlgorithm})),lr in t.result&&(this.pSourceAlgorithm=new X({schema:t.result.pSourceAlgorithm}))}toSchema(){const e=[];return this.hashAlgorithm.isEqual(s.defaultValues(ar))||e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(s.defaultValues(or))||e.push(new q({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.pSourceAlgorithm.isEqual(s.defaultValues(lr))||e.push(new q({idBlock:{tagClass:3,tagNumber:2},value:[this.pSourceAlgorithm.toSchema()]})),new O({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(s.defaultValues(ar))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(s.defaultValues(or))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.pSourceAlgorithm.isEqual(s.defaultValues(lr))||(e.pSourceAlgorithm=this.pSourceAlgorithm.toJSON()),e}}return s.CLASS_NAME="RSAESOAEPParams",s})();const On="keyInfo",cr="entityUInfo",Pn="suppPubInfo",dv=[On,cr,Pn];let zd=(()=>{class s extends fe{constructor(e={}){super(),this.keyInfo=l(e,On,s.defaultValues(On)),cr in e&&(this.entityUInfo=l(e,cr,s.defaultValues(cr))),this.suppPubInfo=l(e,Pn,s.defaultValues(Pn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case On:return new X;case cr:case Pn:return new de;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case On:case cr:case Pn:return t.isEqual(s.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[X.schema(t.keyInfo||{}),new q({name:t.entityUInfo||v,idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[new de]}),new q({name:t.suppPubInfo||v,idBlock:{tagClass:3,tagNumber:2},value:[new de]})]})}fromSchema(e){re(e,dv);const t=ue(e,e,s.schema({names:{keyInfo:{names:{blockName:On}},entityUInfo:cr,suppPubInfo:Pn}}));ae.assertSchema(t,this.className),this.keyInfo=new X({schema:t.result.keyInfo}),cr in t.result&&(this.entityUInfo=t.result.entityUInfo.valueBlock.value[0]),this.suppPubInfo=t.result.suppPubInfo.valueBlock.value[0]}toSchema(){const e=[];return e.push(this.keyInfo.toSchema()),this.entityUInfo&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[this.entityUInfo]})),e.push(new q({idBlock:{tagClass:3,tagNumber:2},value:[this.suppPubInfo]})),new O({value:e})}toJSON(){const e={keyInfo:this.keyInfo.toJSON(),suppPubInfo:this.suppPubInfo.toJSON()};return this.entityUInfo&&(e.entityUInfo=this.entityUInfo.toJSON()),e}}return s.CLASS_NAME="ECCCMSSharedInfo",s})();const Dn="version",ur="originatorInfo",Un="recipientInfos",Mn="encryptedContentInfo",hr="unprotectedAttrs",mv=[Dn,ur,Un,Mn,hr],Yd={kdfAlgorithm:"SHA-512",kekEncryptionLength:256},gv={"P-256":256,"P-384":384,"P-521":528};let Xd=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,Dn,s.defaultValues(Dn)),ur in e&&(this.originatorInfo=l(e,ur,s.defaultValues(ur))),this.recipientInfos=l(e,Un,s.defaultValues(Un)),this.encryptedContentInfo=l(e,Mn,s.defaultValues(Mn)),hr in e&&(this.unprotectedAttrs=l(e,hr,s.defaultValues(hr))),this.policy={disableSplit:!!e.disableSplit},e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Dn:return 0;case ur:return new ah;case Un:return[];case Mn:return new Dt;case hr:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Dn:return t===s.defaultValues(e);case ur:return 0===t.certs.certificates.length&&0===t.crls.crls.length;case Un:case hr:return 0===t.length;case Mn:return Dt.compareWithDefault("contentType",t.contentType)&&Dt.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&Dt.compareWithDefault("encryptedContent",t.encryptedContent);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.version||v}),new q({name:t.originatorInfo||v,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:ah.schema().valueBlock.value}),new _t({value:[new Ge({name:t.recipientInfos||v,value:Vn.schema()})]}),Dt.schema(t.encryptedContentInfo||{}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Ge({name:t.unprotectedAttrs||v,value:st.schema()})]})]})}fromSchema(e){re(e,mv);const t=ue(e,e,s.schema({names:{version:Dn,originatorInfo:ur,recipientInfos:Un,encryptedContentInfo:{names:{blockName:Mn}},unprotectedAttrs:hr}}));ae.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,ur in t.result&&(this.originatorInfo=new ah({schema:new O({value:t.result.originatorInfo.valueBlock.value})})),this.recipientInfos=Array.from(t.result.recipientInfos,r=>new Vn({schema:r})),this.encryptedContentInfo=new Dt({schema:t.result.encryptedContentInfo}),hr in t.result&&(this.unprotectedAttrs=Array.from(t.result.unprotectedAttrs,r=>new st({schema:r})))}toSchema(){const e=[];return e.push(new Y({value:this.version})),this.originatorInfo&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:this.originatorInfo.toSchema().valueBlock.value})),e.push(new _t({value:Array.from(this.recipientInfos,t=>t.toSchema())})),e.push(this.encryptedContentInfo.toSchema()),this.unprotectedAttrs&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={version:this.version,recipientInfos:Array.from(this.recipientInfos,t=>t.toJSON()),encryptedContentInfo:this.encryptedContentInfo.toJSON()};return this.originatorInfo&&(e.originatorInfo=this.originatorInfo.toJSON()),this.unprotectedAttrs&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,t=>t.toJSON())),e}addRecipientByCertificate(e,t,r,a=Je(!0)){const o=Object.assign({useOAEP:!0,oaepHashAlgorithm:"SHA-512"},Yd,t||{});if(-1!==e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.113549"))r=1;else{if(-1===e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.10045"))throw new Error(`Unknown type of certificate's public key: ${e.subjectPublicKeyInfo.algorithm.algorithmId}`);r=2}switch(r){case 1:{let u,h;if(!0===o.useOAEP){u=a.getOIDByAlgorithm({name:"RSA-OAEP"},!0,"keyEncryptionAlgorithm");const N=a.getOIDByAlgorithm({name:o.oaepHashAlgorithm},!0,"RSAES-OAEP-params"),T=new X({algorithmId:N,algorithmParams:new kt});h=new mh({hashAlgorithm:T,maskGenAlgorithm:new X({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:T.toSchema()})}).toSchema()}else{if(u=a.getOIDByAlgorithm({name:"RSAES-PKCS1-v1_5"}),u===v)throw new Error("Can not find OID for RSAES-PKCS1-v1_5");h=new kt}const m=new oh({version:0,rid:new xt({issuer:e.issuer,serialNumber:e.serialNumber}),keyEncryptionAlgorithm:new X({algorithmId:u,algorithmParams:h}),recipientCertificate:e});this.recipientInfos.push(new Vn({variant:1,value:m}))}break;case 2:{const u=new nl({variant:1,value:new xt({issuer:e.issuer,serialNumber:e.serialNumber})});this._addKeyAgreeRecipientInfo(u,o,{recipientCertificate:e},a)}break;default:throw new Error(`Unknown "variant" value: ${r}`)}return!0}addRecipientByPreDefinedData(e,t={},r,a=Je(!0)){if(ot.assert(e,"preDefinedData","ArrayBuffer"),!e.byteLength)throw new Error("Pre-defined data could have zero length");if(!t.keyIdentifier){const o=new ArrayBuffer(16),u=new Uint8Array(o);a.getRandomValues(u),t.keyIdentifier=o}switch(t.hmacHashAlgorithm||(t.hmacHashAlgorithm="SHA-512"),void 0===t.iterationCount&&(t.iterationCount=2048),t.keyEncryptionAlgorithm||(t.keyEncryptionAlgorithm={name:"AES-KW",length:256}),t.keyEncryptionAlgorithmParams||(t.keyEncryptionAlgorithmParams=new kt),r){case 1:{const o=a.getOIDByAlgorithm(t.keyEncryptionAlgorithm,!0,"keyEncryptionAlgorithm"),u=new fh({version:4,kekid:new Tc({keyIdentifier:new de({valueHex:t.keyIdentifier})}),keyEncryptionAlgorithm:new X({algorithmId:o,algorithmParams:t.keyEncryptionAlgorithmParams}),preDefinedKEK:e});this.recipientInfos.push(new Vn({variant:3,value:u}))}break;case 2:{const o=a.getOIDByAlgorithm({name:"PBKDF2"},!0,"keyDerivationAlgorithm"),u=new ArrayBuffer(64),h=new Uint8Array(u);a.getRandomValues(h);const m=a.getOIDByAlgorithm({name:"HMAC",hash:{name:t.hmacHashAlgorithm}},!0,"hmacHashAlgorithm"),N=new so({salt:new de({valueHex:u}),iterationCount:t.iterationCount,prf:new X({algorithmId:m,algorithmParams:new kt})}),T=a.getOIDByAlgorithm(t.keyEncryptionAlgorithm,!0,"keyEncryptionAlgorithm"),K=new dh({version:0,keyDerivationAlgorithm:new X({algorithmId:o,algorithmParams:N.toSchema()}),keyEncryptionAlgorithm:new X({algorithmId:T,algorithmParams:t.keyEncryptionAlgorithmParams}),password:e});this.recipientInfos.push(new Vn({variant:4,value:K}))}break;default:throw new Error(`Unknown value for "variant": ${r}`)}}addRecipientByKeyIdentifier(e,t,r,a=Je(!0)){const o=Object.assign({},Yd,r||{}),u=new nl({variant:2,value:new ch({subjectKeyIdentifier:new de({valueHex:t})})});this._addKeyAgreeRecipientInfo(u,o,{recipientPublicKey:e},a)}_addKeyAgreeRecipientInfo(e,t,r,a=Je(!0)){const o=new uh({rid:e}),u=a.getOIDByAlgorithm({name:"AES-KW",length:t.kekEncryptionLength},!0,"keyEncryptionAlgorithm"),h=new X({algorithmId:u}),m=a.getOIDByAlgorithm({name:"ECDH",kdf:t.kdfAlgorithm},!0,"KeyAgreeRecipientInfo"),N=new ArrayBuffer(64),T=new Uint8Array(N);a.getRandomValues(T);const K={version:3,ukm:new de({valueHex:N}),keyEncryptionAlgorithm:new X({algorithmId:m,algorithmParams:h.toSchema()}),recipientEncryptedKeys:new Ic({encryptedKeys:[o]})},F=new hh(Object.assign(K,r));this.recipientInfos.push(new Vn({variant:2,value:F}))}encrypt(e,t,r=Je(!0)){var a=this;return(0,k.A)(function*(){const o=new ArrayBuffer(16),u=new Uint8Array(o);r.getRandomValues(u);const h=new Uint8Array(t),m=r.getOIDByAlgorithm(e,!0,"contentEncryptionAlgorithm"),N=yield r.generateKey(e,!0,["encrypt"]),T=yield r.encrypt({name:e.name,iv:u},N,h),K=yield r.exportKey("raw",N);a.version=2,a.encryptedContentInfo=new Dt({disableSplit:a.policy.disableSplit,contentType:"1.2.840.113549.1.7.1",contentEncryptionAlgorithm:new X({algorithmId:m,algorithmParams:new de({valueHex:o})}),encryptedContent:new de({valueHex:T})});const F=function(){var Se=(0,k.A)(function*(ne){const oe=a.recipientInfos[ne].value;let pe,Ae;if(oe.recipientPublicKey)pe=oe.recipientPublicKey.algorithm.namedCurve,Ae=oe.recipientPublicKey;else{if(!oe.recipientCertificate)throw new Error("Unsupported RecipientInfo");{const Pe=oe.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(Pe.constructor.blockName()!==Ve.blockName())throw new Error(`Incorrect "recipientCertificate" for index ${ne}`);switch(Pe.valueBlock.toString()){case"1.2.840.10045.3.1.7":pe="P-256";break;case"1.3.132.0.34":pe="P-384";break;case"1.3.132.0.35":pe="P-521";break;default:throw new Error(`Incorrect curve OID for index ${ne}`)}Ae=yield oe.recipientCertificate.getPublicKey({algorithm:{algorithm:{name:"ECDH",namedCurve:pe},usages:[]}},r)}}const Te=gv[pe],xe=yield r.generateKey({name:"ECDH",namedCurve:pe},!0,["deriveBits"]),Me=yield r.exportKey("spki",xe.publicKey),Ye=yield r.deriveBits({name:"ECDH",public:Ae},xe.privateKey,Te),At=new X({schema:oe.keyEncryptionAlgorithm.algorithmParams}),Xe=r.getAlgorithmByOID(At.algorithmId,!0,"aesKWAlgorithm");let lt=Xe.length;const jt=new ArrayBuffer(4),Ot=new Uint8Array(jt);for(let Pe=3;Pe>=0;Pe--)Ot[Pe]=lt,lt>>=8;const Es=new zd({keyInfo:new X({algorithmId:At.algorithmId}),entityUInfo:oe.ukm,suppPubInfo:new de({valueHex:jt})}).toSchema().toBER(!1),Yt=r.getAlgorithmByOID(oe.keyEncryptionAlgorithm.algorithmId,!0,"ecdhAlgorithm"),ut=yield xd(Yt.kdf,Ye,Xe.length,Es,r),nt=yield r.importKey("raw",ut,{name:"AES-KW"},!0,["wrapKey"]),De=yield r.wrapKey("raw",N,nt,{name:"AES-KW"}),je=new kc;return je.variant=3,je.value=lh.fromBER(Me),oe.originator=je,oe.recipientEncryptedKeys.encryptedKeys[0].encryptedKey=new de({valueHex:De}),{ecdhPrivateKey:xe.privateKey}});return function(oe){return Se.apply(this,arguments)}}(),se=function(){var Se=(0,k.A)(function*(ne){const oe=a.recipientInfos[ne].value,pe=r.getAlgorithmByOID(oe.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm");if("RSA-OAEP"===pe.name){const Te=new mh({schema:oe.keyEncryptionAlgorithm.algorithmParams});if(pe.hash=r.getAlgorithmByOID(Te.hashAlgorithm.algorithmId),!("name"in pe.hash))throw new Error(`Incorrect OID for hash algorithm: ${Te.hashAlgorithm.algorithmId}`)}try{const Ae=yield oe.recipientCertificate.getPublicKey({algorithm:{algorithm:pe,usages:["encrypt","wrapKey"]}},r),Te=yield r.encrypt(Ae.algorithm,Ae,K);oe.encryptedKey=new de({valueHex:Te})}catch{}});return function(oe){return Se.apply(this,arguments)}}(),Ee=function(){var Se=(0,k.A)(function*(ne){const oe=a.recipientInfos[ne].value,pe=r.getAlgorithmByOID(oe.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm"),Ae=yield r.importKey("raw",new Uint8Array(oe.preDefinedKEK),pe,!0,["wrapKey"]),Te=yield r.wrapKey("raw",N,Ae,pe);oe.encryptedKey=new de({valueHex:Te})});return function(oe){return Se.apply(this,arguments)}}(),ye=function(){var Se=(0,k.A)(function*(ne){const oe=a.recipientInfos[ne].value;let pe;if(!oe.keyDerivationAlgorithm)throw new Error('Please append encoded "keyDerivationAlgorithm"');if(!oe.keyDerivationAlgorithm.algorithmParams)throw new Error('Incorrectly encoded "keyDerivationAlgorithm"');try{pe=new so({schema:oe.keyDerivationAlgorithm.algorithmParams})}catch{throw new Error('Incorrectly encoded "keyDerivationAlgorithm"')}const Ae=new Uint8Array(oe.password),Te=yield r.importKey("raw",Ae,"PBKDF2",!1,["deriveKey"]),xe=r.getAlgorithmByOID(oe.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm");let Me="SHA-1";pe.prf&&(Me=r.getAlgorithmByOID(pe.prf.algorithmId,!0,"prfAlgorithm").hash.name);const Ye=new Uint8Array(pe.salt.valueBlock.valueHex),At=pe.iterationCount,Xe=yield r.deriveKey({name:"PBKDF2",hash:{name:Me},salt:Ye,iterations:At},Te,xe,!0,["wrapKey"]),lt=yield r.wrapKey("raw",N,Xe,xe);oe.encryptedKey=new de({valueHex:lt})});return function(oe){return Se.apply(this,arguments)}}(),ee=[];for(let Se=0;Se<a.recipientInfos.length;Se++)switch(a.recipientInfos[Se].variant){case 1:ee.push(yield se(Se));break;case 2:ee.push(yield F(Se));break;case 3:ee.push(yield Ee(Se));break;case 4:ee.push(yield ye(Se));break;default:throw new Error(`Unknown recipient type in array with index ${Se}`)}return ee})()}decrypt(e,t,r=Je(!0)){var a=this;return(0,k.A)(function*(){const o=t||{};if(e+1>a.recipientInfos.length)throw new Error('Maximum value for "index" is: '+(a.recipientInfos.length-1));const u=function(){var ee=(0,k.A)(function*(Se){const ne=a.recipientInfos[Se].value;let oe,pe,Ae;const Te=ne.originator;if(o.recipientCertificate){const ut=o.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(ut.constructor.blockName()!==Ve.blockName())throw new Error(`Incorrect "recipientCertificate" for index ${Se}`);oe=ut.valueBlock.toString()}else{if(!Te.value.algorithm.algorithmParams)throw new Error('Parameter "recipientCertificate" is mandatory for "KeyAgreeRecipientInfo" if algorithm params are missing from originator');{const ut=Te.value.algorithm.algorithmParams;if(ut.constructor.blockName()!==Ve.blockName())throw new Error(`Incorrect originator for index ${Se}`);oe=ut.valueBlock.toString()}}if(!o.recipientPrivateKey)throw new Error('Parameter "recipientPrivateKey" is mandatory for "KeyAgreeRecipientInfo"');switch(oe){case"1.2.840.10045.3.1.7":pe="P-256",Ae=256;break;case"1.3.132.0.34":pe="P-384",Ae=384;break;case"1.3.132.0.35":pe="P-521",Ae=528;break;default:throw new Error(`Incorrect curve OID for index ${Se}`)}let xe,Me=r;b._H.isBufferSource(o.recipientPrivateKey)?xe=yield r.importKey("pkcs8",o.recipientPrivateKey,{name:"ECDH",namedCurve:pe},!0,["deriveBits"]):(xe=o.recipientPrivateKey,"crypto"in o&&o.crypto&&(Me=o.crypto.subtle)),"algorithmParams"in Te.value.algorithm||(Te.value.algorithm.algorithmParams=new Ve({value:oe}));const Ye=Te.value.toSchema().toBER(!1),At=yield r.importKey("spki",Ye,{name:"ECDH",namedCurve:pe},!0,[]),Xe=yield Me.deriveBits({name:"ECDH",public:At},xe,Ae);function lt(ut){return jt.apply(this,arguments)}function jt(){return(jt=(0,k.A)(function*(ut){ut=ut||!1;const nt=new X({schema:ne.keyEncryptionAlgorithm.algorithmParams}),De=r.getAlgorithmByOID(nt.algorithmId,!0,"kwAlgorithm");let je=De.length;const Pe=new ArrayBuffer(4),We=new Uint8Array(Pe);for(let Ze=3;Ze>=0;Ze--)We[Ze]=je,je>>=8;const rt={algorithmId:nt.algorithmId};ut&&(rt.algorithmParams=new kt);const ss=new zd({keyInfo:new X(rt),entityUInfo:ne.ukm,suppPubInfo:new de({valueHex:Pe})}).toSchema().toBER(!1),mt=r.getAlgorithmByOID(ne.keyEncryptionAlgorithm.algorithmId,!0,"ecdhAlgorithm");if(!mt.name)throw new Error(`Incorrect OID for key encryption algorithm: ${ne.keyEncryptionAlgorithm.algorithmId}`);return xd(mt.kdf,Xe,De.length,ss,r)})).apply(this,arguments)}const Ot=yield lt(),Pi=function(){var ut=(0,k.A)(function*(nt){return r.importKey("raw",nt,{name:"AES-KW"},!0,["unwrapKey"])});return function(De){return ut.apply(this,arguments)}}(),Es=yield Pi(Ot),Yt=function(){var ut=(0,k.A)(function*(nt){const je=r.getAlgorithmByOID(a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,!0,"contentEncryptionAlgorithm");return r.unwrapKey("raw",ne.recipientEncryptedKeys.encryptedKeys[0].encryptedKey.valueBlock.valueHexView,nt,{name:"AES-KW"},je,!0,["decrypt"])});return function(De){return ut.apply(this,arguments)}}();try{return yield Yt(Es)}catch{const ut=yield lt(!0);return Yt(yield Pi(ut))}});return function(ne){return ee.apply(this,arguments)}}(),h=function(){var ee=(0,k.A)(function*(Se){const ne=a.recipientInfos[Se].value;if(!o.recipientPrivateKey)throw new Error('Parameter "recipientPrivateKey" is mandatory for "KeyTransRecipientInfo"');const oe=r.getAlgorithmByOID(ne.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm");if("RSA-OAEP"===oe.name){const At=new mh({schema:ne.keyEncryptionAlgorithm.algorithmParams});if(oe.hash=r.getAlgorithmByOID(At.hashAlgorithm.algorithmId),!("name"in oe.hash))throw new Error(`Incorrect OID for hash algorithm: ${At.hashAlgorithm.algorithmId}`)}let pe,Ae=r;b._H.isBufferSource(o.recipientPrivateKey)?pe=yield r.importKey("pkcs8",o.recipientPrivateKey,oe,!0,["decrypt"]):(pe=o.recipientPrivateKey,"crypto"in o&&o.crypto&&(Ae=o.crypto.subtle));const Te=yield Ae.decrypt(pe.algorithm,pe,ne.encryptedKey.valueBlock.valueHexView),xe=a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,Me=r.getAlgorithmByOID(xe,!0,"contentEncryptionAlgorithm");if(!("name"in Me))throw new Error(`Incorrect "contentEncryptionAlgorithm": ${xe}`);return r.importKey("raw",Te,Me,!0,["decrypt"])});return function(ne){return ee.apply(this,arguments)}}(),m=function(){var ee=(0,k.A)(function*(Se){const ne=a.recipientInfos[Se].value;if(!o.preDefinedData)throw new Error('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');const oe=r.getAlgorithmByOID(ne.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm"),pe=yield r.importKey("raw",o.preDefinedData,oe,!0,["unwrapKey"]),Ae=a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,Te=r.getAlgorithmByOID(Ae,!0,"contentEncryptionAlgorithm");if(!Te.name)throw new Error(`Incorrect "contentEncryptionAlgorithm": ${Ae}`);return r.unwrapKey("raw",ne.encryptedKey.valueBlock.valueHexView,pe,oe,Te,!0,["decrypt"])});return function(ne){return ee.apply(this,arguments)}}(),N=function(){var ee=(0,k.A)(function*(Se){const ne=a.recipientInfos[Se].value;let oe;if(!o.preDefinedData)throw new Error('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');if(!ne.keyDerivationAlgorithm)throw new Error('Please append encoded "keyDerivationAlgorithm"');if(!ne.keyDerivationAlgorithm.algorithmParams)throw new Error('Incorrectly encoded "keyDerivationAlgorithm"');try{oe=new so({schema:ne.keyDerivationAlgorithm.algorithmParams})}catch{throw new Error('Incorrectly encoded "keyDerivationAlgorithm"')}const pe=yield r.importKey("raw",o.preDefinedData,"PBKDF2",!1,["deriveKey"]),Ae=r.getAlgorithmByOID(ne.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm"),Te=oe.prf?r.getAlgorithmByOID(oe.prf.algorithmId,!0,"prfAlgorithm").hash.name:"SHA-1",xe=new Uint8Array(oe.salt.valueBlock.valueHex),Me=oe.iterationCount,Ye=yield r.deriveKey({name:"PBKDF2",hash:{name:Te},salt:xe,iterations:Me},pe,Ae,!0,["unwrapKey"]),Xe=r.getAlgorithmByOID(a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,!0,"contentEncryptionAlgorithm");return r.unwrapKey("raw",ne.encryptedKey.valueBlock.valueHexView,Ye,Ae,Xe,!0,["decrypt"])});return function(ne){return ee.apply(this,arguments)}}();let T;switch(a.recipientInfos[e].variant){case 1:T=yield h(e);break;case 2:T=yield u(e);break;case 3:T=yield m(e);break;case 4:T=yield N(e);break;default:throw new Error(`Unknown recipient type in array with index ${e}`)}const F=r.getAlgorithmByOID(a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,!0,"contentEncryptionAlgorithm"),Ee=new Uint8Array(a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams.valueBlock.valueHex);if(!a.encryptedContentInfo.encryptedContent)throw new Error("Required property `encryptedContent` is empty");const ye=a.encryptedContentInfo.getEncryptedContent();return r.decrypt({name:F.name,iv:Ee},T,ye)})()}}return s.CLASS_NAME="EnvelopedData",s})();const Ln="safeContents",ol="parsedValue",Qd="contentInfos";let gh=(()=>{class s extends fe{constructor(e={}){super(),this.safeContents=l(e,Ln,s.defaultValues(Ln)),ol in e&&(this.parsedValue=l(e,ol,s.defaultValues(ol))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ln:return[];case ol:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ln:return 0===t.length;case ol:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ge({name:t.contentInfos||v,value:Ut.schema()})]})}fromSchema(e){re(e,[Qd]);const t=ue(e,e,s.schema({names:{contentInfos:Qd}}));ae.assertSchema(t,this.className),this.safeContents=Array.from(t.result.contentInfos,r=>new Ut({schema:r}))}toSchema(){return new O({value:Array.from(this.safeContents,e=>e.toSchema())})}toJSON(){return{safeContents:Array.from(this.safeContents,e=>e.toJSON())}}parseInternalValues(e,t=Je(!0)){var r=this;return(0,k.A)(function*(){if(tt.assert(e,Ln),ot.assert(e.safeContents,Ln,"Array"),e.safeContents.length!==r.safeContents.length)throw new ot('Length of "parameters.safeContents" must be equal to "this.safeContents.length"');r.parsedValue={safeContents:[]};for(const[a,o]of r.safeContents.entries()){const u=e.safeContents[a],h=`parameters.safeContents[${a}]`;switch(o.contentType){case bu:{ot.assert(o.content,"this.safeContents[j].content",de);const m=o.content.getValue();r.parsedValue.safeContents.push({privacyMode:0,value:ai.fromBER(m)})}break;case id:{const m=new Xd({schema:o.content});tt.assert(h,u,"recipientCertificate","recipientKey");const T=u.recipientCertificate,K=u.recipientKey,F=yield m.decrypt(0,{recipientCertificate:T,recipientPrivateKey:K},t);r.parsedValue.safeContents.push({privacyMode:2,value:ai.fromBER(F)})}break;case nd:{const m=new wc({schema:o.content});tt.assert(h,u,"password");const N=u.password,T=yield m.decrypt({password:N},t);r.parsedValue.safeContents.push({privacyMode:1,value:ai.fromBER(T)})}break;default:throw new Error(`Unknown "contentType" for AuthenticatedSafe: " ${o.contentType}`)}}})()}makeInternalValues(e,t=Je(!0)){var r=this;return(0,k.A)(function*(){if(!r.parsedValue)throw new Error('Please run "parseValues" first or add "parsedValue" manually');if(ot.assert(r.parsedValue,"this.parsedValue","object"),ot.assert(r.parsedValue.safeContents,"this.parsedValue.safeContents","Array"),ot.assert(e,"parameters","object"),tt.assert(e,"safeContents"),ot.assert(e.safeContents,"parameters.safeContents","Array"),e.safeContents.length!==r.parsedValue.safeContents.length)throw new ot('Length of "parameters.safeContents" must be equal to "this.parsedValue.safeContents"');r.safeContents=[];for(const[a,o]of r.parsedValue.safeContents.entries())switch(tt.assert("content",o,"privacyMode","value"),ot.assert(o.value,"content.value",ai),o.privacyMode){case 0:{const u=o.value.toSchema().toBER(!1);r.safeContents.push(new Ut({contentType:"1.2.840.113549.1.7.1",content:new de({valueHex:u})}))}break;case 1:{const u=new wc,h=e.safeContents[a];h.contentToEncrypt=o.value.toSchema().toBER(!1),yield u.encrypt(h,t),r.safeContents.push(new Ut({contentType:"1.2.840.113549.1.7.6",content:u.toSchema()}))}break;case 2:{const u=new Xd,h=o.value.toSchema().toBER(!1),m=e.safeContents[a];switch(tt.assert(`parameters.safeContents[${a}]`,m,"encryptingCertificate","encryptionAlgorithm"),!0){case"aes-cbc"===m.encryptionAlgorithm.name.toLowerCase():case"aes-gcm"===m.encryptionAlgorithm.name.toLowerCase():break;default:throw new Error(`Incorrect parameter "encryptionAlgorithm" in "parameters.safeContents[i]": ${m.encryptionAlgorithm}`)}switch(!0){case 128===m.encryptionAlgorithm.length:case 192===m.encryptionAlgorithm.length:case 256===m.encryptionAlgorithm.length:break;default:throw new Error(`Incorrect parameter "encryptionAlgorithm.length" in "parameters.safeContents[i]": ${m.encryptionAlgorithm.length}`)}const N=m.encryptionAlgorithm;u.addRecipientByCertificate(m.encryptingCertificate,{},void 0,t),yield u.encrypt(N,h,t),r.safeContents.push(new Ut({contentType:"1.2.840.113549.1.7.3",content:u.toSchema()}))}break;default:throw new Error(`Incorrect value for "content.privacyMode": ${o.privacyMode}`)}return r})()}}return s.CLASS_NAME="AuthenticatedSafe",s})();const gi="hashAlgorithm",Fn="issuerNameHash",Hn="issuerKeyHash",pi="serialNumber",pv=[gi,Fn,Hn,pi];let fr=(()=>{class s extends fe{static create(e,t,r=Je(!0)){return(0,k.A)(function*(){const a=new s;return yield a.createForCertificate(e,t,r),a})()}constructor(e={}){super(),this.hashAlgorithm=l(e,gi,s.defaultValues(gi)),this.issuerNameHash=l(e,Fn,s.defaultValues(Fn)),this.issuerKeyHash=l(e,Hn,s.defaultValues(Hn)),this.serialNumber=l(e,pi,s.defaultValues(pi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case gi:return new X;case Fn:case Hn:return new de;case pi:return new Y;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case gi:return t.algorithmId===v&&!("algorithmParams"in t);case Fn:case Hn:case pi:return t.isEqual(s.defaultValues(pi));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[X.schema(t.hashAlgorithmObject||{names:{blockName:t.hashAlgorithm||v}}),new de({name:t.issuerNameHash||v}),new de({name:t.issuerKeyHash||v}),new Y({name:t.serialNumber||v})]})}fromSchema(e){re(e,pv);const t=ue(e,e,s.schema({names:{hashAlgorithm:gi,issuerNameHash:Fn,issuerKeyHash:Hn,serialNumber:pi}}));ae.assertSchema(t,this.className),this.hashAlgorithm=new X({schema:t.result.hashAlgorithm}),this.issuerNameHash=t.result.issuerNameHash,this.issuerKeyHash=t.result.issuerKeyHash,this.serialNumber=t.result.serialNumber}toSchema(){return new O({value:[this.hashAlgorithm.toSchema(),this.issuerNameHash,this.issuerKeyHash,this.serialNumber]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),issuerNameHash:this.issuerNameHash.toJSON(),issuerKeyHash:this.issuerKeyHash.toJSON(),serialNumber:this.serialNumber.toJSON()}}isEqual(e){return!(this.hashAlgorithm.algorithmId!==e.hashAlgorithm.algorithmId||!b._H.isEqual(this.issuerNameHash.valueBlock.valueHexView,e.issuerNameHash.valueBlock.valueHexView)||!b._H.isEqual(this.issuerKeyHash.valueBlock.valueHexView,e.issuerKeyHash.valueBlock.valueHexView)||!this.serialNumber.isEqual(e.serialNumber))}createForCertificate(e,t,r=Je(!0)){var a=this;return(0,k.A)(function*(){tt.assert(t,gi,"issuerCertificate");const o=r.getOIDByAlgorithm({name:t.hashAlgorithm},!0,"hashAlgorithm");a.hashAlgorithm=new X({algorithmId:o,algorithmParams:new kt});const u=t.issuerCertificate;a.serialNumber=e.serialNumber;const h=yield r.digest({name:t.hashAlgorithm},u.subject.toSchema().toBER(!1));a.issuerNameHash=new de({valueHex:h});const m=u.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView,N=yield r.digest({name:t.hashAlgorithm},m);a.issuerKeyHash=new de({valueHex:N})})()}}return s.CLASS_NAME="CertID",s})();const jn="certID",$n="certStatus",Kn="thisUpdate",dr="nextUpdate",vi="singleExtensions",vv=[jn,$n,Kn,dr,vi];let Zd=(()=>{class s extends fe{constructor(e={}){super(),this.certID=l(e,jn,s.defaultValues(jn)),this.certStatus=l(e,$n,s.defaultValues($n)),this.thisUpdate=l(e,Kn,s.defaultValues(Kn)),dr in e&&(this.nextUpdate=l(e,dr,s.defaultValues(dr))),vi in e&&(this.singleExtensions=l(e,vi,s.defaultValues(vi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case jn:return new fr;case $n:return{};case Kn:case dr:return new Date(0,0,0);case vi:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case jn:return fr.compareWithDefault("hashAlgorithm",t.hashAlgorithm)&&fr.compareWithDefault("issuerNameHash",t.issuerNameHash)&&fr.compareWithDefault("issuerKeyHash",t.issuerKeyHash)&&fr.compareWithDefault("serialNumber",t.serialNumber);case $n:return 0===Object.keys(t).length;case Kn:case dr:return t===s.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[fr.schema(t.certID||{}),new ft({value:[new Le({name:t.certStatus||v,idBlock:{tagClass:3,tagNumber:0}}),new q({name:t.certStatus||v,idBlock:{tagClass:3,tagNumber:1},value:[new ht,new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ua]})]}),new Le({name:t.certStatus||v,idBlock:{tagClass:3,tagNumber:2},lenBlock:{length:1}})]}),new ht({name:t.thisUpdate||v}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ht({name:t.nextUpdate||v})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[Rt.schema(t.singleExtensions||{})]})]})}fromSchema(e){re(e,vv);const t=ue(e,e,s.schema({names:{certID:{names:{blockName:jn}},certStatus:$n,thisUpdate:Kn,nextUpdate:dr,singleExtensions:{names:{blockName:vi}}}}));ae.assertSchema(t,this.className),this.certID=new fr({schema:t.result.certID}),this.certStatus=t.result.certStatus,this.thisUpdate=t.result.thisUpdate.toDate(),dr in t.result&&(this.nextUpdate=t.result.nextUpdate.toDate()),vi in t.result&&(this.singleExtensions=Array.from(t.result.singleExtensions.valueBlock.value,r=>new Lr({schema:r})))}toSchema(){const e=[];return e.push(this.certID.toSchema()),e.push(this.certStatus),e.push(new ht({valueDate:this.thisUpdate})),this.nextUpdate&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[new ht({valueDate:this.nextUpdate})]})),this.singleExtensions&&e.push(new O({value:Array.from(this.singleExtensions,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={certID:this.certID.toJSON(),certStatus:this.certStatus.toJSON(),thisUpdate:this.thisUpdate};return this.nextUpdate&&(e.nextUpdate=this.nextUpdate),this.singleExtensions&&(e.singleExtensions=Array.from(this.singleExtensions,t=>t.toJSON())),e}}return s.CLASS_NAME="SingleResponse",s})();const Pc="tbs",wi="version",ll="responderID",cl="producedAt",ul="responses",Gn="responseExtensions",yi="ResponseData",Dc=`${yi}.${wi}`,Jn=`${yi}.${ll}`,ph=`${yi}.${cl}`,vh=`${yi}.${ul}`,Uc=`${yi}.${Gn}`,wv=[yi,Dc,Jn,ph,vh,Uc];let mr=(()=>{class s extends fe{get tbs(){return b._H.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(l(e,Pc,s.defaultValues(Pc))),wi in e&&(this.version=l(e,wi,s.defaultValues(wi))),this.responderID=l(e,ll,s.defaultValues(ll)),this.producedAt=l(e,cl,s.defaultValues(cl)),this.responses=l(e,ul,s.defaultValues(ul)),Gn in e&&(this.responseExtensions=l(e,Gn,s.defaultValues(Gn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wi:return 0;case Pc:return Ct;case ll:return{};case cl:return new Date(0,0,0);case ul:case Gn:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Pc:return 0===t.byteLength;case ll:return 0===Object.keys(t).length;case cl:return t===s.defaultValues(e);case ul:case Gn:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||yi,value:[new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Y({name:t.version||Dc})]}),new ft({value:[new q({name:t.responderID||Jn,idBlock:{tagClass:3,tagNumber:1},value:[dt.schema(t.ResponseDataByName||{names:{blockName:"ResponseData.byName"}})]}),new q({name:t.responderID||Jn,idBlock:{tagClass:3,tagNumber:2},value:[new de({name:t.ResponseDataByKey||"ResponseData.byKey"})]})]}),new ht({name:t.producedAt||ph}),new O({value:[new Ge({name:vh,value:Zd.schema(t.response||{})})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[Rt.schema(t.extensions||{names:{blockName:Uc}})]})]})}fromSchema(e){re(e,wv);const t=ue(e,e,s.schema());ae.assertSchema(t,this.className),this.tbsView=t.result.ResponseData.valueBeforeDecodeView,Dc in t.result&&(this.version=t.result[Dc].valueBlock.valueDec),this.responderID=1===t.result[Jn].idBlock.tagNumber?new dt({schema:t.result[Jn].valueBlock.value[0]}):t.result[Jn].valueBlock.value[0],this.producedAt=t.result[ph].toDate(),this.responses=Array.from(t.result[vh],r=>new Zd({schema:r})),Uc in t.result&&(this.responseExtensions=Array.from(t.result[Uc].valueBlock.value,r=>new Lr({schema:r})))}toSchema(e=!1){let t;if(!1===e){if(!this.tbsView.byteLength)return s.schema();const r=ct(this.tbsView);ae.assert(r,"TBS Response Data"),t=r.result}else{const r=[];wi in this&&r.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[new Y({value:this.version})]})),r.push(new q(this.responderID instanceof dt?{idBlock:{tagClass:3,tagNumber:1},value:[this.responderID.toSchema()]}:{idBlock:{tagClass:3,tagNumber:2},value:[this.responderID]})),r.push(new ht({valueDate:this.producedAt})),r.push(new O({value:Array.from(this.responses,a=>a.toSchema())})),this.responseExtensions&&r.push(new q({idBlock:{tagClass:3,tagNumber:1},value:[new O({value:Array.from(this.responseExtensions,a=>a.toSchema())})]})),t=new O({value:r})}return t}toJSON(){const e={};return wi in this&&(e.version=this.version),this.responderID&&(e.responderID=this.responderID),this.producedAt&&(e.producedAt=this.producedAt),this.responses&&(e.responses=Array.from(this.responses,t=>t.toJSON())),this.responseExtensions&&(e.responseExtensions=Array.from(this.responseExtensions,t=>t.toJSON())),e}}return s.CLASS_NAME="ResponseData",s})();const wh="trustedCerts",yh="certs",Sh="crls",bh="ocsps",Ah="checkDate",Eh="findOrigin",kh="findIssuer";var qn=function(s){return s[s.unknown=-1]="unknown",s[s.success=0]="success",s[s.noRevocation=11]="noRevocation",s[s.noPath=60]="noPath",s[s.noValidPath=97]="noValidPath",s}(qn||{});let hl=(()=>{class s extends Error{constructor(e,t){super(t),this.name=s.NAME,this.code=e,this.message=t}}return s.NAME="ChainValidationError",s})();class Mc{constructor(i={}){this.trustedCerts=l(i,wh,this.defaultValues(wh)),this.certs=l(i,yh,this.defaultValues(yh)),this.crls=l(i,Sh,this.defaultValues(Sh)),this.ocsps=l(i,bh,this.defaultValues(bh)),this.checkDate=l(i,Ah,this.defaultValues(Ah)),this.findOrigin=l(i,Eh,this.defaultValues(Eh)),this.findIssuer=l(i,kh,this.defaultValues(kh))}static defaultFindOrigin(i,e){0===i.tbsView.byteLength&&(i.tbsView=new Uint8Array(i.encodeTBS().toBER()));for(const t of e.certs)if(0===t.tbsView.byteLength&&(t.tbsView=new Uint8Array(t.encodeTBS().toBER())),b._H.isEqual(i.tbsView,t.tbsView))return"Intermediate Certificates";for(const t of e.trustedCerts)if(0===t.tbsView.byteLength&&(t.tbsView=new Uint8Array(t.encodeTBS().toBER())),b._H.isEqual(i.tbsView,t.tbsView))return"Trusted Certificates";return"Unknown"}defaultFindIssuer(i,e,t=Je(!0)){return(0,k.A)(function*(){const r=[];let a=null,o=null,u=null;if(i.subject.isEqual(i.issuer))try{if(yield i.verify(void 0,t))return[i]}catch{}if(i.extensions)for(const m of i.extensions)if(m.extnID===yu&&m.parsedValue instanceof cd){m.parsedValue.keyIdentifier?a=m.parsedValue.keyIdentifier:(m.parsedValue.authorityCertIssuer&&(o=m.parsedValue.authorityCertIssuer),m.parsedValue.authorityCertSerialNumber&&(u=m.parsedValue.authorityCertSerialNumber));break}function h(m){if(null!==a&&m.extensions){let T=!1;for(const K of m.extensions)if("2.5.29.14"===K.extnID&&K.parsedValue){T=!0,b._H.isEqual(K.parsedValue.valueBlock.valueHex,a.valueBlock.valueHexView)&&r.push(m);break}if(T)return}let N=!1;null!==u&&(N=m.serialNumber.isEqual(u)),null!==o?m.subject.isEqual(o)&&N&&r.push(m):i.issuer.isEqual(m.subject)&&r.push(m)}for(const m of e.trustedCerts)h(m);for(const m of e.certs)h(m);for(let m=r.length-1;m>=0;m--)try{!1===(yield i.verify(r[m],t))&&r.splice(m,1)}catch{r.splice(m,1)}return r})()}defaultValues(i){switch(i){case wh:case yh:case Sh:case bh:return[];case Ah:return new Date;case Eh:return Mc.defaultFindOrigin;case kh:return this.defaultFindIssuer;default:throw new Error(`Invalid member name for CertificateChainValidationEngine class: ${i}`)}}sort(i=!1,e=Je(!0)){var t=this;return(0,k.A)(function*(){const r=[],a=function(){var ye=(0,k.A)(function*(ee,Se){const ne=[];function oe(Ae){let Te=!0;for(let xe=0;xe<Ae.length;xe++){for(let Me=0;Me<Ae.length;Me++)if(Me!==xe&&Ae[xe]===Ae[Me]){Te=!1;break}if(!Te)break}return Te}if(function yv(s,i){for(let e=0;e<i.length;e++)if(b._H.isEqual(s.tbsView,i[e].tbsView))return!0;return!1}(ee,t.trustedCerts))return[[ee]];const pe=yield t.findIssuer(ee,t,Se);if(0===pe.length)throw new Error("No valid certificate paths found");for(let Ae=0;Ae<pe.length;Ae++){if(b._H.isEqual(pe[Ae].tbsView,ee.tbsView)){ne.push([pe[Ae]]);continue}const Te=yield a(pe[Ae],Se);for(let xe=0;xe<Te.length;xe++){const Me=Te[xe].slice();Me.splice(0,0,pe[Ae]),oe(Me)?ne.push(Me):ne.push(Te[xe])}}return ne});return function(Se,ne){return ye.apply(this,arguments)}}(),o=function(){var ye=(0,k.A)(function*(ee){const Se=[],ne=[],oe=[];if(Se.push(...r.filter(pe=>ee.issuer.isEqual(pe.subject))),0===Se.length)return{status:1,statusMessage:"No certificate's issuers"};if(ne.push(...t.crls.filter(pe=>pe.issuer.isEqual(ee.issuer))),0===ne.length)return{status:2,statusMessage:"No CRLs for specific certificate issuer"};for(let pe=0;pe<ne.length;pe++){const Ae=ne[pe];if(!(Ae.nextUpdate&&Ae.nextUpdate.value<t.checkDate))for(let Te=0;Te<Se.length;Te++)try{if(yield ne[pe].verify({issuerCertificate:Se[Te]},e)){oe.push({crl:ne[pe],certificate:Se[Te]});break}}catch{}}return oe.length?{status:0,statusMessage:v,result:oe}:{status:3,statusMessage:"No valid CRLs found"}});return function(Se){return ye.apply(this,arguments)}}(),u=function(){var ye=(0,k.A)(function*(ee,Se){const ne=e.getAlgorithmByOID(ee.signatureAlgorithm.algorithmId);if(!ne.name||!ne.hash)return 1;for(let oe=0;oe<t.ocsps.length;oe++){const Ae=yield t.ocsps[oe].getCertificateStatus(ee,Se,e);if(Ae.isForCertificate)return 0===Ae.status?0:1}return 2});return function(Se,ne){return ye.apply(this,arguments)}}();function h(ye){return m.apply(this,arguments)}function m(){return(m=(0,k.A)(function*(ye,ee=!1){let Se=!1,ne=!1,oe=!1,pe=!1;if(ye.extensions){for(let Ae=0;Ae<ye.extensions.length;Ae++){const Te=ye.extensions[Ae];if(Te.critical&&!Te.parsedValue)return{result:!1,resultCode:6,resultMessage:`Unable to parse critical certificate extension: ${Te.extnID}`};if("2.5.29.15"===Te.extnID){oe=!0;const xe=new Uint8Array(Te.parsedValue.valueBlock.valueHex);!(4&~xe[0])&&(ne=!0),!(2&~xe[0])&&(pe=!0)}Te.extnID===vu&&"cA"in Te.parsedValue&&!0===Te.parsedValue.cA&&(Se=!0)}if(!0===ne&&!1===Se)return{result:!1,resultCode:3,resultMessage:'Unable to build certificate chain - using "keyCertSign" flag set without BasicConstraints'};if(!0===oe&&!0===Se&&!1===ne)return{result:!1,resultCode:4,resultMessage:'Unable to build certificate chain - "keyCertSign" flag was not set'};if(!0===Se&&!0===oe&&ee&&!1===pe)return{result:!1,resultCode:5,resultMessage:'Unable to build certificate chain - intermediate certificate must have "cRLSign" key usage flag'}}return!1===Se?{result:!1,resultCode:7,resultMessage:"Unable to build certificate chain - more than one possible end-user certificate"}:{result:!0,resultCode:0,resultMessage:v}})).apply(this,arguments)}const N=function(){var ye=(0,k.A)(function*(ee,Se){for(let ne=0;ne<ee.length;ne++)if(ee[ne].notBefore.value>Se||ee[ne].notAfter.value<Se)return{result:!1,resultCode:8,resultMessage:"The certificate is either not yet valid or expired"};if(ee.length<2)return{result:!1,resultCode:9,resultMessage:"Too short certificate path"};for(let ne=ee.length-2;ne>=0;ne--)if(!1===ee[ne].issuer.isEqual(ee[ne].subject)&&!1===ee[ne].issuer.isEqual(ee[ne+1].subject))return{result:!1,resultCode:10,resultMessage:"Incorrect name chaining"};if(0!==t.crls.length||0!==t.ocsps.length)for(let ne=0;ne<ee.length-1;ne++){let oe=2,pe={status:0,statusMessage:v};if(0!==t.ocsps.length)switch(oe=yield u(ee[ne],ee[ne+1]),oe){case 0:continue;case 1:return{result:!1,resultCode:12,resultMessage:"One of certificates was revoked via OCSP response"}}if(0!==t.crls.length){if(pe=yield o(ee[ne]),0===pe.status&&pe.result)for(let Ae=0;Ae<pe.result.length;Ae++){if(pe.result[Ae].crl.isCertificateRevoked(ee[ne]))return{result:!1,resultCode:12,resultMessage:"One of certificates had been revoked"};if(!1===(yield h(pe.result[Ae].certificate,!0)).result)return{result:!1,resultCode:13,resultMessage:"CRL issuer certificate is not a CA certificate or does not have crlSign flag"}}else if(!1===i)throw new hl(qn.noRevocation,`No revocation values found for one of certificates: ${pe.statusMessage}`)}else if(2===oe)return{result:!1,resultCode:11,resultMessage:"No revocation values found for one of certificates"};if(2===oe&&2===pe.status&&i){const Ae=ee[ne+1];let Te=!1;if(Ae.extensions)for(const xe of Ae.extensions)switch(xe.extnID){case Zf:case wu:case Su:Te=!0}if(Te)throw new hl(qn.noRevocation,`No revocation values found for one of certificates: ${pe.statusMessage}`)}}for(const[ne,oe]of ee.entries())if(ne&&!(yield h(oe)).result)return{result:!1,resultCode:14,resultMessage:"One of intermediate certificates is not a CA certificate"};return{result:!0}});return function(Se,ne){return ye.apply(this,arguments)}}();r.push(...t.trustedCerts),r.push(...t.certs);for(let ye=0;ye<r.length;ye++)for(let ee=0;ee<r.length;ee++)if(ye!==ee&&b._H.isEqual(r[ye].tbsView,r[ee].tbsView)){r.splice(ee,1),ye=0;break}const T=r[r.length-1];let K;const F=[T];if(K=yield a(T,e),0===K.length)throw new hl(qn.noPath,"Unable to find certificate path");for(let ye=K.length-1;ye>=0;ye--){let ee=!1;for(let Se=0;Se<K[ye].length;Se++){const ne=K[ye][Se];for(let oe=0;oe<t.trustedCerts.length;oe++)if(b._H.isEqual(ne.tbsView,t.trustedCerts[oe].tbsView)){ee=!0;break}if(ee)break}ee||K.splice(ye,1)}if(0===K.length)throw new hl(qn.noValidPath,"No valid certificate paths found");let se=K[0].length,Ee=0;for(let ye=0;ye<K.length;ye++)K[ye].length<se&&(se=K[ye].length,Ee=ye);for(let ye=0;ye<K[Ee].length;ye++)F.push(K[Ee][ye]);if(K=yield N(F,t.checkDate),!1===K.result)throw K;return F})()}verify(i={},e=Je(!0)){var t=this;return(0,k.A)(function*(){function r(m,N){const T=Rs(m),K=Rs(N),F=T.split("."),se=K.split("."),Ee=F.length,ye=se.length;if(0===Ee||0===ye||Ee<ye)return!1;for(let ee=0;ee<Ee;ee++)if(0===F[ee].length)return!1;for(let ee=0;ee<ye;ee++)if(0===se[ee].length){if(0===ee){if(1===ye)return!1;continue}return!1}for(let ee=0;ee<ye;ee++)if(0!==se[ye-1-ee].length&&0!==F[Ee-1-ee].localeCompare(se[ye-1-ee]))return!1;return!0}function a(m,N){const T=Rs(m),K=Rs(N),F=T.split("@"),se=K.split("@");if(0===F.length||0===se.length||F.length<se.length)return!1;if(1===se.length){if(r(F[1],se[0])){const ye=F[1].split("."),ee=se[0].split(".");return 0===ee[0].length||ye.length===ee.length}return!1}return 0===T.localeCompare(K)}function o(m,N){let T=Rs(m);const K=Rs(N),F=T.split("/");if(K.split("/").length>1)return!1;if(F.length>1)for(let ye=0;ye<F.length;ye++)if(F[ye].length>0&&":"!==F[ye].charAt(F[ye].length-1)){T=F[ye].split(":")[0];break}if(r(T,K)){const ye=T.split("."),ee=K.split(".");return 0===ee[0].length||ye.length===ee.length}return!1}function u(m,N){const T=m.valueBlock.valueHexView,K=N.valueBlock.valueHexView;if(4===T.length&&8===K.length){for(let F=0;F<4;F++)if((T[F]^K[F])&K[F+4])return!1;return!0}if(16===T.length&&32===K.length){for(let F=0;F<16;F++)if((T[F]^K[F])&K[F+16])return!1;return!0}return!1}function h(m,N){if(0===m.typesAndValues.length||0===N.typesAndValues.length)return!0;if(m.typesAndValues.length<N.typesAndValues.length)return!1;let T=!0,K=0;for(let F=0;F<N.typesAndValues.length;F++){let se=!1;for(let Ee=K;Ee<m.typesAndValues.length;Ee++)if(se=m.typesAndValues[Ee].isEqual(N.typesAndValues[F]),m.typesAndValues[Ee].type===N.typesAndValues[F].type&&(T=T&&se),!0===se){if(0===K||K===Ee){K=Ee+1;break}return!1}if(!1===se)return!1}return 0!==K&&T}try{if(0===t.certs.length)throw new Error("Empty certificate array");const m=i.passedWhenNotRevValues||!1,N=i.initialPolicySet||[Wt];let ee=i.initialExplicitPolicy||!1,Se=i.initialPolicyMappingInhibit||!1,ne=i.initialInhibitPolicy||!1;const oe=[!1,!1,!1];let pe=0,Ae=0,Te=0,xe=i.initialPermittedSubtreesSet||[],Me=i.initialExcludedSubtreesSet||[];const Ye=i.initialRequiredNameForms||[];let At=1;t.certs=yield t.sort(m,e);const Xe=[];Xe.push(Wt);const lt=[],jt=new Array(t.certs.length-1);for(let De=0;De<t.certs.length-1;De++)jt[De]=!0;lt.push(jt);const Ot=new Array(t.certs.length-1),Pi=new Array(t.certs.length-1);let Es=ee?t.certs.length-1:-1;for(let De=t.certs.length-2;De>=0;De--,At++){const je=t.certs[De];if(je.extensions){for(let Pe=0;Pe<je.extensions.length;Pe++){const We=je.extensions[Pe];if(We.extnID===ed){Pi[De]=We.parsedValue;for(let rt=0;rt<Xe.length;rt++)if(Xe[rt]===Wt){delete lt[rt][De];break}for(let rt=0;rt<We.parsedValue.certificatePolicies.length;rt++){let Mt=-1;const ss=We.parsedValue.certificatePolicies[rt].policyIdentifier;for(let mt=0;mt<Xe.length;mt++)if(ss===Xe[mt]){Mt=mt;break}if(-1===Mt){Xe.push(ss);const mt=new Array(t.certs.length-1);mt[De]=!0,lt.push(mt)}else lt[Mt][De]=!0}}if(We.extnID===td){if(Se)return{result:!1,resultCode:98,resultMessage:"Policy mapping prohibited"};Ot[De]=We.parsedValue}We.extnID===sd&&!1===ee&&(0===We.parsedValue.requireExplicitPolicy?(ee=!0,Es=De):!1===oe[0]?(oe[0]=!0,pe=We.parsedValue.requireExplicitPolicy):pe=pe>We.parsedValue.requireExplicitPolicy?We.parsedValue.requireExplicitPolicy:pe,0===We.parsedValue.inhibitPolicyMapping?Se=!0:!1===oe[1]?(oe[1]=!0,Ae=We.parsedValue.inhibitPolicyMapping+1):Ae=Ae>We.parsedValue.inhibitPolicyMapping+1?We.parsedValue.inhibitPolicyMapping+1:Ae),"2.5.29.54"===We.extnID&&!1===ne&&(0===We.parsedValue.valueBlock.valueDec?ne=!0:!1===oe[2]?(oe[2]=!0,Te=We.parsedValue.valueBlock.valueDec):Te=Te>We.parsedValue.valueBlock.valueDec?We.parsedValue.valueBlock.valueDec:Te)}if(!0===ne){let Pe=-1;for(let We=0;We<Xe.length;We++)if(Xe[We]===Wt){Pe=We;break}-1!==Pe&&delete lt[0][De]}!1===ee&&!0===oe[0]&&(pe--,0===pe&&(ee=!0,Es=De,oe[0]=!1)),!1===Se&&!0===oe[1]&&(Ae--,0===Ae&&(Se=!0,oe[1]=!1)),!1===ne&&!0===oe[2]&&(Te--,0===Te&&(ne=!0,oe[2]=!1))}}for(let De=0;De<t.certs.length-1;De++)if(De<t.certs.length-2&&typeof Ot[De+1]<"u")for(let je=0;je<Ot[De+1].mappings.length;je++){if(Ot[De+1].mappings[je].issuerDomainPolicy===Wt||Ot[De+1].mappings[je].subjectDomainPolicy===Wt)return{result:!1,resultCode:99,resultMessage:'The "anyPolicy" should not be a part of policy mapping scheme'};let Pe=-1,We=-1;for(let rt=0;rt<Xe.length;rt++)Xe[rt]===Ot[De+1].mappings[je].issuerDomainPolicy&&(Pe=rt),Xe[rt]===Ot[De+1].mappings[je].subjectDomainPolicy&&(We=rt);typeof lt[Pe][De]<"u"&&delete lt[Pe][De];for(let rt=0;rt<Pi[De].certificatePolicies.length;rt++)if(Ot[De+1].mappings[je].subjectDomainPolicy===Pi[De].certificatePolicies[rt].policyIdentifier&&-1!==Pe&&-1!==We)for(let Mt=0;Mt<=De;Mt++)typeof lt[We][Mt]<"u"&&(lt[Pe][Mt]=!0,delete lt[We][Mt])}for(let De=0;De<Xe.length;De++)if(Xe[De]===Wt)for(let je=0;je<Es;je++)delete lt[De][je];const Yt=[];for(let De=0;De<lt.length;De++){let je=!0;for(let Pe=0;Pe<t.certs.length-1;Pe++){let We=!1;if(Pe<Es&&Xe[De]===Wt&&Xe.length>1){je=!1;break}if(typeof lt[De][Pe]>"u"){if(Pe>=Es)for(let rt=0;rt<Xe.length;rt++)if(Xe[rt]===Wt){!0===lt[rt][Pe]&&(We=!0);break}if(!We){je=!1;break}}}!0===je&&Yt.push(Xe[De])}let ut=[];if(1===N.length&&N[0]===Wt&&!1===ee)ut=N;else if(1===Yt.length&&Yt[0]===Wt)ut=N;else for(let De=0;De<Yt.length;De++)for(let je=0;je<N.length;je++)if(N[je]===Yt[De]||N[je]===Wt){ut.push(Yt[De]);break}const nt={result:ut.length>0,resultCode:0,resultMessage:ut.length>0?v:'Zero "userConstrPolicies" array, no intersections with "authConstrPolicies"',authConstrPolicies:Yt,userConstrPolicies:ut,explicitPolicyIndicator:ee,policyMappings:Ot,certificatePath:t.certs};if(0===ut.length||!1===nt.result)return nt;At=1;for(let De=t.certs.length-2;De>=0;De--,At++){const je=t.certs[De];let Pe=[],We=[],rt=[];if(je.extensions)for(let Ze=0;Ze<je.extensions.length;Ze++){const He=je.extensions[Ze];He.extnID===Qf&&("permittedSubtrees"in He.parsedValue&&(We=We.concat(He.parsedValue.permittedSubtrees)),"excludedSubtrees"in He.parsedValue&&(rt=rt.concat(He.parsedValue.excludedSubtrees))),He.extnID===Wf&&(Pe=Pe.concat(He.parsedValue.altNames))}let Mt=Ye.length<=0;for(let Ze=0;Ze<Ye.length;Ze++)switch(Ye[Ze].base.type){case 4:if(Ye[Ze].base.value.typesAndValues.length!==je.subject.typesAndValues.length)continue;Mt=!0;for(let He=0;He<je.subject.typesAndValues.length;He++)if(je.subject.typesAndValues[He].type!==Ye[Ze].base.value.typesAndValues[He].type){Mt=!1;break}if(!0===Mt)break}if(!1===Mt)throw nt.result=!1,nt.resultCode=21,nt.resultMessage="No necessary name form found",nt;const ss=[[],[],[],[],[]];for(let Ze=0;Ze<xe.length;Ze++)switch(xe[Ze].base.type){case 1:ss[0].push(xe[Ze]);break;case 2:ss[1].push(xe[Ze]);break;case 4:ss[2].push(xe[Ze]);break;case 6:ss[3].push(xe[Ze]);break;case 7:ss[4].push(xe[Ze])}for(let Ze=0;Ze<5;Ze++){let He=!1,Di=!1;const wr=ss[Ze];for(let yr=0;yr<wr.length;yr++){switch(Ze){case 0:if(Pe.length>0)for(let gt=0;gt<Pe.length;gt++)1===Pe[gt].type&&(Di=!0,He=He||a(Pe[gt].value,wr[yr].base.value));else for(let gt=0;gt<je.subject.typesAndValues.length;gt++)("1.2.840.113549.1.9.1"===je.subject.typesAndValues[gt].type||"0.9.2342.19200300.100.1.3"===je.subject.typesAndValues[gt].type)&&(Di=!0,He=He||a(je.subject.typesAndValues[gt].value.valueBlock.value,wr[yr].base.value));break;case 1:if(Pe.length>0)for(let gt=0;gt<Pe.length;gt++)2===Pe[gt].type&&(Di=!0,He=He||r(Pe[gt].value,wr[yr].base.value));break;case 2:Di=!0,He=h(je.subject,wr[yr].base.value);break;case 3:if(Pe.length>0)for(let gt=0;gt<Pe.length;gt++)6===Pe[gt].type&&(Di=!0,He=He||o(Pe[gt].value,wr[yr].base.value));break;case 4:if(Pe.length>0)for(let gt=0;gt<Pe.length;gt++)7===Pe[gt].type&&(Di=!0,He=He||u(Pe[gt].value,wr[yr].base.value))}if(He)break}if(!1===He&&wr.length>0&&Di)throw nt.result=!1,nt.resultCode=41,nt.resultMessage='Failed to meet "permitted sub-trees" name constraint',nt}let mt=!1;for(let Ze=0;Ze<Me.length;Ze++){switch(Me[Ze].base.type){case 1:if(Pe.length>=0)for(let He=0;He<Pe.length;He++)1===Pe[He].type&&(mt=mt||a(Pe[He].value,Me[Ze].base.value));else for(let He=0;He<je.subject.typesAndValues.length;He++)("1.2.840.113549.1.9.1"===je.subject.typesAndValues[He].type||"0.9.2342.19200300.100.1.3"===je.subject.typesAndValues[He].type)&&(mt=mt||a(je.subject.typesAndValues[He].value.valueBlock.value,Me[Ze].base.value));break;case 2:if(Pe.length>0)for(let He=0;He<Pe.length;He++)2===Pe[He].type&&(mt=mt||r(Pe[He].value,Me[Ze].base.value));break;case 4:mt=mt||h(je.subject,Me[Ze].base.value);break;case 6:if(Pe.length>0)for(let He=0;He<Pe.length;He++)6===Pe[He].type&&(mt=mt||o(Pe[He].value,Me[Ze].base.value));break;case 7:if(Pe.length>0)for(let He=0;He<Pe.length;He++)7===Pe[He].type&&(mt=mt||u(Pe[He].value,Me[Ze].base.value))}if(mt)break}if(!0===mt)throw nt.result=!1,nt.resultCode=42,nt.resultMessage='Failed to meet "excluded sub-trees" name constraint',nt;xe=xe.concat(We),Me=Me.concat(rt)}return nt}catch(m){return m instanceof Error?m instanceof hl?{result:!1,resultCode:m.code,resultMessage:m.message,error:m}:{result:!1,resultCode:qn.unknown,resultMessage:m.message,error:m}:m&&"object"==typeof m&&"resultMessage"in m?m:{result:!1,resultCode:-1,resultMessage:`${m}`}}})()}}const Lc="tbsResponseData",fl="signatureAlgorithm",dl="signature",Wn="certs",ml="BasicOCSPResponse",_h=`${ml}.${Lc}`,Ch=`${ml}.${fl}`,Nh=`${ml}.${dl}`,Fc=`${ml}.${Wn}`,Sv=[_h,Ch,Nh,Fc];let bv=(()=>{class s extends fe{constructor(e={}){super(),this.tbsResponseData=l(e,Lc,s.defaultValues(Lc)),this.signatureAlgorithm=l(e,fl,s.defaultValues(fl)),this.signature=l(e,dl,s.defaultValues(dl)),Wn in e&&(this.certs=l(e,Wn,s.defaultValues(Wn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Lc:return new mr;case fl:return new X;case dl:return new et;case Wn:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"type":{let r=mr.compareWithDefault("tbs",t.tbs)&&mr.compareWithDefault("responderID",t.responderID)&&mr.compareWithDefault("producedAt",t.producedAt)&&mr.compareWithDefault("responses",t.responses);return"responseExtensions"in t&&(r=r&&mr.compareWithDefault("responseExtensions",t.responseExtensions)),r}case fl:return t.algorithmId===v&&!("algorithmParams"in t);case dl:return t.isEqual(s.defaultValues(e));case Wn:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||ml,value:[mr.schema(t.tbsResponseData||{names:{blockName:_h}}),X.schema(t.signatureAlgorithm||{names:{blockName:Ch}}),new et({name:t.signature||Nh}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new O({value:[new Ge({name:Fc,value:zt.schema(t.certs||{})})]})]})]})}fromSchema(e){re(e,Sv);const t=ue(e,e,s.schema());ae.assertSchema(t,this.className),this.tbsResponseData=new mr({schema:t.result[_h]}),this.signatureAlgorithm=new X({schema:t.result[Ch]}),this.signature=t.result[Nh],Fc in t.result&&(this.certs=Array.from(t.result[Fc],r=>new zt({schema:r})))}toSchema(){const e=[];return e.push(this.tbsResponseData.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.certs&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[new O({value:Array.from(this.certs,t=>t.toSchema())})]})),new O({value:e})}toJSON(){const e={tbsResponseData:this.tbsResponseData.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.certs&&(e.certs=Array.from(this.certs,t=>t.toJSON())),e}getCertificateStatus(e,t,r=Je(!0)){var a=this;return(0,k.A)(function*(){const o={isForCertificate:!1,status:2},u={},h=[];for(const m of a.tbsResponseData.responses){const N=r.getAlgorithmByOID(m.certID.hashAlgorithm.algorithmId,!0,"CertID.hashAlgorithm");if(!u[N.name]){u[N.name]=1;const T=new fr;h.push(T),yield T.createForCertificate(e,{hashAlgorithm:N.name,issuerCertificate:t},r)}}for(const m of a.tbsResponseData.responses)for(const N of h)if(m.certID.isEqual(N)){o.isForCertificate=!0;try{switch(m.certStatus.idBlock.isConstructed){case!0:1===m.certStatus.idBlock.tagNumber&&(o.status=1);break;case!1:switch(m.certStatus.idBlock.tagNumber){case 0:o.status=0;break;case 2:o.status=2}}}catch{}return o}return o})()}sign(e,t="SHA-1",r=Je(!0)){var a=this;return(0,k.A)(function*(){if(!e)throw new Error("Need to provide a private key for signing");const o=yield r.getSignatureParameters(e,t),u=o.parameters.algorithm;if(!("name"in u))throw new Error("Empty algorithm");a.signatureAlgorithm=o.signatureAlgorithm,a.tbsResponseData.tbsView=new Uint8Array(a.tbsResponseData.toSchema(!0).toBER());const h=yield r.signWithPrivateKey(a.tbsResponseData.tbsView,e,{algorithm:u});a.signature=new et({valueHex:h})})()}verify(e={},t=Je(!0)){var r=this;return(0,k.A)(function*(){let a=null,o=-1;const u=e.trustedCerts||[];if(!r.certs)throw new Error("No certificates attached to the BasicOCSPResponse");switch(!0){case r.tbsResponseData.responderID instanceof dt:for(const[T,K]of r.certs.entries())if(K.subject.isEqual(r.tbsResponseData.responderID)){o=T;break}break;case r.tbsResponseData.responderID instanceof de:for(const[T,K]of r.certs.entries())if(ie(yield t.digest({name:"sha-1"},K.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView),r.tbsResponseData.responderID.valueBlock.valueHex)){o=T;break}break;default:throw new Error("Wrong value for responderID")}if(-1===o)throw new Error("Correct certificate was not found in OCSP response");a=r.certs[o];const h=[a];for(const T of r.certs){const K=yield Gd(T,a);K&&h.push(K)}if(!(yield new Mc({certs:h,trustedCerts:u}).verify({},t)).result)throw new Error("Validation of signer's certificate failed");return t.verifyWithPublicKey(r.tbsResponseData.tbsView,r.signature,r.certs[o].subjectPublicKeyInfo,r.signatureAlgorithm)})()}}return s.CLASS_NAME="BasicOCSPResponse",s})();const Bh="version",Rh="subject",Th="subjectPublicKeyInfo",zn="attributes",gl="signatureAlgorithm",pl="signatureValue",Yn="CertificationRequestInfo",xh=`${Yn}.version`,Vh=`${Yn}.subject`,Oh=`${Yn}.subjectPublicKeyInfo`,Hc=`${Yn}.attributes`,Av=[Yn,xh,Vh,Oh,Hc,gl,pl];function Ev(s={}){const i=l(s,"names",{});return new O({name:i.CertificationRequestInfo||Yn,value:[new Y({name:i.CertificationRequestInfoVersion||xh}),dt.schema(i.subject||{names:{blockName:Vh}}),ns.schema({names:{blockName:Oh}}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ge({optional:!0,name:i.CertificationRequestInfoAttributes||Hc,value:st.schema(i.attributes||{})})]})]})}let kv=(()=>{class s extends fe{get tbs(){return b._H.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(l(e,"tbs",s.defaultValues("tbs"))),this.version=l(e,Bh,s.defaultValues(Bh)),this.subject=l(e,Rh,s.defaultValues(Rh)),this.subjectPublicKeyInfo=l(e,Th,s.defaultValues(Th)),zn in e&&(this.attributes=l(e,zn,s.defaultValues(zn))),this.signatureAlgorithm=l(e,gl,s.defaultValues(gl)),this.signatureValue=l(e,pl,s.defaultValues(pl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return Ct;case Bh:return 0;case Rh:return new dt;case Th:return new ns;case zn:return[];case gl:return new X;case pl:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({value:[Ev(t.certificationRequestInfo||{}),new O({name:t.signatureAlgorithm||gl,value:[new Ve,new Fe({optional:!0})]}),new et({name:t.signatureValue||pl})]})}fromSchema(e){re(e,Av);const t=ue(e,e,s.schema());ae.assertSchema(t,this.className),this.tbsView=t.result.CertificationRequestInfo.valueBeforeDecodeView,this.version=t.result[xh].valueBlock.valueDec,this.subject=new dt({schema:t.result[Vh]}),this.subjectPublicKeyInfo=new ns({schema:t.result[Oh]}),Hc in t.result&&(this.attributes=Array.from(t.result[Hc],r=>new st({schema:r}))),this.signatureAlgorithm=new X({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[new Y({value:this.version}),this.subject.toSchema(),this.subjectPublicKeyInfo.toSchema()];return zn in this&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes||[],t=>t.toSchema())})),new O({value:e})}toSchema(e=!1){let t;if(!1===e){if(0===this.tbsView.byteLength)return s.schema();const r=ct(this.tbsView);ae.assert(r,"PKCS#10 Certificate Request"),t=r.result}else t=this.encodeTBS();return new O({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:b.U$.ToHex(this.tbsView),version:this.version,subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return zn in this&&(e.attributes=Array.from(this.attributes||[],t=>t.toJSON())),e}sign(e,t="SHA-1",r=Je(!0)){var a=this;return(0,k.A)(function*(){if(!e)throw new Error("Need to provide a private key for signing");const o=yield r.getSignatureParameters(e,t),u=o.parameters;a.signatureAlgorithm=o.signatureAlgorithm,a.tbsView=new Uint8Array(a.encodeTBS().toBER());const h=yield r.signWithPrivateKey(a.tbsView,e,u);a.signatureValue=new et({valueHex:h})})()}verify(e=Je(!0)){var t=this;return(0,k.A)(function*(){return e.verifyWithPublicKey(t.tbsView,t.signatureValue,t.subjectPublicKeyInfo,t.signatureAlgorithm)})()}getPublicKey(e,t=Je(!0)){var r=this;return(0,k.A)(function*(){return t.getPublicKey(r.subjectPublicKeyInfo,r.signatureAlgorithm,e)})()}}return s.CLASS_NAME="CertificationRequest",s})();const Si="digestAlgorithm",bi="digest",_v=[Si,bi];let Xn=(()=>{class s extends fe{constructor(e={}){super(),this.digestAlgorithm=l(e,Si,s.defaultValues(Si)),this.digest=l(e,bi,s.defaultValues(bi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Si:return new X;case bi:return new de;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Si:return X.compareWithDefault("algorithmId",t.algorithmId)&&!("algorithmParams"in t);case bi:return t.isEqual(s.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[X.schema(t.digestAlgorithm||{names:{blockName:Si}}),new de({name:t.digest||bi})]})}fromSchema(e){re(e,_v);const t=ue(e,e,s.schema({names:{digestAlgorithm:{names:{blockName:Si}},digest:bi}}));ae.assertSchema(t,this.className),this.digestAlgorithm=new X({schema:t.result.digestAlgorithm}),this.digest=t.result.digest}toSchema(){return new O({value:[this.digestAlgorithm.toSchema(),this.digest]})}toJSON(){return{digestAlgorithm:this.digestAlgorithm.toJSON(),digest:this.digest.toJSON()}}}return s.CLASS_NAME="DigestInfo",s})();const Qn="eContentType",es="eContent",Cv=[Qn,es];let Zn=(()=>{class s extends fe{constructor(e={}){if(super(),this.eContentType=l(e,Qn,s.defaultValues(Qn)),es in e&&(this.eContent=l(e,es,s.defaultValues(es)),1===this.eContent.idBlock.tagClass&&4===this.eContent.idBlock.tagNumber&&!1===this.eContent.idBlock.isConstructed)){const t=new de({idBlock:{isConstructed:!0},isConstructed:!0});let r=0;const a=this.eContent.valueBlock.valueHexView.slice().buffer;let o=a.byteLength;for(;o>0;){const u=new Uint8Array(a,r,r+65536>a.byteLength?a.byteLength-r:65536),h=new ArrayBuffer(u.length),m=new Uint8Array(h);for(let N=0;N<m.length;N++)m[N]=u[N];t.valueBlock.value.push(new de({valueHex:h})),o-=u.length,r+=u.length}this.eContent=t}e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qn:return v;case es:return new de;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Qn:return t===v;case es:return 1===t.idBlock.tagClass&&4===t.idBlock.tagNumber&&t.isEqual(s.defaultValues(es));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.eContentType||v}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.eContent||v})]})]})}fromSchema(e){re(e,Cv);const t=ue(e,e,s.schema({names:{eContentType:Qn,eContent:es}}));ae.assertSchema(t,this.className),this.eContentType=t.result.eContentType.valueBlock.toString(),es in t.result&&(this.eContent=t.result.eContent)}toSchema(){const e=[];return e.push(new Ve({value:this.eContentType})),this.eContent&&!1===s.compareWithDefault(es,this.eContent)&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.eContent]})),new O({value:e})}toJSON(){const e={eContentType:this.eContentType};return this.eContent&&!1===s.compareWithDefault(es,this.eContent)&&(e.eContent=this.eContent.toJSON()),e}}return s.CLASS_NAME="EncapsulatedContentInfo",s})();const Ai="mac",Ei="macSalt",ys="iterations",Nv=[Ai,Ei,ys];let ki=(()=>{class s extends fe{constructor(e={}){super(),this.mac=l(e,Ai,s.defaultValues(Ai)),this.macSalt=l(e,Ei,s.defaultValues(Ei)),ys in e&&(this.iterations=l(e,ys,s.defaultValues(ys))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ai:return new Xn;case Ei:return new de;case ys:return 1;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ai:return Xn.compareWithDefault("digestAlgorithm",t.digestAlgorithm)&&Xn.compareWithDefault("digest",t.digest);case Ei:return t.isEqual(s.defaultValues(e));case ys:return t===s.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,optional:t.optional||!0,value:[Xn.schema(t.mac||{names:{blockName:Ai}}),new de({name:t.macSalt||Ei}),new Y({optional:!0,name:t.iterations||ys})]})}fromSchema(e){re(e,Nv);const t=ue(e,e,s.schema({names:{mac:{names:{blockName:Ai}},macSalt:Ei,iterations:ys}}));ae.assertSchema(t,this.className),this.mac=new Xn({schema:t.result.mac}),this.macSalt=t.result.macSalt,ys in t.result&&(this.iterations=t.result.iterations.valueBlock.valueDec)}toSchema(){const e=[this.mac.toSchema(),this.macSalt];return void 0!==this.iterations&&e.push(new Y({value:this.iterations})),new O({value:e})}toJSON(){const e={mac:this.mac.toJSON(),macSalt:this.macSalt.toJSON()};return void 0!==this.iterations&&(e.iterations=this.iterations),e}}return s.CLASS_NAME="MacData",s})();const _i="hashAlgorithm",Ci="hashedMessage",Iv=[_i,Ci];let vl=(()=>{class s extends fe{static create(e,t,r=Je(!0)){return(0,k.A)(function*(){const a=r.getOIDByAlgorithm({name:e},!0,"hashAlgorithm"),o=yield r.digest(e,t);return new s({hashAlgorithm:new X({algorithmId:a,algorithmParams:new kt}),hashedMessage:new de({valueHex:o})})})()}constructor(e={}){super(),this.hashAlgorithm=l(e,_i,s.defaultValues(_i)),this.hashedMessage=l(e,Ci,s.defaultValues(Ci)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case _i:return new X;case Ci:return new de;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case _i:return t.algorithmId===v&&!("algorithmParams"in t);case Ci:return 0===t.isEqual(s.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[X.schema(t.hashAlgorithm||{}),new de({name:t.hashedMessage||v})]})}fromSchema(e){re(e,Iv);const t=ue(e,e,s.schema({names:{hashAlgorithm:{names:{blockName:_i}},hashedMessage:Ci}}));ae.assertSchema(t,this.className),this.hashAlgorithm=new X({schema:t.result.hashAlgorithm}),this.hashedMessage=t.result.hashedMessage}toSchema(){return new O({value:[this.hashAlgorithm.toSchema(),this.hashedMessage]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),hashedMessage:this.hashedMessage.toJSON()}}}return s.CLASS_NAME="MessageImprint",s})();const Ni="type",Ss="attributes",jc="encodedValue",Dv=[Ss];let Ht=(()=>{class s extends fe{constructor(e={}){super(),this.type=l(e,Ni,s.defaultValues(Ni)),this.attributes=l(e,Ss,s.defaultValues(Ss)),this.encodedValue=l(e,jc,s.defaultValues(jc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ni:return-1;case Ss:return[];case jc:return Ct;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ni:return t===s.defaultValues(Ni);case Ss:return 0===t.length;case jc:return 0===t.byteLength;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new q({name:t.blockName||v,optional:!0,idBlock:{tagClass:3,tagNumber:t.tagNumber||0},value:[new Ge({name:t.attributes||v,value:st.schema()})]})}fromSchema(e){re(e,Dv);const t=ue(e,e,s.schema({names:{tagNumber:this.type,attributes:Ss}}));if(ae.assertSchema(t,this.className),this.type=t.result.idBlock.tagNumber,this.encodedValue=b._H.toArrayBuffer(t.result.valueBeforeDecodeView),new Uint8Array(this.encodedValue)[0]=49,Ss in t.result)this.attributes=Array.from(t.result.attributes,a=>new st({schema:a}));else if(0===this.type)throw new Error("Wrong structure of SignedUnsignedAttributes")}toSchema(){if(s.compareWithDefault(Ni,this.type)||s.compareWithDefault(Ss,this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return new q({optional:!0,idBlock:{tagClass:3,tagNumber:this.type},value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){if(s.compareWithDefault(Ni,this.type)||s.compareWithDefault(Ss,this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return{type:this.type,attributes:Array.from(this.attributes,e=>e.toJSON())}}}return s.CLASS_NAME="SignedAndUnsignedAttributes",s})();const ea="version",Ii="sid",ta="digestAlgorithm",gr="signedAttrs",sa="signatureAlgorithm",yl="signature",pr="unsignedAttrs",vr="SignerInfo",Ph=`${vr}.${ea}`,Sl=`${vr}.${Ii}`,Dh=`${vr}.${ta}`,$c=`${vr}.${gr}`,Uh=`${vr}.${sa}`,Mh=`${vr}.${yl}`,Kc=`${vr}.${pr}`,Uv=[Ph,Sl,Dh,$c,Uh,Mh,Kc];let Lh=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,ea,s.defaultValues(ea)),this.sid=l(e,Ii,s.defaultValues(Ii)),this.digestAlgorithm=l(e,ta,s.defaultValues(ta)),gr in e&&(this.signedAttrs=l(e,gr,s.defaultValues(gr))),this.signatureAlgorithm=l(e,sa,s.defaultValues(sa)),this.signature=l(e,yl,s.defaultValues(yl)),pr in e&&(this.unsignedAttrs=l(e,pr,s.defaultValues(pr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ea:return 0;case Ii:return new Fe;case ta:return new X;case gr:return new Ht({type:0});case sa:return new X;case yl:return new de;case pr:return new Ht({type:1});default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ea:return s.defaultValues(ea)===t;case Ii:return t instanceof Fe;case ta:return t instanceof X&&t.isEqual(s.defaultValues(ta));case gr:return Ht.compareWithDefault("type",t.type)&&Ht.compareWithDefault("attributes",t.attributes)&&Ht.compareWithDefault("encodedValue",t.encodedValue);case sa:return t instanceof X&&t.isEqual(s.defaultValues(sa));case yl:case pr:return Ht.compareWithDefault("type",t.type)&&Ht.compareWithDefault("attributes",t.attributes)&&Ht.compareWithDefault("encodedValue",t.encodedValue);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:vr,value:[new Y({name:t.version||Ph}),new ft({value:[xt.schema(t.sidSchema||{names:{blockName:Sl}}),new ft({value:[new q({optional:!0,name:t.sid||Sl,idBlock:{tagClass:3,tagNumber:0},value:[new de]}),new Le({optional:!0,name:t.sid||Sl,idBlock:{tagClass:3,tagNumber:0}})]})]}),X.schema(t.digestAlgorithm||{names:{blockName:Dh}}),Ht.schema(t.signedAttrs||{names:{blockName:$c,tagNumber:0}}),X.schema(t.signatureAlgorithm||{names:{blockName:Uh}}),new de({name:t.signature||Mh}),Ht.schema(t.unsignedAttrs||{names:{blockName:Kc,tagNumber:1}})]})}fromSchema(e){re(e,Uv);const t=ue(e,e,s.schema());ae.assertSchema(t,this.className),this.version=t.result[Ph].valueBlock.valueDec;const r=t.result[Sl];this.sid=1===r.idBlock.tagClass?new xt({schema:r}):r,this.digestAlgorithm=new X({schema:t.result[Dh]}),$c in t.result&&(this.signedAttrs=new Ht({type:0,schema:t.result[$c]})),this.signatureAlgorithm=new X({schema:t.result[Uh]}),this.signature=t.result[Mh],Kc in t.result&&(this.unsignedAttrs=new Ht({type:1,schema:t.result[Kc]}))}toSchema(){if(s.compareWithDefault(Ii,this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e=[];return e.push(new Y({value:this.version})),e.push(this.sid instanceof xt?this.sid.toSchema():this.sid),e.push(this.digestAlgorithm.toSchema()),this.signedAttrs&&!1===s.compareWithDefault(gr,this.signedAttrs)&&e.push(this.signedAttrs.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.unsignedAttrs&&!1===s.compareWithDefault(pr,this.unsignedAttrs)&&e.push(this.unsignedAttrs.toSchema()),new O({value:e})}toJSON(){if(s.compareWithDefault(Ii,this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e={version:this.version,digestAlgorithm:this.digestAlgorithm.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.sid instanceof Fe||(e.sid=this.sid.toJSON()),this.signedAttrs&&!1===s.compareWithDefault(gr,this.signedAttrs)&&(e.signedAttrs=this.signedAttrs.toJSON()),this.unsignedAttrs&&!1===s.compareWithDefault(pr,this.unsignedAttrs)&&(e.unsignedAttrs=this.unsignedAttrs.toJSON()),e}}return s.CLASS_NAME="SignerInfo",s})();const bl="version",Al="policy",El="messageImprint",kl="serialNumber",_l="genTime",Bi="ordering",Ri="nonce",ra="accuracy",ia="tsa",na="extensions",ts="TSTInfo",Fh=`${ts}.${bl}`,Hh=`${ts}.${Al}`,jh=`${ts}.${El}`,$h=`${ts}.${kl}`,Kh=`${ts}.${_l}`,Gc=`${ts}.${ra}`,Jc=`${ts}.${Bi}`,qc=`${ts}.${Ri}`,Wc=`${ts}.${ia}`,zc=`${ts}.${na}`,Mv=[Fh,Hh,jh,$h,Kh,Gc,Jc,qc,Wc,zc];let Lv=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,bl,s.defaultValues(bl)),this.policy=l(e,Al,s.defaultValues(Al)),this.messageImprint=l(e,El,s.defaultValues(El)),this.serialNumber=l(e,kl,s.defaultValues(kl)),this.genTime=l(e,_l,s.defaultValues(_l)),ra in e&&(this.accuracy=l(e,ra,s.defaultValues(ra))),Bi in e&&(this.ordering=l(e,Bi,s.defaultValues(Bi))),Ri in e&&(this.nonce=l(e,Ri,s.defaultValues(Ri))),ia in e&&(this.tsa=l(e,ia,s.defaultValues(ia))),na in e&&(this.extensions=l(e,na,s.defaultValues(na))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case bl:return 0;case Al:return v;case El:return new vl;case kl:return new Y;case _l:return new Date(0,0,0);case ra:return new Li;case Bi:return!1;case Ri:return new Y;case ia:return new bt;case na:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case bl:case Al:case _l:case Bi:return t===s.defaultValues(Bi);case El:return vl.compareWithDefault(_i,t.hashAlgorithm)&&vl.compareWithDefault(Ci,t.hashedMessage);case kl:case Ri:return t.isEqual(s.defaultValues(Ri));case ra:return Li.compareWithDefault(Ts,t.seconds)&&Li.compareWithDefault(xs,t.millis)&&Li.compareWithDefault(Vs,t.micros);case ia:return bt.compareWithDefault(pa,t.type)&&bt.compareWithDefault(va,t.value);case na:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||ts,value:[new Y({name:t.version||Fh}),new Ve({name:t.policy||Hh}),vl.schema(t.messageImprint||{names:{blockName:jh}}),new Y({name:t.serialNumber||$h}),new ht({name:t.genTime||Kh}),Li.schema(t.accuracy||{names:{blockName:Gc}}),new ks({name:t.ordering||Jc,optional:!0}),new Y({name:t.nonce||qc,optional:!0}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[bt.schema(t.tsa||{names:{blockName:Wc}})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Ge({name:t.extensions||zc,value:Lr.schema(t.extension||{})})]})]})}fromSchema(e){re(e,Mv);const t=ue(e,e,s.schema());ae.assertSchema(t,this.className),this.version=t.result[Fh].valueBlock.valueDec,this.policy=t.result[Hh].valueBlock.toString(),this.messageImprint=new vl({schema:t.result[jh]}),this.serialNumber=t.result[$h],this.genTime=t.result[Kh].toDate(),Gc in t.result&&(this.accuracy=new Li({schema:t.result[Gc]})),Jc in t.result&&(this.ordering=t.result[Jc].valueBlock.value),qc in t.result&&(this.nonce=t.result[qc]),Wc in t.result&&(this.tsa=new bt({schema:t.result[Wc]})),zc in t.result&&(this.extensions=Array.from(t.result[zc],r=>new Lr({schema:r})))}toSchema(){const e=[];return e.push(new Y({value:this.version})),e.push(new Ve({value:this.policy})),e.push(this.messageImprint.toSchema()),e.push(this.serialNumber),e.push(new ht({valueDate:this.genTime})),this.accuracy&&e.push(this.accuracy.toSchema()),void 0!==this.ordering&&e.push(new ks({value:this.ordering})),this.nonce&&e.push(this.nonce),this.tsa&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.tsa.toSchema()]})),this.extensions&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.extensions,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={version:this.version,policy:this.policy,messageImprint:this.messageImprint.toJSON(),serialNumber:this.serialNumber.toJSON(),genTime:this.genTime};return this.accuracy&&(e.accuracy=this.accuracy.toJSON()),void 0!==this.ordering&&(e.ordering=this.ordering),this.nonce&&(e.nonce=this.nonce.toJSON()),this.tsa&&(e.tsa=this.tsa.toJSON()),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}verify(e,t=Je(!0)){var r=this;return(0,k.A)(function*(){if(!e.data)throw new Error('"data" is a mandatory attribute for TST_INFO verification');const a=e.data;if(e.notBefore&&r.genTime<e.notBefore)throw new Error("Generation time for TSTInfo object is less than notBefore value");if(e.notAfter&&r.genTime>e.notAfter)throw new Error("Generation time for TSTInfo object is more than notAfter value");const o=t.getAlgorithmByOID(r.messageImprint.hashAlgorithm.algorithmId,!0,"MessageImprint.hashAlgorithm"),u=yield t.digest(o.name,new Uint8Array(a));return b._H.isEqual(u,r.messageImprint.hashedMessage.valueBlock.valueHexView)})()}}return s.CLASS_NAME="TSTInfo",s})();const aa="version",Cl="digestAlgorithms",Nl="encapContentInfo",oa="certificates",la="crls",Il="signerInfos",Bl="ocsps",Ti="SignedData",Gh=`${Ti}.${aa}`,Yc=`${Ti}.${Cl}`,Jh=`${Ti}.${Nl}`,Xc=`${Ti}.${oa}`,Qc=`${Ti}.${la}`,Zc=`${Ti}.${Il}`,Fv=[Gh,Yc,Jh,Xc,Qc,Zc];class Vt extends Error{constructor({message:i,code:e=0,date:t=new Date,signatureVerified:r=null,signerCertificate:a=null,signerCertificateVerified:o=null,timestampSerial:u=null,certificatePath:h=[]}){super(i),this.name="SignedDataVerifyError",this.date=t,this.code=e,this.timestampSerial=u,this.signatureVerified=r,this.signerCertificate=a,this.signerCertificateVerified=o,this.certificatePath=h}}let em=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,aa,s.defaultValues(aa)),this.digestAlgorithms=l(e,Cl,s.defaultValues(Cl)),this.encapContentInfo=l(e,Nl,s.defaultValues(Nl)),oa in e&&(this.certificates=l(e,oa,s.defaultValues(oa))),la in e&&(this.crls=l(e,la,s.defaultValues(la))),Bl in e&&(this.ocsps=l(e,Bl,s.defaultValues(Bl))),this.signerInfos=l(e,Il,s.defaultValues(Il)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case aa:return 0;case Cl:return[];case Nl:return new Zn;case oa:case la:case Bl:case Il:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case aa:return t===s.defaultValues(aa);case Nl:return Zn.compareWithDefault("eContentType",t.eContentType)&&Zn.compareWithDefault("eContent",t.eContent);case Cl:case oa:case la:case Bl:case Il:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return void 0===t.optional&&(t.optional=!1),new O({name:t.blockName||Ti,optional:t.optional,value:[new Y({name:t.version||Gh}),new _t({value:[new Ge({name:t.digestAlgorithms||Yc,value:X.schema()})]}),Zn.schema(t.encapContentInfo||{names:{blockName:Jh}}),new q({name:t.certificates||Xc,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:mn.schema().valueBlock.value}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Sc.schema(t.crls||{names:{crls:Qc}}).valueBlock.value}),new _t({value:[new Ge({name:t.signerInfos||Zc,value:Lh.schema()})]})]})}fromSchema(e){re(e,Fv);const t=ue(e,e,s.schema());if(ae.assertSchema(t,this.className),this.version=t.result[Gh].valueBlock.valueDec,Yc in t.result&&(this.digestAlgorithms=Array.from(t.result[Yc],r=>new X({schema:r}))),this.encapContentInfo=new Zn({schema:t.result[Jh]}),Xc in t.result){const r=new mn({schema:new _t({value:t.result[Xc].valueBlock.value})});this.certificates=r.certificates.slice(0)}Qc in t.result&&(this.crls=Array.from(t.result[Qc],r=>1===r.idBlock.tagClass?new vc({schema:r}):(r.idBlock.tagClass=1,r.idBlock.tagNumber=16,new yc({schema:r})))),Zc in t.result&&(this.signerInfos=Array.from(t.result[Zc],r=>new Lh({schema:r})))}toSchema(e=!1){const t=[];if(this.version=this.certificates&&this.certificates.length&&this.certificates.some(r=>r instanceof er)||this.crls&&this.crls.length&&this.crls.some(r=>r instanceof yc)?5:this.certificates&&this.certificates.length&&this.certificates.some(r=>r instanceof ei)?4:this.certificates&&this.certificates.length&&this.certificates.some(r=>r instanceof Lu)||this.signerInfos.some(r=>3===r.version)||this.encapContentInfo.eContentType!==s.ID_DATA?3:1,t.push(new Y({value:this.version})),t.push(new _t({value:Array.from(this.digestAlgorithms,r=>r.toSchema())})),t.push(this.encapContentInfo.toSchema()),this.certificates){const a=new mn({certificates:this.certificates}).toSchema();t.push(new q({idBlock:{tagClass:3,tagNumber:0},value:a.valueBlock.value}))}return this.crls&&t.push(new q({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.crls,r=>{if(r instanceof yc){const a=r.toSchema();return a.idBlock.tagClass=3,a.idBlock.tagNumber=1,a}return r.toSchema(e)})})),t.push(new _t({value:Array.from(this.signerInfos,r=>r.toSchema())})),new O({value:t})}toJSON(){const e={version:this.version,digestAlgorithms:Array.from(this.digestAlgorithms,t=>t.toJSON()),encapContentInfo:this.encapContentInfo.toJSON(),signerInfos:Array.from(this.signerInfos,t=>t.toJSON())};return this.certificates&&(e.certificates=Array.from(this.certificates,t=>t.toJSON())),this.crls&&(e.crls=Array.from(this.crls,t=>t.toJSON())),e}verify({signer:e=-1,data:t=Ct,trustedCerts:r=[],checkDate:a=new Date,checkChain:o=!1,passedWhenNotRevValues:u=!1,extendedMode:h=!1,findOrigin:m=null,findIssuer:N=null}={},T=Je(!0)){var K=this;return(0,k.A)(function*(){let F=null,se=null;try{let Ee=Ct,ye=v,ee=[];const Se=K.signerInfos[e];if(!Se)throw new Vt({date:a,code:1,message:"Unable to get signer by supplied index"});if(!K.certificates)throw new Vt({date:a,code:2,message:"No certificates attached to this signed data"});if(Se.sid instanceof xt){for(const Ae of K.certificates)if(Ae instanceof zt&&Ae.issuer.isEqual(Se.sid.issuer)&&Ae.serialNumber.isEqual(Se.sid.serialNumber)){F=Ae;break}}else{const Ae=Se.sid,Te=Ae.idBlock.isConstructed?Ae.valueBlock.value[0].valueBlock.valueHex:Ae.valueBlock.valueHex;for(const xe of K.certificates)if(xe instanceof zt&&ie(yield T.digest({name:"sha-1"},xe.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView),Te)){F=xe;break}}if(!F)throw new Vt({date:a,code:3,message:"Unable to find signer certificate"});if("1.2.840.113549.1.9.16.1.4"===K.encapContentInfo.eContentType){if(!K.encapContentInfo.eContent)throw new Vt({date:a,code:15,message:"Error during verification: TSTInfo eContent is empty",signatureVerified:null,signerCertificate:F,timestampSerial:se,signerCertificateVerified:!0});let Ae;try{Ae=Lv.fromBER(K.encapContentInfo.eContent.valueBlock.valueHexView)}catch{throw new Vt({date:a,code:15,message:"Error during verification: TSTInfo wrong ASN.1 schema ",signatureVerified:null,signerCertificate:F,timestampSerial:se,signerCertificateVerified:!0})}if(a=Ae.genTime,se=Ae.serialNumber.valueBlock.valueHexView.slice(),0===t.byteLength)throw new Vt({date:a,code:4,message:"Missed detached data input array"});if(!(yield Ae.verify({data:t},T)))throw new Vt({date:a,code:15,message:"Error during verification: TSTInfo verification is failed",signatureVerified:!1,signerCertificate:F,timestampSerial:se,signerCertificateVerified:!0})}if(o){const Ae=K.certificates.filter(Ye=>Ye instanceof zt&&!!Gd(Ye,F)),Te={checkDate:a,certs:Ae,trustedCerts:r};N&&(Te.findIssuer=N),m&&(Te.findOrigin=m);const xe=new Mc(Te);if(xe.certs.push(F),K.crls)for(const Ye of K.crls)"thisUpdate"in Ye?xe.crls.push(Ye):"1.3.6.1.5.5.7.48.1.1"===Ye.otherRevInfoFormat&&xe.ocsps.push(new bv({schema:Ye.otherRevInfo}));K.ocsps&&xe.ocsps.push(...K.ocsps);const Me=yield xe.verify({passedWhenNotRevValues:u},T).catch(Ye=>{throw new Vt({date:a,code:5,message:`Validation of signer's certificate failed with error: ${Ye instanceof Object?Ye.resultMessage:Ye}`,signerCertificate:F,signerCertificateVerified:!1})});if(Me.certificatePath&&(ee=Me.certificatePath),!Me.result)throw new Vt({date:a,code:5,message:`Validation of signer's certificate failed: ${Me.resultMessage}`,signerCertificate:F,signerCertificateVerified:!1})}const ne=T.getAlgorithmByOID(Se.digestAlgorithm.algorithmId);if(!("name"in ne))throw new Vt({date:a,code:7,message:`Unsupported signature algorithm: ${Se.digestAlgorithm.algorithmId}`,signerCertificate:F,signerCertificateVerified:!0});ye=ne.name;const oe=K.encapContentInfo.eContent;if(oe)t=1===oe.idBlock.tagClass&&4===oe.idBlock.tagNumber?oe.getValue():oe.valueBlock.valueBeforeDecodeView;else if(0===t.byteLength)throw new Vt({date:a,code:8,message:"Missed detached data input array",signerCertificate:F,signerCertificateVerified:!0});if(Se.signedAttrs){let Ae=!1,Te=!1;for(const xe of Se.signedAttrs.attributes)if("1.2.840.113549.1.9.3"===xe.type&&(Ae=!0),"1.2.840.113549.1.9.4"===xe.type&&(Te=!0,Ee=xe.values[0].valueBlock.valueHex),Ae&&Te)break;if(!1===Ae)throw new Vt({date:a,code:9,message:'Attribute "content-type" is a mandatory attribute for "signed attributes"',signerCertificate:F,signerCertificateVerified:!0});if(!1===Te)throw new Vt({date:a,code:10,message:'Attribute "message-digest" is a mandatory attribute for "signed attributes"',signatureVerified:null,signerCertificate:F,signerCertificateVerified:!0})}if(Se.signedAttrs){if(!ie(yield T.digest(ye,new Uint8Array(t)),Ee))throw new Vt({date:a,code:15,message:"Error during verification: Message digest doesn't match",signatureVerified:null,signerCertificate:F,timestampSerial:se,signerCertificateVerified:!0});t=Se.signedAttrs.encodedValue}const pe="1.2.840.113549.1.1.1"===Se.signatureAlgorithm.algorithmId?yield T.verifyWithPublicKey(t,Se.signature,F.subjectPublicKeyInfo,Se.signatureAlgorithm,ye):yield T.verifyWithPublicKey(t,Se.signature,F.subjectPublicKeyInfo,Se.signatureAlgorithm);return h?{date:a,code:14,message:v,signatureVerified:pe,signerCertificate:F,timestampSerial:se,signerCertificateVerified:!0,certificatePath:ee}:pe}catch(Ee){throw Ee instanceof Vt?Ee:new Vt({date:a,code:15,message:`Error during verification: ${Ee instanceof Error?Ee.message:Ee}`,signatureVerified:null,signerCertificate:F,timestampSerial:se,signerCertificateVerified:!0})}})()}sign(e,t,r="SHA-1",a=Ct,o=Je(!0)){var u=this;return(0,k.A)(function*(){var h;if(!e)throw new Error("Need to provide a private key for signing");const m=u.signerInfos[t];if(!m)throw new RangeError("SignerInfo index is out of range");(null===(h=m.signedAttrs)||void 0===h||!h.attributes.length)&&"hash"in e.algorithm&&"hash"in e.algorithm&&e.algorithm.hash&&(r=e.algorithm.hash.name);const N=o.getOIDByAlgorithm({name:r},!0,"hashAlgorithm");0===u.digestAlgorithms.filter(se=>se.algorithmId===N).length&&u.digestAlgorithms.push(new X({algorithmId:N,algorithmParams:new kt})),m.digestAlgorithm=new X({algorithmId:N,algorithmParams:new kt});const T=yield o.getSignatureParameters(e,r),K=T.parameters;if(m.signatureAlgorithm=T.signatureAlgorithm,m.signedAttrs)0!==m.signedAttrs.encodedValue.byteLength?a=m.signedAttrs.encodedValue:(a=m.signedAttrs.toSchema().toBER(),b._H.toUint8Array(a)[0]=49);else{const se=u.encapContentInfo.eContent;if(se)a=1===se.idBlock.tagClass&&4===se.idBlock.tagNumber?se.getValue():se.valueBlock.valueBeforeDecodeView;else if(0===a.byteLength)throw new Error("Missed detached data input array")}const F=yield o.signWithPrivateKey(a,e,K);m.signature=new de({valueHex:F})})()}}return s.CLASS_NAME="SignedData",s.ID_DATA=bu,s})();const xi="version",Vi="authSafe",As="macData",Rl="parsedValue",Hv=[xi,Vi,As];let jv=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,xi,s.defaultValues(xi)),this.authSafe=l(e,Vi,s.defaultValues(Vi)),As in e&&(this.macData=l(e,As,s.defaultValues(As))),Rl in e&&(this.parsedValue=l(e,Rl,s.defaultValues(Rl))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xi:return 3;case Vi:return new Ut;case As:return new ki;case Rl:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case xi:return t===s.defaultValues(e);case Vi:return Ut.compareWithDefault("contentType",t.contentType)&&Ut.compareWithDefault("content",t.content);case As:return ki.compareWithDefault("mac",t.mac)&&ki.compareWithDefault("macSalt",t.macSalt)&&ki.compareWithDefault("iterations",t.iterations);case Rl:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Y({name:t.version||xi}),Ut.schema(t.authSafe||{names:{blockName:Vi}}),ki.schema(t.macData||{names:{blockName:As,optional:!0}})]})}fromSchema(e){re(e,Hv);const t=ue(e,e,s.schema({names:{version:xi,authSafe:{names:{blockName:Vi}},macData:{names:{blockName:As}}}}));ae.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.authSafe=new Ut({schema:t.result.authSafe}),As in t.result&&(this.macData=new ki({schema:t.result.macData}))}toSchema(){const e=[new Y({value:this.version}),this.authSafe.toSchema()];return this.macData&&e.push(this.macData.toSchema()),new O({value:e})}toJSON(){const e={version:this.version,authSafe:this.authSafe.toJSON()};return this.macData&&(e.macData=this.macData.toJSON()),e}makeInternalValues(e={},t=Je(!0)){var r=this;return(0,k.A)(function*(){if(ot.assert(e,"parameters","object"),!r.parsedValue)throw new Error('Please call "parseValues" function first in order to make "parsedValue" data');switch(tt.assertEmpty(r.parsedValue.integrityMode,"integrityMode","parsedValue"),tt.assertEmpty(r.parsedValue.authenticatedSafe,"authenticatedSafe","parsedValue"),r.parsedValue.integrityMode){case 0:{if(!("iterations"in e))throw new tt("iterations");tt.assertEmpty(e.pbkdf2HashAlgorithm,"pbkdf2HashAlgorithm"),tt.assertEmpty(e.hmacHashAlgorithm,"hmacHashAlgorithm"),tt.assertEmpty(e.password,"password");const a=new ArrayBuffer(64),o=new Uint8Array(a);t.getRandomValues(o);const u=r.parsedValue.authenticatedSafe.toSchema().toBER(!1);r.authSafe=new Ut({contentType:Ut.DATA,content:new de({valueHex:u})});const h=yield t.stampDataWithPassword({password:e.password,hashAlgorithm:e.hmacHashAlgorithm,salt:a,iterationCount:e.iterations,contentToStamp:u});r.macData=new ki({mac:new Xn({digestAlgorithm:new X({algorithmId:t.getOIDByAlgorithm({name:e.hmacHashAlgorithm},!0,"hmacHashAlgorithm")}),digest:new de({valueHex:h})}),macSalt:new de({valueHex:a}),iterations:e.iterations})}break;case 1:{if(!("signingCertificate"in e))throw new tt("signingCertificate");tt.assertEmpty(e.privateKey,"privateKey"),tt.assertEmpty(e.hashAlgorithm,"hashAlgorithm");const a=r.parsedValue.authenticatedSafe.toSchema().toBER(!1),o=new em({version:1,encapContentInfo:new Zn({eContentType:"1.2.840.113549.1.7.1",eContent:new de({valueHex:a})}),certificates:[e.signingCertificate]}),u=yield t.digest({name:e.hashAlgorithm},new Uint8Array(a)),h=[];h.push(new st({type:"1.2.840.113549.1.9.3",values:[new Ve({value:"1.2.840.113549.1.7.1"})]})),h.push(new st({type:"1.2.840.113549.1.9.5",values:[new Mi({valueDate:new Date})]})),h.push(new st({type:"1.2.840.113549.1.9.4",values:[new de({valueHex:u})]})),o.signerInfos.push(new Lh({version:1,sid:new xt({issuer:e.signingCertificate.issuer,serialNumber:e.signingCertificate.serialNumber}),signedAttrs:new Ht({type:0,attributes:h})})),yield o.sign(e.privateKey,0,e.hashAlgorithm,void 0,t),r.authSafe=new Ut({contentType:"1.2.840.113549.1.7.2",content:o.toSchema(!0)})}break;default:throw new Error(`Parameter "integrityMode" has unknown value: ${r.parsedValue.integrityMode}`)}})()}parseInternalValues(e,t=Je(!0)){var r=this;return(0,k.A)(function*(){switch(ot.assert(e,"parameters","object"),void 0===e.checkIntegrity&&(e.checkIntegrity=!0),r.parsedValue={},r.authSafe.contentType){case Ut.DATA:{tt.assertEmpty(e.password,"password"),r.parsedValue.integrityMode=0,ot.assert(r.authSafe.content,"authSafe.content",de);const a=r.authSafe.content.getValue();if(r.parsedValue.authenticatedSafe=gh.fromBER(a),e.checkIntegrity){if(!r.macData)throw new Error('Absent "macData" value, can not check PKCS#12 data integrity');const o=t.getAlgorithmByOID(r.macData.mac.digestAlgorithm.algorithmId,!0,"digestAlgorithm");if(!(yield t.verifyDataStampedWithPassword({password:e.password,hashAlgorithm:o.name,salt:b._H.toArrayBuffer(r.macData.macSalt.valueBlock.valueHexView),iterationCount:r.macData.iterations||1,contentToVerify:a,signatureToVerify:b._H.toArrayBuffer(r.macData.mac.digest.valueBlock.valueHexView)})))throw new Error("Integrity for the PKCS#12 data is broken!")}}break;case Ut.SIGNED_DATA:{r.parsedValue.integrityMode=1;const a=new em({schema:r.authSafe.content}),o=a.encapContentInfo.eContent;tt.assert(o,"eContent","cmsSigned.encapContentInfo"),ot.assert(o,"eContent",de);const u=o.getValue();if(r.parsedValue.authenticatedSafe=gh.fromBER(u),!(yield a.verify({signer:0,checkChain:!1},t)))throw new Error("Integrity for the PKCS#12 data is broken!")}break;default:throw new Error(`Incorrect value for "this.authSafe.contentType": ${r.authSafe.contentType}`)}})()}}return s.CLASS_NAME="PFX",s})();!function aw(){if(typeof self<"u"){if("crypto"in self){let s="webcrypto";"webkitSubtle"in self.crypto&&(s="safari"),Td(s,new zl({name:s,crypto}))}}else if(typeof crypto<"u"&&"webcrypto"in crypto){const s="NodeJS ^15",i=crypto.webcrypto;Td(s,new zl({name:s,crypto:i}))}}();const ow=function(){var s=(0,k.A)(function*(i,e,t,r,a,o){try{const u={name:"ECDSA",namedCurve:"P-384",typedCurve:""},h=yield crypto.subtle.generateKey(u,!0,["sign","verify"]),m=new kv;m.subject.typesAndValues.push(new gu({type:"2.5.4.3",value:new qt({value:"Test"})})),yield m.subjectPublicKeyInfo.importKey(h.publicKey),yield m.sign(h.privateKey,"SHA-384");const N=m.toSchema().toBER(!1),T=Tl(N,"CERTIFICATE REQUEST"),K=yield new Promise((ye,ee)=>{i.issueNewCertificate(T,e,t,r).subscribe(Se=>{},Se=>{201===Se.status?ye(Se.error.text):(console.error("Error when trying to issue new certificate:",Se.error.message),ee(Se))})}),F=yield crypto.subtle.exportKey("pkcs8",h.privateKey),se=yield crypto.subtle.exportKey("spki",h.publicKey),Ee=new Yi({schema:ct(F).result});if(a){const ee=lw(K).map(oe=>new zt({schema:ct(oe).result})),Se=cw(),ne=yield uw(Ee,ee,Se);return{certificate:K,publicKey:Tl(se,"PUBLIC KEY"),privateKey:Tl(F,"PRIVATE KEY"),pkcs12Keystore:ne,keystorePassword:Se}}return{certificate:K,publicKey:Tl(se,"PUBLIC KEY"),privateKey:Tl(F,"PRIVATE KEY")}}catch(u){return void console.error("Error while issuing new certificate:",u)}});return function(e,t,r,a,o,u){return s.apply(this,arguments)}}(),Tl=(s,i)=>{let e=b.U$.ToBase64(s),t="";for(;e.length>0;)t+=e.substring(0,64)+"\n",e=e.substring(64);return`-----BEGIN ${i}-----\n${t}-----END ${i}-----\n`},lw=s=>{let i=s.split(/-----END CERTIFICATE-----/);return i=i.slice(0,i.length-1),i.map(t=>t.split(/-----BEGIN CERTIFICATE-----/)[1].replace(/\n/gm,"")).map(t=>b.U$.FromBase64(t))},cw=()=>{const i=new Uint32Array(26);crypto.getRandomValues(i);let e="";for(const t of i)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_^$#&!%"[t%70];return e},uw=function(){var s=(0,k.A)(function*(i,e,t){const r=new ArrayBuffer(4);Nu(new Uint8Array(r));const o=new ArrayBuffer(4);Nu(new Uint8Array(o));const h=new ArrayBuffer(4);Nu(new Uint8Array(h));const N=new ArrayBuffer(1);new Uint8Array(N)[0]|=128;const K=new et({valueHex:N,unusedBits:7});i.attributes=[new st({type:"2.5.29.15",values:[K]})];let F="";e[0].subject.typesAndValues.forEach(ee=>{"2.5.4.3"===ee.type&&(F=ee.value.valueBlock.value)});let se="";e[1].subject.typesAndValues.forEach(ee=>{"2.5.4.3"===ee.type&&(se=ee.value.valueBlock.value)});const Ee=new jv({parsedValue:{integrityMode:0,authenticatedSafe:new gh({parsedValue:{safeContents:[{privacyMode:0,value:new ai({safeBags:[new qo({bagId:"1.2.840.113549.1.12.10.1.2",bagValue:new Jd({parsedValue:i}),bagAttributes:[new st({type:"1.2.840.113549.1.9.20",values:[new Xt({value:"PKCS8ShroudedKeyBag from PKIjs"})]}),new st({type:"1.2.840.113549.1.9.21",values:[new de({valueHex:r})]}),new st({type:"1.3.6.1.4.1.311.17.1",values:[new Xt({value:"MCP using https://pkijs.org/"})]})]})]})},{privacyMode:1,value:new ai({safeBags:[new qo({bagId:"1.2.840.113549.1.12.10.1.3",bagValue:new Qu({parsedValue:e[0]}),bagAttributes:[new st({type:"1.2.840.113549.1.9.20",values:[new Xt({value:F})]}),new st({type:"1.2.840.113549.1.9.21",values:[new de({valueHex:o})]}),new st({type:"1.3.6.1.4.1.311.17.1",values:[new Xt({value:"MCP using https://pkijs.org/"})]})]}),new qo({bagId:"1.2.840.113549.1.12.10.1.3",bagValue:new Qu({parsedValue:e[1]}),bagAttributes:[new st({type:"1.2.840.113549.1.9.20",values:[new Xt({value:se})]}),new st({type:"1.2.840.113549.1.9.21",values:[new de({valueHex:h})]}),new st({type:"1.3.6.1.4.1.311.17.1",values:[new Xt({value:"MCP using https://pkijs.org/"})]})]})]})}]}})}}),ye=Ne(t);return yield Ee.parsedValue.authenticatedSafe.parsedValue.safeContents[0].value.safeBags[0].bagValue.makeInternalValues({password:ye,contentEncryptionAlgorithm:{name:"AES-CBC",length:128},hmacHashAlgorithm:"SHA-1",iterationCount:1e5}),yield Ee.parsedValue.authenticatedSafe.makeInternalValues({safeContents:[{},{password:ye,contentEncryptionAlgorithm:{name:"AES-CBC",length:128},hmacHashAlgorithm:"SHA-1",iterationCount:1e5}]}),yield Ee.makeInternalValues({password:ye,iterations:1e5,pbkdf2HashAlgorithm:"SHA-256",hmacHashAlgorithm:"SHA-256"}),Ee.toSchema().toBER(!1)});return function(e,t,r){return s.apply(this,arguments)}}();var Oi=j(5004),os=j(7277);const sm=s=>{switch(s){case os.q.RevocationReasonEnum.Aacompromise:return{value:s,title:"AA compromised",description:"This reason indicates that it is known or suspected that the certificate subject's private key has been compromised. It applies to authority attribute (AA) certificates only.",reference:"https://docs.oracle.com/javase/8/docs/api/java/security/cert/CRLReason.html"};case os.q.RevocationReasonEnum.Affiliationchanged:return{value:s,title:"Affiliation changed",description:"The user has terminated his or her relationship with the organization indicated in the Distinguished Name attribute of the certificate. This revocation code is typically used when an individual is terminated or has resigned from an organization. You do not have to revoke a certificate when a user changes departments, unless your security policy requires different certificate be issued by a departmental CA.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Cacompromise:return{value:s,title:"CA compromised",description:"The token or disk location where the CA's private key is stored has been compromised and is in the possession of an unauthorized individual. When a CA's private key is revoked, this results in all certificates issued by the CA that are signed using the private key associated with the revoked certificate being considered revoked.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Certificatehold:return{value:s,title:"Certificate Hold",description:"A temporary revocation that indicates that a CA will not vouch for a certificate at a specific point in time. Once a certificate is revoked with a CertificateHold reason code, the certificate can then be revoked with another Reason Code, or unrevoked and returned to use.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Cessationofoperation:return{value:s,title:"Cessation of Operation",description:"If a CA is decommissioned, no longer to be used, the CA's certificate should be revoked with this reason code. Do not revoke the CA's certificate if the CA no longer issues new certificates, yet still publishes CRLs for the currently issued certificates.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Keycompromise:return{value:s,title:"Key compromised",description:"The token or disk location where the private key associated with the certificate has been compromised and is in the possession of an unauthorized individual. This can include the case where a laptop is stolen, or a smart card is lost.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Privilegewithdrawn:return{value:s,title:"Privilege withdrawn",description:"A certificate (public-key or attribute certificate) was revoked because a privilege contained within that certificate has been withdrawn",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Removefromcrl:return{value:s,title:"Remove from CRL",description:'If a certificate is revoked with the CertificateHold reason code, it is possible to "unrevoke" a certificate. The unrevoking process still lists the certificate in the CRL, but with the reason code set to RemoveFromCRL.',reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Superseded:return{value:s,title:"Superseded",description:"A replacement certificate has been issued to a user, and the reason does not fall under the previous reasons. This revocation reason is typically used when a smart card fails, the password for a token is forgotten by a user, or the user has changed their legal name.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};default:return{value:s,title:"Unspecified",description:"It is possible to revoke a certificate without providing a specific reason code. While it is possible to revoke a certificate with the Unspecified reason code, this is not recommended, as it does not provide an audit trail as to why a certificate is revoked.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"}}};var hw=j(1224);let fw=(()=>{class s{constructor(e,t,r,a,o,u){this.organizationsService=e,this.devicesService=t,this.servicesService=r,this.usersService=a,this.vesselsService=o,this.mmsService=u}ngOnInit(){}formatCerts(e){let t=[];for(const r in e){const a=e[r];for(const o in a)e[r][o]=a[o];a.revoked&&(a.revokeInfo=a.revokedAt,a.revokeReasonText=sm(a.revokeReason).title),t.push(a)}return t}splitByRevokeStatus(e){let t=[],r=[];for(const a in e){const o=e[a];o.revoked?r.push(o):t.push(o)}return t.sort((a,o)=>a.end-o.end),r.sort((a,o)=>a.end-o.end),{activeCertificates:this.formatCerts(t),revokedCertificates:this.formatCerts(r)}}issueNewCertificate(e,t,r,a){if(null==t||!r)throw new Error("Internal state lost");switch(t){case c.SP.Organization:return this.organizationsService.newOrgCertFromCsr(e,r);case c.SP.Device:return this.devicesService.newDeviceCertFromCsr(e,a,r);case c.SP.Service:return this.servicesService.newServiceCertFromCsr1(e,a,r);case c.SP.User:return this.usersService.newUserCertFromCsr(e,a,r);case c.SP.Vessel:return this.vesselsService.newVesselCertFromCsr(e,a,r);case c.SP.MMS:return this.mmsService.newMMSCertFromCsr(e,a,r);default:throw new Error("Unknown item type")}}revokeCertificate(e,t,r,a,o,u){if(null==e||!t)throw new Error("Internal state lost");switch(e){case c.SP.Organization:return this.organizationsService.revokeOrgCert(o,t,a);case c.SP.Device:return this.devicesService.revokeDeviceCert(o,r,t,a);case c.SP.Service:return u?this.servicesService.revokeServiceCert(o,r,t,u,a):this.servicesService.revokeServiceCert1(o,r,t,a);case c.SP.User:return this.usersService.revokeUserCert(o,r,t,a);case c.SP.Vessel:return this.vesselsService.revokeVesselCert(o,r,t,a);case c.SP.MMS:return this.mmsService.revokeMMSCert(o,r,t,a);default:throw new Error("Unknown item type")}}static#e=this.\u0275fac=function(t){return new(t||s)(n.KVO(Oi.PZ),n.KVO(Oi.SV),n.KVO(Oi.dd),n.KVO(Oi.Tz),n.KVO(Oi.YY),n.KVO(Oi.tZ))};static#t=this.\u0275prov=n.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var rm=j(9380),dw=j(5189),qh=j(5540),mw=j(8721);let gw=(()=>{class s{constructor(e){this.translate=e}downloadPemCertificate(e,t,r){try{const a=t.split(" ").join("_"),o=new mw;o.file("Certificate_"+a+".pem",e.certificate),e.privateKey&&o.file("PrivateKey_"+a+".pem",e.privateKey),e.publicKey&&o.file("PublicKey_"+a+".pem",e.publicKey),e.pkcs12Keystore&&o.file("Keystore_"+a+".p12",e.pkcs12Keystore),e.keystorePassword&&o.file("KeystorePassword_"+a+".txt",e.keystorePassword),o.generateAsync({type:"blob"}).then(function(u){qh.saveAs(u,"Certificate_"+a+".zip")})}catch(a){r.notify("error",this.translate.instant("error.file.downloadcert")+a)}}downloadXml(e,t){e?this.downloadFile(e.content,e.contentContentType,e.name,t):t.notify("error",this.translate.instant("error.file.empty"))}downloadDoc(e,t){if(!e)return void t.notify("error",this.translate.instant("error.file.empty"));if(e.filecontent.length>1&&e.filecontent.length<10)return void t.notify("error",this.translate.instant("error.file.wrongformat")+e.name);let r=e.filecontent.toString();this.downloadBase64File(r,e.filecontentContentType,e.name,t)}downloadBase64File(e,t,r,a){try{let o=this.convertBase64ToByteArray(e),u=new Blob([o],{type:t});qh.saveAs(u,r)}catch(o){a.notify("error",this.translate.instant("error.file.downloaderror")+o)}}downloadFile(e,t,r,a){try{let o=new Blob([e],{type:t});qh.saveAs(o,r)}catch(o){a.notify("error",this.translate.instant("error.file.downloaderror")+o)}}convertBase64ToByteArray(e){let t=window.atob(e),r=new Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return new Uint8Array(r)}static#e=this.\u0275fac=function(t){return new(t||s)(n.KVO(rm.c$))};static#t=this.\u0275prov=n.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var pw=j(6482);const vw=["certModal"],ww=["revokeModal"],yw=["migrateModal"];function Sw(s,i){if(1&s&&n.nrm(0,"input",38),2&s){const e=n.XpG(2).$implicit,t=n.XpG();n.xc7("width",400,"px"),n.Y8G("value",t.convertTimeString(t.item[e.key]))}}function bw(s,i){if(1&s&&n.nrm(0,"input",38),2&s){const e=n.XpG(2).$implicit,t=n.XpG();n.xc7("width",400,"px"),n.Y8G("value",t.item[e.key])}}function Aw(s,i){if(1&s&&n.DNE(0,Sw,1,3,"input",37)(1,bw,1,3,"input",37),2&s){const e=n.XpG().$implicit,t=n.XpG();n.vxM(t.isTimestampFormat(e.key)?0:1)}}function Ew(s,i){1&s&&n.nrm(0,"input",38),2&s&&n.xc7("width",400,"px")}function kw(s,i){if(1&s&&(n.j41(0,"div",34)(1,"label",35),n.EFF(2),n.k0s(),n.j41(3,"div",36)(4,"div",30),n.DNE(5,Aw,2,1)(6,Ew,1,2,"input",37),n.k0s()()()),2&s){const e=i.$implicit,t=n.XpG();n.R7$(2),n.JRh(e.value.title),n.R7$(3),n.vxM(t.item[e.key]?5:6)}}function _w(s,i){if(1&s){const e=n.RV6();n.j41(0,"div",34)(1,"label",35),n.EFF(2,"Active certificates"),n.k0s(),n.j41(3,"div",4)(4,"app-cert-table",39),n.bIt("onAdd",function(){n.eBV(e);const r=n.XpG();return n.Njj(r.openCertModal())})("onDownload",function(r){n.eBV(e);const a=n.XpG();return n.Njj(a.clickDownloadBtn(r))})("onRevoke",function(r){n.eBV(e);const a=n.XpG();return n.Njj(a.clickRevokeBtn(r))}),n.k0s()()(),n.j41(5,"div",34)(6,"label",35),n.EFF(7,"Revoked certificates"),n.k0s(),n.j41(8,"div",4),n.nrm(9,"app-cert-table",40),n.k0s()()}if(2&s){const e=n.XpG();n.R7$(4),n.Y8G("data",e.activeCertificates),n.R7$(5),n.Y8G("data",e.revokedCertificates)}}function Cw(s,i){if(1&s){const e=n.RV6();n.j41(0,"button",41),n.bIt("click",function(){n.eBV(e);const r=n.XpG();return n.Njj(r.clickMigrateBtn())}),n.EFF(1,"Migrate"),n.k0s()}}function Nw(s,i){if(1&s){const e=n.RV6();n.j41(0,"button",42),n.bIt("click",function(){n.eBV(e);const r=n.XpG();return n.Njj(r.approve())}),n.EFF(1,"Approve"),n.k0s()}}function Iw(s,i){if(1&s){const e=n.RV6();n.j41(0,"button",41),n.bIt("click",function(){n.eBV(e);const r=n.XpG();return n.Njj(r.edit())}),n.EFF(1,"Edit"),n.k0s()}}function Bw(s,i){1&s&&(n.j41(0,"div",19)(1,"p"),n.EFF(2,"Here is your certificate bundle. You can download it by clicking the button below."),n.k0s()())}function Rw(s,i){if(1&s&&(n.j41(0,"h3",16),n.EFF(1),n.k0s()),2&s){const e=n.XpG();n.R7$(),n.SpI("Revoke ",e.selectedActiveCerts.length," certificates")}}function Tw(s,i){if(1&s&&(n.j41(0,"h3",16),n.EFF(1),n.k0s()),2&s){const e=n.XpG();n.R7$(),n.SpI("Revoke ",e.selectedActiveCerts.length," certificate")}}function xw(s,i){if(1&s){const e=n.RV6();n.j41(0,"clr-radio-wrapper")(1,"input",43),n.bIt("click",function(){const r=n.eBV(e).$implicit,a=n.XpG();return n.Njj(a.revokeReason=r)}),n.k0s(),n.j41(2,"label"),n.EFF(3),n.k0s()()}if(2&s){const e=i.$implicit;n.R7$(3),n.JRh(e.title)}}function Vw(s,i){if(1&s&&(n.j41(0,"div")(1,"span"),n.EFF(2),n.k0s()(),n.j41(3,"div")(4,"a",44),n.EFF(5,"More info"),n.k0s()()),2&s){const e=n.XpG();n.R7$(2),n.JRh(e.revokeReason.description),n.R7$(2),n.Y8G("href",e.revokeReason.reference,n.B4B)}}function Ow(s,i){1&s&&(n.j41(0,"div")(1,"span"),n.EFF(2,"Select reason name"),n.k0s()())}let Pw=(()=>{class s{constructor(e,t,r,a,o,u){this.certificateService=e,this.translate=t,this.notifier=r,this.fileHelper=a,this.locale=u,this.itemType=c.SP.None,this.item={},this.orgMrn="",this.instanceVersion=void 0,this.onEdit=new n.bkB,this.onMigrate=new n.bkB,this.onDelete=new n.bkB,this.onRefresh=new n.bkB,this.onApprove=new n.bkB,this.onDownloadCert=new n.bkB,this.viewContext="detail",this.columnForMenu={},this.itemId="",this.activeCertificates=[],this.revokedCertificates=[],this.revokeModalOpened=!1,this.certModalOpened=!1,this.fromBrowser=!0,this.revokeReason=void 0,this.revokeReasons=[],this.selectedActiveCerts=[],this.revokeAt=void 0,this.reasonTitle="",this.certificateBundle=void 0,this.migrateModalOpened=!1,this.newServiceMrn="",this.setForm=()=>{Object.entries(B.Y[this.itemType.toString()]).map(([h,m])=>{m.visibleFrom&&(m.visibleFrom&&!m.visibleFrom.includes(this.viewContext)||(this.columnForMenu[h]=m))})},this.assignCertificatesByStatus=h=>{this.activeCertificates=[],this.revokedCertificates=[],h.sort((m,N)=>m.start<N.start?1:-1),h.map(m=>{m.revoked?this.revokedCertificates.push(m):this.activeCertificates.push(m)}),this.revokedCertificates=this.updateRevokeReason(this.revokedCertificates)},this.updateRevokeReason=h=>h.map(m=>({...m,revokeReason:this.revokeReasons.filter(N=>N.value===m.revokeReason)[0].title})),this.sortColumnForMenu=(h,m)=>((s,i)=>s.order>i.order?-1:1)(h,m),this.edit=()=>{this.onEdit.emit(this.item)},this.migrate=()=>{this.onMigrate.emit(this.newServiceMrn)},this.approve=()=>{this.onApprove.emit(this.item)},this.deleteItem=()=>{this.onDelete.emit(this.item)},this.convertTimeString=h=>(0,p.t)(h),this.openCertModal=()=>{this.itemType===c.SP.Service&&this.instanceVersion?this.notifier.notify("error",this.translate.instant("error.form.requiremigrate")):(this.certModal?.open(),this.certModalOpened=!0,this.issue())},this.issue=()=>{ow(this.certificateService,this.itemType,this.itemId,this.orgMrn,this.fromBrowser,this.instanceVersion).then(h=>{this.certificateBundle=h,this.notifier.notify("success",this.translate.instant("success.resource.create"))})},this.revokeCerts=h=>{this.revokeAt=new Date(Date.parse(this.revokeAt.toLocaleString()));const m={revokedAt:this.revokeAt,revocationReason:this.revokeReason?.value};h.forEach(N=>{this.certificateService.revokeCertificate(this.itemType,this.item.mrn,this.orgMrn,N.serialNumber,m,this.instanceVersion).subscribe(T=>{this.notifier.notify("success",this.translate.instant("success.certificate.revoke")),this.cancel()},T=>{this.notifier.notify("error",this.translate.instant("error.certificate.revoke"))})})},this.clickDownloadBtn=h=>{0!==h.length?h.forEach(m=>{const N=(0,g.Yq)(m.end,"yyyy-MM-ddTHH-mm-ss",this.locale);this.fileHelper.downloadPemCertificate({certificate:m.certificate},this.item.mrn+"_exp_"+N,this.notifier)}):this.notifier.notify("warning",this.translate.instant("error.selection.noSelection"))},this.clickRevokeBtn=h=>{this.itemType===c.SP.Service&&this.instanceVersion?this.notifier.notify("error",this.translate.instant("error.form.requiremigrate")):0!==h.length?(this.revokeModalOpened=!0,this.selectedActiveCerts=h):this.notifier.notify("warning",this.translate.instant("error.selection.noSelection"))},this.clickMigrateBtn=()=>{this.migrateModal?.open(),this.migrateModalOpened=!0,this.newServiceMrn=this.item.mrn+":"+this.instanceVersion},this.cancel=()=>{this.certModal?.close(),this.certModalOpened=!1,this.revokeModal?.close(),this.revokeModalOpened=!1,this.migrateModal?.close(),this.migrateModalOpened=!1,this.onRefresh.emit(),this.newServiceMrn="",this.certificateBundle=void 0},this.refreshData=()=>{this.onRefresh.emit()},this.issueFromBrowser=()=>{this.fromBrowser=!0},this.issueManualKeystore=()=>{this.fromBrowser=!1},this.capitalize=h=>h[0].toUpperCase()+h.slice(1);for(const h in Oi.qQ.RevocationReasonEnum)this.revokeReasons.push(sm(h.toLocaleLowerCase()));this.revokeReasons.sort((h,m)=>h.value.localeCompare(m.value)),o.getOrgMrn().then(h=>{this.orgMrn=h})}ngOnChanges(e){!e.item||!e.item.currentValue||(this.item=e.item.currentValue&&e.item.currentValue,this.item&&this.itemType===c.SP.Role?(this.itemId=this.item.id,this.setForm()):this.item&&this.item.mrn&&(this.itemId=this.item.mrn,this.item.instanceVersion&&(this.instanceVersion=this.item.instanceVersion),this.itemType===c.SP.Vessel&&(this.item=(0,hw.BY)(this.item)),this.setForm(),this.item.certificates&&this.assignCertificatesByStatus(this.item.certificates)))}isTimestampFormat(e){return c.N3.includes(e)}download(){this.certificateBundle&&(this.fileHelper.downloadPemCertificate(this.certificateBundle,this.itemId,this.notifier),this.notifier.notify("success",this.translate.instant("success.certificate.chosen")))}static#e=this.\u0275fac=function(t){return new(t||s)(n.rXU(fw),n.rXU(rm.c$),n.rXU(dw.iJ),n.rXU(gw),n.rXU(pw.u),n.rXU(n.xe9))};static#t=this.\u0275cmp=n.VBU({type:s,selectors:[["app-item-view"]],viewQuery:function(t,r){if(1&t&&(n.GBs(vw,7),n.GBs(ww,7),n.GBs(yw,7)),2&t){let a;n.mGM(a=n.lsd())&&(r.certModal=a.first),n.mGM(a=n.lsd())&&(r.revokeModal=a.first),n.mGM(a=n.lsd())&&(r.migrateModal=a.first)}},inputs:{itemType:"itemType",item:"item",orgMrn:"orgMrn",instanceVersion:"instanceVersion"},outputs:{onEdit:"onEdit",onMigrate:"onMigrate",onDelete:"onDelete",onRefresh:"onRefresh",onApprove:"onApprove",onDownloadCert:"onDownloadCert"},standalone:!0,features:[n.OA$,n.aNF],decls:100,vars:17,consts:[["certModal",""],["revokeModal",""],["migrateModal",""],[1,"clr-row"],[1,"clr-col-lg-12","clr-col-md-8","clr-col-12"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"card-text"],["clrForm",""],["class","clr-form-horizontal clr-form-control clr-row",4,"ngFor","ngForOf"],[1,"card-footer"],[1,"btn","btn-primary"],[1,"btn","btn-success"],[1,"btn","btn-danger",3,"click"],["clrModalSize","lg",1,"modal",3,"clrModalOpenChange","clrModalOpen"],[1,"modal-title"],["aria-label","Close","type","button",1,"close",3,"click"],[1,"modal-body"],[1,"clr-col-sm-12","clr-col-md-12"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-outline",3,"click"],[1,"clr-col-4"],[1,"clr-col-8"],["type","date","autocomplete","off","clrDate","","name","demo",3,"ngModelChange","ngModel"],[1,"clr-form"],[1,"clr-form-control"],["for","basic",1,"clr-control-label"],[1,"clr-control-container"],[1,"clr-input-wrapper"],["type","text","id","basic","placeholder","Enter value here",1,"clr-input",3,"value"],["shape","exclamation-circle",1,"clr-validate-icon"],[1,"clr-subtext"],[1,"clr-form-horizontal","clr-form-control","clr-row"],[1,"clr-control-label"],["ng-reflect-ng-class","clr-col-md-10 clr-col-12",1,"clr-control-container","clr-col-md-10","clr-col-12"],["clrinput","","type","string","ng-reflect-name","mrn","ng-reflect-required","true","id","clr-form-control-1","required","","aria-describedby","clr-form-control-1-helper",1,"clr-input","ng-untouched","ng-pristine","ng-invalid","ng-star-inserted",3,"value","width"],["clrinput","","type","string","ng-reflect-name","mrn","ng-reflect-required","true","id","clr-form-control-1","required","","aria-describedby","clr-form-control-1-helper",1,"clr-input","ng-untouched","ng-pristine","ng-invalid","ng-star-inserted",3,"value"],["context","active",3,"onAdd","onDownload","onRevoke","data"],["context","revoked",3,"data"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-success",3,"click"],["type","radio","clrRadio","","name","options","required","",3,"click"],["target","_blank",3,"href"]],template:function(t,r){if(1&t){const a=n.RV6();n.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6),n.EFF(4),n.k0s(),n.j41(5,"div",7)(6,"div",8)(7,"form",9),n.DNE(8,kw,7,2,"div",10),n.nI1(9,"keyvalue"),n.DNE(10,_w,10,2),n.k0s()()(),n.j41(11,"div",11),n.DNE(12,Cw,2,0,"button",12)(13,Nw,2,0,"button",13)(14,Iw,2,0,"button",12),n.j41(15,"button",14),n.bIt("click",function(){return n.eBV(a),n.Njj(r.deleteItem())}),n.EFF(16,"Delete"),n.k0s()()()()(),n.j41(17,"clr-modal",15,0),n.mxI("clrModalOpenChange",function(u){return n.eBV(a),n.DH7(r.certModalOpened,u)||(r.certModalOpened=u),n.Njj(u)}),n.j41(19,"div",16)(20,"button",17),n.bIt("click",function(){return n.eBV(a),n.Njj(r.cancel())}),n.k0s(),n.j41(21,"h3",16),n.EFF(22,"Issue a new certificate"),n.k0s()(),n.j41(23,"div",18),n.DNE(24,Bw,3,0,"div",19),n.k0s(),n.j41(25,"div",20)(26,"button",21),n.bIt("click",function(){return n.eBV(a),n.Njj(r.download())}),n.EFF(27,"Download certificate"),n.k0s(),n.j41(28,"button",22),n.bIt("click",function(){return n.eBV(a),n.Njj(r.cancel())}),n.EFF(29,"Close"),n.k0s()()(),n.j41(30,"clr-modal",15,1),n.mxI("clrModalOpenChange",function(u){return n.eBV(a),n.DH7(r.revokeModalOpened,u)||(r.revokeModalOpened=u),n.Njj(u)}),n.j41(32,"div",16)(33,"button",17),n.bIt("click",function(){return n.eBV(a),n.Njj(r.cancel())}),n.k0s(),n.DNE(34,Rw,2,1,"h3",16)(35,Tw,2,1,"h3",16),n.k0s(),n.j41(36,"div",18)(37,"div",19)(38,"div",3)(39,"span")(40,"b"),n.EFF(41,"Warning: chosen certificates will no longer be valid when they are revoked!"),n.k0s()()(),n.j41(42,"div",3)(43,"div",23)(44,"div")(45,"h5"),n.EFF(46,"Reason name"),n.k0s()(),n.j41(47,"div"),n.Z7z(48,xw,4,1,"clr-radio-wrapper",null,n.fX1),n.k0s()(),n.j41(50,"div",24)(51,"div")(52,"h5"),n.EFF(53,"Explanation"),n.k0s()(),n.j41(54,"div"),n.DNE(55,Vw,6,2)(56,Ow,3,0,"div"),n.k0s()()(),n.j41(57,"div",3)(58,"div",23)(59,"div")(60,"h5"),n.EFF(61,"Revoke at"),n.k0s()()(),n.j41(62,"div",24)(63,"clr-date-container")(64,"input",25),n.mxI("ngModelChange",function(u){return n.eBV(a),n.DH7(r.revokeAt,u)||(r.revokeAt=u),n.Njj(u)}),n.k0s()()()(),n.j41(65,"div",3)(66,"div")(67,"p"),n.EFF(68,"Choose revocation reason and date to proceed."),n.k0s()()()()(),n.j41(69,"div",20)(70,"button",21),n.bIt("click",function(){return n.eBV(a),n.Njj(r.revokeCerts(r.selectedActiveCerts))}),n.EFF(71,"Revoke"),n.k0s(),n.j41(72,"button",22),n.bIt("click",function(){return n.eBV(a),n.Njj(r.cancel())}),n.EFF(73,"Cancel"),n.k0s()()(),n.j41(74,"clr-modal",15,2),n.mxI("clrModalOpenChange",function(u){return n.eBV(a),n.DH7(r.migrateModalOpened,u)||(r.migrateModalOpened=u),n.Njj(u)}),n.j41(76,"div",16)(77,"button",17),n.bIt("click",function(){return n.eBV(a),n.Njj(r.cancel())}),n.k0s(),n.EFF(78," Migrate service "),n.k0s(),n.j41(79,"div",18)(80,"div",19)(81,"div",3)(82,"span"),n.EFF(83,"This migration allows you to remove the version from an existing service's MRN by assigning a new MRN that includes the version. It simplifies version management and future updates, making it easier for users to maintain and update services. The MRN below is given as an example, but you can edit it as you want."),n.k0s()(),n.j41(84,"div",3)(85,"form",26)(86,"div",27)(87,"label",28),n.EFF(88,"Recommended new MRN for your service"),n.k0s(),n.j41(89,"div",29)(90,"div",30),n.nrm(91,"input",31)(92,"cds-icon",32),n.k0s(),n.j41(93,"span",33),n.EFF(94,"New MRN can have the version of service inside."),n.k0s()()()()()()(),n.j41(95,"div",20)(96,"button",21),n.bIt("click",function(){return n.eBV(a),n.Njj(r.migrate())}),n.EFF(97,"Migrate"),n.k0s(),n.j41(98,"button",22),n.bIt("click",function(){return n.eBV(a),n.Njj(r.cancel())}),n.EFF(99,"Cancel"),n.k0s()()()}2&t&&(n.R7$(4),n.SpI(" ",r.capitalize(r.itemType)," details "),n.R7$(4),n.Y8G("ngForOf",n.i5U(9,14,r.columnForMenu,r.sortColumnForMenu)),n.R7$(2),n.vxM("role"!==r.itemType?10:-1),n.R7$(2),n.vxM("service"===r.itemType&&r.instanceVersion?12:"orgcandidate"===r.itemType?13:14),n.R7$(5),n.R50("clrModalOpen",r.certModalOpened),n.R7$(7),n.vxM(r.certificateBundle?24:-1),n.R7$(6),n.R50("clrModalOpen",r.revokeModalOpened),n.R7$(4),n.vxM(r.selectedActiveCerts.length>1?34:35),n.R7$(14),n.Dyx(r.revokeReasons),n.R7$(7),n.vxM(r.revokeReason?55:56),n.R7$(9),n.R50("ngModel",r.revokeAt),n.R7$(10),n.R50("clrModalOpen",r.migrateModalOpened),n.R7$(17),n.xc7("width",400,"px"),n.Y8G("value",r.newServiceMrn))},dependencies:[S.G,g.Sq,g.lG,_.z7t,_.bZN,_.zN1,_.BlU,_.jsN,_.aZZ,_.mDd,_.fkp,_.cIb,_.CxT,_.lnv,_._Qf,_.WF1,w,y.YN,y.qT,y.me,y.BC,y.cb,y.vS,y.cV]})}return s})()},3426:(It,L,j)=>{"use strict";j.d(L,{d:()=>R});var n=j(6994),c=j(5950),A=j(3585),p=j(5166),C=j(3685),V=j(1066),U=j(8745),P=j(6482),H=j(5004);function w($,d){if(1&$){const D=c.RV6();c.j41(0,"div")(1,"button",1),c.bIt("click",function(){c.eBV(D);const W=c.XpG();return c.Njj(W.back())}),c.EFF(2,"Back"),c.k0s()(),c.j41(3,"div",2)(4,"div",3)(5,"app-item-view",4),c.bIt("onEdit",function(){c.eBV(D);const W=c.XpG();return c.Njj(W.edit(W.selectedItem))})("onDelete",function(){c.eBV(D);const W=c.XpG();return c.Njj(W.deleteItem(W.selectedItem))})("onRefresh",function(){c.eBV(D);const W=c.XpG();return c.Njj(W.refreshData())})("onMigrate",function(W){c.eBV(D);const Be=c.XpG();return c.Njj(Be.migrate(W))})("onApprove",function(){c.eBV(D);const W=c.XpG();return c.Njj(W.approve(W.selectedItem))}),c.k0s()()()}if(2&$){const D=c.XpG();c.R7$(5),c.Y8G("itemType",D.itemType)("item",D.selectedItem)}}function B($,d){if(1&$){const D=c.RV6();c.j41(0,"div",9)(1,"button",10),c.bIt("click",function(){c.eBV(D);const W=c.XpG(3);return c.Njj(W.onAdd())}),c.nrm(2,"cds-icon",11),c.EFF(3),c.k0s()()}if(2&$){const D=c.XpG(3);c.R7$(3),c.SpI(" ",D.addText," ")}}function y($,d){if(1&$){const D=c.RV6();c.j41(0,"div",9)(1,"button",10),c.bIt("click",function(){c.eBV(D);const W=c.XpG(3);return c.Njj(W.onDelete(W.selected))}),c.nrm(2,"cds-icon",12),c.EFF(3),c.k0s(),c.j41(4,"button",10),c.bIt("click",function(){c.eBV(D);const W=c.XpG(3);return c.Njj(W.onDownload(W.selected))}),c.nrm(5,"cds-icon",13),c.EFF(6),c.k0s()()}if(2&$){const D=c.XpG(3);c.R7$(3),c.SpI(" ",D.deleteText,""),c.R7$(3),c.SpI(" ",D.downloadText,"")}}function E($,d){if(1&$){const D=c.RV6();c.j41(0,"div",9)(1,"button",10),c.bIt("click",function(){c.eBV(D);const W=c.XpG(3);return c.Njj(W.onDelete(W.selected))}),c.nrm(2,"cds-icon",12),c.EFF(3),c.k0s()()}if(2&$){const D=c.XpG(3);c.R7$(3),c.SpI(" ",D.deleteText,"")}}function g($,d){if(1&$&&(c.j41(0,"clr-dg-action-bar"),c.DNE(1,B,4,1,"div",9)(2,y,7,2,"div",9)(3,E,4,1,"div",9),c.k0s()),2&$){const D=c.XpG(2);c.R7$(),c.vxM(void 0!==D.onAdd?1:-1),c.R7$(),c.vxM(void 0!==D.onDelete&&void 0!==D.onDownload?2:void 0!==D.onDelete?3:-1)}}function S($,d){if(1&$&&(c.j41(0,"clr-dg-column"),c.EFF(1),c.k0s()),2&$){const D=d.$implicit;c.R7$(),c.JRh(D)}}function _($,d){if(1&$){const D=c.RV6();c.j41(0,"clr-dg-cell",15),c.bIt("click",function(){c.eBV(D);const W=c.XpG(2).$implicit,Be=c.XpG(2);return c.Njj(Be.userRowSelect(W))}),c.EFF(1),c.k0s()}if(2&$){const D=c.XpG().$implicit,ie=c.XpG().$implicit,W=c.XpG(2);c.R7$(),c.JRh(W.convertTimeString(ie[D]))}}function k($,d){if(1&$){const D=c.RV6();c.j41(0,"clr-dg-cell",15),c.bIt("click",function(){c.eBV(D);const W=c.XpG(2).$implicit,Be=c.XpG(2);return c.Njj(Be.userRowSelect(W))}),c.EFF(1),c.k0s()}if(2&$){const D=c.XpG().$implicit,ie=c.XpG().$implicit;c.R7$(),c.JRh(ie[D])}}function b($,d){if(1&$&&c.DNE(0,_,2,1,"clr-dg-cell")(1,k,2,1,"clr-dg-cell"),2&$){const D=d.$implicit,ie=c.XpG(3);c.vxM(ie.isTimestampFormat(D)?0:1)}}function Z($,d){if(1&$&&(c.j41(0,"clr-dg-row",14),c.Z7z(1,b,2,1,null,null,c.fX1),c.k0s()),2&$){const D=d.$implicit,ie=c.XpG(2);c.Y8G("clrDgItem",D),c.R7$(),c.Dyx(ie.labelKeys)}}function l($,d){if(1&$&&(c.j41(0,"clr-dg-detail")(1,"clr-dg-detail-header"),c.EFF(2),c.k0s(),c.j41(3,"clr-dg-detail-body"),c.nrm(4,"app-item-view",17),c.k0s()()),2&$){const D=d.$implicit,ie=c.XpG(3);c.R7$(2),c.JRh(D.mrn),c.R7$(2),c.Y8G("itemType",ie.itemType)("item",D)}}function we($,d){1&$&&c.DNE(0,l,5,3,"clr-dg-detail",16)}function te($,d){if(1&$){const D=c.RV6();c.j41(0,"button",20),c.bIt("click",function(){const W=c.eBV(D).$implicit,Be=c.XpG(3);return c.Njj(Be.loadData(W))}),c.EFF(1),c.k0s()}if(2&$){const D=d.$implicit,ie=c.XpG(3);c.Y8G("disabled",D==ie.currentPageNumber),c.R7$(),c.JRh(D+1)}}function be($,d){if(1&$&&(c.j41(0,"div",8)(1,"div",18),c.Z7z(2,te,2,2,"button",19,c.fX1),c.k0s()()),2&$){const D=c.XpG(2);c.R7$(2),c.Dyx(D.pageNumbers)}}function Oe($,d){if(1&$){const D=c.RV6();c.j41(0,"clr-datagrid",5),c.mxI("clrDgSelectedChange",function(W){c.eBV(D);const Be=c.XpG();return c.DH7(Be.selected,W)||(Be.selected=W),c.Njj(W)}),c.bIt("clrDgRefresh",function(W){c.eBV(D);const Be=c.XpG();return c.Njj(Be.refresh(W))}),c.DNE(1,g,4,2,"clr-dg-action-bar"),c.Z7z(2,S,2,1,"clr-dg-column",null,c.fX1),c.j41(4,"clr-dg-placeholder",6),c.EFF(5),c.k0s(),c.DNE(6,Z,3,1,"clr-dg-row",7)(7,we,1,0,"clr-dg-detail"),c.j41(8,"clr-dg-footer"),c.DNE(9,be,4,0,"div",8),c.k0s()()}if(2&$){const D=c.XpG();c.R50("clrDgSelected",D.selected),c.Y8G("clrDgLoading",D.isLoading),c.R7$(),c.vxM(D.onAdd||D.onDelete||D.onDownload?1:-1),c.R7$(),c.Dyx(D.labelTitles),c.R7$(3),c.JRh(D.placeholder),c.R7$(),c.Y8G("clrDgItemsOf",D.data),c.R7$(),c.vxM(D.detailView?7:-1),c.R7$(2),c.vxM(D.totalPages>1?9:-1)}}let R=(()=>{class ${constructor(D,ie,W){this.router=D,this.authService=ie,this.roleService=W,this.itemType=p.SP.Device,this.labels=void 0,this.placeholder="We couldn't find any data!",this.deleteText="Delete",this.downloadText="Download",this.addText="Add",this.totalPages=0,this.totalElements=0,this.getData=Be=>new Promise((ve,he)=>ve([])),this.onRowSelect=new c.bkB,this.onRevokeCerts=new c.bkB,this.onDownloadCerts=new c.bkB,this.onEdit=new c.bkB,this.onMigrate=new c.bkB,this.onRefresh=new c.bkB,this.onApprove=new c.bkB,this.data=void 0,this.selected=[],this.detail={},this.selectedItem={},this.expanded=!1,this.detailView=!1,this.labelKeys=[],this.labelTitles=[],this.isLoading=!1,this.pageNumbers=[],this.currentPageNumber=0,this.elementsPerPage=10,this.roles=[],this.userRowSelect=Be=>{this.expanded=!0,this.selectedItem=Be,this.onRowSelect.emit(Be)},this.back=()=>{this.expanded=!1,this.selectedItem={}},this.edit=Be=>{this.expanded=!0,this.selectedItem=Be,this.onEdit.emit(Be)},this.approve=Be=>{this.onApprove.emit(Be)},this.migrate=Be=>{this.onMigrate.emit({...this.selectedItem,newServiceMrn:Be})},this.deleteItem=Be=>{this.onDelete?.call(this,[Be])},this.convertTimeString=Be=>(0,V.t)(Be),this.refreshData=()=>{this.loadData().then(()=>{if(this.selectedItem&&this.selectedItem.mrn){const Be=this.data?.find(ve=>this.itemType===p.SP.Service?ve.mrn===this.selectedItem.mrn&&ve.instanceVersion===this.selectedItem.instanceVersion:this.itemType===p.SP.Role?ve.id===this.selectedItem.id:ve.mrn===this.selectedItem.mrn);Be&&(this.selectedItem=Be)}})},this.isLoading=!0}ngOnInit(){this.labels&&(this.labelKeys=Object.keys(this.labels),this.labelTitles=Object.values(this.labels).map(D=>D.title)),this.authService.getOrgMrn().then(D=>{this.roleService.getRoles(D).subscribe(ie=>{this.roles=ie})})}ngOnChanges(D){D.totalPages&&(this.pageNumbers=Array(this.totalPages).fill(0).map((ie,W)=>W))}loadData(D=this.currentPageNumber){var ie=this;return(0,n.A)(function*(){ie.data=(yield ie.getData(ie.itemType,D,ie.elementsPerPage))||[],D!==ie.currentPageNumber&&(ie.currentPageNumber=D),ie.isLoading=!1})()}refresh(D){var ie=this;return(0,n.A)(function*(){ie.data||ie.loadData()})()}isTimestampFormat(D){return p.N3.includes(D)}static#e=this.\u0275fac=function(ie){return new(ie||$)(c.rXU(U.Ix),c.rXU(P.u),c.rXU(H.Ky))};static#t=this.\u0275cmp=c.VBU({type:$,selectors:[["app-smart-expandable-table"]],inputs:{itemType:"itemType",labels:"labels",placeholder:"placeholder",onDownload:"onDownload",onDelete:"onDelete",onAdd:"onAdd",deleteText:"deleteText",downloadText:"downloadText",addText:"addText",totalPages:"totalPages",totalElements:"totalElements",getData:"getData"},outputs:{onRowSelect:"onRowSelect",onRevokeCerts:"onRevokeCerts",onDownloadCerts:"onDownloadCerts",onEdit:"onEdit",onMigrate:"onMigrate",onRefresh:"onRefresh",onApprove:"onApprove"},standalone:!0,features:[c.OA$,c.aNF],decls:2,vars:1,consts:[[3,"clrDgSelected","clrDgLoading"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"clr-row"],[1,"clr-col-lg-12","clr-col-md-8","clr-col-12"],[3,"onEdit","onDelete","onRefresh","onMigrate","onApprove","itemType","item"],[3,"clrDgSelectedChange","clrDgRefresh","clrDgSelected","clrDgLoading"],[1,"datagrid-empty"],[3,"clrDgItem",4,"clrDgItems","clrDgItemsOf"],[1,"clr-row","clr-justify-content-center"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],["shape","times"],["shape","download"],[3,"clrDgItem"],[3,"click"],[4,"clrIfDetail"],[3,"itemType","item"],[1,"btn-group","btn-outline-primary","btn-sm"],[1,"btn",3,"disabled"],[1,"btn",3,"click","disabled"]],template:function(ie,W){1&ie&&c.DNE(0,w,6,2)(1,Oe,10,7,"clr-datagrid",0),2&ie&&c.vxM(W.expanded?0:1)},dependencies:[A.PuD,A.ghA,A.fQA,A.slD,A.scM,A.f1O,A.PNO,A.ig6,A.Lwm,A.AtP,A.XTg,A.E1i,A.aFj,A.NTI,A.cIg,A.qDI,A.v0q,A.Aup,A.rpC,A.mCo,A.BlU,A.oFi,C.Y]})}return $})()},2537:(It,L,j)=>{"use strict";j.d(L,{B:()=>Oe});var n=j(5950),c=j(3585),A=j(1232),p=j(5930);const V=["download",(0,p.s)({outline:'<path d="M31,31H5a1,1,0,0,0,0,2H31a1,1,0,0,0,0-2Z"/><path d="M18,29.48,28.61,18.87a1,1,0,0,0-1.41-1.41L19,25.65V5a1,1,0,0,0-2,0V25.65L8.81,17.46a1,1,0,1,0-1.41,1.41Z"/>',outlineAlerted:'<path d="M31,31H5a1,1,0,0,0,0,2H31a1,1,0,0,0,0-2Z"/><path d="M18,29.48,28.61,18.87a1,1,0,0,0-1.41-1.41L19,25.65V5a1,1,0,0,0-2,0V25.65L8.81,17.46a1,1,0,1,0-1.41,1.41Z"/>',outlineBadged:'<path d="M31,31H5a1,1,0,0,0,0,2H31a1,1,0,0,0,0-2Z"/><path d="M18,29.48,28.61,18.87a1,1,0,0,0-1.41-1.41L19,25.65V5a1,1,0,0,0-2,0V25.65L8.81,17.46a1,1,0,1,0-1.41,1.41Z"/>'})];var U=j(673);const H=["plus",(0,p.s)({outline:'<path d="M30,17H19V6a1,1,0,1,0-2,0V17H6a1,1,0,0,0-1,1,.91.91,0,0,0,1,.94H17V30a1,1,0,1,0,2,0V19H30a1,1,0,0,0,1-1A1,1,0,0,0,30,17Z"/>'})];var w=j(5166),B=j(1066);const y=()=>[10,20,50,100];function E(R,$){1&R&&(n.j41(0,"clr-spinner"),n.EFF(1,"Loading"),n.k0s())}function g(R,$){if(1&R){const d=n.RV6();n.j41(0,"div",7)(1,"button",8),n.bIt("click",function(){n.eBV(d);const ie=n.XpG(3);return n.Njj(ie.onAdd())}),n.nrm(2,"cds-icon",9),n.EFF(3),n.k0s()()}if(2&R){const d=n.XpG(3);n.R7$(3),n.SpI(" ",d.addText," ")}}function S(R,$){if(1&R){const d=n.RV6();n.j41(0,"div",7)(1,"button",8),n.bIt("click",function(){n.eBV(d);const ie=n.XpG(3);return n.Njj(ie.onDelete(ie.selected))}),n.nrm(2,"cds-icon",10),n.EFF(3),n.k0s(),n.j41(4,"button",8),n.bIt("click",function(){n.eBV(d);const ie=n.XpG(3);return n.Njj(ie.onDownload(ie.selected))}),n.nrm(5,"cds-icon",11),n.EFF(6),n.k0s()()}if(2&R){const d=n.XpG(3);n.R7$(3),n.SpI(" ",d.deleteText,""),n.R7$(3),n.SpI(" ",d.downloadText,"")}}function _(R,$){if(1&R){const d=n.RV6();n.j41(0,"div",7)(1,"button",8),n.bIt("click",function(){n.eBV(d);const ie=n.XpG(3);return n.Njj(ie.onDelete(ie.selected))}),n.nrm(2,"cds-icon",10),n.EFF(3),n.k0s()()}if(2&R){const d=n.XpG(3);n.R7$(3),n.SpI(" ",d.deleteText,"")}}function k(R,$){if(1&R&&(n.j41(0,"clr-dg-action-bar"),n.DNE(1,g,4,1,"div",7)(2,S,7,2,"div",7)(3,_,4,1,"div",7),n.k0s()),2&R){const d=n.XpG(2);n.R7$(),n.vxM(void 0!==d.onAdd?1:-1),n.R7$(),n.vxM(void 0!==d.onDelete&&void 0!==d.onDownload?2:void 0!==d.onDelete?3:-1)}}function b(R,$){if(1&R&&(n.j41(0,"clr-dg-column"),n.EFF(1),n.k0s()),2&R){const d=$.$implicit;n.R7$(),n.JRh(d)}}function Z(R,$){if(1&R){const d=n.RV6();n.j41(0,"clr-dg-cell",13),n.bIt("click",function(){n.eBV(d);const ie=n.XpG(2).$implicit,W=n.XpG(2);return n.Njj(W.userRowSelect(ie))}),n.EFF(1),n.k0s()}if(2&R){const d=n.XpG().$implicit,D=n.XpG().$implicit,ie=n.XpG(2);n.R7$(),n.JRh(ie.convertTimeString(D[d]))}}function l(R,$){if(1&R){const d=n.RV6();n.j41(0,"clr-dg-cell",13),n.bIt("click",function(){n.eBV(d);const ie=n.XpG(2).$implicit,W=n.XpG(2);return n.Njj(W.userRowSelect(ie))}),n.EFF(1),n.k0s()}if(2&R){const d=n.XpG().$implicit,D=n.XpG().$implicit;n.R7$(),n.JRh(D[d])}}function we(R,$){if(1&R&&n.DNE(0,Z,2,1,"clr-dg-cell")(1,l,2,1,"clr-dg-cell"),2&R){const d=$.$implicit,D=n.XpG(3);n.vxM(D.isTimestampFormat(d)?0:1)}}function te(R,$){if(1&R&&(n.j41(0,"clr-dg-row",12),n.Z7z(1,we,2,1,null,null,n.fX1),n.k0s()),2&R){const d=$.$implicit,D=n.XpG(2);n.Y8G("clrDgItem",d),n.R7$(),n.Dyx(D.labelKeys)}}function be(R,$){if(1&R){const d=n.RV6();n.j41(0,"clr-datagrid",2),n.mxI("clrDgSelectedChange",function(ie){n.eBV(d);const W=n.XpG();return n.DH7(W.selected,ie)||(W.selected=ie),n.Njj(ie)}),n.DNE(1,k,4,2,"clr-dg-action-bar"),n.Z7z(2,b,2,1,"clr-dg-column",null,n.fX1),n.j41(4,"clr-dg-placeholder",3),n.EFF(5),n.k0s(),n.DNE(6,te,3,1,"clr-dg-row",4),n.j41(7,"clr-dg-footer")(8,"clr-dg-pagination",5,0)(10,"clr-dg-page-size",6),n.EFF(11," items per page"),n.k0s(),n.EFF(12),n.k0s()()()}if(2&R){const d=n.sdS(9),D=n.XpG();n.R50("clrDgSelected",D.selected),n.R7$(),n.vxM(D.onAdd||D.onDelete||D.onDownload?1:-1),n.R7$(),n.Dyx(D.labelTitles),n.R7$(3),n.JRh(D.placeholder),n.R7$(),n.Y8G("clrDgItemsOf",D.data),n.R7$(2),n.Y8G("clrDgPageSize",10),n.R7$(2),n.Y8G("clrPageSizeOptions",n.lJ4(9,y)),n.R7$(2),n.E5c(" ",d.firstItem+1," - ",d.lastItem+1," of ",d.totalItems," certificates ")}}A.h.addIcons(V,U.a,H);let Oe=(()=>{class R{constructor(){this.data=[],this.itemType=w.SP.Device,this.labels={},this.placeholder="We couldn't find any data!",this.deleteText="Delete",this.downloadText="Download",this.addText="Add",this.onRowSelect=new n.bkB,this.selected=[],this.detail={},this.isLoading=!1,this.labelKeys=[],this.labelTitles=[],this.userRowSelect=d=>{this.onRowSelect&&this.onRowSelect.emit(d)},this.convertTimeString=d=>(0,B.t)(d),this.isLoading=!0}ngOnChanges(d){d.data.currentValue.length>0&&(this.labelKeys=Object.keys(this.labels),this.labelTitles=Object.values(this.labels).map(D=>D.title)),this.isLoading=!1}isTimestampFormat(d){return w.N3.includes(d)}static#e=this.\u0275fac=function(D){return new(D||R)};static#t=this.\u0275cmp=n.VBU({type:R,selectors:[["app-smart-table"]],inputs:{data:"data",itemType:"itemType",labels:"labels",placeholder:"placeholder",onDownload:"onDownload",onDelete:"onDelete",onAdd:"onAdd",deleteText:"deleteText",downloadText:"downloadText",addText:"addText"},outputs:{onRowSelect:"onRowSelect"},standalone:!0,features:[n.OA$,n.aNF],decls:2,vars:1,consts:[["pagination",""],[3,"clrDgSelected"],[3,"clrDgSelectedChange","clrDgSelected"],[1,"datagrid-empty"],[3,"clrDgItem",4,"clrDgItems","clrDgItemsOf"],[3,"clrDgPageSize"],[3,"clrPageSizeOptions"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],["shape","times"],["shape","download"],[3,"clrDgItem"],[3,"click"]],template:function(D,ie){1&D&&n.DNE(0,E,2,0,"clr-spinner")(1,be,13,10,"clr-datagrid",1),2&D&&n.vxM(ie.isLoading?0:1)},dependencies:[c.PuD,c.ghA,c.fQA,c.slD,c.scM,c.Lwm,c.AtP,c.oip,c.o3y,c.XTg,c.E1i,c.NTI,c.cIg,c.qDI,c.v0q,c.Aup,c.rpC,c.mCo,c.BlU,c.BkK,c.oFi]})}return R})()},5540:function(It,L){var j,c;void 0!==(c="function"==typeof(j=function(){"use strict";function p(w,B,y){var E=new XMLHttpRequest;E.open("GET",w),E.responseType="blob",E.onload=function(){H(E.response,B,y)},E.onerror=function(){console.error("could not download file")},E.send()}function C(w){var B=new XMLHttpRequest;B.open("HEAD",w,!1);try{B.send()}catch{}return 200<=B.status&&299>=B.status}function V(w){try{w.dispatchEvent(new MouseEvent("click"))}catch{var B=document.createEvent("MouseEvents");B.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),w.dispatchEvent(B)}}var U="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,P=U.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),H=U.saveAs||("object"!=typeof window||window!==U?function(){}:"download"in HTMLAnchorElement.prototype&&!P?function(w,B,y){var E=U.URL||U.webkitURL,g=document.createElement("a");g.download=B=B||w.name||"download",g.rel="noopener","string"==typeof w?(g.href=w,g.origin===location.origin?V(g):C(g.href)?p(w,B,y):V(g,g.target="_blank")):(g.href=E.createObjectURL(w),setTimeout(function(){E.revokeObjectURL(g.href)},4e4),setTimeout(function(){V(g)},0))}:"msSaveOrOpenBlob"in navigator?function(w,B,y){if(B=B||w.name||"download","string"!=typeof w)navigator.msSaveOrOpenBlob(function A(w,B){return typeof B>"u"?B={autoBom:!1}:"object"!=typeof B&&(console.warn("Deprecated: Expected third argument to be a object"),B={autoBom:!B}),B.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(w.type)?new Blob(["\ufeff",w],{type:w.type}):w}(w,y),B);else if(C(w))p(w,B,y);else{var E=document.createElement("a");E.href=w,E.target="_blank",setTimeout(function(){V(E)})}}:function(w,B,y,E){if((E=E||open("","_blank"))&&(E.document.title=E.document.body.innerText="downloading..."),"string"==typeof w)return p(w,B,y);var g="application/octet-stream"===w.type,S=/constructor/i.test(U.HTMLElement)||U.safari,_=/CriOS\/[\d]+/.test(navigator.userAgent);if((_||g&&S||P)&&typeof FileReader<"u"){var k=new FileReader;k.onloadend=function(){var l=k.result;l=_?l:l.replace(/^data:[^;]*;/,"data:attachment/file;"),E?E.location.href=l:location=l,E=null},k.readAsDataURL(w)}else{var b=U.URL||U.webkitURL,Z=b.createObjectURL(w);E?E.location=Z:location.href=Z,E=null,setTimeout(function(){b.revokeObjectURL(Z)},4e4)}});U.saveAs=H.saveAs=H,It.exports=H})?j.apply(L,[]):j)&&(It.exports=c)},8721:It=>{It.exports=function L(j,n,c){function A(V,U){if(!n[V]){if(!j[V]){if(p)return p(V,!0);var H=new Error("Cannot find module '"+V+"'");throw H.code="MODULE_NOT_FOUND",H}var w=n[V]={exports:{}};j[V][0].call(w.exports,function(B){return A(j[V][1][B]||B)},w,w.exports,L,j,n,c)}return n[V].exports}for(var p=void 0,C=0;C<c.length;C++)A(c[C]);return A}({1:[function(L,j,n){"use strict";var c=L("./utils"),A=L("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(C){for(var V,U,P,w,B,y,E=[],g=0,S=C.length,_=S,k="string"!==c.getTypeOf(C);g<C.length;)_=S-g,P=k?(V=C[g++],U=g<S?C[g++]:0,g<S?C[g++]:0):(V=C.charCodeAt(g++),U=g<S?C.charCodeAt(g++):0,g<S?C.charCodeAt(g++):0),w=(3&V)<<4|U>>4,B=1<_?(15&U)<<2|P>>6:64,y=2<_?63&P:64,E.push(p.charAt(V>>2)+p.charAt(w)+p.charAt(B)+p.charAt(y));return E.join("")},n.decode=function(C){var V,U,P,H,w,B,y=0,E=0,g="data:";if(C.substr(0,5)===g)throw new Error("Invalid base64 input, it looks like a data url.");var S,_=3*(C=C.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(C.charAt(C.length-1)===p.charAt(64)&&_--,C.charAt(C.length-2)===p.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(S=A.uint8array?new Uint8Array(0|_):new Array(0|_);y<C.length;)V=p.indexOf(C.charAt(y++))<<2|(H=p.indexOf(C.charAt(y++)))>>4,U=(15&H)<<4|(w=p.indexOf(C.charAt(y++)))>>2,P=(3&w)<<6|(B=p.indexOf(C.charAt(y++))),S[E++]=V,64!==w&&(S[E++]=U),64!==B&&(S[E++]=P);return S}},{"./support":30,"./utils":32}],2:[function(L,j,n){"use strict";var c=L("./external"),A=L("./stream/DataWorker"),p=L("./stream/Crc32Probe"),C=L("./stream/DataLengthProbe");function V(U,P,H,w,B){this.compressedSize=U,this.uncompressedSize=P,this.crc32=H,this.compression=w,this.compressedContent=B}V.prototype={getContentWorker:function(){var U=new A(c.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new C("data_length")),P=this;return U.on("end",function(){if(this.streamInfo.data_length!==P.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),U},getCompressedWorker:function(){return new A(c.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},V.createWorkerFrom=function(U,P,H){return U.pipe(new p).pipe(new C("uncompressedSize")).pipe(P.compressWorker(H)).pipe(new C("compressedSize")).withStreamInfo("compression",P)},j.exports=V},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(L,j,n){"use strict";var c=L("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new c("STORE compression")},uncompressWorker:function(){return new c("STORE decompression")}},n.DEFLATE=L("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(L,j,n){"use strict";var c=L("./utils"),A=function(){for(var p,C=[],V=0;V<256;V++){p=V;for(var U=0;U<8;U++)p=1&p?3988292384^p>>>1:p>>>1;C[V]=p}return C}();j.exports=function(p,C){return void 0!==p&&p.length?"string"!==c.getTypeOf(p)?function(V,U,P){var w=A,B=0+P;V^=-1;for(var y=0;y<B;y++)V=V>>>8^w[255&(V^U[y])];return~V}(0|C,p,p.length):function(V,U,P){var w=A,B=0+P;V^=-1;for(var y=0;y<B;y++)V=V>>>8^w[255&(V^U.charCodeAt(y))];return~V}(0|C,p,p.length):0}},{"./utils":32}],5:[function(L,j,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(L,j,n){"use strict";var c;c=typeof Promise<"u"?Promise:L("lie"),j.exports={Promise:c}},{lie:37}],7:[function(L,j,n){"use strict";var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",A=L("pako"),p=L("./utils"),C=L("./stream/GenericWorker"),V=c?"uint8array":"array";function U(P,H){C.call(this,"FlateWorker/"+P),this._pako=null,this._pakoAction=P,this._pakoOptions=H,this.meta={}}n.magic="\b\0",p.inherits(U,C),U.prototype.processChunk=function(P){this.meta=P.meta,null===this._pako&&this._createPako(),this._pako.push(p.transformTo(V,P.data),!1)},U.prototype.flush=function(){C.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},U.prototype.cleanUp=function(){C.prototype.cleanUp.call(this),this._pako=null},U.prototype._createPako=function(){this._pako=new A[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var P=this;this._pako.onData=function(H){P.push({data:H,meta:P.meta})}},n.compressWorker=function(P){return new U("Deflate",P)},n.uncompressWorker=function(){return new U("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(L,j,n){"use strict";function c(w,B){var y,E="";for(y=0;y<B;y++)E+=String.fromCharCode(255&w),w>>>=8;return E}function A(w,B,y,E,g,S){var _,k,b=w.file,Z=w.compression,l=S!==V.utf8encode,we=p.transformTo("string",S(b.name)),te=p.transformTo("string",V.utf8encode(b.name)),be=b.comment,Oe=p.transformTo("string",S(be)),R=p.transformTo("string",V.utf8encode(be)),$=te.length!==b.name.length,d=R.length!==be.length,D="",ie="",W="",Be=b.dir,ve=b.date,he={crc32:0,compressedSize:0,uncompressedSize:0};B&&!y||(he.crc32=w.crc32,he.compressedSize=w.compressedSize,he.uncompressedSize=w.uncompressedSize);var J=0;B&&(J|=8),l||!$&&!d||(J|=2048);var ke,ze,M=0,Ne=0;Be&&(M|=16),"UNIX"===g?(Ne=798,M|=(ze=ke=b.unixPermissions,ke||(ze=Be?16893:33204),(65535&ze)<<16)):(Ne=20,M|=function(ke){return 63&(ke||0)}(b.dosPermissions)),_=ve.getUTCHours(),_<<=6,_|=ve.getUTCMinutes(),_<<=5,_|=ve.getUTCSeconds()/2,k=ve.getUTCFullYear()-1980,k<<=4,k|=ve.getUTCMonth()+1,k<<=5,k|=ve.getUTCDate(),$&&(ie=c(1,1)+c(U(we),4)+te,D+="up"+c(ie.length,2)+ie),d&&(W=c(1,1)+c(U(Oe),4)+R,D+="uc"+c(W.length,2)+W);var Ce="";return Ce+="\n\0",Ce+=c(J,2),Ce+=Z.magic,Ce+=c(_,2),Ce+=c(k,2),Ce+=c(he.crc32,4),Ce+=c(he.compressedSize,4),Ce+=c(he.uncompressedSize,4),Ce+=c(we.length,2),Ce+=c(D.length,2),{fileRecord:P.LOCAL_FILE_HEADER+Ce+we+D,dirRecord:P.CENTRAL_FILE_HEADER+c(Ne,2)+Ce+c(Oe.length,2)+"\0\0\0\0"+c(M,4)+c(E,4)+we+D+Oe}}var p=L("../utils"),C=L("../stream/GenericWorker"),V=L("../utf8"),U=L("../crc32"),P=L("../signature");function H(w,B,y,E){C.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=B,this.zipPlatform=y,this.encodeFileName=E,this.streamFiles=w,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}p.inherits(H,C),H.prototype.push=function(w){var B=w.meta.percent||0,y=this.entriesCount,E=this._sources.length;this.accumulate?this.contentBuffer.push(w):(this.bytesWritten+=w.data.length,C.prototype.push.call(this,{data:w.data,meta:{currentFile:this.currentFile,percent:y?(B+100*(y-E-1))/y:100}}))},H.prototype.openedSource=function(w){this.currentSourceOffset=this.bytesWritten,this.currentFile=w.file.name;var B=this.streamFiles&&!w.file.dir;if(B){var y=A(w,B,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:y.fileRecord,meta:{percent:0}})}else this.accumulate=!0},H.prototype.closedSource=function(w){this.accumulate=!1;var E,B=this.streamFiles&&!w.file.dir,y=A(w,B,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(y.dirRecord),B)this.push({data:(E=w,P.DATA_DESCRIPTOR+c(E.crc32,4)+c(E.compressedSize,4)+c(E.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:y.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},H.prototype.flush=function(){for(var w=this.bytesWritten,B=0;B<this.dirRecords.length;B++)this.push({data:this.dirRecords[B],meta:{percent:100}});var g,S,_,Z,E=(g=this.dirRecords.length,S=this.bytesWritten-w,_=w,Z=p.transformTo("string",(0,this.encodeFileName)(this.zipComment)),P.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(g,2)+c(g,2)+c(S,4)+c(_,4)+c(Z.length,2)+Z);this.push({data:E,meta:{percent:100}})},H.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},H.prototype.registerPrevious=function(w){this._sources.push(w);var B=this;return w.on("data",function(y){B.processChunk(y)}),w.on("end",function(){B.closedSource(B.previous.streamInfo),B._sources.length?B.prepareNextSource():B.end()}),w.on("error",function(y){B.error(y)}),this},H.prototype.resume=function(){return!!C.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},H.prototype.error=function(w){var B=this._sources;if(!C.prototype.error.call(this,w))return!1;for(var y=0;y<B.length;y++)try{B[y].error(w)}catch{}return!0},H.prototype.lock=function(){C.prototype.lock.call(this);for(var w=this._sources,B=0;B<w.length;B++)w[B].lock()},j.exports=H},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(L,j,n){"use strict";var c=L("../compressions"),A=L("./ZipFileWorker");n.generateWorker=function(p,C,V){var U=new A(C.streamFiles,V,C.platform,C.encodeFileName),P=0;try{p.forEach(function(H,w){P++;var B=function(S,_){var k=S||_,b=c[k];if(!b)throw new Error(k+" is not a valid compression method !");return b}(w.options.compression,C.compression),E=w.dir,g=w.date;w._compressWorker(B,w.options.compressionOptions||C.compressionOptions||{}).withStreamInfo("file",{name:H,dir:E,date:g,comment:w.comment||"",unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions}).pipe(U)}),U.entriesCount=P}catch(H){U.error(H)}return U}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(L,j,n){"use strict";function c(){if(!(this instanceof c))return new c;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var A=new c;for(var p in this)"function"!=typeof this[p]&&(A[p]=this[p]);return A}}(c.prototype=L("./object")).loadAsync=L("./load"),c.support=L("./support"),c.defaults=L("./defaults"),c.version="3.10.1",c.loadAsync=function(A,p){return(new c).loadAsync(A,p)},c.external=L("./external"),j.exports=c},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(L,j,n){"use strict";var c=L("./utils"),A=L("./external"),p=L("./utf8"),C=L("./zipEntries"),V=L("./stream/Crc32Probe"),U=L("./nodejsUtils");function P(H){return new A.Promise(function(w,B){var y=H.decompressed.getContentWorker().pipe(new V);y.on("error",function(E){B(E)}).on("end",function(){y.streamInfo.crc32!==H.decompressed.crc32?B(new Error("Corrupted zip : CRC32 mismatch")):w()}).resume()})}j.exports=function(H,w){var B=this;return w=c.extend(w||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:p.utf8decode}),U.isNode&&U.isStream(H)?A.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):c.prepareContent("the loaded zip file",H,!0,w.optimizedBinaryString,w.base64).then(function(y){var E=new C(w);return E.load(y),E}).then(function(y){var E=[A.Promise.resolve(y)],g=y.files;if(w.checkCRC32)for(var S=0;S<g.length;S++)E.push(P(g[S]));return A.Promise.all(E)}).then(function(y){for(var E=y.shift(),g=E.files,S=0;S<g.length;S++){var _=g[S],k=_.fileNameStr,b=c.resolve(_.fileNameStr);B.file(b,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:w.createFolders}),_.dir||(B.file(b).unsafeOriginalName=k)}return E.zipComment.length&&(B.comment=E.zipComment),B})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(L,j,n){"use strict";var c=L("../utils"),A=L("../stream/GenericWorker");function p(C,V){A.call(this,"Nodejs stream input adapter for "+C),this._upstreamEnded=!1,this._bindStream(V)}c.inherits(p,A),p.prototype._bindStream=function(C){var V=this;(this._stream=C).pause(),C.on("data",function(U){V.push({data:U,meta:{percent:0}})}).on("error",function(U){V.isPaused?this.generatedError=U:V.error(U)}).on("end",function(){V.isPaused?V._upstreamEnded=!0:V.end()})},p.prototype.pause=function(){return!!A.prototype.pause.call(this)&&(this._stream.pause(),!0)},p.prototype.resume=function(){return!!A.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},j.exports=p},{"../stream/GenericWorker":28,"../utils":32}],13:[function(L,j,n){"use strict";var c=L("readable-stream").Readable;function A(p,C,V){c.call(this,C),this._helper=p;var U=this;p.on("data",function(P,H){U.push(P)||U._helper.pause(),V&&V(H)}).on("error",function(P){U.emit("error",P)}).on("end",function(){U.push(null)})}L("../utils").inherits(A,c),A.prototype._read=function(){this._helper.resume()},j.exports=A},{"../utils":32,"readable-stream":16}],14:[function(L,j,n){"use strict";j.exports={isNode:typeof Buffer<"u",newBufferFrom:function(c,A){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(c,A);if("number"==typeof c)throw new Error('The "data" argument must not be a number');return new Buffer(c,A)},allocBuffer:function(c){if(Buffer.alloc)return Buffer.alloc(c);var A=new Buffer(c);return A.fill(0),A},isBuffer:function(c){return Buffer.isBuffer(c)},isStream:function(c){return c&&"function"==typeof c.on&&"function"==typeof c.pause&&"function"==typeof c.resume}}},{}],15:[function(L,j,n){"use strict";function c(b,Z,l){var we,te=p.getTypeOf(Z),be=p.extend(l||{},U);be.date=be.date||new Date,null!==be.compression&&(be.compression=be.compression.toUpperCase()),"string"==typeof be.unixPermissions&&(be.unixPermissions=parseInt(be.unixPermissions,8)),be.unixPermissions&&16384&be.unixPermissions&&(be.dir=!0),be.dosPermissions&&16&be.dosPermissions&&(be.dir=!0),be.dir&&(b=g(b)),be.createFolders&&(we=E(b))&&S.call(this,we,!0),l&&void 0!==l.binary||(be.binary=!("string"===te&&!1===be.binary&&!1===be.base64)),(Z instanceof P&&0===Z.uncompressedSize||be.dir||!Z||0===Z.length)&&(be.base64=!1,be.binary=!0,Z="",be.compression="STORE",te="string");var R;R=Z instanceof P||Z instanceof C?Z:B.isNode&&B.isStream(Z)?new y(b,Z):p.prepareContent(b,Z,be.binary,be.optimizedBinaryString,be.base64);var $=new H(b,R,be);this.files[b]=$}var A=L("./utf8"),p=L("./utils"),C=L("./stream/GenericWorker"),V=L("./stream/StreamHelper"),U=L("./defaults"),P=L("./compressedObject"),H=L("./zipObject"),w=L("./generate"),B=L("./nodejsUtils"),y=L("./nodejs/NodejsStreamInputAdapter"),E=function(b){"/"===b.slice(-1)&&(b=b.substring(0,b.length-1));var Z=b.lastIndexOf("/");return 0<Z?b.substring(0,Z):""},g=function(b){return"/"!==b.slice(-1)&&(b+="/"),b},S=function(b,Z){return Z=void 0!==Z?Z:U.createFolders,b=g(b),this.files[b]||c.call(this,b,null,{dir:!0,createFolders:Z}),this.files[b]};function _(b){return"[object RegExp]"===Object.prototype.toString.call(b)}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(b){var Z,l,we;for(Z in this.files)we=this.files[Z],(l=Z.slice(this.root.length,Z.length))&&Z.slice(0,this.root.length)===this.root&&b(l,we)},filter:function(b){var Z=[];return this.forEach(function(l,we){b(l,we)&&Z.push(we)}),Z},file:function(b,Z,l){if(1!==arguments.length)return c.call(this,b=this.root+b,Z,l),this;if(_(b)){var we=b;return this.filter(function(be,Oe){return!Oe.dir&&we.test(be)})}var te=this.files[this.root+b];return te&&!te.dir?te:null},folder:function(b){if(!b)return this;if(_(b))return this.filter(function(te,be){return be.dir&&b.test(te)});var l=S.call(this,this.root+b),we=this.clone();return we.root=l.name,we},remove:function(b){var Z=this.files[b=this.root+b];if(Z||("/"!==b.slice(-1)&&(b+="/"),Z=this.files[b]),Z&&!Z.dir)delete this.files[b];else for(var l=this.filter(function(te,be){return be.name.slice(0,b.length)===b}),we=0;we<l.length;we++)delete this.files[l[we].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(b){var Z,l={};try{if((l=p.extend(b||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:A.utf8encode})).type=l.type.toLowerCase(),l.compression=l.compression.toUpperCase(),"binarystring"===l.type&&(l.type="string"),!l.type)throw new Error("No output type specified.");p.checkSupport(l.type),"darwin"!==l.platform&&"freebsd"!==l.platform&&"linux"!==l.platform&&"sunos"!==l.platform||(l.platform="UNIX"),"win32"===l.platform&&(l.platform="DOS"),Z=w.generateWorker(this,l,l.comment||this.comment||"")}catch(te){(Z=new C("error")).error(te)}return new V(Z,l.type||"string",l.mimeType)},generateAsync:function(b,Z){return this.generateInternalStream(b).accumulate(Z)},generateNodeStream:function(b,Z){return(b=b||{}).type||(b.type="nodebuffer"),this.generateInternalStream(b).toNodejsStream(Z)}};j.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(L,j,n){"use strict";j.exports=L("stream")},{stream:void 0}],17:[function(L,j,n){"use strict";var c=L("./DataReader");function A(p){c.call(this,p);for(var C=0;C<this.data.length;C++)p[C]=255&p[C]}L("../utils").inherits(A,c),A.prototype.byteAt=function(p){return this.data[this.zero+p]},A.prototype.lastIndexOfSignature=function(p){for(var C=p.charCodeAt(0),V=p.charCodeAt(1),U=p.charCodeAt(2),P=p.charCodeAt(3),H=this.length-4;0<=H;--H)if(this.data[H]===C&&this.data[H+1]===V&&this.data[H+2]===U&&this.data[H+3]===P)return H-this.zero;return-1},A.prototype.readAndCheckSignature=function(p){var C=p.charCodeAt(0),V=p.charCodeAt(1),U=p.charCodeAt(2),P=p.charCodeAt(3),H=this.readData(4);return C===H[0]&&V===H[1]&&U===H[2]&&P===H[3]},A.prototype.readData=function(p){if(this.checkOffset(p),0===p)return[];var C=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,C},j.exports=A},{"../utils":32,"./DataReader":18}],18:[function(L,j,n){"use strict";var c=L("../utils");function A(p){this.data=p,this.length=p.length,this.index=0,this.zero=0}A.prototype={checkOffset:function(p){this.checkIndex(this.index+p)},checkIndex:function(p){if(this.length<this.zero+p||p<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+p+"). Corrupted zip ?")},setIndex:function(p){this.checkIndex(p),this.index=p},skip:function(p){this.setIndex(this.index+p)},byteAt:function(){},readInt:function(p){var C,V=0;for(this.checkOffset(p),C=this.index+p-1;C>=this.index;C--)V=(V<<8)+this.byteAt(C);return this.index+=p,V},readString:function(p){return c.transformTo("string",this.readData(p))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var p=this.readInt(4);return new Date(Date.UTC(1980+(p>>25&127),(p>>21&15)-1,p>>16&31,p>>11&31,p>>5&63,(31&p)<<1))}},j.exports=A},{"../utils":32}],19:[function(L,j,n){"use strict";var c=L("./Uint8ArrayReader");function A(p){c.call(this,p)}L("../utils").inherits(A,c),A.prototype.readData=function(p){this.checkOffset(p);var C=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,C},j.exports=A},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(L,j,n){"use strict";var c=L("./DataReader");function A(p){c.call(this,p)}L("../utils").inherits(A,c),A.prototype.byteAt=function(p){return this.data.charCodeAt(this.zero+p)},A.prototype.lastIndexOfSignature=function(p){return this.data.lastIndexOf(p)-this.zero},A.prototype.readAndCheckSignature=function(p){return p===this.readData(4)},A.prototype.readData=function(p){this.checkOffset(p);var C=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,C},j.exports=A},{"../utils":32,"./DataReader":18}],21:[function(L,j,n){"use strict";var c=L("./ArrayReader");function A(p){c.call(this,p)}L("../utils").inherits(A,c),A.prototype.readData=function(p){if(this.checkOffset(p),0===p)return new Uint8Array(0);var C=this.data.subarray(this.zero+this.index,this.zero+this.index+p);return this.index+=p,C},j.exports=A},{"../utils":32,"./ArrayReader":17}],22:[function(L,j,n){"use strict";var c=L("../utils"),A=L("../support"),p=L("./ArrayReader"),C=L("./StringReader"),V=L("./NodeBufferReader"),U=L("./Uint8ArrayReader");j.exports=function(P){var H=c.getTypeOf(P);return c.checkSupport(H),"string"!==H||A.uint8array?"nodebuffer"===H?new V(P):A.uint8array?new U(c.transformTo("uint8array",P)):new p(c.transformTo("array",P)):new C(P)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(L,j,n){"use strict";n.LOCAL_FILE_HEADER="PK\x03\x04",n.CENTRAL_FILE_HEADER="PK\x01\x02",n.CENTRAL_DIRECTORY_END="PK\x05\x06",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(L,j,n){"use strict";var c=L("./GenericWorker"),A=L("../utils");function p(C){c.call(this,"ConvertWorker to "+C),this.destType=C}A.inherits(p,c),p.prototype.processChunk=function(C){this.push({data:A.transformTo(this.destType,C.data),meta:C.meta})},j.exports=p},{"../utils":32,"./GenericWorker":28}],25:[function(L,j,n){"use strict";var c=L("./GenericWorker"),A=L("../crc32");function p(){c.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}L("../utils").inherits(p,c),p.prototype.processChunk=function(C){this.streamInfo.crc32=A(C.data,this.streamInfo.crc32||0),this.push(C)},j.exports=p},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(L,j,n){"use strict";var c=L("../utils"),A=L("./GenericWorker");function p(C){A.call(this,"DataLengthProbe for "+C),this.propName=C,this.withStreamInfo(C,0)}c.inherits(p,A),p.prototype.processChunk=function(C){C&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+C.data.length),A.prototype.processChunk.call(this,C)},j.exports=p},{"../utils":32,"./GenericWorker":28}],27:[function(L,j,n){"use strict";var c=L("../utils"),A=L("./GenericWorker");function p(C){A.call(this,"DataWorker");var V=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,C.then(function(U){V.dataIsReady=!0,V.data=U,V.max=U&&U.length||0,V.type=c.getTypeOf(U),V.isPaused||V._tickAndRepeat()},function(U){V.error(U)})}c.inherits(p,A),p.prototype.cleanUp=function(){A.prototype.cleanUp.call(this),this.data=null},p.prototype.resume=function(){return!!A.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,c.delay(this._tickAndRepeat,[],this)),!0)},p.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(c.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},p.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var C=null,V=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":C=this.data.substring(this.index,V);break;case"uint8array":C=this.data.subarray(this.index,V);break;case"array":case"nodebuffer":C=this.data.slice(this.index,V)}return this.index=V,this.push({data:C,meta:{percent:this.max?this.index/this.max*100:0}})},j.exports=p},{"../utils":32,"./GenericWorker":28}],28:[function(L,j,n){"use strict";function c(A){this.name=A||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}c.prototype={push:function(A){this.emit("data",A)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(A){this.emit("error",A)}return!0},error:function(A){return!this.isFinished&&(this.isPaused?this.generatedError=A:(this.isFinished=!0,this.emit("error",A),this.previous&&this.previous.error(A),this.cleanUp()),!0)},on:function(A,p){return this._listeners[A].push(p),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(A,p){if(this._listeners[A])for(var C=0;C<this._listeners[A].length;C++)this._listeners[A][C].call(this,p)},pipe:function(A){return A.registerPrevious(this)},registerPrevious:function(A){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=A.streamInfo,this.mergeStreamInfo(),this.previous=A;var p=this;return A.on("data",function(C){p.processChunk(C)}),A.on("end",function(){p.end()}),A.on("error",function(C){p.error(C)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var A=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),A=!0),this.previous&&this.previous.resume(),!A},flush:function(){},processChunk:function(A){this.push(A)},withStreamInfo:function(A,p){return this.extraStreamInfo[A]=p,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var A in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,A)&&(this.streamInfo[A]=this.extraStreamInfo[A])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var A="Worker "+this.name;return this.previous?this.previous+" -> "+A:A}},j.exports=c},{}],29:[function(L,j,n){"use strict";var c=L("../utils"),A=L("./ConvertWorker"),p=L("./GenericWorker"),C=L("../base64"),V=L("../support"),U=L("../external"),P=null;if(V.nodestream)try{P=L("../nodejs/NodejsStreamOutputAdapter")}catch{}function w(B,y,E){var g=y;switch(y){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=y,this._mimeType=E,c.checkSupport(g),this._worker=B.pipe(new A(g)),B.lock()}catch(S){this._worker=new p("error"),this._worker.error(S)}}w.prototype={accumulate:function(B){return function H(B,y){return new U.Promise(function(E,g){var S=[],_=B._internalType,k=B._outputType,b=B._mimeType;B.on("data",function(Z,l){S.push(Z),y&&y(l)}).on("error",function(Z){S=[],g(Z)}).on("end",function(){try{var Z=function(l,we,te){switch(l){case"blob":return c.newBlob(c.transformTo("arraybuffer",we),te);case"base64":return C.encode(we);default:return c.transformTo(l,we)}}(k,function(l,we){var te,be=0,Oe=null,R=0;for(te=0;te<we.length;te++)R+=we[te].length;switch(l){case"string":return we.join("");case"array":return Array.prototype.concat.apply([],we);case"uint8array":for(Oe=new Uint8Array(R),te=0;te<we.length;te++)Oe.set(we[te],be),be+=we[te].length;return Oe;case"nodebuffer":return Buffer.concat(we);default:throw new Error("concat : unsupported type '"+l+"'")}}(_,S),b);E(Z)}catch(l){g(l)}S=[]}).resume()})}(this,B)},on:function(B,y){var E=this;return this._worker.on(B,"data"===B?function(g){y.call(E,g.data,g.meta)}:function(){c.delay(y,arguments,E)}),this},resume:function(){return c.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(B){if(c.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new P(this,{objectMode:"nodebuffer"!==this._outputType},B)}},j.exports=w},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(L,j,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var c=new ArrayBuffer(0);try{n.blob=0===new Blob([c],{type:"application/zip"}).size}catch{try{var A=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);A.append(c),n.blob=0===A.getBlob("application/zip").size}catch{n.blob=!1}}}try{n.nodestream=!!L("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(L,j,n){"use strict";for(var c=L("./utils"),A=L("./support"),p=L("./nodejsUtils"),C=L("./stream/GenericWorker"),V=new Array(256),U=0;U<256;U++)V[U]=252<=U?6:248<=U?5:240<=U?4:224<=U?3:192<=U?2:1;function P(){C.call(this,"utf-8 decode"),this.leftOver=null}function H(){C.call(this,"utf-8 encode")}V[254]=V[254]=1,n.utf8encode=function(w){return A.nodebuffer?p.newBufferFrom(w,"utf-8"):function(B){var y,E,g,S,_,k=B.length,b=0;for(S=0;S<k;S++)55296==(64512&(E=B.charCodeAt(S)))&&S+1<k&&56320==(64512&(g=B.charCodeAt(S+1)))&&(E=65536+(E-55296<<10)+(g-56320),S++),b+=E<128?1:E<2048?2:E<65536?3:4;for(y=A.uint8array?new Uint8Array(b):new Array(b),S=_=0;_<b;S++)55296==(64512&(E=B.charCodeAt(S)))&&S+1<k&&56320==(64512&(g=B.charCodeAt(S+1)))&&(E=65536+(E-55296<<10)+(g-56320),S++),E<128?y[_++]=E:(E<2048?y[_++]=192|E>>>6:(E<65536?y[_++]=224|E>>>12:(y[_++]=240|E>>>18,y[_++]=128|E>>>12&63),y[_++]=128|E>>>6&63),y[_++]=128|63&E);return y}(w)},n.utf8decode=function(w){return A.nodebuffer?c.transformTo("nodebuffer",w).toString("utf-8"):function(B){var y,E,g,S,_=B.length,k=new Array(2*_);for(y=E=0;y<_;)if((g=B[y++])<128)k[E++]=g;else if(4<(S=V[g]))k[E++]=65533,y+=S-1;else{for(g&=2===S?31:3===S?15:7;1<S&&y<_;)g=g<<6|63&B[y++],S--;1<S?k[E++]=65533:g<65536?k[E++]=g:(k[E++]=55296|(g-=65536)>>10&1023,k[E++]=56320|1023&g)}return k.length!==E&&(k.subarray?k=k.subarray(0,E):k.length=E),c.applyFromCharCode(k)}(w=c.transformTo(A.uint8array?"uint8array":"array",w))},c.inherits(P,C),P.prototype.processChunk=function(w){var B=c.transformTo(A.uint8array?"uint8array":"array",w.data);if(this.leftOver&&this.leftOver.length){if(A.uint8array){var y=B;(B=new Uint8Array(y.length+this.leftOver.length)).set(this.leftOver,0),B.set(y,this.leftOver.length)}else B=this.leftOver.concat(B);this.leftOver=null}var E=function(S,_){var k;for((_=_||S.length)>S.length&&(_=S.length),k=_-1;0<=k&&128==(192&S[k]);)k--;return k<0||0===k?_:k+V[S[k]]>_?k:_}(B),g=B;E!==B.length&&(A.uint8array?(g=B.subarray(0,E),this.leftOver=B.subarray(E,B.length)):(g=B.slice(0,E),this.leftOver=B.slice(E,B.length))),this.push({data:n.utf8decode(g),meta:w.meta})},P.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=P,c.inherits(H,C),H.prototype.processChunk=function(w){this.push({data:n.utf8encode(w.data),meta:w.meta})},n.Utf8EncodeWorker=H},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(L,j,n){"use strict";var c=L("./support"),A=L("./base64"),p=L("./nodejsUtils"),C=L("./external");function V(y){return y}function U(y,E){for(var g=0;g<y.length;++g)E[g]=255&y.charCodeAt(g);return E}L("setimmediate"),n.newBlob=function(y,E){n.checkSupport("blob");try{return new Blob([y],{type:E})}catch{try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(y),g.getBlob(E)}catch{throw new Error("Bug : can't construct the Blob.")}}};var P={stringifyByChunk:function(y,E,g){var S=[],_=0,k=y.length;if(k<=g)return String.fromCharCode.apply(null,y);for(;_<k;)S.push(String.fromCharCode.apply(null,"array"===E||"nodebuffer"===E?y.slice(_,Math.min(_+g,k)):y.subarray(_,Math.min(_+g,k)))),_+=g;return S.join("")},stringifyByChar:function(y){for(var E="",g=0;g<y.length;g++)E+=String.fromCharCode(y[g]);return E},applyCanBeUsed:{uint8array:function(){try{return c.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return c.nodebuffer&&1===String.fromCharCode.apply(null,p.allocBuffer(1)).length}catch{return!1}}()}};function H(y){var E=65536,g=n.getTypeOf(y),S=!0;if("uint8array"===g?S=P.applyCanBeUsed.uint8array:"nodebuffer"===g&&(S=P.applyCanBeUsed.nodebuffer),S)for(;1<E;)try{return P.stringifyByChunk(y,g,E)}catch{E=Math.floor(E/2)}return P.stringifyByChar(y)}function w(y,E){for(var g=0;g<y.length;g++)E[g]=y[g];return E}n.applyFromCharCode=H;var B={};B.string={string:V,array:function(y){return U(y,new Array(y.length))},arraybuffer:function(y){return B.string.uint8array(y).buffer},uint8array:function(y){return U(y,new Uint8Array(y.length))},nodebuffer:function(y){return U(y,p.allocBuffer(y.length))}},B.array={string:H,array:V,arraybuffer:function(y){return new Uint8Array(y).buffer},uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return p.newBufferFrom(y)}},B.arraybuffer={string:function(y){return H(new Uint8Array(y))},array:function(y){return w(new Uint8Array(y),new Array(y.byteLength))},arraybuffer:V,uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return p.newBufferFrom(new Uint8Array(y))}},B.uint8array={string:H,array:function(y){return w(y,new Array(y.length))},arraybuffer:function(y){return y.buffer},uint8array:V,nodebuffer:function(y){return p.newBufferFrom(y)}},B.nodebuffer={string:H,array:function(y){return w(y,new Array(y.length))},arraybuffer:function(y){return B.nodebuffer.uint8array(y).buffer},uint8array:function(y){return w(y,new Uint8Array(y.length))},nodebuffer:V},n.transformTo=function(y,E){if(E=E||"",!y)return E;n.checkSupport(y);var g=n.getTypeOf(E);return B[g][y](E)},n.resolve=function(y){for(var E=y.split("/"),g=[],S=0;S<E.length;S++){var _=E[S];"."===_||""===_&&0!==S&&S!==E.length-1||(".."===_?g.pop():g.push(_))}return g.join("/")},n.getTypeOf=function(y){return"string"==typeof y?"string":"[object Array]"===Object.prototype.toString.call(y)?"array":c.nodebuffer&&p.isBuffer(y)?"nodebuffer":c.uint8array&&y instanceof Uint8Array?"uint8array":c.arraybuffer&&y instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(y){if(!c[y.toLowerCase()])throw new Error(y+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(y){var E,g,S="";for(g=0;g<(y||"").length;g++)S+="\\x"+((E=y.charCodeAt(g))<16?"0":"")+E.toString(16).toUpperCase();return S},n.delay=function(y,E,g){setImmediate(function(){y.apply(g||null,E||[])})},n.inherits=function(y,E){function g(){}g.prototype=E.prototype,y.prototype=new g},n.extend=function(){var y,E,g={};for(y=0;y<arguments.length;y++)for(E in arguments[y])Object.prototype.hasOwnProperty.call(arguments[y],E)&&void 0===g[E]&&(g[E]=arguments[y][E]);return g},n.prepareContent=function(y,E,g,S,_){return C.Promise.resolve(E).then(function(k){return c.blob&&(k instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k)))&&typeof FileReader<"u"?new C.Promise(function(b,Z){var l=new FileReader;l.onload=function(we){b(we.target.result)},l.onerror=function(we){Z(we.target.error)},l.readAsArrayBuffer(k)}):k}).then(function(k){var Z,b=n.getTypeOf(k);return b?("arraybuffer"===b?k=n.transformTo("uint8array",k):"string"===b&&(_?k=A.decode(k):g&&!0!==S&&(k=U(Z=k,c.uint8array?new Uint8Array(Z.length):new Array(Z.length)))),k):C.Promise.reject(new Error("Can't read the data of '"+y+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(L,j,n){"use strict";var c=L("./reader/readerFor"),A=L("./utils"),p=L("./signature"),C=L("./zipEntry"),V=L("./support");function U(P){this.files=[],this.loadOptions=P}U.prototype={checkSignature:function(P){if(!this.reader.readAndCheckSignature(P)){this.reader.index-=4;var H=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+A.pretty(H)+", expected "+A.pretty(P)+")")}},isSignature:function(P,H){var w=this.reader.index;this.reader.setIndex(P);var B=this.reader.readString(4)===H;return this.reader.setIndex(w),B},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var P=this.reader.readData(this.zipCommentLength),w=A.transformTo(V.uint8array?"uint8array":"array",P);this.zipComment=this.loadOptions.decodeFileName(w)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var P,H,w,B=this.zip64EndOfCentralSize-44;0<B;)P=this.reader.readInt(2),H=this.reader.readInt(4),w=this.reader.readData(H),this.zip64ExtensibleData[P]={id:P,length:H,value:w}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var P,H;for(P=0;P<this.files.length;P++)this.reader.setIndex((H=this.files[P]).localHeaderOffset),this.checkSignature(p.LOCAL_FILE_HEADER),H.readLocalPart(this.reader),H.handleUTF8(),H.processAttributes()},readCentralDir:function(){var P;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(p.CENTRAL_FILE_HEADER);)(P=new C({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(P);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var P=this.reader.lastIndexOfSignature(p.CENTRAL_DIRECTORY_END);if(P<0)throw this.isSignature(0,p.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(P);var H=P;if(this.checkSignature(p.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===A.MAX_VALUE_16BITS||this.diskWithCentralDirStart===A.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===A.MAX_VALUE_16BITS||this.centralDirRecords===A.MAX_VALUE_16BITS||this.centralDirSize===A.MAX_VALUE_32BITS||this.centralDirOffset===A.MAX_VALUE_32BITS){if(this.zip64=!0,(P=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(P),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,p.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var w=this.centralDirOffset+this.centralDirSize;this.zip64&&(w+=20,w+=12+this.zip64EndOfCentralSize);var B=H-w;if(0<B)this.isSignature(H,p.CENTRAL_FILE_HEADER)||(this.reader.zero=B);else if(B<0)throw new Error("Corrupted zip: missing "+Math.abs(B)+" bytes.")},prepareReader:function(P){this.reader=c(P)},load:function(P){this.prepareReader(P),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},j.exports=U},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(L,j,n){"use strict";var c=L("./reader/readerFor"),A=L("./utils"),p=L("./compressedObject"),C=L("./crc32"),V=L("./utf8"),U=L("./compressions"),P=L("./support");function H(w,B){this.options=w,this.loadOptions=B}H.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(w){var B,y;if(w.skip(22),this.fileNameLength=w.readInt(2),y=w.readInt(2),this.fileName=w.readData(this.fileNameLength),w.skip(y),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(B=function(E){for(var g in U)if(Object.prototype.hasOwnProperty.call(U,g)&&U[g].magic===E)return U[g];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+A.pretty(this.compressionMethod)+" unknown (inner file : "+A.transformTo("string",this.fileName)+")");this.decompressed=new p(this.compressedSize,this.uncompressedSize,this.crc32,B,w.readData(this.compressedSize))},readCentralPart:function(w){this.versionMadeBy=w.readInt(2),w.skip(2),this.bitFlag=w.readInt(2),this.compressionMethod=w.readString(2),this.date=w.readDate(),this.crc32=w.readInt(4),this.compressedSize=w.readInt(4),this.uncompressedSize=w.readInt(4);var B=w.readInt(2);if(this.extraFieldsLength=w.readInt(2),this.fileCommentLength=w.readInt(2),this.diskNumberStart=w.readInt(2),this.internalFileAttributes=w.readInt(2),this.externalFileAttributes=w.readInt(4),this.localHeaderOffset=w.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");w.skip(B),this.readExtraFields(w),this.parseZIP64ExtraField(w),this.fileComment=w.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var w=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==w&&(this.dosPermissions=63&this.externalFileAttributes),3==w&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var w=c(this.extraFields[1].value);this.uncompressedSize===A.MAX_VALUE_32BITS&&(this.uncompressedSize=w.readInt(8)),this.compressedSize===A.MAX_VALUE_32BITS&&(this.compressedSize=w.readInt(8)),this.localHeaderOffset===A.MAX_VALUE_32BITS&&(this.localHeaderOffset=w.readInt(8)),this.diskNumberStart===A.MAX_VALUE_32BITS&&(this.diskNumberStart=w.readInt(4))}},readExtraFields:function(w){var B,y,E,g=w.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});w.index+4<g;)B=w.readInt(2),y=w.readInt(2),E=w.readData(y),this.extraFields[B]={id:B,length:y,value:E};w.setIndex(g)},handleUTF8:function(){var w=P.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=V.utf8decode(this.fileName),this.fileCommentStr=V.utf8decode(this.fileComment);else{var B=this.findExtraFieldUnicodePath();if(null!==B)this.fileNameStr=B;else{var y=A.transformTo(w,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var E=this.findExtraFieldUnicodeComment();if(null!==E)this.fileCommentStr=E;else{var g=A.transformTo(w,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var w=this.extraFields[28789];if(w){var B=c(w.value);return 1!==B.readInt(1)||C(this.fileName)!==B.readInt(4)?null:V.utf8decode(B.readData(w.length-5))}return null},findExtraFieldUnicodeComment:function(){var w=this.extraFields[25461];if(w){var B=c(w.value);return 1!==B.readInt(1)||C(this.fileComment)!==B.readInt(4)?null:V.utf8decode(B.readData(w.length-5))}return null}},j.exports=H},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(L,j,n){"use strict";function c(B,y,E){this.name=B,this.dir=E.dir,this.date=E.date,this.comment=E.comment,this.unixPermissions=E.unixPermissions,this.dosPermissions=E.dosPermissions,this._data=y,this._dataBinary=E.binary,this.options={compression:E.compression,compressionOptions:E.compressionOptions}}var A=L("./stream/StreamHelper"),p=L("./stream/DataWorker"),C=L("./utf8"),V=L("./compressedObject"),U=L("./stream/GenericWorker");c.prototype={internalStream:function(B){var y=null,E="string";try{if(!B)throw new Error("No output type specified.");var g="string"===(E=B.toLowerCase())||"text"===E;"binarystring"!==E&&"text"!==E||(E="string"),y=this._decompressWorker();var S=!this._dataBinary;S&&!g&&(y=y.pipe(new C.Utf8EncodeWorker)),!S&&g&&(y=y.pipe(new C.Utf8DecodeWorker))}catch(_){(y=new U("error")).error(_)}return new A(y,E,"")},async:function(B,y){return this.internalStream(B).accumulate(y)},nodeStream:function(B,y){return this.internalStream(B||"nodebuffer").toNodejsStream(y)},_compressWorker:function(B,y){if(this._data instanceof V&&this._data.compression.magic===B.magic)return this._data.getCompressedWorker();var E=this._decompressWorker();return this._dataBinary||(E=E.pipe(new C.Utf8EncodeWorker)),V.createWorkerFrom(E,B,y)},_decompressWorker:function(){return this._data instanceof V?this._data.getContentWorker():this._data instanceof U?this._data:new p(this._data)}};for(var P=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],H=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},w=0;w<P.length;w++)c.prototype[P[w]]=H;j.exports=c},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(L,j,n){(function(c){"use strict";var A,p,C=c.MutationObserver||c.WebKitMutationObserver;if(C){var V=0,U=new C(B),P=c.document.createTextNode("");U.observe(P,{characterData:!0}),A=function(){P.data=V=++V%2}}else if(c.setImmediate||void 0===c.MessageChannel)A="document"in c&&"onreadystatechange"in c.document.createElement("script")?function(){var y=c.document.createElement("script");y.onreadystatechange=function(){B(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},c.document.documentElement.appendChild(y)}:function(){setTimeout(B,0)};else{var H=new c.MessageChannel;H.port1.onmessage=B,A=function(){H.port2.postMessage(0)}}var w=[];function B(){var y,E;p=!0;for(var g=w.length;g;){for(E=w,w=[],y=-1;++y<g;)E[y]();g=w.length}p=!1}j.exports=function(y){1!==w.push(y)||p||A()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(L,j,n){"use strict";var c=L("immediate");function A(){}var p={},C=["REJECTED"],V=["FULFILLED"],U=["PENDING"];function P(g){if("function"!=typeof g)throw new TypeError("resolver must be a function");this.state=U,this.queue=[],this.outcome=void 0,g!==A&&y(this,g)}function H(g,S,_){this.promise=g,"function"==typeof S&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),"function"==typeof _&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function w(g,S,_){c(function(){var k;try{k=S(_)}catch(b){return p.reject(g,b)}k===g?p.reject(g,new TypeError("Cannot resolve promise with itself")):p.resolve(g,k)})}function B(g){var S=g&&g.then;if(g&&("object"==typeof g||"function"==typeof g)&&"function"==typeof S)return function(){S.apply(g,arguments)}}function y(g,S){var _=!1;function k(l){_||(_=!0,p.reject(g,l))}function b(l){_||(_=!0,p.resolve(g,l))}var Z=E(function(){S(b,k)});"error"===Z.status&&k(Z.value)}function E(g,S){var _={};try{_.value=g(S),_.status="success"}catch(k){_.status="error",_.value=k}return _}(j.exports=P).prototype.finally=function(g){if("function"!=typeof g)return this;var S=this.constructor;return this.then(function(_){return S.resolve(g()).then(function(){return _})},function(_){return S.resolve(g()).then(function(){throw _})})},P.prototype.catch=function(g){return this.then(null,g)},P.prototype.then=function(g,S){if("function"!=typeof g&&this.state===V||"function"!=typeof S&&this.state===C)return this;var _=new this.constructor(A);return this.state!==U?w(_,this.state===V?g:S,this.outcome):this.queue.push(new H(_,g,S)),_},H.prototype.callFulfilled=function(g){p.resolve(this.promise,g)},H.prototype.otherCallFulfilled=function(g){w(this.promise,this.onFulfilled,g)},H.prototype.callRejected=function(g){p.reject(this.promise,g)},H.prototype.otherCallRejected=function(g){w(this.promise,this.onRejected,g)},p.resolve=function(g,S){var _=E(B,S);if("error"===_.status)return p.reject(g,_.value);var k=_.value;if(k)y(g,k);else{g.state=V,g.outcome=S;for(var b=-1,Z=g.queue.length;++b<Z;)g.queue[b].callFulfilled(S)}return g},p.reject=function(g,S){g.state=C,g.outcome=S;for(var _=-1,k=g.queue.length;++_<k;)g.queue[_].callRejected(S);return g},P.resolve=function(g){return g instanceof this?g:p.resolve(new this(A),g)},P.reject=function(g){var S=new this(A);return p.reject(S,g)},P.all=function(g){var S=this;if("[object Array]"!==Object.prototype.toString.call(g))return this.reject(new TypeError("must be an array"));var _=g.length,k=!1;if(!_)return this.resolve([]);for(var b=new Array(_),Z=0,l=-1,we=new this(A);++l<_;)te(g[l],l);return we;function te(be,Oe){S.resolve(be).then(function(R){b[Oe]=R,++Z!==_||k||(k=!0,p.resolve(we,b))},function(R){k||(k=!0,p.reject(we,R))})}},P.race=function(g){if("[object Array]"!==Object.prototype.toString.call(g))return this.reject(new TypeError("must be an array"));var _=g.length,k=!1;if(!_)return this.resolve([]);for(var b=-1,Z=new this(A);++b<_;)this.resolve(g[b]).then(function(we){k||(k=!0,p.resolve(Z,we))},function(we){k||(k=!0,p.reject(Z,we))});return Z}},{immediate:36}],38:[function(L,j,n){"use strict";var c={};(0,L("./lib/utils/common").assign)(c,L("./lib/deflate"),L("./lib/inflate"),L("./lib/zlib/constants")),j.exports=c},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(L,j,n){"use strict";var c=L("./zlib/deflate"),A=L("./utils/common"),p=L("./utils/strings"),C=L("./zlib/messages"),V=L("./zlib/zstream"),U=Object.prototype.toString,P=0,H=-1,w=0,B=8;function y(g){if(!(this instanceof y))return new y(g);this.options=A.assign({level:H,method:B,chunkSize:16384,windowBits:15,memLevel:8,strategy:w,to:""},g||{});var S=this.options;S.raw&&0<S.windowBits?S.windowBits=-S.windowBits:S.gzip&&0<S.windowBits&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new V,this.strm.avail_out=0;var _=c.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(_!==P)throw new Error(C[_]);if(S.header&&c.deflateSetHeader(this.strm,S.header),S.dictionary){var k;if(k="string"==typeof S.dictionary?p.string2buf(S.dictionary):"[object ArrayBuffer]"===U.call(S.dictionary)?new Uint8Array(S.dictionary):S.dictionary,(_=c.deflateSetDictionary(this.strm,k))!==P)throw new Error(C[_]);this._dict_set=!0}}function E(g,S){var _=new y(S);if(_.push(g,!0),_.err)throw _.msg||C[_.err];return _.result}y.prototype.push=function(g,S){var _,k,b=this.strm,Z=this.options.chunkSize;if(this.ended)return!1;k=S===~~S?S:!0===S?4:0,b.input="string"==typeof g?p.string2buf(g):"[object ArrayBuffer]"===U.call(g)?new Uint8Array(g):g,b.next_in=0,b.avail_in=b.input.length;do{if(0===b.avail_out&&(b.output=new A.Buf8(Z),b.next_out=0,b.avail_out=Z),1!==(_=c.deflate(b,k))&&_!==P)return this.onEnd(_),!(this.ended=!0);0!==b.avail_out&&(0!==b.avail_in||4!==k&&2!==k)||this.onData("string"===this.options.to?p.buf2binstring(A.shrinkBuf(b.output,b.next_out)):A.shrinkBuf(b.output,b.next_out))}while((0<b.avail_in||0===b.avail_out)&&1!==_);return 4===k?(_=c.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===P):2!==k||(this.onEnd(P),!(b.avail_out=0))},y.prototype.onData=function(g){this.chunks.push(g)},y.prototype.onEnd=function(g){g===P&&(this.result="string"===this.options.to?this.chunks.join(""):A.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},n.Deflate=y,n.deflate=E,n.deflateRaw=function(g,S){return(S=S||{}).raw=!0,E(g,S)},n.gzip=function(g,S){return(S=S||{}).gzip=!0,E(g,S)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(L,j,n){"use strict";var c=L("./zlib/inflate"),A=L("./utils/common"),p=L("./utils/strings"),C=L("./zlib/constants"),V=L("./zlib/messages"),U=L("./zlib/zstream"),P=L("./zlib/gzheader"),H=Object.prototype.toString;function w(y){if(!(this instanceof w))return new w(y);this.options=A.assign({chunkSize:16384,windowBits:0,to:""},y||{});var E=this.options;E.raw&&0<=E.windowBits&&E.windowBits<16&&(E.windowBits=-E.windowBits,0===E.windowBits&&(E.windowBits=-15)),!(0<=E.windowBits&&E.windowBits<16)||y&&y.windowBits||(E.windowBits+=32),15<E.windowBits&&E.windowBits<48&&!(15&E.windowBits)&&(E.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new U,this.strm.avail_out=0;var g=c.inflateInit2(this.strm,E.windowBits);if(g!==C.Z_OK)throw new Error(V[g]);this.header=new P,c.inflateGetHeader(this.strm,this.header)}function B(y,E){var g=new w(E);if(g.push(y,!0),g.err)throw g.msg||V[g.err];return g.result}w.prototype.push=function(y,E){var g,S,_,k,b,Z,l=this.strm,we=this.options.chunkSize,te=this.options.dictionary,be=!1;if(this.ended)return!1;S=E===~~E?E:!0===E?C.Z_FINISH:C.Z_NO_FLUSH,l.input="string"==typeof y?p.binstring2buf(y):"[object ArrayBuffer]"===H.call(y)?new Uint8Array(y):y,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new A.Buf8(we),l.next_out=0,l.avail_out=we),(g=c.inflate(l,C.Z_NO_FLUSH))===C.Z_NEED_DICT&&te&&(Z="string"==typeof te?p.string2buf(te):"[object ArrayBuffer]"===H.call(te)?new Uint8Array(te):te,g=c.inflateSetDictionary(this.strm,Z)),g===C.Z_BUF_ERROR&&!0===be&&(g=C.Z_OK,be=!1),g!==C.Z_STREAM_END&&g!==C.Z_OK)return this.onEnd(g),!(this.ended=!0);l.next_out&&(0!==l.avail_out&&g!==C.Z_STREAM_END&&(0!==l.avail_in||S!==C.Z_FINISH&&S!==C.Z_SYNC_FLUSH)||("string"===this.options.to?(_=p.utf8border(l.output,l.next_out),k=l.next_out-_,b=p.buf2string(l.output,_),l.next_out=k,l.avail_out=we-k,k&&A.arraySet(l.output,l.output,_,k,0),this.onData(b)):this.onData(A.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(be=!0)}while((0<l.avail_in||0===l.avail_out)&&g!==C.Z_STREAM_END);return g===C.Z_STREAM_END&&(S=C.Z_FINISH),S===C.Z_FINISH?(g=c.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===C.Z_OK):S!==C.Z_SYNC_FLUSH||(this.onEnd(C.Z_OK),!(l.avail_out=0))},w.prototype.onData=function(y){this.chunks.push(y)},w.prototype.onEnd=function(y){y===C.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):A.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},n.Inflate=w,n.inflate=B,n.inflateRaw=function(y,E){return(E=E||{}).raw=!0,B(y,E)},n.ungzip=B},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(L,j,n){"use strict";var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(C){for(var V=Array.prototype.slice.call(arguments,1);V.length;){var U=V.shift();if(U){if("object"!=typeof U)throw new TypeError(U+"must be non-object");for(var P in U)U.hasOwnProperty(P)&&(C[P]=U[P])}}return C},n.shrinkBuf=function(C,V){return C.length===V?C:C.subarray?C.subarray(0,V):(C.length=V,C)};var A={arraySet:function(C,V,U,P,H){if(V.subarray&&C.subarray)C.set(V.subarray(U,U+P),H);else for(var w=0;w<P;w++)C[H+w]=V[U+w]},flattenChunks:function(C){var V,U,P,H,w,B;for(V=P=0,U=C.length;V<U;V++)P+=C[V].length;for(B=new Uint8Array(P),V=H=0,U=C.length;V<U;V++)B.set(w=C[V],H),H+=w.length;return B}},p={arraySet:function(C,V,U,P,H){for(var w=0;w<P;w++)C[H+w]=V[U+w]},flattenChunks:function(C){return[].concat.apply([],C)}};n.setTyped=function(C){C?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,A)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,p))},n.setTyped(c)},{}],42:[function(L,j,n){"use strict";var c=L("./common"),A=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch{A=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{p=!1}for(var C=new c.Buf8(256),V=0;V<256;V++)C[V]=252<=V?6:248<=V?5:240<=V?4:224<=V?3:192<=V?2:1;function U(P,H){if(H<65537&&(P.subarray&&p||!P.subarray&&A))return String.fromCharCode.apply(null,c.shrinkBuf(P,H));for(var w="",B=0;B<H;B++)w+=String.fromCharCode(P[B]);return w}C[254]=C[254]=1,n.string2buf=function(P){var H,w,B,y,E,g=P.length,S=0;for(y=0;y<g;y++)55296==(64512&(w=P.charCodeAt(y)))&&y+1<g&&56320==(64512&(B=P.charCodeAt(y+1)))&&(w=65536+(w-55296<<10)+(B-56320),y++),S+=w<128?1:w<2048?2:w<65536?3:4;for(H=new c.Buf8(S),y=E=0;E<S;y++)55296==(64512&(w=P.charCodeAt(y)))&&y+1<g&&56320==(64512&(B=P.charCodeAt(y+1)))&&(w=65536+(w-55296<<10)+(B-56320),y++),w<128?H[E++]=w:(w<2048?H[E++]=192|w>>>6:(w<65536?H[E++]=224|w>>>12:(H[E++]=240|w>>>18,H[E++]=128|w>>>12&63),H[E++]=128|w>>>6&63),H[E++]=128|63&w);return H},n.buf2binstring=function(P){return U(P,P.length)},n.binstring2buf=function(P){for(var H=new c.Buf8(P.length),w=0,B=H.length;w<B;w++)H[w]=P.charCodeAt(w);return H},n.buf2string=function(P,H){var w,B,y,E,g=H||P.length,S=new Array(2*g);for(w=B=0;w<g;)if((y=P[w++])<128)S[B++]=y;else if(4<(E=C[y]))S[B++]=65533,w+=E-1;else{for(y&=2===E?31:3===E?15:7;1<E&&w<g;)y=y<<6|63&P[w++],E--;1<E?S[B++]=65533:y<65536?S[B++]=y:(S[B++]=55296|(y-=65536)>>10&1023,S[B++]=56320|1023&y)}return U(S,B)},n.utf8border=function(P,H){var w;for((H=H||P.length)>P.length&&(H=P.length),w=H-1;0<=w&&128==(192&P[w]);)w--;return w<0||0===w?H:w+C[P[w]]>H?w:H}},{"./common":41}],43:[function(L,j,n){"use strict";j.exports=function(c,A,p,C){for(var V=65535&c,U=c>>>16&65535,P=0;0!==p;){for(p-=P=2e3<p?2e3:p;U=U+(V=V+A[C++]|0)|0,--P;);V%=65521,U%=65521}return V|U<<16}},{}],44:[function(L,j,n){"use strict";j.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(L,j,n){"use strict";var c=function(){for(var A,p=[],C=0;C<256;C++){A=C;for(var V=0;V<8;V++)A=1&A?3988292384^A>>>1:A>>>1;p[C]=A}return p}();j.exports=function(A,p,C,V){var U=c,P=V+C;A^=-1;for(var H=V;H<P;H++)A=A>>>8^U[255&(A^p[H])];return~A}},{}],46:[function(L,j,n){"use strict";var c,A=L("../utils/common"),p=L("./trees"),C=L("./adler32"),V=L("./crc32"),U=L("./messages"),P=0,w=0,B=-2,g=2,S=8,k=286,b=30,Z=19,l=2*k+1,we=15,te=3,be=258,Oe=be+te+1,R=42,$=113;function Be(f,le){return f.msg=U[le],le}function ve(f){return(f<<1)-(4<f?9:0)}function he(f){for(var le=f.length;0<=--le;)f[le]=0}function J(f){var le=f.state,Q=le.pending;Q>f.avail_out&&(Q=f.avail_out),0!==Q&&(A.arraySet(f.output,le.pending_buf,le.pending_out,Q,f.next_out),f.next_out+=Q,le.pending_out+=Q,f.total_out+=Q,f.avail_out-=Q,le.pending-=Q,0===le.pending&&(le.pending_out=0))}function M(f,le){p._tr_flush_block(f,0<=f.block_start?f.block_start:-1,f.strstart-f.block_start,le),f.block_start=f.strstart,J(f.strm)}function Ne(f,le){f.pending_buf[f.pending++]=le}function Ce(f,le){f.pending_buf[f.pending++]=le>>>8&255,f.pending_buf[f.pending++]=255&le}function ke(f,le){var Q,x,I=f.max_chain_length,G=f.strstart,ce=f.prev_length,me=f.nice_match,z=f.strstart>f.w_size-Oe?f.strstart-(f.w_size-Oe):0,ge=f.window,Ie=f.w_mask,_e=f.prev,Ue=f.strstart+be,it=ge[G+ce-1],Qe=ge[G+ce];f.prev_length>=f.good_match&&(I>>=2),me>f.lookahead&&(me=f.lookahead);do{if(ge[(Q=le)+ce]===Qe&&ge[Q+ce-1]===it&&ge[Q]===ge[G]&&ge[++Q]===ge[G+1]){G+=2,Q++;do{}while(ge[++G]===ge[++Q]&&ge[++G]===ge[++Q]&&ge[++G]===ge[++Q]&&ge[++G]===ge[++Q]&&ge[++G]===ge[++Q]&&ge[++G]===ge[++Q]&&ge[++G]===ge[++Q]&&ge[++G]===ge[++Q]&&G<Ue);if(x=be-(Ue-G),G=Ue-be,ce<x){if(f.match_start=le,me<=(ce=x))break;it=ge[G+ce-1],Qe=ge[G+ce]}}}while((le=_e[le&Ie])>z&&0!=--I);return ce<=f.lookahead?ce:f.lookahead}function re(f){var le,Q,x,I,G,ce,me,z,ge,Ie,_e=f.w_size;do{if(I=f.window_size-f.lookahead-f.strstart,f.strstart>=_e+(_e-Oe)){for(A.arraySet(f.window,f.window,_e,_e,0),f.match_start-=_e,f.strstart-=_e,f.block_start-=_e,le=Q=f.hash_size;x=f.head[--le],f.head[le]=_e<=x?x-_e:0,--Q;);for(le=Q=_e;x=f.prev[--le],f.prev[le]=_e<=x?x-_e:0,--Q;);I+=_e}if(0===f.strm.avail_in)break;if(me=f.window,z=f.strstart+f.lookahead,Ie=void 0,(ge=I)<(Ie=(ce=f.strm).avail_in)&&(Ie=ge),Q=0===Ie?0:(ce.avail_in-=Ie,A.arraySet(me,ce.input,ce.next_in,Ie,z),1===ce.state.wrap?ce.adler=C(ce.adler,me,Ie,z):2===ce.state.wrap&&(ce.adler=V(ce.adler,me,Ie,z)),ce.next_in+=Ie,ce.total_in+=Ie,Ie),f.lookahead+=Q,f.lookahead+f.insert>=te)for(f.ins_h=f.window[G=f.strstart-f.insert],f.ins_h=(f.ins_h<<f.hash_shift^f.window[G+1])&f.hash_mask;f.insert&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[G+te-1])&f.hash_mask,f.prev[G&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=G,G++,f.insert--,!(f.lookahead+f.insert<te)););}while(f.lookahead<Oe&&0!==f.strm.avail_in)}function ze(f,le){for(var Q,x;;){if(f.lookahead<Oe){if(re(f),f.lookahead<Oe&&le===P)return 1;if(0===f.lookahead)break}if(Q=0,f.lookahead>=te&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+te-1])&f.hash_mask,Q=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),0!==Q&&f.strstart-Q<=f.w_size-Oe&&(f.match_length=ke(f,Q)),f.match_length>=te)if(x=p._tr_tally(f,f.strstart-f.match_start,f.match_length-te),f.lookahead-=f.match_length,f.match_length<=f.max_lazy_match&&f.lookahead>=te){for(f.match_length--;f.strstart++,f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+te-1])&f.hash_mask,Q=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart,0!=--f.match_length;);f.strstart++}else f.strstart+=f.match_length,f.match_length=0,f.ins_h=f.window[f.strstart],f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+1])&f.hash_mask;else x=p._tr_tally(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++;if(x&&(M(f,!1),0===f.strm.avail_out))return 1}return f.insert=f.strstart<te-1?f.strstart:te-1,4===le?(M(f,!0),0===f.strm.avail_out?3:4):f.last_lit&&(M(f,!1),0===f.strm.avail_out)?1:2}function $e(f,le){for(var Q,x,I;;){if(f.lookahead<Oe){if(re(f),f.lookahead<Oe&&le===P)return 1;if(0===f.lookahead)break}if(Q=0,f.lookahead>=te&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+te-1])&f.hash_mask,Q=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),f.prev_length=f.match_length,f.prev_match=f.match_start,f.match_length=te-1,0!==Q&&f.prev_length<f.max_lazy_match&&f.strstart-Q<=f.w_size-Oe&&(f.match_length=ke(f,Q),f.match_length<=5&&(1===f.strategy||f.match_length===te&&4096<f.strstart-f.match_start)&&(f.match_length=te-1)),f.prev_length>=te&&f.match_length<=f.prev_length){for(I=f.strstart+f.lookahead-te,x=p._tr_tally(f,f.strstart-1-f.prev_match,f.prev_length-te),f.lookahead-=f.prev_length-1,f.prev_length-=2;++f.strstart<=I&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+te-1])&f.hash_mask,Q=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),0!=--f.prev_length;);if(f.match_available=0,f.match_length=te-1,f.strstart++,x&&(M(f,!1),0===f.strm.avail_out))return 1}else if(f.match_available){if((x=p._tr_tally(f,0,f.window[f.strstart-1]))&&M(f,!1),f.strstart++,f.lookahead--,0===f.strm.avail_out)return 1}else f.match_available=1,f.strstart++,f.lookahead--}return f.match_available&&(x=p._tr_tally(f,0,f.window[f.strstart-1]),f.match_available=0),f.insert=f.strstart<te-1?f.strstart:te-1,4===le?(M(f,!0),0===f.strm.avail_out?3:4):f.last_lit&&(M(f,!1),0===f.strm.avail_out)?1:2}function Ke(f,le,Q,x,I){this.good_length=f,this.max_lazy=le,this.nice_length=Q,this.max_chain=x,this.func=I}function pt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new A.Buf16(2*l),this.dyn_dtree=new A.Buf16(2*(2*b+1)),this.bl_tree=new A.Buf16(2*(2*Z+1)),he(this.dyn_ltree),he(this.dyn_dtree),he(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new A.Buf16(we+1),this.heap=new A.Buf16(2*k+1),he(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new A.Buf16(2*k+1),he(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function at(f){var le;return f&&f.state?(f.total_in=f.total_out=0,f.data_type=g,(le=f.state).pending=0,le.pending_out=0,le.wrap<0&&(le.wrap=-le.wrap),le.status=le.wrap?R:$,f.adler=2===le.wrap?0:1,le.last_flush=P,p._tr_init(le),w):Be(f,B)}function Lt(f){var Q,le=at(f);return le===w&&((Q=f.state).window_size=2*Q.w_size,he(Q.head),Q.max_lazy_match=c[Q.level].max_lazy,Q.good_match=c[Q.level].good_length,Q.nice_match=c[Q.level].nice_length,Q.max_chain_length=c[Q.level].max_chain,Q.strstart=0,Q.block_start=0,Q.lookahead=0,Q.insert=0,Q.match_length=Q.prev_length=te-1,Q.match_available=0,Q.ins_h=0),le}function Pt(f,le,Q,x,I,G){if(!f)return B;var ce=1;if(-1===le&&(le=6),x<0?(ce=0,x=-x):15<x&&(ce=2,x-=16),I<1||9<I||Q!==S||x<8||15<x||le<0||9<le||G<0||4<G)return Be(f,B);8===x&&(x=9);var me=new pt;return(f.state=me).strm=f,me.wrap=ce,me.gzhead=null,me.w_bits=x,me.w_size=1<<me.w_bits,me.w_mask=me.w_size-1,me.hash_bits=I+7,me.hash_size=1<<me.hash_bits,me.hash_mask=me.hash_size-1,me.hash_shift=~~((me.hash_bits+te-1)/te),me.window=new A.Buf8(2*me.w_size),me.head=new A.Buf16(me.hash_size),me.prev=new A.Buf16(me.w_size),me.lit_bufsize=1<<I+6,me.pending_buf_size=4*me.lit_bufsize,me.pending_buf=new A.Buf8(me.pending_buf_size),me.d_buf=1*me.lit_bufsize,me.l_buf=3*me.lit_bufsize,me.level=le,me.strategy=G,me.method=Q,Lt(f)}c=[new Ke(0,0,0,0,function(f,le){var Q=65535;for(Q>f.pending_buf_size-5&&(Q=f.pending_buf_size-5);;){if(f.lookahead<=1){if(re(f),0===f.lookahead&&le===P)return 1;if(0===f.lookahead)break}f.strstart+=f.lookahead,f.lookahead=0;var x=f.block_start+Q;if((0===f.strstart||f.strstart>=x)&&(f.lookahead=f.strstart-x,f.strstart=x,M(f,!1),0===f.strm.avail_out)||f.strstart-f.block_start>=f.w_size-Oe&&(M(f,!1),0===f.strm.avail_out))return 1}return f.insert=0,4===le?(M(f,!0),0===f.strm.avail_out?3:4):(f.strstart>f.block_start&&M(f,!1),1)}),new Ke(4,4,8,4,ze),new Ke(4,5,16,8,ze),new Ke(4,6,32,32,ze),new Ke(4,4,16,16,$e),new Ke(8,16,32,32,$e),new Ke(8,16,128,128,$e),new Ke(8,32,128,256,$e),new Ke(32,128,258,1024,$e),new Ke(32,258,258,4096,$e)],n.deflateInit=function(f,le){return Pt(f,le,S,15,8,0)},n.deflateInit2=Pt,n.deflateReset=Lt,n.deflateResetKeep=at,n.deflateSetHeader=function(f,le){return f&&f.state?2!==f.state.wrap?B:(f.state.gzhead=le,w):B},n.deflate=function(f,le){var Q,x,I,G;if(!f||!f.state||5<le||le<0)return f?Be(f,B):B;if(x=f.state,!f.output||!f.input&&0!==f.avail_in||666===x.status&&4!==le)return Be(f,0===f.avail_out?-5:B);if(x.strm=f,Q=x.last_flush,x.last_flush=le,x.status===R)if(2===x.wrap)f.adler=0,Ne(x,31),Ne(x,139),Ne(x,8),x.gzhead?(Ne(x,(x.gzhead.text?1:0)+(x.gzhead.hcrc?2:0)+(x.gzhead.extra?4:0)+(x.gzhead.name?8:0)+(x.gzhead.comment?16:0)),Ne(x,255&x.gzhead.time),Ne(x,x.gzhead.time>>8&255),Ne(x,x.gzhead.time>>16&255),Ne(x,x.gzhead.time>>24&255),Ne(x,9===x.level?2:2<=x.strategy||x.level<2?4:0),Ne(x,255&x.gzhead.os),x.gzhead.extra&&x.gzhead.extra.length&&(Ne(x,255&x.gzhead.extra.length),Ne(x,x.gzhead.extra.length>>8&255)),x.gzhead.hcrc&&(f.adler=V(f.adler,x.pending_buf,x.pending,0)),x.gzindex=0,x.status=69):(Ne(x,0),Ne(x,0),Ne(x,0),Ne(x,0),Ne(x,0),Ne(x,9===x.level?2:2<=x.strategy||x.level<2?4:0),Ne(x,3),x.status=$);else{var ce=S+(x.w_bits-8<<4)<<8;ce|=(2<=x.strategy||x.level<2?0:x.level<6?1:6===x.level?2:3)<<6,0!==x.strstart&&(ce|=32),ce+=31-ce%31,x.status=$,Ce(x,ce),0!==x.strstart&&(Ce(x,f.adler>>>16),Ce(x,65535&f.adler)),f.adler=1}if(69===x.status)if(x.gzhead.extra){for(I=x.pending;x.gzindex<(65535&x.gzhead.extra.length)&&(x.pending!==x.pending_buf_size||(x.gzhead.hcrc&&x.pending>I&&(f.adler=V(f.adler,x.pending_buf,x.pending-I,I)),J(f),I=x.pending,x.pending!==x.pending_buf_size));)Ne(x,255&x.gzhead.extra[x.gzindex]),x.gzindex++;x.gzhead.hcrc&&x.pending>I&&(f.adler=V(f.adler,x.pending_buf,x.pending-I,I)),x.gzindex===x.gzhead.extra.length&&(x.gzindex=0,x.status=73)}else x.status=73;if(73===x.status)if(x.gzhead.name){I=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>I&&(f.adler=V(f.adler,x.pending_buf,x.pending-I,I)),J(f),I=x.pending,x.pending===x.pending_buf_size)){G=1;break}G=x.gzindex<x.gzhead.name.length?255&x.gzhead.name.charCodeAt(x.gzindex++):0,Ne(x,G)}while(0!==G);x.gzhead.hcrc&&x.pending>I&&(f.adler=V(f.adler,x.pending_buf,x.pending-I,I)),0===G&&(x.gzindex=0,x.status=91)}else x.status=91;if(91===x.status)if(x.gzhead.comment){I=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>I&&(f.adler=V(f.adler,x.pending_buf,x.pending-I,I)),J(f),I=x.pending,x.pending===x.pending_buf_size)){G=1;break}G=x.gzindex<x.gzhead.comment.length?255&x.gzhead.comment.charCodeAt(x.gzindex++):0,Ne(x,G)}while(0!==G);x.gzhead.hcrc&&x.pending>I&&(f.adler=V(f.adler,x.pending_buf,x.pending-I,I)),0===G&&(x.status=103)}else x.status=103;if(103===x.status&&(x.gzhead.hcrc?(x.pending+2>x.pending_buf_size&&J(f),x.pending+2<=x.pending_buf_size&&(Ne(x,255&f.adler),Ne(x,f.adler>>8&255),f.adler=0,x.status=$)):x.status=$),0!==x.pending){if(J(f),0===f.avail_out)return x.last_flush=-1,w}else if(0===f.avail_in&&ve(le)<=ve(Q)&&4!==le)return Be(f,-5);if(666===x.status&&0!==f.avail_in)return Be(f,-5);if(0!==f.avail_in||0!==x.lookahead||le!==P&&666!==x.status){var me=2===x.strategy?function(z,ge){for(var Ie;;){if(0===z.lookahead&&(re(z),0===z.lookahead)){if(ge===P)return 1;break}if(z.match_length=0,Ie=p._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,Ie&&(M(z,!1),0===z.strm.avail_out))return 1}return z.insert=0,4===ge?(M(z,!0),0===z.strm.avail_out?3:4):z.last_lit&&(M(z,!1),0===z.strm.avail_out)?1:2}(x,le):3===x.strategy?function(z,ge){for(var Ie,_e,Ue,it,Qe=z.window;;){if(z.lookahead<=be){if(re(z),z.lookahead<=be&&ge===P)return 1;if(0===z.lookahead)break}if(z.match_length=0,z.lookahead>=te&&0<z.strstart&&(_e=Qe[Ue=z.strstart-1])===Qe[++Ue]&&_e===Qe[++Ue]&&_e===Qe[++Ue]){it=z.strstart+be;do{}while(_e===Qe[++Ue]&&_e===Qe[++Ue]&&_e===Qe[++Ue]&&_e===Qe[++Ue]&&_e===Qe[++Ue]&&_e===Qe[++Ue]&&_e===Qe[++Ue]&&_e===Qe[++Ue]&&Ue<it);z.match_length=be-(it-Ue),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=te?(Ie=p._tr_tally(z,1,z.match_length-te),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(Ie=p._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),Ie&&(M(z,!1),0===z.strm.avail_out))return 1}return z.insert=0,4===ge?(M(z,!0),0===z.strm.avail_out?3:4):z.last_lit&&(M(z,!1),0===z.strm.avail_out)?1:2}(x,le):c[x.level].func(x,le);if(3!==me&&4!==me||(x.status=666),1===me||3===me)return 0===f.avail_out&&(x.last_flush=-1),w;if(2===me&&(1===le?p._tr_align(x):5!==le&&(p._tr_stored_block(x,0,0,!1),3===le&&(he(x.head),0===x.lookahead&&(x.strstart=0,x.block_start=0,x.insert=0))),J(f),0===f.avail_out))return x.last_flush=-1,w}return 4!==le?w:x.wrap<=0?1:(2===x.wrap?(Ne(x,255&f.adler),Ne(x,f.adler>>8&255),Ne(x,f.adler>>16&255),Ne(x,f.adler>>24&255),Ne(x,255&f.total_in),Ne(x,f.total_in>>8&255),Ne(x,f.total_in>>16&255),Ne(x,f.total_in>>24&255)):(Ce(x,f.adler>>>16),Ce(x,65535&f.adler)),J(f),0<x.wrap&&(x.wrap=-x.wrap),0!==x.pending?w:1)},n.deflateEnd=function(f){var le;return f&&f.state?(le=f.state.status)!==R&&69!==le&&73!==le&&91!==le&&103!==le&&le!==$&&666!==le?Be(f,B):(f.state=null,le===$?Be(f,-3):w):B},n.deflateSetDictionary=function(f,le){var Q,x,I,G,ce,me,z,ge,Ie=le.length;if(!f||!f.state||2===(G=(Q=f.state).wrap)||1===G&&Q.status!==R||Q.lookahead)return B;for(1===G&&(f.adler=C(f.adler,le,Ie,0)),Q.wrap=0,Ie>=Q.w_size&&(0===G&&(he(Q.head),Q.strstart=0,Q.block_start=0,Q.insert=0),ge=new A.Buf8(Q.w_size),A.arraySet(ge,le,Ie-Q.w_size,Q.w_size,0),le=ge,Ie=Q.w_size),ce=f.avail_in,me=f.next_in,z=f.input,f.avail_in=Ie,f.next_in=0,f.input=le,re(Q);Q.lookahead>=te;){for(x=Q.strstart,I=Q.lookahead-(te-1);Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[x+te-1])&Q.hash_mask,Q.prev[x&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=x,x++,--I;);Q.strstart=x,Q.lookahead=te-1,re(Q)}return Q.strstart+=Q.lookahead,Q.block_start=Q.strstart,Q.insert=Q.lookahead,Q.lookahead=0,Q.match_length=Q.prev_length=te-1,Q.match_available=0,f.next_in=me,f.input=z,f.avail_in=ce,Q.wrap=G,w},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(L,j,n){"use strict";j.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(L,j,n){"use strict";j.exports=function(c,A){var p,C,V,U,P,H,w,B,y,E,g,S,_,k,b,Z,l,we,te,be,Oe,R,$,d,D;d=c.input,V=(C=c.next_in)+(c.avail_in-5),D=c.output,P=(U=c.next_out)-(A-c.avail_out),H=U+(c.avail_out-257),w=(p=c.state).dmax,B=p.wsize,y=p.whave,E=p.wnext,g=p.window,S=p.hold,_=p.bits,k=p.lencode,b=p.distcode,Z=(1<<p.lenbits)-1,l=(1<<p.distbits)-1;e:do{_<15&&(S+=d[C++]<<_,S+=d[C++]<<(_+=8),_+=8),we=k[S&Z];t:for(;;){if(S>>>=te=we>>>24,_-=te,0==(te=we>>>16&255))D[U++]=65535&we;else{if(!(16&te)){if(!(64&te)){we=k[(65535&we)+(S&(1<<te)-1)];continue t}if(32&te){p.mode=12;break e}c.msg="invalid literal/length code",p.mode=30;break e}be=65535&we,(te&=15)&&(_<te&&(S+=d[C++]<<_,_+=8),be+=S&(1<<te)-1,S>>>=te,_-=te),_<15&&(S+=d[C++]<<_,S+=d[C++]<<(_+=8),_+=8),we=b[S&l];s:for(;;){if(S>>>=te=we>>>24,_-=te,!(16&(te=we>>>16&255))){if(!(64&te)){we=b[(65535&we)+(S&(1<<te)-1)];continue s}c.msg="invalid distance code",p.mode=30;break e}if(Oe=65535&we,_<(te&=15)&&(S+=d[C++]<<_,(_+=8)<te&&(S+=d[C++]<<_,_+=8)),w<(Oe+=S&(1<<te)-1)){c.msg="invalid distance too far back",p.mode=30;break e}if(S>>>=te,_-=te,(te=U-P)<Oe){if(y<(te=Oe-te)&&p.sane){c.msg="invalid distance too far back",p.mode=30;break e}if($=g,(R=0)===E){if(R+=B-te,te<be){for(be-=te;D[U++]=g[R++],--te;);R=U-Oe,$=D}}else if(E<te){if(R+=B+E-te,(te-=E)<be){for(be-=te;D[U++]=g[R++],--te;);if(R=0,E<be){for(be-=te=E;D[U++]=g[R++],--te;);R=U-Oe,$=D}}}else if(R+=E-te,te<be){for(be-=te;D[U++]=g[R++],--te;);R=U-Oe,$=D}for(;2<be;)D[U++]=$[R++],D[U++]=$[R++],D[U++]=$[R++],be-=3;be&&(D[U++]=$[R++],1<be&&(D[U++]=$[R++]))}else{for(R=U-Oe;D[U++]=D[R++],D[U++]=D[R++],D[U++]=D[R++],2<(be-=3););be&&(D[U++]=D[R++],1<be&&(D[U++]=D[R++]))}break}}break}}while(C<V&&U<H);C-=be=_>>3,S&=(1<<(_-=be<<3))-1,c.next_in=C,c.next_out=U,c.avail_in=C<V?V-C+5:5-(C-V),c.avail_out=U<H?H-U+257:257-(U-H),p.hold=S,p.bits=_}},{}],49:[function(L,j,n){"use strict";var c=L("../utils/common"),A=L("./adler32"),p=L("./crc32"),C=L("./inffast"),V=L("./inftrees"),H=0,w=-2,B=1,y=852,E=592;function g(R){return(R>>>24&255)+(R>>>8&65280)+((65280&R)<<8)+((255&R)<<24)}function S(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new c.Buf16(320),this.work=new c.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(R){var $;return R&&R.state?(R.total_in=R.total_out=($=R.state).total=0,R.msg="",$.wrap&&(R.adler=1&$.wrap),$.mode=B,$.last=0,$.havedict=0,$.dmax=32768,$.head=null,$.hold=0,$.bits=0,$.lencode=$.lendyn=new c.Buf32(y),$.distcode=$.distdyn=new c.Buf32(E),$.sane=1,$.back=-1,H):w}function k(R){var $;return R&&R.state?(($=R.state).wsize=0,$.whave=0,$.wnext=0,_(R)):w}function b(R,$){var d,D;return R&&R.state?(D=R.state,$<0?(d=0,$=-$):(d=1+($>>4),$<48&&($&=15)),$&&($<8||15<$)?w:(null!==D.window&&D.wbits!==$&&(D.window=null),D.wrap=d,D.wbits=$,k(R))):w}function Z(R,$){var d,D;return R?(D=new S,(R.state=D).window=null,(d=b(R,$))!==H&&(R.state=null),d):w}var l,we,te=!0;function be(R){if(te){var $;for(l=new c.Buf32(512),we=new c.Buf32(32),$=0;$<144;)R.lens[$++]=8;for(;$<256;)R.lens[$++]=9;for(;$<280;)R.lens[$++]=7;for(;$<288;)R.lens[$++]=8;for(V(1,R.lens,0,288,l,0,R.work,{bits:9}),$=0;$<32;)R.lens[$++]=5;V(2,R.lens,0,32,we,0,R.work,{bits:5}),te=!1}R.lencode=l,R.lenbits=9,R.distcode=we,R.distbits=5}function Oe(R,$,d,D){var ie,W=R.state;return null===W.window&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new c.Buf8(W.wsize)),D>=W.wsize?(c.arraySet(W.window,$,d-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(D<(ie=W.wsize-W.wnext)&&(ie=D),c.arraySet(W.window,$,d-D,ie,W.wnext),(D-=ie)?(c.arraySet(W.window,$,d-D,D,0),W.wnext=D,W.whave=W.wsize):(W.wnext+=ie,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=ie))),0}n.inflateReset=k,n.inflateReset2=b,n.inflateResetKeep=_,n.inflateInit=function(R){return Z(R,15)},n.inflateInit2=Z,n.inflate=function(R,$){var d,D,ie,W,Be,ve,he,J,M,Ne,Ce,ke,re,ze,$e,Ke,pt,at,Lt,Pt,f,le,Q,x,I=0,G=new c.Buf8(4),ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!R||!R.state||!R.output||!R.input&&0!==R.avail_in)return w;12===(d=R.state).mode&&(d.mode=13),Be=R.next_out,ie=R.output,W=R.next_in,D=R.input,J=d.hold,M=d.bits,Ne=ve=R.avail_in,Ce=he=R.avail_out,le=H;e:for(;;)switch(d.mode){case B:if(0===d.wrap){d.mode=13;break}for(;M<16;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}if(2&d.wrap&&35615===J){G[d.check=0]=255&J,G[1]=J>>>8&255,d.check=p(d.check,G,2,0),M=J=0,d.mode=2;break}if(d.flags=0,d.head&&(d.head.done=!1),!(1&d.wrap)||(((255&J)<<8)+(J>>8))%31){R.msg="incorrect header check",d.mode=30;break}if(8!=(15&J)){R.msg="unknown compression method",d.mode=30;break}if(M-=4,f=8+(15&(J>>>=4)),0===d.wbits)d.wbits=f;else if(f>d.wbits){R.msg="invalid window size",d.mode=30;break}d.dmax=1<<f,R.adler=d.check=1,d.mode=512&J?10:12,M=J=0;break;case 2:for(;M<16;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}if(d.flags=J,8!=(255&d.flags)){R.msg="unknown compression method",d.mode=30;break}if(57344&d.flags){R.msg="unknown header flags set",d.mode=30;break}d.head&&(d.head.text=J>>8&1),512&d.flags&&(G[0]=255&J,G[1]=J>>>8&255,d.check=p(d.check,G,2,0)),M=J=0,d.mode=3;case 3:for(;M<32;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}d.head&&(d.head.time=J),512&d.flags&&(G[0]=255&J,G[1]=J>>>8&255,G[2]=J>>>16&255,G[3]=J>>>24&255,d.check=p(d.check,G,4,0)),M=J=0,d.mode=4;case 4:for(;M<16;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}d.head&&(d.head.xflags=255&J,d.head.os=J>>8),512&d.flags&&(G[0]=255&J,G[1]=J>>>8&255,d.check=p(d.check,G,2,0)),M=J=0,d.mode=5;case 5:if(1024&d.flags){for(;M<16;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}d.length=J,d.head&&(d.head.extra_len=J),512&d.flags&&(G[0]=255&J,G[1]=J>>>8&255,d.check=p(d.check,G,2,0)),M=J=0}else d.head&&(d.head.extra=null);d.mode=6;case 6:if(1024&d.flags&&(ve<(ke=d.length)&&(ke=ve),ke&&(d.head&&(f=d.head.extra_len-d.length,d.head.extra||(d.head.extra=new Array(d.head.extra_len)),c.arraySet(d.head.extra,D,W,ke,f)),512&d.flags&&(d.check=p(d.check,D,ke,W)),ve-=ke,W+=ke,d.length-=ke),d.length))break e;d.length=0,d.mode=7;case 7:if(2048&d.flags){if(0===ve)break e;for(ke=0;f=D[W+ke++],d.head&&f&&d.length<65536&&(d.head.name+=String.fromCharCode(f)),f&&ke<ve;);if(512&d.flags&&(d.check=p(d.check,D,ke,W)),ve-=ke,W+=ke,f)break e}else d.head&&(d.head.name=null);d.length=0,d.mode=8;case 8:if(4096&d.flags){if(0===ve)break e;for(ke=0;f=D[W+ke++],d.head&&f&&d.length<65536&&(d.head.comment+=String.fromCharCode(f)),f&&ke<ve;);if(512&d.flags&&(d.check=p(d.check,D,ke,W)),ve-=ke,W+=ke,f)break e}else d.head&&(d.head.comment=null);d.mode=9;case 9:if(512&d.flags){for(;M<16;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}if(J!==(65535&d.check)){R.msg="header crc mismatch",d.mode=30;break}M=J=0}d.head&&(d.head.hcrc=d.flags>>9&1,d.head.done=!0),R.adler=d.check=0,d.mode=12;break;case 10:for(;M<32;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}R.adler=d.check=g(J),M=J=0,d.mode=11;case 11:if(0===d.havedict)return R.next_out=Be,R.avail_out=he,R.next_in=W,R.avail_in=ve,d.hold=J,d.bits=M,2;R.adler=d.check=1,d.mode=12;case 12:if(5===$||6===$)break e;case 13:if(d.last){J>>>=7&M,M-=7&M,d.mode=27;break}for(;M<3;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}switch(d.last=1&J,M-=1,3&(J>>>=1)){case 0:d.mode=14;break;case 1:if(be(d),d.mode=20,6!==$)break;J>>>=2,M-=2;break e;case 2:d.mode=17;break;case 3:R.msg="invalid block type",d.mode=30}J>>>=2,M-=2;break;case 14:for(J>>>=7&M,M-=7&M;M<32;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}if((65535&J)!=(J>>>16^65535)){R.msg="invalid stored block lengths",d.mode=30;break}if(d.length=65535&J,M=J=0,d.mode=15,6===$)break e;case 15:d.mode=16;case 16:if(ke=d.length){if(ve<ke&&(ke=ve),he<ke&&(ke=he),0===ke)break e;c.arraySet(ie,D,W,ke,Be),ve-=ke,W+=ke,he-=ke,Be+=ke,d.length-=ke;break}d.mode=12;break;case 17:for(;M<14;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}if(d.nlen=257+(31&J),M-=5,d.ndist=1+(31&(J>>>=5)),M-=5,d.ncode=4+(15&(J>>>=5)),J>>>=4,M-=4,286<d.nlen||30<d.ndist){R.msg="too many length or distance symbols",d.mode=30;break}d.have=0,d.mode=18;case 18:for(;d.have<d.ncode;){for(;M<3;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}d.lens[ce[d.have++]]=7&J,J>>>=3,M-=3}for(;d.have<19;)d.lens[ce[d.have++]]=0;if(d.lencode=d.lendyn,d.lenbits=7,le=V(0,d.lens,0,19,d.lencode,0,d.work,Q={bits:d.lenbits}),d.lenbits=Q.bits,le){R.msg="invalid code lengths set",d.mode=30;break}d.have=0,d.mode=19;case 19:for(;d.have<d.nlen+d.ndist;){for(;Ke=(I=d.lencode[J&(1<<d.lenbits)-1])>>>16&255,pt=65535&I,!(($e=I>>>24)<=M);){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}if(pt<16)J>>>=$e,M-=$e,d.lens[d.have++]=pt;else{if(16===pt){for(x=$e+2;M<x;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}if(J>>>=$e,M-=$e,0===d.have){R.msg="invalid bit length repeat",d.mode=30;break}f=d.lens[d.have-1],ke=3+(3&J),J>>>=2,M-=2}else if(17===pt){for(x=$e+3;M<x;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}M-=$e,f=0,ke=3+(7&(J>>>=$e)),J>>>=3,M-=3}else{for(x=$e+7;M<x;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}M-=$e,f=0,ke=11+(127&(J>>>=$e)),J>>>=7,M-=7}if(d.have+ke>d.nlen+d.ndist){R.msg="invalid bit length repeat",d.mode=30;break}for(;ke--;)d.lens[d.have++]=f}}if(30===d.mode)break;if(0===d.lens[256]){R.msg="invalid code -- missing end-of-block",d.mode=30;break}if(d.lenbits=9,le=V(1,d.lens,0,d.nlen,d.lencode,0,d.work,Q={bits:d.lenbits}),d.lenbits=Q.bits,le){R.msg="invalid literal/lengths set",d.mode=30;break}if(d.distbits=6,d.distcode=d.distdyn,le=V(2,d.lens,d.nlen,d.ndist,d.distcode,0,d.work,Q={bits:d.distbits}),d.distbits=Q.bits,le){R.msg="invalid distances set",d.mode=30;break}if(d.mode=20,6===$)break e;case 20:d.mode=21;case 21:if(6<=ve&&258<=he){R.next_out=Be,R.avail_out=he,R.next_in=W,R.avail_in=ve,d.hold=J,d.bits=M,C(R,Ce),Be=R.next_out,ie=R.output,he=R.avail_out,W=R.next_in,D=R.input,ve=R.avail_in,J=d.hold,M=d.bits,12===d.mode&&(d.back=-1);break}for(d.back=0;Ke=(I=d.lencode[J&(1<<d.lenbits)-1])>>>16&255,pt=65535&I,!(($e=I>>>24)<=M);){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}if(Ke&&!(240&Ke)){for(at=$e,Lt=Ke,Pt=pt;Ke=(I=d.lencode[Pt+((J&(1<<at+Lt)-1)>>at)])>>>16&255,pt=65535&I,!(at+($e=I>>>24)<=M);){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}J>>>=at,M-=at,d.back+=at}if(J>>>=$e,M-=$e,d.back+=$e,d.length=pt,0===Ke){d.mode=26;break}if(32&Ke){d.back=-1,d.mode=12;break}if(64&Ke){R.msg="invalid literal/length code",d.mode=30;break}d.extra=15&Ke,d.mode=22;case 22:if(d.extra){for(x=d.extra;M<x;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}d.length+=J&(1<<d.extra)-1,J>>>=d.extra,M-=d.extra,d.back+=d.extra}d.was=d.length,d.mode=23;case 23:for(;Ke=(I=d.distcode[J&(1<<d.distbits)-1])>>>16&255,pt=65535&I,!(($e=I>>>24)<=M);){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}if(!(240&Ke)){for(at=$e,Lt=Ke,Pt=pt;Ke=(I=d.distcode[Pt+((J&(1<<at+Lt)-1)>>at)])>>>16&255,pt=65535&I,!(at+($e=I>>>24)<=M);){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}J>>>=at,M-=at,d.back+=at}if(J>>>=$e,M-=$e,d.back+=$e,64&Ke){R.msg="invalid distance code",d.mode=30;break}d.offset=pt,d.extra=15&Ke,d.mode=24;case 24:if(d.extra){for(x=d.extra;M<x;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}d.offset+=J&(1<<d.extra)-1,J>>>=d.extra,M-=d.extra,d.back+=d.extra}if(d.offset>d.dmax){R.msg="invalid distance too far back",d.mode=30;break}d.mode=25;case 25:if(0===he)break e;if(d.offset>(ke=Ce-he)){if((ke=d.offset-ke)>d.whave&&d.sane){R.msg="invalid distance too far back",d.mode=30;break}re=ke>d.wnext?d.wsize-(ke-=d.wnext):d.wnext-ke,ke>d.length&&(ke=d.length),ze=d.window}else ze=ie,re=Be-d.offset,ke=d.length;for(he<ke&&(ke=he),he-=ke,d.length-=ke;ie[Be++]=ze[re++],--ke;);0===d.length&&(d.mode=21);break;case 26:if(0===he)break e;ie[Be++]=d.length,he--,d.mode=21;break;case 27:if(d.wrap){for(;M<32;){if(0===ve)break e;ve--,J|=D[W++]<<M,M+=8}if(R.total_out+=Ce-=he,d.total+=Ce,Ce&&(R.adler=d.check=d.flags?p(d.check,ie,Ce,Be-Ce):A(d.check,ie,Ce,Be-Ce)),Ce=he,(d.flags?J:g(J))!==d.check){R.msg="incorrect data check",d.mode=30;break}M=J=0}d.mode=28;case 28:if(d.wrap&&d.flags){for(;M<32;){if(0===ve)break e;ve--,J+=D[W++]<<M,M+=8}if(J!==(4294967295&d.total)){R.msg="incorrect length check",d.mode=30;break}M=J=0}d.mode=29;case 29:le=1;break e;case 30:le=-3;break e;case 31:return-4;default:return w}return R.next_out=Be,R.avail_out=he,R.next_in=W,R.avail_in=ve,d.hold=J,d.bits=M,(d.wsize||Ce!==R.avail_out&&d.mode<30&&(d.mode<27||4!==$))&&Oe(R,R.output,R.next_out,Ce-R.avail_out)?(d.mode=31,-4):(Ce-=R.avail_out,R.total_in+=Ne-=R.avail_in,R.total_out+=Ce,d.total+=Ce,d.wrap&&Ce&&(R.adler=d.check=d.flags?p(d.check,ie,Ce,R.next_out-Ce):A(d.check,ie,Ce,R.next_out-Ce)),R.data_type=d.bits+(d.last?64:0)+(12===d.mode?128:0)+(20===d.mode||15===d.mode?256:0),(0==Ne&&0===Ce||4===$)&&le===H&&(le=-5),le)},n.inflateEnd=function(R){if(!R||!R.state)return w;var $=R.state;return $.window&&($.window=null),R.state=null,H},n.inflateGetHeader=function(R,$){var d;return R&&R.state&&2&(d=R.state).wrap?((d.head=$).done=!1,H):w},n.inflateSetDictionary=function(R,$){var d,D=$.length;return R&&R.state?0!==(d=R.state).wrap&&11!==d.mode?w:11===d.mode&&A(1,$,D,0)!==d.check?-3:Oe(R,$,D,D)?(d.mode=31,-4):(d.havedict=1,H):w},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(L,j,n){"use strict";var c=L("../utils/common"),A=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],V=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];j.exports=function(U,P,H,w,B,y,E,g){var S,_,k,b,Z,l,we,te,be,Oe=g.bits,R=0,$=0,d=0,D=0,ie=0,W=0,Be=0,ve=0,he=0,J=0,M=null,Ne=0,Ce=new c.Buf16(16),ke=new c.Buf16(16),re=null,ze=0;for(R=0;R<=15;R++)Ce[R]=0;for($=0;$<w;$++)Ce[P[H+$]]++;for(ie=Oe,D=15;1<=D&&0===Ce[D];D--);if(D<ie&&(ie=D),0===D)return B[y++]=20971520,B[y++]=20971520,g.bits=1,0;for(d=1;d<D&&0===Ce[d];d++);for(ie<d&&(ie=d),R=ve=1;R<=15;R++)if(ve<<=1,(ve-=Ce[R])<0)return-1;if(0<ve&&(0===U||1!==D))return-1;for(ke[1]=0,R=1;R<15;R++)ke[R+1]=ke[R]+Ce[R];for($=0;$<w;$++)0!==P[H+$]&&(E[ke[P[H+$]]++]=$);if(l=0===U?(M=re=E,19):1===U?(M=A,Ne-=257,re=p,ze-=257,256):(M=C,re=V,-1),R=d,Z=y,Be=$=J=0,k=-1,b=(he=1<<(W=ie))-1,1===U&&852<he||2===U&&592<he)return 1;for(;;){for(we=R-Be,be=E[$]<l?(te=0,E[$]):E[$]>l?(te=re[ze+E[$]],M[Ne+E[$]]):(te=96,0),S=1<<R-Be,d=_=1<<W;B[Z+(J>>Be)+(_-=S)]=we<<24|te<<16|be,0!==_;);for(S=1<<R-1;J&S;)S>>=1;if(0!==S?(J&=S-1,J+=S):J=0,$++,0==--Ce[R]){if(R===D)break;R=P[H+E[$]]}if(ie<R&&(J&b)!==k){for(0===Be&&(Be=ie),Z+=d,ve=1<<(W=R-Be);W+Be<D&&!((ve-=Ce[W+Be])<=0);)W++,ve<<=1;if(he+=1<<W,1===U&&852<he||2===U&&592<he)return 1;B[k=J&b]=ie<<24|W<<16|Z-y}}return 0!==J&&(B[Z+J]=R-Be<<24|64<<16),g.bits=ie,0}},{"../utils/common":41}],51:[function(L,j,n){"use strict";j.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(L,j,n){"use strict";var c=L("../utils/common");function C(I){for(var G=I.length;0<=--G;)I[G]=0}var P=256,H=286,w=30,E=15,g=16,l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],we=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],be=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Oe=new Array(576);C(Oe);var R=new Array(60);C(R);var $=new Array(512);C($);var d=new Array(256);C(d);var D=new Array(29);C(D);var ie,W,Be,ve=new Array(w);function he(I,G,ce,me,z){this.static_tree=I,this.extra_bits=G,this.extra_base=ce,this.elems=me,this.max_length=z,this.has_stree=I&&I.length}function J(I,G){this.dyn_tree=I,this.max_code=0,this.stat_desc=G}function M(I){return I<256?$[I]:$[256+(I>>>7)]}function Ne(I,G){I.pending_buf[I.pending++]=255&G,I.pending_buf[I.pending++]=G>>>8&255}function Ce(I,G,ce){I.bi_valid>g-ce?(I.bi_buf|=G<<I.bi_valid&65535,Ne(I,I.bi_buf),I.bi_buf=G>>g-I.bi_valid,I.bi_valid+=ce-g):(I.bi_buf|=G<<I.bi_valid&65535,I.bi_valid+=ce)}function ke(I,G,ce){Ce(I,ce[2*G],ce[2*G+1])}function re(I,G){for(var ce=0;ce|=1&I,I>>>=1,ce<<=1,0<--G;);return ce>>>1}function ze(I,G,ce){var me,z,ge=new Array(E+1),Ie=0;for(me=1;me<=E;me++)ge[me]=Ie=Ie+ce[me-1]<<1;for(z=0;z<=G;z++){var _e=I[2*z+1];0!==_e&&(I[2*z]=re(ge[_e]++,_e))}}function $e(I){var G;for(G=0;G<H;G++)I.dyn_ltree[2*G]=0;for(G=0;G<w;G++)I.dyn_dtree[2*G]=0;for(G=0;G<19;G++)I.bl_tree[2*G]=0;I.dyn_ltree[512]=1,I.opt_len=I.static_len=0,I.last_lit=I.matches=0}function Ke(I){8<I.bi_valid?Ne(I,I.bi_buf):0<I.bi_valid&&(I.pending_buf[I.pending++]=I.bi_buf),I.bi_buf=0,I.bi_valid=0}function pt(I,G,ce,me){var z=2*G,ge=2*ce;return I[z]<I[ge]||I[z]===I[ge]&&me[G]<=me[ce]}function at(I,G,ce){for(var me=I.heap[ce],z=ce<<1;z<=I.heap_len&&(z<I.heap_len&&pt(G,I.heap[z+1],I.heap[z],I.depth)&&z++,!pt(G,me,I.heap[z],I.depth));)I.heap[ce]=I.heap[z],ce=z,z<<=1;I.heap[ce]=me}function Lt(I,G,ce){var me,z,ge,Ie,_e=0;if(0!==I.last_lit)for(;me=I.pending_buf[I.d_buf+2*_e]<<8|I.pending_buf[I.d_buf+2*_e+1],z=I.pending_buf[I.l_buf+_e],_e++,0===me?ke(I,z,G):(ke(I,(ge=d[z])+P+1,G),0!==(Ie=l[ge])&&Ce(I,z-=D[ge],Ie),ke(I,ge=M(--me),ce),0!==(Ie=we[ge])&&Ce(I,me-=ve[ge],Ie)),_e<I.last_lit;);ke(I,256,G)}function Pt(I,G){var ce,me,z,ge=G.dyn_tree,Ie=G.stat_desc.static_tree,_e=G.stat_desc.has_stree,Ue=G.stat_desc.elems,it=-1;for(I.heap_len=0,I.heap_max=573,ce=0;ce<Ue;ce++)0!==ge[2*ce]?(I.heap[++I.heap_len]=it=ce,I.depth[ce]=0):ge[2*ce+1]=0;for(;I.heap_len<2;)ge[2*(z=I.heap[++I.heap_len]=it<2?++it:0)]=1,I.depth[z]=0,I.opt_len--,_e&&(I.static_len-=Ie[2*z+1]);for(G.max_code=it,ce=I.heap_len>>1;1<=ce;ce--)at(I,ge,ce);for(z=Ue;ce=I.heap[1],I.heap[1]=I.heap[I.heap_len--],at(I,ge,1),me=I.heap[1],I.heap[--I.heap_max]=ce,I.heap[--I.heap_max]=me,ge[2*z]=ge[2*ce]+ge[2*me],I.depth[z]=(I.depth[ce]>=I.depth[me]?I.depth[ce]:I.depth[me])+1,ge[2*ce+1]=ge[2*me+1]=z,I.heap[1]=z++,at(I,ge,1),2<=I.heap_len;);I.heap[--I.heap_max]=I.heap[1],function(Qe,Et){var $t,vt,Sr,St,Re,Nt,Kt=Et.dyn_tree,xl=Et.max_code,eu=Et.stat_desc.static_tree,Vl=Et.stat_desc.has_stree,Le=Et.stat_desc.extra_bits,Ol=Et.stat_desc.extra_base,Gt=Et.stat_desc.max_length,ct=0;for(St=0;St<=E;St++)Qe.bl_count[St]=0;for(Kt[2*Qe.heap[Qe.heap_max]+1]=0,$t=Qe.heap_max+1;$t<573;$t++)Gt<(St=Kt[2*Kt[2*(vt=Qe.heap[$t])+1]+1]+1)&&(St=Gt,ct++),Kt[2*vt+1]=St,xl<vt||(Qe.bl_count[St]++,Re=0,Ol<=vt&&(Re=Le[vt-Ol]),Qe.opt_len+=(Nt=Kt[2*vt])*(St+Re),Vl&&(Qe.static_len+=Nt*(eu[2*vt+1]+Re)));if(0!==ct){do{for(St=Gt-1;0===Qe.bl_count[St];)St--;Qe.bl_count[St]--,Qe.bl_count[St+1]+=2,Qe.bl_count[Gt]--,ct-=2}while(0<ct);for(St=Gt;0!==St;St--)for(vt=Qe.bl_count[St];0!==vt;)xl<(Sr=Qe.heap[--$t])||(Kt[2*Sr+1]!==St&&(Qe.opt_len+=(St-Kt[2*Sr+1])*Kt[2*Sr],Kt[2*Sr+1]=St),vt--)}}(I,G),ze(ge,it,I.bl_count)}function f(I,G,ce){var me,z,ge=-1,Ie=G[1],_e=0,Ue=7,it=4;for(0===Ie&&(Ue=138,it=3),G[2*(ce+1)+1]=65535,me=0;me<=ce;me++)z=Ie,Ie=G[2*(me+1)+1],++_e<Ue&&z===Ie||(_e<it?I.bl_tree[2*z]+=_e:0!==z?(z!==ge&&I.bl_tree[2*z]++,I.bl_tree[32]++):_e<=10?I.bl_tree[34]++:I.bl_tree[36]++,ge=z,it=(_e=0)===Ie?(Ue=138,3):z===Ie?(Ue=6,3):(Ue=7,4))}function le(I,G,ce){var me,z,ge=-1,Ie=G[1],_e=0,Ue=7,it=4;for(0===Ie&&(Ue=138,it=3),me=0;me<=ce;me++)if(z=Ie,Ie=G[2*(me+1)+1],!(++_e<Ue&&z===Ie)){if(_e<it)for(;ke(I,z,I.bl_tree),0!=--_e;);else 0!==z?(z!==ge&&(ke(I,z,I.bl_tree),_e--),ke(I,16,I.bl_tree),Ce(I,_e-3,2)):_e<=10?(ke(I,17,I.bl_tree),Ce(I,_e-3,3)):(ke(I,18,I.bl_tree),Ce(I,_e-11,7));ge=z,it=(_e=0)===Ie?(Ue=138,3):z===Ie?(Ue=6,3):(Ue=7,4)}}C(ve);var Q=!1;function x(I,G,ce,me){var z,ge,Ie;Ce(I,0+(me?1:0),3),ge=G,Ie=ce,Ke(z=I),Ne(z,Ie),Ne(z,~Ie),c.arraySet(z.pending_buf,z.window,ge,Ie,z.pending),z.pending+=Ie}n._tr_init=function(I){Q||(function(){var G,ce,me,z,ge,Ie=new Array(E+1);for(z=me=0;z<28;z++)for(D[z]=me,G=0;G<1<<l[z];G++)d[me++]=z;for(d[me-1]=z,z=ge=0;z<16;z++)for(ve[z]=ge,G=0;G<1<<we[z];G++)$[ge++]=z;for(ge>>=7;z<w;z++)for(ve[z]=ge<<7,G=0;G<1<<we[z]-7;G++)$[256+ge++]=z;for(ce=0;ce<=E;ce++)Ie[ce]=0;for(G=0;G<=143;)Oe[2*G+1]=8,G++,Ie[8]++;for(;G<=255;)Oe[2*G+1]=9,G++,Ie[9]++;for(;G<=279;)Oe[2*G+1]=7,G++,Ie[7]++;for(;G<=287;)Oe[2*G+1]=8,G++,Ie[8]++;for(ze(Oe,287,Ie),G=0;G<w;G++)R[2*G+1]=5,R[2*G]=re(G,5);ie=new he(Oe,l,257,H,E),W=new he(R,we,0,w,E),Be=new he(new Array(0),te,0,19,7)}(),Q=!0),I.l_desc=new J(I.dyn_ltree,ie),I.d_desc=new J(I.dyn_dtree,W),I.bl_desc=new J(I.bl_tree,Be),I.bi_buf=0,I.bi_valid=0,$e(I)},n._tr_stored_block=x,n._tr_flush_block=function(I,G,ce,me){var z,ge,Ie=0;0<I.level?(2===I.strm.data_type&&(I.strm.data_type=function(_e){var Ue,it=4093624447;for(Ue=0;Ue<=31;Ue++,it>>>=1)if(1&it&&0!==_e.dyn_ltree[2*Ue])return 0;if(0!==_e.dyn_ltree[18]||0!==_e.dyn_ltree[20]||0!==_e.dyn_ltree[26])return 1;for(Ue=32;Ue<P;Ue++)if(0!==_e.dyn_ltree[2*Ue])return 1;return 0}(I)),Pt(I,I.l_desc),Pt(I,I.d_desc),Ie=function(_e){var Ue;for(f(_e,_e.dyn_ltree,_e.l_desc.max_code),f(_e,_e.dyn_dtree,_e.d_desc.max_code),Pt(_e,_e.bl_desc),Ue=18;3<=Ue&&0===_e.bl_tree[2*be[Ue]+1];Ue--);return _e.opt_len+=3*(Ue+1)+5+5+4,Ue}(I),(ge=I.static_len+3+7>>>3)<=(z=I.opt_len+3+7>>>3)&&(z=ge)):z=ge=ce+5,ce+4<=z&&-1!==G?x(I,G,ce,me):4===I.strategy||ge===z?(Ce(I,2+(me?1:0),3),Lt(I,Oe,R)):(Ce(I,4+(me?1:0),3),function(_e,Ue,it,Qe){var Et;for(Ce(_e,Ue-257,5),Ce(_e,it-1,5),Ce(_e,Qe-4,4),Et=0;Et<Qe;Et++)Ce(_e,_e.bl_tree[2*be[Et]+1],3);le(_e,_e.dyn_ltree,Ue-1),le(_e,_e.dyn_dtree,it-1)}(I,I.l_desc.max_code+1,I.d_desc.max_code+1,Ie+1),Lt(I,I.dyn_ltree,I.dyn_dtree)),$e(I),me&&Ke(I)},n._tr_tally=function(I,G,ce){return I.pending_buf[I.d_buf+2*I.last_lit]=G>>>8&255,I.pending_buf[I.d_buf+2*I.last_lit+1]=255&G,I.pending_buf[I.l_buf+I.last_lit]=255&ce,I.last_lit++,0===G?I.dyn_ltree[2*ce]++:(I.matches++,G--,I.dyn_ltree[2*(d[ce]+P+1)]++,I.dyn_dtree[2*M(G)]++),I.last_lit===I.lit_bufsize-1},n._tr_align=function(I){var G;Ce(I,2,3),ke(I,256,Oe),16===(G=I).bi_valid?(Ne(G,G.bi_buf),G.bi_buf=0,G.bi_valid=0):8<=G.bi_valid&&(G.pending_buf[G.pending++]=255&G.bi_buf,G.bi_buf>>=8,G.bi_valid-=8)}},{"../utils/common":41}],53:[function(L,j,n){"use strict";j.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(L,j,n){(function(c){!function(A,p){"use strict";if(!A.setImmediate){var C,V,U,P,H=1,w={},B=!1,y=A.document,E=Object.getPrototypeOf&&Object.getPrototypeOf(A);E=E&&E.setTimeout?E:A,C="[object process]"==={}.toString.call(A.process)?function(k){process.nextTick(function(){S(k)})}:function(){if(A.postMessage&&!A.importScripts){var k=!0,b=A.onmessage;return A.onmessage=function(){k=!1},A.postMessage("","*"),A.onmessage=b,k}}()?(P="setImmediate$"+Math.random()+"$",A.addEventListener?A.addEventListener("message",_,!1):A.attachEvent("onmessage",_),function(k){A.postMessage(P+k,"*")}):A.MessageChannel?((U=new MessageChannel).port1.onmessage=function(k){S(k.data)},function(k){U.port2.postMessage(k)}):y&&"onreadystatechange"in y.createElement("script")?(V=y.documentElement,function(k){var b=y.createElement("script");b.onreadystatechange=function(){S(k),b.onreadystatechange=null,V.removeChild(b),b=null},V.appendChild(b)}):function(k){setTimeout(S,0,k)},E.setImmediate=function(k){"function"!=typeof k&&(k=new Function(""+k));for(var b=new Array(arguments.length-1),Z=0;Z<b.length;Z++)b[Z]=arguments[Z+1];return w[H]={callback:k,args:b},C(H),H++},E.clearImmediate=g}function g(k){delete w[k]}function S(k){if(B)setTimeout(S,0,k);else{var b=w[k];if(b){B=!0;try{!function(Z){var l=Z.callback,we=Z.args;switch(we.length){case 0:l();break;case 1:l(we[0]);break;case 2:l(we[0],we[1]);break;case 3:l(we[0],we[1],we[2]);break;default:l.apply(p,we)}}(b)}finally{g(k),B=!1}}}}function _(k){k.source===A&&"string"==typeof k.data&&0===k.data.indexOf(P)&&S(+k.data.slice(P.length))}}(typeof self>"u"?void 0===c?this:c:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)},153:(It,L)=>{"use strict";class c{static isArrayBuffer(g){return"[object ArrayBuffer]"===Object.prototype.toString.call(g)}static toArrayBuffer(g){return this.isArrayBuffer(g)?g:g.byteLength===g.buffer.byteLength||0===g.byteOffset&&g.byteLength===g.buffer.byteLength?g.buffer:this.toUint8Array(g.buffer).slice(g.byteOffset,g.byteOffset+g.byteLength).buffer}static toUint8Array(g){return this.toView(g,Uint8Array)}static toView(g,S){if(g.constructor===S)return g;if(this.isArrayBuffer(g))return new S(g);if(this.isArrayBufferView(g))return new S(g.buffer,g.byteOffset,g.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(g){return this.isArrayBufferView(g)||this.isArrayBuffer(g)}static isArrayBufferView(g){return ArrayBuffer.isView(g)||g&&this.isArrayBuffer(g.buffer)}static isEqual(g,S){const _=c.toUint8Array(g),k=c.toUint8Array(S);if(_.length!==k.byteLength)return!1;for(let b=0;b<_.length;b++)if(_[b]!==k[b])return!1;return!0}static concat(...g){let S;S=Array.isArray(g[0])&&!(g[1]instanceof Function)||Array.isArray(g[0])&&g[1]instanceof Function?g[0]:g[g.length-1]instanceof Function?g.slice(0,g.length-1):g;let _=0;for(const Z of S)_+=Z.byteLength;const k=new Uint8Array(_);let b=0;for(const Z of S){const l=this.toUint8Array(Z);k.set(l,b),b+=l.length}return g[g.length-1]instanceof Function?this.toView(k,g[g.length-1]):k.buffer}}const A="string",p=/^[0-9a-f]+$/i,C=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,V=/^[a-zA-Z0-9-_]+$/;class U{static fromString(g){const S=unescape(encodeURIComponent(g)),_=new Uint8Array(S.length);for(let k=0;k<S.length;k++)_[k]=S.charCodeAt(k);return _.buffer}static toString(g){const S=c.toUint8Array(g);let _="";for(let b=0;b<S.length;b++)_+=String.fromCharCode(S[b]);return decodeURIComponent(escape(_))}}class P{static toString(g,S=!1){const _=c.toArrayBuffer(g),k=new DataView(_);let b="";for(let Z=0;Z<_.byteLength;Z+=2){const l=k.getUint16(Z,S);b+=String.fromCharCode(l)}return b}static fromString(g,S=!1){const _=new ArrayBuffer(2*g.length),k=new DataView(_);for(let b=0;b<g.length;b++)k.setUint16(2*b,g.charCodeAt(b),S);return _}}let H=(()=>{class E{static isHex(S){return typeof S===A&&p.test(S)}static isBase64(S){return typeof S===A&&C.test(S)}static isBase64Url(S){return typeof S===A&&V.test(S)}static ToString(S,_="utf8"){const k=c.toUint8Array(S);switch(_.toLowerCase()){case"utf8":return this.ToUtf8String(k);case"binary":return this.ToBinary(k);case"hex":return this.ToHex(k);case"base64":return this.ToBase64(k);case"base64url":return this.ToBase64Url(k);case"utf16le":return P.toString(k,!0);case"utf16":case"utf16be":return P.toString(k);default:throw new Error(`Unknown type of encoding '${_}'`)}}static FromString(S,_="utf8"){if(!S)return new ArrayBuffer(0);switch(_.toLowerCase()){case"utf8":return this.FromUtf8String(S);case"binary":return this.FromBinary(S);case"hex":return this.FromHex(S);case"base64":return this.FromBase64(S);case"base64url":return this.FromBase64Url(S);case"utf16le":return P.fromString(S,!0);case"utf16":case"utf16be":return P.fromString(S);default:throw new Error(`Unknown type of encoding '${_}'`)}}static ToBase64(S){const _=c.toUint8Array(S);if(typeof btoa<"u"){const k=this.ToString(_,"binary");return btoa(k)}return Buffer.from(_).toString("base64")}static FromBase64(S){const _=this.formatString(S);if(!_)return new ArrayBuffer(0);if(!E.isBase64(_))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(_)):new Uint8Array(Buffer.from(_,"base64")).buffer}static FromBase64Url(S){const _=this.formatString(S);if(!_)return new ArrayBuffer(0);if(!E.isBase64Url(_))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(_.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(S){return this.ToBase64(S).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(S,_=E.DEFAULT_UTF8_ENCODING){switch(_){case"ascii":return this.FromBinary(S);case"utf8":return U.fromString(S);case"utf16":case"utf16be":return P.fromString(S);case"utf16le":case"usc2":return P.fromString(S,!0);default:throw new Error(`Unknown type of encoding '${_}'`)}}static ToUtf8String(S,_=E.DEFAULT_UTF8_ENCODING){switch(_){case"ascii":return this.ToBinary(S);case"utf8":return U.toString(S);case"utf16":case"utf16be":return P.toString(S);case"utf16le":case"usc2":return P.toString(S,!0);default:throw new Error(`Unknown type of encoding '${_}'`)}}static FromBinary(S){const _=S.length,k=new Uint8Array(_);for(let b=0;b<_;b++)k[b]=S.charCodeAt(b);return k.buffer}static ToBinary(S){const _=c.toUint8Array(S);let k="";for(let b=0;b<_.length;b++)k+=String.fromCharCode(_[b]);return k}static ToHex(S){const _=c.toUint8Array(S);let k="";const b=_.length;for(let Z=0;Z<b;Z++){const l=_[Z];l<16&&(k+="0"),k+=l.toString(16)}return k}static FromHex(S){let _=this.formatString(S);if(!_)return new ArrayBuffer(0);if(!E.isHex(_))throw new TypeError("Argument 'hexString' is not HEX encoded");_.length%2&&(_=`0${_}`);const k=new Uint8Array(_.length/2);for(let b=0;b<_.length;b+=2){const Z=_.slice(b,b+2);k[b/2]=parseInt(Z,16)}return k.buffer}static ToUtf16String(S,_=!1){return P.toString(S,_)}static FromUtf16String(S,_=!1){return P.fromString(S,_)}static Base64Padding(S){const _=4-S.length%4;if(_<4)for(let k=0;k<_;k++)S+="=";return S}static formatString(S){return S?.replace(/[\n\r\t ]/g,"")||""}}return E.DEFAULT_UTF8_ENCODING="utf8",E})();L._H=c,L.U$=H}}]);