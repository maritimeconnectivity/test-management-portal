(self.webpackChunkmanagement_portal_clr=self.webpackChunkmanagement_portal_clr||[]).push([[660],{1748:(Nt,M,j)=>{"use strict";j.d(M,{Y:()=>b});const n=[{code:"AF",code3:"AFG",title:"Afghanistan",value:"Afghanistan"},{code:"AL",code3:"ALB",title:"Albania",value:"Albania"},{code:"DZ",code3:"DZA",title:"Algeria",value:"Algeria"},{code:"AS",code3:"ASM",title:"American Samoa",value:"American Samoa"},{code:"AD",code3:"AND",title:"Andorra",value:"Andorra"},{code:"AO",code3:"AGO",title:"Angola",value:"Angola"},{code:"AI",code3:"AIA",title:"Anguilla",value:"Anguilla"},{code:"AQ",code3:"ATA",title:"Antarctica",value:"Antarctica"},{code:"AG",code3:"ATG",title:"Antigua and Barbuda",value:"Antigua and Barbuda"},{code:"AR",code3:"ARG",title:"Argentina",value:"Argentina"},{code:"AM",code3:"ARM",title:"Armenia",value:"Armenia"},{code:"AW",code3:"ABW",title:"Aruba",value:"Aruba"},{code:"AU",code3:"AUS",title:"Australia",value:"Australia"},{code:"AT",code3:"AUT",title:"Austria",value:"Austria"},{code:"AZ",code3:"AZE",title:"Azerbaijan",value:"Azerbaijan"},{code:"BS",code3:"BHS",title:"Bahamas (the)",value:"Bahamas (the)"},{code:"BH",code3:"BHR",title:"Bahrain",value:"Bahrain"},{code:"BD",code3:"BGD",title:"Bangladesh",value:"Bangladesh"},{code:"BB",code3:"BRB",title:"Barbados",value:"Barbados"},{code:"BY",code3:"BLR",title:"Belarus",value:"Belarus"},{code:"BE",code3:"BEL",title:"Belgium",value:"Belgium"},{code:"BZ",code3:"BLZ",title:"Belize",value:"Belize"},{code:"BJ",code3:"BEN",title:"Benin",value:"Benin"},{code:"BM",code3:"BMU",title:"Bermuda",value:"Bermuda"},{code:"BT",code3:"BTN",title:"Bhutan",value:"Bhutan"},{code:"BO",code3:"BOL",title:"Bolivia (Plurinational State of)",value:"Bolivia (Plurinational State of)"},{code:"BQ",code3:"BES",title:"Bonaire, Sint Eustatius and Saba",value:"Bonaire, Sint Eustatius and Saba"},{code:"BA",code3:"BIH",title:"Bosnia and Herzegovina",value:"Bosnia and Herzegovina"},{code:"BW",code3:"BWA",title:"Botswana",value:"Botswana"},{code:"BV",code3:"BVT",title:"Bouvet Island",value:"Bouvet Island"},{code:"BR",code3:"BRA",title:"Brazil",value:"Brazil"},{code:"IO",code3:"IOT",title:"British Indian Ocean Territory (the)",value:"British Indian Ocean Territory (the)"},{code:"BN",code3:"BRN",title:"Brunei Darussalam",value:"Brunei Darussalam"},{code:"BG",code3:"BGR",title:"Bulgaria",value:"Bulgaria"},{code:"BF",code3:"BFA",title:"Burkina Faso",value:"Burkina Faso"},{code:"BI",code3:"BDI",title:"Burundi",value:"Burundi"},{code:"CV",code3:"CPV",title:"Cabo Verde",value:"Cabo Verde"},{code:"KH",code3:"KHM",title:"Cambodia",value:"Cambodia"},{code:"CM",code3:"CMR",title:"Cameroon",value:"Cameroon"},{code:"CA",code3:"CAN",title:"Canada",value:"Canada"},{code:"KY",code3:"CYM",title:"Cayman Islands (the)",value:"Cayman Islands (the)"},{code:"CF",code3:"CAF",title:"Central African Republic (the)",value:"Central African Republic (the)"},{code:"TD",code3:"TCD",title:"Chad",value:"Chad"},{code:"CL",code3:"CHL",title:"Chile",value:"Chile"},{code:"CN",code3:"CHN",title:"China",value:"China"},{code:"CX",code3:"CXR",title:"Christmas Island",value:"Christmas Island"},{code:"CC",code3:"CCK",title:"Cocos (Keeling) Islands (the)",value:"Cocos (Keeling) Islands (the)"},{code:"CO",code3:"COL",title:"Colombia",value:"Colombia"},{code:"KM",code3:"COM",title:"Comoros (the)",value:"Comoros (the)"},{code:"CD",code3:"COD",title:"Congo (the Democratic Republic of the)",value:"Congo (the Democratic Republic of the)"},{code:"CG",code3:"COG",title:"Congo (the)",value:"Congo (the)"},{code:"CK",code3:"COK",title:"Cook Islands (the)",value:"Cook Islands (the)"},{code:"CR",code3:"CRI",title:"Costa Rica",value:"Costa Rica"},{code:"HR",code3:"HRV",title:"Croatia",value:"Croatia"},{code:"CU",code3:"CUB",title:"Cuba",value:"Cuba"},{code:"CW",code3:"CUW",title:"Cura\xe7ao",value:"Cura\xe7ao"},{code:"CY",code3:"CYP",title:"Cyprus",value:"Cyprus"},{code:"CZ",code3:"CZE",title:"Czechia",value:"Czechia"},{code:"CI",code3:"CIV",title:"C\xf4te d'Ivoire",value:"C\xf4te d'Ivoire"},{code:"DK",code3:"DNK",title:"Denmark",value:"Denmark"},{code:"DJ",code3:"DJI",title:"Djibouti",value:"Djibouti"},{code:"DM",code3:"DMA",title:"Dominica",value:"Dominica"},{code:"DO",code3:"DOM",title:"Dominican Republic (the)",value:"Dominican Republic (the)"},{code:"EC",code3:"ECU",title:"Ecuador",value:"Ecuador"},{code:"EG",code3:"EGY",title:"Egypt",value:"Egypt"},{code:"SV",code3:"SLV",title:"El Salvador",value:"El Salvador"},{code:"GQ",code3:"GNQ",title:"Equatorial Guinea",value:"Equatorial Guinea"},{code:"ER",code3:"ERI",title:"Eritrea",value:"Eritrea"},{code:"EE",code3:"EST",title:"Estonia",value:"Estonia"},{code:"SZ",code3:"SWZ",title:"Eswatini",value:"Eswatini"},{code:"ET",code3:"ETH",title:"Ethiopia",value:"Ethiopia"},{code:"FK",code3:"FLK",title:"Falkland Islands (the) [Malvinas]",value:"Falkland Islands (the) [Malvinas]"},{code:"FO",code3:"FRO",title:"Faroe Islands (the)",value:"Faroe Islands (the)"},{code:"FJ",code3:"FJI",title:"Fiji",value:"Fiji"},{code:"FI",code3:"FIN",title:"Finland",value:"Finland"},{code:"FR",code3:"FRA",title:"France",value:"France"},{code:"GF",code3:"GUF",title:"French Guiana",value:"French Guiana"},{code:"PF",code3:"PYF",title:"French Polynesia",value:"French Polynesia"},{code:"TF",code3:"ATF",title:"French Southern Territories (the)",value:"French Southern Territories (the)"},{code:"GA",code3:"GAB",title:"Gabon",value:"Gabon"},{code:"GM",code3:"GMB",title:"Gambia (the)",value:"Gambia (the)"},{code:"GE",code3:"GEO",title:"Georgia",value:"Georgia"},{code:"DE",code3:"DEU",title:"Germany",value:"Germany"},{code:"GH",code3:"GHA",title:"Ghana",value:"Ghana"},{code:"GI",code3:"GIB",title:"Gibraltar",value:"Gibraltar"},{code:"GR",code3:"GRC",title:"Greece",value:"Greece"},{code:"GL",code3:"GRL",title:"Greenland",value:"Greenland"},{code:"GD",code3:"GRD",title:"Grenada",value:"Grenada"},{code:"GP",code3:"GLP",title:"Guadeloupe",value:"Guadeloupe"},{code:"GU",code3:"GUM",title:"Guam",value:"Guam"},{code:"GT",code3:"GTM",title:"Guatemala",value:"Guatemala"},{code:"GG",code3:"GGY",title:"Guernsey",value:"Guernsey"},{code:"GN",code3:"GIN",title:"Guinea",value:"Guinea"},{code:"GW",code3:"GNB",title:"Guinea-Bissau",value:"Guinea-Bissau"},{code:"GY",code3:"GUY",title:"Guyana",value:"Guyana"},{code:"HT",code3:"HTI",title:"Haiti",value:"Haiti"},{code:"HM",code3:"HMD",title:"Heard Island and McDonald Islands",value:"Heard Island and McDonald Islands"},{code:"VA",code3:"VAT",title:"Holy See (the)",value:"Holy See (the)"},{code:"HN",code3:"HND",title:"Honduras",value:"Honduras"},{code:"HK",code3:"HKG",title:"Hong Kong",value:"Hong Kong"},{code:"HU",code3:"HUN",title:"Hungary",value:"Hungary"},{code:"IS",code3:"ISL",title:"Iceland",value:"Iceland"},{code:"IN",code3:"IND",title:"India",value:"India"},{code:"ID",code3:"IDN",title:"Indonesia",value:"Indonesia"},{code:"IR",code3:"IRN",title:"Iran (Islamic Republic of)",value:"Iran (Islamic Republic of)"},{code:"IQ",code3:"IRQ",title:"Iraq",value:"Iraq"},{code:"IE",code3:"IRL",title:"Ireland",value:"Ireland"},{code:"IM",code3:"IMN",title:"Isle of Man",value:"Isle of Man"},{code:"IL",code3:"ISR",title:"Israel",value:"Israel"},{code:"IT",code3:"ITA",title:"Italy",value:"Italy"},{code:"JM",code3:"JAM",title:"Jamaica",value:"Jamaica"},{code:"JP",code3:"JPN",title:"Japan",value:"Japan"},{code:"JE",code3:"JEY",title:"Jersey",value:"Jersey"},{code:"JO",code3:"JOR",title:"Jordan",value:"Jordan"},{code:"KZ",code3:"KAZ",title:"Kazakhstan",value:"Kazakhstan"},{code:"KE",code3:"KEN",title:"Kenya",value:"Kenya"},{code:"KI",code3:"KIR",title:"Kiribati",value:"Kiribati"},{code:"KP",code3:"PRK",title:"Korea (the Democratic People's Republic of)",value:"Korea (the Democratic People's Republic of)"},{code:"KR",code3:"KOR",title:"Korea (the Republic of)",value:"Korea (the Republic of)"},{code:"KW",code3:"KWT",title:"Kuwait",value:"Kuwait"},{code:"KG",code3:"KGZ",title:"Kyrgyzstan",value:"Kyrgyzstan"},{code:"LA",code3:"LAO",title:"Lao People's Democratic Republic (the)",value:"Lao People's Democratic Republic (the)"},{code:"LV",code3:"LVA",title:"Latvia",value:"Latvia"},{code:"LB",code3:"LBN",title:"Lebanon",value:"Lebanon"},{code:"LS",code3:"LSO",title:"Lesotho",value:"Lesotho"},{code:"LR",code3:"LBR",title:"Liberia",value:"Liberia"},{code:"LY",code3:"LBY",title:"Libya",value:"Libya"},{code:"LI",code3:"LIE",title:"Liechtenstein",value:"Liechtenstein"},{code:"LT",code3:"LTU",title:"Lithuania",value:"Lithuania"},{code:"LU",code3:"LUX",title:"Luxembourg",value:"Luxembourg"},{code:"MO",code3:"MAC",title:"Macao",value:"Macao"},{code:"MG",code3:"MDG",title:"Madagascar",value:"Madagascar"},{code:"MW",code3:"MWI",title:"Malawi",value:"Malawi"},{code:"MY",code3:"MYS",title:"Malaysia",value:"Malaysia"},{code:"MV",code3:"MDV",title:"Maldives",value:"Maldives"},{code:"ML",code3:"MLI",title:"Mali",value:"Mali"},{code:"MT",code3:"MLT",title:"Malta",value:"Malta"},{code:"MH",code3:"MHL",title:"Marshall Islands (the)",value:"Marshall Islands (the)"},{code:"MQ",code3:"MTQ",title:"Martinique",value:"Martinique"},{code:"MR",code3:"MRT",title:"Mauritania",value:"Mauritania"},{code:"MU",code3:"MUS",title:"Mauritius",value:"Mauritius"},{code:"YT",code3:"MYT",title:"Mayotte",value:"Mayotte"},{code:"MX",code3:"MEX",title:"Mexico",value:"Mexico"},{code:"FM",code3:"FSM",title:"Micronesia (Federated States of)",value:"Micronesia (Federated States of)"},{code:"MD",code3:"MDA",title:"Moldova (the Republic of)",value:"Moldova (the Republic of)"},{code:"MC",code3:"MCO",title:"Monaco",value:"Monaco"},{code:"MN",code3:"MNG",title:"Mongolia",value:"Mongolia"},{code:"ME",code3:"MNE",title:"Montenegro",value:"Montenegro"},{code:"MS",code3:"MSR",title:"Montserrat",value:"Montserrat"},{code:"MA",code3:"MAR",title:"Morocco",value:"Morocco"},{code:"MZ",code3:"MOZ",title:"Mozambique",value:"Mozambique"},{code:"MM",code3:"MMR",title:"Myanmar",value:"Myanmar"},{code:"NA",code3:"NAM",title:"Namibia",value:"Namibia"},{code:"NR",code3:"NRU",title:"Nauru",value:"Nauru"},{code:"NP",code3:"NPL",title:"Nepal",value:"Nepal"},{code:"NL",code3:"NLD",title:"Netherlands (the)",value:"Netherlands (the)"},{code:"NC",code3:"NCL",title:"New Caledonia",value:"New Caledonia"},{code:"NZ",code3:"NZL",title:"New Zealand",value:"New Zealand"},{code:"NI",code3:"NIC",title:"Nicaragua",value:"Nicaragua"},{code:"NE",code3:"NER",title:"Niger (the)",value:"Niger (the)"},{code:"NG",code3:"NGA",title:"Nigeria",value:"Nigeria"},{code:"NU",code3:"NIU",title:"Niue",value:"Niue"},{code:"NF",code3:"NFK",title:"Norfolk Island",value:"Norfolk Island"},{code:"MP",code3:"MNP",title:"Northern Mariana Islands (the)",value:"Northern Mariana Islands (the)"},{code:"NO",code3:"NOR",title:"Norway",value:"Norway"},{code:"OM",code3:"OMN",title:"Oman",value:"Oman"},{code:"PK",code3:"PAK",title:"Pakistan",value:"Pakistan"},{code:"PW",code3:"PLW",title:"Palau",value:"Palau"},{code:"PS",code3:"PSE",title:"Palestine, State of",value:"Palestine, State of"},{code:"PA",code3:"PAN",title:"Panama",value:"Panama"},{code:"PG",code3:"PNG",title:"Papua New Guinea",value:"Papua New Guinea"},{code:"PY",code3:"PRY",title:"Paraguay",value:"Paraguay"},{code:"PE",code3:"PER",title:"Peru",value:"Peru"},{code:"PH",code3:"PHL",title:"Philippines (the)",value:"Philippines (the)"},{code:"PN",code3:"PCN",title:"Pitcairn",value:"Pitcairn"},{code:"PL",code3:"POL",title:"Poland",value:"Poland"},{code:"PT",code3:"PRT",title:"Portugal",value:"Portugal"},{code:"PR",code3:"PRI",title:"Puerto Rico",value:"Puerto Rico"},{code:"QA",code3:"QAT",title:"Qatar",value:"Qatar"},{code:"MK",code3:"MKD",title:"Republic of North Macedonia",value:"Republic of North Macedonia"},{code:"RO",code3:"ROU",title:"Romania",value:"Romania"},{code:"RU",code3:"RUS",title:"Russian Federation (the)",value:"Russian Federation (the)"},{code:"RW",code3:"RWA",title:"Rwanda",value:"Rwanda"},{code:"RE",code3:"REU",title:"R\xe9union",value:"R\xe9union"},{code:"BL",code3:"BLM",title:"Saint Barth\xe9lemy",value:"Saint Barth\xe9lemy"},{code:"SH",code3:"SHN",title:"Saint Helena, Ascension and Tristan da Cunha",value:"Saint Helena, Ascension and Tristan da Cunha"},{code:"KN",code3:"KNA",title:"Saint Kitts and Nevis",value:"Saint Kitts and Nevis"},{code:"LC",code3:"LCA",title:"Saint Lucia",value:"Saint Lucia"},{code:"MF",code3:"MAF",title:"Saint Martin (French part)",value:"Saint Martin (French part)"},{code:"PM",code3:"SPM",title:"Saint Pierre and Miquelon",value:"Saint Pierre and Miquelon"},{code:"VC",code3:"VCT",title:"Saint Vincent and the Grenadines",value:"Saint Vincent and the Grenadines"},{code:"WS",code3:"WSM",title:"Samoa",value:"Samoa"},{code:"SM",code3:"SMR",title:"San Marino",value:"San Marino"},{code:"ST",code3:"STP",title:"Sao Tome and Principe",value:"Sao Tome and Principe"},{code:"SA",code3:"SAU",title:"Saudi Arabia",value:"Saudi Arabia"},{code:"SN",code3:"SEN",title:"Senegal",value:"Senegal"},{code:"RS",code3:"SRB",title:"Serbia",value:"Serbia"},{code:"SC",code3:"SYC",title:"Seychelles",value:"Seychelles"},{code:"SL",code3:"SLE",title:"Sierra Leone",value:"Sierra Leone"},{code:"SG",code3:"SGP",title:"Singapore",value:"Singapore"},{code:"SX",code3:"SXM",title:"Sint Maarten (Dutch part)",value:"Sint Maarten (Dutch part)"},{code:"SK",code3:"SVK",title:"Slovakia",value:"Slovakia"},{code:"SI",code3:"SVN",title:"Slovenia",value:"Slovenia"},{code:"SB",code3:"SLB",title:"Solomon Islands",value:"Solomon Islands"},{code:"SO",code3:"SOM",title:"Somalia",value:"Somalia"},{code:"ZA",code3:"ZAF",title:"South Africa",value:"South Africa"},{code:"GS",code3:"SGS",title:"South Georgia and the South Sandwich Islands",value:"South Georgia and the South Sandwich Islands"},{code:"SS",code3:"SSD",title:"South Sudan",value:"South Sudan"},{code:"ES",code3:"ESP",title:"Spain",value:"Spain"},{code:"LK",code3:"LKA",title:"Sri Lanka",value:"Sri Lanka"},{code:"SD",code3:"SDN",title:"Sudan (the)",value:"Sudan (the)"},{code:"SR",code3:"SUR",title:"Surititle",value:"Surititle"},{code:"SJ",code3:"SJM",title:"Svalbard and Jan Mayen",value:"Svalbard and Jan Mayen"},{code:"SE",code3:"SWE",title:"Sweden",value:"Sweden"},{code:"CH",code3:"CHE",title:"Switzerland",value:"Switzerland"},{code:"SY",code3:"SYR",title:"Syrian Arab Republic",value:"Syrian Arab Republic"},{code:"TW",code3:"TWN",title:"Taiwan",value:"Taiwan"},{code:"TJ",code3:"TJK",title:"Tajikistan",value:"Tajikistan"},{code:"TZ",code3:"TZA",title:"Tanzania, United Republic of",value:"Tanzania, United Republic of"},{code:"TH",code3:"THA",title:"Thailand",value:"Thailand"},{code:"TL",code3:"TLS",title:"Timor-Leste",value:"Timor-Leste"},{code:"TG",code3:"TGO",title:"Togo",value:"Togo"},{code:"TK",code3:"TKL",title:"Tokelau",value:"Tokelau"},{code:"TO",code3:"TON",title:"Tonga",value:"Tonga"},{code:"TT",code3:"TTO",title:"Trinidad and Tobago",value:"Trinidad and Tobago"},{code:"TN",code3:"TUN",title:"Tunisia",value:"Tunisia"},{code:"TR",code3:"TUR",title:"Turkey",value:"Turkey"},{code:"TM",code3:"TKM",title:"Turkmenistan",value:"Turkmenistan"},{code:"TC",code3:"TCA",title:"Turks and Caicos Islands (the)",value:"Turks and Caicos Islands (the)"},{code:"TV",code3:"TUV",title:"Tuvalu",value:"Tuvalu"},{code:"UG",code3:"UGA",title:"Uganda",value:"Uganda"},{code:"UA",code3:"UKR",title:"Ukraine",value:"Ukraine"},{code:"AE",code3:"ARE",title:"United Arab Emirates (the)",value:"United Arab Emirates (the)"},{code:"GB",code3:"GBR",title:"United Kingdom of Great Britain and Northern Ireland (the)",value:"United Kingdom of Great Britain and Northern Ireland (the)"},{code:"UM",code3:"UMI",title:"United States Minor Outlying Islands (the)",value:"United States Minor Outlying Islands (the)"},{code:"US",code3:"USA",title:"United States of America (the)",value:"United States of America (the)"},{code:"UY",code3:"URY",title:"Uruguay",value:"Uruguay"},{code:"UZ",code3:"UZB",title:"Uzbekistan",value:"Uzbekistan"},{code:"VU",code3:"VUT",title:"Vanuatu",value:"Vanuatu"},{code:"VE",code3:"VEN",title:"Venezuela (Bolivarian Republic of)",value:"Venezuela (Bolivarian Republic of)"},{code:"VN",code3:"VNM",title:"Viet Nam",value:"Viet Nam"},{code:"VG",code3:"VGB",title:"Virgin Islands (British)",value:"Virgin Islands (British)"},{code:"VI",code3:"VIR",title:"Virgin Islands (U.S.)",value:"Virgin Islands (U.S.)"},{code:"WF",code3:"WLF",title:"Wallis and Futuna",value:"Wallis and Futuna"},{code:"EH",code3:"ESH",title:"Western Sahara",value:"Western Sahara"},{code:"YE",code3:"YEM",title:"Yemen",value:"Yemen"},{code:"ZM",code3:"ZMB",title:"Zambia",value:"Zambia"},{code:"ZW",code3:"ZWE",title:"Zimbabwe",value:"Zimbabwe"},{code:"AX",code3:"ALA",title:"\xc5land Islands",value:"\xc5land Islands"}];var c=j(1066);const b={device:{id:{title:"ID",type:"number",description:"identifier"},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"device",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>:<unique_id>'"},name:{title:"Name",type:"string",description:"Name of device",visibleFrom:["detail","list","edit","edit-new"],required:!0},permissions:{title:"Permissions",type:"string",description:"List of permissions assigned by the organization",visibleFrom:["edit","detail","edit","edit-new"]},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},organization:{id:{title:"ID",type:"number"},logo:{title:"Logo",type:"image",allowedExtensions:[".jpg",".png"],visibleFrom:["detail","edit"]},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"organization",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>'"},name:{title:"Name",type:"string",description:"Name of organization",visibleFrom:["detail","list","edit","edit-new"],required:!0},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},email:{title:"e-mail",type:"string",description:"Contact e-mail",visibleFrom:["detail","edit","edit-new"],required:!0},url:{title:"URL",type:"string",description:"URL of organization",visibleFrom:["detail","edit","edit-new"],required:!0},address:{title:"Address",type:"string",description:"Address of organization",visibleFrom:["detail","edit","edit-new"],required:!0},country:{title:"Country",type:"string",description:"Country that organization belongs to",visibleFrom:["detail","list","edit","edit-new"],options:n,required:!0},federationType:{title:"Federation type",type:"string",description:"OpenID Connect federation type",visibleFrom:["detail","edit","edit-new"],immutable:!0},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},service:{id:{title:"ID",type:"number"},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"service",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>:<unique_id>'"},name:{title:"Name",type:"string",description:"Name of service",visibleFrom:["detail","list","edit","edit-new"],required:!0},permissions:{title:"Permissions",type:"string",description:"List of permissions assigned by the organization",visibleFrom:["edit","detail","edit","edit-new"]},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},instanceVersion:{title:"Instance version",type:"string",description:"Version of service instance",immutable:!0},certDomainName:{title:"Certificate domain name",type:"string",description:"The domain name the service will be available on. Used in the issued certificates for the service.",visibleFrom:["detail","edit","edit-new"]},oidcClientId:{title:"OIDC client ID",type:"string",description:"OpenID Connect client ID",visibleFrom:["detail","edit"]},oidcClientSecret:{title:"OIDC client secret",type:"string",description:"OpenID Connect client secret",visibleFrom:["detail","edit"]},oidcAccessType:{title:"Access type",type:"string",description:"OpenID Connect access type",options:[{title:"public",value:"public",showField:{key:"oidcRedirectUri",value:!0}},{title:"bearer-only",value:"bearer-only",showField:{key:"oidcRedirectUri",value:!1}},{title:"confidential",value:"confidential",showField:{key:"oidcRedirectUri",value:!0}}],visibleFrom:["detail","edit"]},oidcRedirectUri:{title:"OIDC redirect URI",type:"string",description:"OpenID Connect client redirect URI",visibleFrom:["detail","edit"]},vessel:{title:"Vessel",type:"vessel",description:"Correlated vessel",visibleFrom:["detail","edit"]},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},user:{id:{title:"ID",type:"number"},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"user",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>:<unique_id>'"},firstName:{title:"First name",type:"string",visibleFrom:["detail","list","edit","edit-new"],required:!0},lastName:{title:"Last name",type:"string",visibleFrom:["detail","list","edit","edit-new"],required:!0},email:{title:"e-mail",type:"string",description:"Contact e-mail",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0},permissions:{title:"Permissions",type:"string",description:"List of permissions assigned by the organization",visibleFrom:["detail","list","edit","edit-new"]},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},vessel:{id:{title:"ID",type:"number"},logo:{title:"Logo",type:"image",allowedExtensions:[".jpg",".png"],visibleFrom:["detail","edit"]},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"vessel",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>:<unique_id>'"},name:{title:"Name",type:"string",description:"Name of device",visibleFrom:["detail","list","edit","edit-new"],required:!0},permissions:{title:"Permissions",type:"string",description:"List of permissions assigned by the organization",visibleFrom:["detail","edit","edit-new"]},imoNumber:{title:"IMO number",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},mmsiNumber:{title:"MMSI number",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},callsign:{title:"Call sign",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},flagstate:{title:"Flag state",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},aisClass:{title:"AIS class",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},portOfRegister:{title:"Port of register",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},role:{id:{title:"ID",type:"number"},permission:{title:"Permission",type:"string",visibleFrom:["detail","list","edit","edit-new"],required:!0},roleName:{title:"Role name",type:"string",visibleFrom:["detail","list","edit","edit-new"],options:[{title:"ROLE_SITE_ADMIN",value:"ROLE_SITE_ADMIN"},{title:"ROLE_ORG_ADMIN",value:"ROLE_ORG_ADMIN"},{title:"ROLE_USER",value:"ROLE_USER"},{title:"ROLE_ENTITY_ADMIN",value:"ROLE_ENTITY_ADMIN"},{title:"ROLE_USER_ADMIN",value:"ROLE_USER_ADMIN"},{title:"ROLE_VESSEL_ADMIN",value:"ROLE_VESSEL_ADMIN"},{title:"ROLE_SERVICE_ADMIN",value:"ROLE_SERVICE_ADMIN"},{title:"ROLE_APPROVE_ORG",value:"ROLE_APPROVE_ORG"},{title:"ROLE_DEVICE_ADMIN",value:"ROLE_DEVICE_ADMIN"},{title:"ROLE_MMS_ADMIN",value:"ROLE_MMS_ADMIN"}],required:!0},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},orgcandidate:{id:{title:"ID",type:"number"},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],shortIdType:"organization",immutable:!0,required:!0,error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>'"},name:{title:"Name",type:"string",description:"Name of organization",visibleFrom:["detail","list","edit","edit-new"],required:!0},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},email:{title:"e-mail",type:"string",description:"Contact e-mail",visibleFrom:["detail","list","edit","edit-new"],required:!0},url:{title:"URL",type:"string",description:"URL of organization",visibleFrom:["detail","list","edit","edit-new"],required:!0},address:{title:"Address",type:"string",description:"Address of organization",visibleFrom:["detail","edit","edit-new"],required:!0},country:{title:"Country",type:"string",description:"Country that organization belongs to",visibleFrom:["detail","list","edit","edit-new"],options:n,required:!0},federationType:{title:"Federation type",type:"string",description:"OpenID Connect federation type",visibleFrom:["detail","edit"],immutable:!0},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:p=>(0,c.t)(p),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},instance:{id:{title:"ID",type:"number"},instanceId:{title:"Instance ID",type:"string",description:"MCP MRN as unique identifer",placeholder:"urn:mrn:",visibleFrom:["detail","edit","edit-new"],required:!0},name:{title:"Name",type:"string",description:"Name of service instance",visibleFrom:["detail","list","edit","edit-new"],required:!0},version:{title:"Version",type:"string",description:"Version of service instance",visibleFrom:["detail","list","edit","edit-new"],required:!0},comment:{title:"Comment",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},serviceType:{title:"Service type",type:"stringArray",options:[{title:"MS 1 - VTS Information service (INS)",value:"VTSInformationService"},{title:"MS 2 - VTS Navigational assistance service (NAS)",value:"VTSNavigationalAssistanceService"},{title:"MS 3 - Traffic organization service (TOS)",value:"TrafficOrganizationService"},{title:"MS 4 - Port support service (PSS)",value:"PortSupportService"},{title:"MS 5 - Maritime safety information (MSI) service",value:"MaritimeSafetyInformationService"},{title:"MS 6 - Pilotage service",value:"PilotageService"},{title:"MS 7 - Tug service",value:"TugService"},{title:"MS 8 - Vessel shore reporting",value:"VesselShoreReporting"},{title:"MS 9 - Telemedical assistance service (TMAS)",value:"TelemedicalAssistanceService"},{title:"MS 10 - Maritime assistance service (MAS)",value:"MaritimeAssistanceService"},{title:"MS 11 - Nautical chart service",value:"NauticalChartService"},{title:"MS 12 - Nautical publications service",value:"NauticalPublicationsService"},{title:"MS 13 - Ice navigation service",value:"IceNavigationService"},{title:"MS 14 - Meteorological information service",value:"MeteorologicalInformationService"},{title:"MS 15 - Real-time hydrographic and environmental information services",value:"RealTimeHydrographicAndEnvironmentalInformationServices"},{title:"MS 16 - Search and rescue (SAR) service",value:"SearchAndRescueService"},{title:"Other",value:"other:etc"}],description:"The service type shall reflect the associated operational service type provided according to defined types",visibleFrom:["detail","list","edit","edit-new"]},dataProductType:{title:"Data product type",type:"stringArray",options:[{title:"S-57 Electronic Navigational Chart (ENC)",value:"S57"},{title:"S-101 Electronic Navigational Chart (ENC)",value:"S101"},{title:"S-102 Bathymetric Surface",value:"S102"},{title:"S-104 Water Level Information for Surface Navigation",value:"S104"},{title:"S-111 Surface Currents",value:"S111"},{title:"S-122 Marine Protected Areas (MPAs)",value:"S122"},{title:"S-123 Marine Radio Services",value:"S123"},{title:"S-124 Navigational Warnings",value:"S124"},{title:"S-125 Marine Navigational Services",value:"S125"},{title:"S-126 Marine Physical Environment",value:"S126"},{title:"S-127 Marine Traffic Management",value:"S127"},{title:"S-128 Catalogue of Nautical Products",value:"S128"},{title:"S-129 Under Keel Clearance Management (UKCM)",value:"S129"},{title:"S-131 Marine Harbour Infrastructure",value:"S131"},{title:"S-210 Inter-VTS Exchange Format",value:"S210"},{title:"S-211 Port Call Message Format",value:"S211"},{title:"S-212 VTS Digital Information Service",value:"S212"},{title:"S-401 Inland ENC",value:"S401"},{title:"S-402 Bathymetric Contour Overlay for Inland ENC",value:"S402"},{title:"S-411 Sea Ice Information",value:"S411"},{title:"S-412 Weather Overlay",value:"S412"},{title:"S-413 Marine Weather Conditions",value:"S413"},{title:"S-414 Marine Weather Observations",value:"S414"},{title:"S-421 Route Plan",value:"S421"},{title:"Route Plan",value:"RTZ"},{title:"Electronic Port Clearance",value:"EPC"},{title:"Other data types not covered in this table",value:"OTHER"}],description:"Data product type defined in IEC 63173-2 SECOM standard",visibleFrom:["detail","list","edit","edit-new"]},status:{title:"Status",type:"string",options:[{title:"Provisional",value:"PROVISIONAL"},{title:"Released",value:"RELEASED"},{title:"Deprecated",value:"DEPRECATED"},{title:"Deleted",value:"DELETED"}],visibleFrom:["detail","list","edit","edit-new"],required:!0},endpointUri:{title:"Endpoint URI",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},endpointType:{title:"Endpoint type",type:"string",visibleFrom:["detail","edit","edit-new"]},organizationId:{title:"Organization ID",type:"string",visibleFrom:["detail","edit","edit-new"],immutable:!0},keywords:{title:"Keywords",type:"stringArray",placeholder:"Please enter keyword",visibleFrom:["detail","list","edit","edit-new"]},implementsServiceDesign:{title:"Technical design ID",type:"string",description:"MCP MRN as unique identifer",placeholder:"urn:mrn:",visibleFrom:["detail","edit","edit-new"]},implementsServiceDesignVersion:{title:"Technical design version",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","edit","edit-new"]},geometryContentType:{title:"Geometry content type",type:"string",visibleFrom:["detail","edit","edit-new"]},geometry:{title:"Geometry",type:"object",visibleFrom:[]},unlocode:{title:"Unlocode",type:"stringArray",placeholder:"Please enter UN/LOCODE",visibleFrom:["detail","edit","edit-new"]},mmsi:{title:"MMSI",type:"string",visibleFrom:["detail","edit","edit-new"]},imo:{title:"IMO number",type:"string",visibleFrom:["detail","edit","edit-new"]},instanceAsXml:{title:"Instance as XML",type:"xml",notShowOnEdit:!0,visibleFrom:["detail","edit","edit-new"]},instanceAsDocId:{title:"Instance as DocId",type:"number"},instanceAsDoc:{title:"Instance as document",type:"file",visibleFrom:["detail","edit","edit-new"]},ledgerRequestId:{title:"Ledger Request ID",type:"number"},ledgerRequestStatus:{title:"Ledger Request status",type:"string",options:[{title:"Inactive",value:"INACTIVE"},{title:"Created",value:"CREATED"},{title:"Vetting",value:"VETTING"},{title:"Vetted",value:"VETTED"},{title:"Requesting",value:"REQUESTING"},{title:"Succeeded",value:"SUCCEEDED"},{title:"Failed",value:"FAILED"},{title:"Rejected",value:"REJECTED"}],visibleFrom:["detail","edit","edit-new"]},docIds:{title:"Related documents",type:"fileArray",filter:!1,visibleFrom:["detail","edit","edit-new"]},publishedAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","edit","edit-new"]},lastUpdatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]}},newOrganization:{orgMrn:{title:"Maritime Resource Name (MRN) for organization",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","edit","edit-new"],required:!0,shortIdType:"organization"},orgName:{title:"Organization name",type:"string",description:"Name of organization",visibleFrom:["detail","edit","edit-new"],required:!0},orgEmail:{title:"Organization contact e-mail",type:"string",description:"Contact e-mail",placeholder:"non-personal email, e.g., info@example.org",visibleFrom:["detail","edit","edit-new"],required:!0},orgUrl:{title:"URL of organization",type:"string",description:"URL of organization",visibleFrom:["detail","edit","edit-new"],required:!0},orgAddress:{title:"Address of organization",type:"string",description:"Address of organization",visibleFrom:["detail","edit","edit-new"],required:!0},orgCountry:{title:"Country of organization",type:"string",description:"Country that organization belongs to",visibleFrom:["detail","edit","edit-new"],options:n,required:!0}},ledgerInstance:{name:{title:"Name",type:"string",description:"Name of service instance",visibleFrom:["list"]},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["list"]},version:{title:"Version",type:"string",description:"Version of service instance",visibleFrom:["list"]},keywords:{title:"Keywords",type:"string",visibleFrom:["list"]},coverageArea:{title:"Coverage ",type:"string"},status:{title:"Status",type:"string",options:[{title:"Provisional",value:"PROVISIONAL"},{title:"Released",value:"RELEASED"},{title:"Deprecated",value:"DEPRECATED"},{title:"Deleted",value:"DELETED"}],visibleFrom:["list"]},implementsDesignMRN:{title:"Technical design ID",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["list"],shortIdType:"design",immutable:!0},implementsDesignVersion:{title:"Technical design version",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["list"]},msrName:{title:"MSR Name of register",type:"string",visibleFrom:["list"]},msrUrl:{title:"MSR URL of register",type:"string",visibleFrom:["list"]}}}},1224:(Nt,M,j)=>{"use strict";j.d(M,{$l:()=>c,BY:()=>b,kB:()=>n});const n=p=>Object.fromEntries(Object.entries(p).filter(([C,V])=>void 0!==V&&V.toString().length>0)),c=(p,C)=>{const V={...p};for(const U in C)V.hasOwnProperty(U)&&C[U]!==V[U]&&(V[U]=C[U]);return V},b=p=>({...p,...p.attributes.reduce((C,V)=>({...C,[V.attributeName.replace(/-([a-z])/g,function(U){return U[1].toUpperCase()})]:V.attributeValue}),{})})},2170:(Nt,M,j)=>{"use strict";j.d(M,{c:()=>n,e:()=>c});const n=["en-GB","ko-KR"],c=[{code:"en-GB",name:"English"},{code:"ko-KR",name:"\ud55c\uad6d\uc5b4"}]},3830:(Nt,M,j)=>{"use strict";j.d(M,{B:()=>n});const n=c=>{const b=c.split(":");return b.slice(0,3).join(":")+":entity:"+b.slice(4,6).join(":")+":"}},58:(Nt,M,j)=>{"use strict";j.d(M,{G:()=>p});var n=j(2047),c=j(9380),b=j(5950);let p=(()=>{class C{static#e=this.\u0275fac=function(P){return new(P||C)};static#t=this.\u0275mod=b.$C({type:C});static#s=this.\u0275inj=b.G2t({imports:[n.MD,n.MD,c.h]})}return C})()},1066:(Nt,M,j)=>{"use strict";j.d(M,{t:()=>n});const n=c=>new Date(c).toLocaleString()},3987:(Nt,M,j)=>{"use strict";j.d(M,{Xo:()=>C,lk:()=>p,rR:()=>b,xs:()=>c});var n=j(2170);const c=V=>{V.addLangs(n.c)},b=V=>{const U=localStorage.getItem("locale"),P=U&&n.c.includes(U)?localStorage.getItem("locale"):"en-GB";if(null!==P)return V.setDefaultLang(P),V.use(P),P;throw new Error("Locale not found")},p=(V,U)=>{V.use(U),V.setDefaultLang(U),localStorage.setItem("locale",U)},C=V=>n.e.find(U=>U.code===V)?.name||"English"},8168:(Nt,M,j)=>{"use strict";j.d(M,{s:()=>n});const n="ORGADMIN"},9850:(Nt,M,j)=>{"use strict";j.d(M,{h:()=>F});var n=j(2047),c=j(58),b=j(3585),p=j(698),C=j(3685),V=j(2537),U=j(3426),P=j(5950);let F=(()=>{class w{static#e=this.\u0275fac=function(E){return new(E||w)};static#t=this.\u0275mod=P.$C({type:w});static#s=this.\u0275inj=P.G2t({imports:[n.MD,c.G,b.PuD,p.j,C.Y,V.B,U.d]})}return w})()},698:(Nt,M,j)=>{"use strict";j.d(M,{j:()=>Ie});var n=j(5950),c=j(7882),b=j(3585),p=j(1748),C=j(1224),V=j(5166),P=j(58),F=j(5004),w=j(6482),B=j(5189),y=j(9380),E=j(2047);function g(Y,Te){if(1&Y&&(n.j41(0,"clr-control-error"),n.EFF(1),n.k0s()),2&Y){const H=n.XpG(2).$implicit;n.R7$(),n.JRh(H.value.error)}}function S(Y,Te){1&Y&&(n.j41(0,"clr-control-error"),n.EFF(1,"Please enter a value"),n.k0s())}function _(Y,Te){if(1&Y){const H=n.RV6();n.j41(0,"clr-input-container")(1,"label"),n.EFF(2),n.k0s(),n.j41(3,"input",9),n.bIt("ngModelChange",function(_e){n.eBV(H);const Ne=n.XpG(2);return n.Njj(Ne.onMrnChange(_e))})("keydown",function(_e){n.eBV(H);const Ne=n.XpG(2);return n.Njj(Ne.onMrnKeyDown(_e))}),n.k0s(),n.j41(4,"clr-control-helper"),n.EFF(5),n.k0s(),n.DNE(6,g,2,1,"clr-control-error")(7,S,2,0,"clr-control-error"),n.k0s()}if(2&Y){const H=n.XpG().$implicit,J=n.XpG();n.R7$(2),n.JRh(H.value.title),n.R7$(),n.xc7("width",400,"px"),n.Y8G("type",H.value.type)("formControlName",H.key)("required",!0===H.value.required)("placeholder",J.mrnPrefix),n.R7$(2),n.JRh(H.value.description),n.R7$(),n.vxM(H.value.error?6:7)}}function k(Y,Te){if(1&Y&&(n.j41(0,"option",12),n.EFF(1),n.k0s()),2&Y){const H=Te.$implicit;n.Y8G("value",H.value),n.R7$(),n.JRh(H.title)}}function A(Y,Te){if(1&Y&&(n.j41(0,"clr-control-error"),n.EFF(1),n.k0s()),2&Y){const H=n.XpG(2).$implicit;n.R7$(),n.JRh(H.value.error)}}function te(Y,Te){1&Y&&(n.j41(0,"clr-control-error"),n.EFF(1,"Please enter a value"),n.k0s())}function l(Y,Te){if(1&Y&&(n.j41(0,"clr-select-container")(1,"label"),n.EFF(2),n.k0s(),n.j41(3,"select",10),n.DNE(4,k,2,2,"option",11),n.k0s(),n.j41(5,"clr-control-helper"),n.EFF(6),n.k0s(),n.DNE(7,A,2,1,"clr-control-error")(8,te,2,0,"clr-control-error"),n.k0s()),2&Y){const H=n.XpG().$implicit;n.R7$(2),n.Lme("",H.value.title," ",H.key,""),n.R7$(),n.xc7("width",400,"px"),n.Y8G("formControlName",H.key)("required",!0===H.value.required),n.R7$(),n.Y8G("ngForOf",H.value.options),n.R7$(2),n.JRh(H.value.description),n.R7$(),n.vxM(H.value.error?7:8)}}function ve(Y,Te){if(1&Y&&(n.j41(0,"option",12),n.EFF(1),n.k0s()),2&Y){const H=Te.$implicit;n.Y8G("value",H.permission),n.R7$(),n.JRh(H.permission)}}function ie(Y,Te){if(1&Y&&(n.j41(0,"clr-control-error"),n.EFF(1),n.k0s()),2&Y){const H=n.XpG(2).$implicit;n.R7$(),n.JRh(H.value.error)}}function Se(Y,Te){1&Y&&(n.j41(0,"clr-control-error"),n.EFF(1,"Please enter a value"),n.k0s())}function Oe(Y,Te){if(1&Y&&(n.j41(0,"clr-select-container")(1,"label"),n.EFF(2),n.k0s(),n.j41(3,"select",10),n.DNE(4,ve,2,2,"option",11),n.k0s(),n.j41(5,"clr-control-helper"),n.EFF(6),n.k0s(),n.DNE(7,ie,2,1,"clr-control-error")(8,Se,2,0,"clr-control-error"),n.k0s()),2&Y){const H=n.XpG().$implicit,J=n.XpG();n.R7$(2),n.JRh(H.value.title),n.R7$(),n.xc7("width",400,"px"),n.Y8G("formControlName",H.key)("required",!0===H.value.required),n.R7$(),n.Y8G("ngForOf",J.roles),n.R7$(2),n.JRh(H.value.description),n.R7$(),n.vxM(H.value.error?7:8)}}function R(Y,Te){if(1&Y&&(n.j41(0,"clr-control-error"),n.EFF(1),n.k0s()),2&Y){const H=n.XpG(2).$implicit;n.R7$(),n.JRh(H.value.error)}}function $(Y,Te){1&Y&&(n.j41(0,"clr-control-error"),n.EFF(1,"Please enter a value"),n.k0s())}function d(Y,Te){if(1&Y&&(n.j41(0,"clr-input-container")(1,"label"),n.EFF(2),n.k0s(),n.nrm(3,"input",13),n.j41(4,"clr-control-helper"),n.EFF(5),n.k0s(),n.DNE(6,R,2,1,"clr-control-error")(7,$,2,0,"clr-control-error"),n.k0s()),2&Y){const H=n.XpG().$implicit;n.R7$(2),n.JRh(H.value.title),n.R7$(),n.xc7("width",400,"px"),n.Y8G("type",H.value.type)("formControlName",H.key)("required",!0===H.value.required),n.R7$(2),n.JRh(H.value.description),n.R7$(),n.vxM(H.value.error?6:7)}}function D(Y,Te){if(1&Y&&(n.j41(0,"div"),n.DNE(1,_,8,9,"clr-input-container")(2,l,9,9,"clr-select-container")(3,Oe,9,8,"clr-select-container")(4,d,8,8,"clr-input-container"),n.k0s()),2&Y){const H=Te.$implicit;n.R7$(),n.vxM("mrn"===H.key?1:"roleName"===H.key?2:"permissions"===H.key?3:4)}}function ne(Y,Te){if(1&Y){const H=n.RV6();n.j41(0,"button",17),n.bIt("click",function(){n.eBV(H);const _e=n.XpG(2);return n.Njj(_e.cancel())}),n.EFF(1,"Cancel"),n.k0s()}}function W(Y,Te){if(1&Y){const H=n.RV6();n.j41(0,"div",8)(1,"button",14),n.bIt("click",function(){n.eBV(H);const _e=n.XpG();return n.Njj(_e.submit())}),n.EFF(2,"Submit"),n.k0s(),n.j41(3,"button",15),n.bIt("click",function(){n.eBV(H);const _e=n.XpG();return n.Njj(_e.resetForm())}),n.EFF(4,"Reset"),n.k0s(),n.DNE(5,ne,2,0,"button",16),n.k0s()}if(2&Y){const H=n.XpG();n.R7$(5),n.vxM(H.isForNew?-1:5)}}let Ie=(()=>{class Y{constructor(H,J,_e,Ne,ke){this.formBuilder=H,this.roleService=J,this.authService=_e,this.notifierService=Ne,this.translate=ke,this.itemType=V.SP.None,this.isForNew=!1,this.item={},this.mrnPrefix="urn:mrn:",this.title="",this.onCancel=new n.bkB,this.onSubmit=new n.bkB,this.viewContext="edit",this.itemForm=new c.gE({}),this.columnForMenu={},this.isEditing=!1,this.roles=[],this.id="",this.onSubmitIsGiven=!0,this.submit=()=>{if(this.isValid()){const Z=(0,C.kB)(this.itemForm.value);if(this.isForNew)this.onSubmit.emit(Z);else{const it=(0,C.$l)(this.item,Z);this.onSubmit.emit(it)}}},this.isValid=()=>this.itemForm.valid?this.itemForm.value.mrn!==this.mrnPrefix||(this.notifierService.notify("error",this.translate.instant("error.form.invalidmrn")),!1):(this.itemForm.markAllAsTouched(),this.clrForm?.markAsTouched(),this.notifierService.notify("error",this.translate.instant("error.form.invalid")),!1),this.getFormValue=()=>{if(this.isValid())return(0,C.kB)(this.itemForm.value)},this.resetForm=()=>{this.setForm(),this.isForNew?this.itemType!==V.SP.Role&&(this.item={mrn:this.mrnPrefix},this.itemForm.patchValue(this.item)):this.itemForm.patchValue(this.item)},this.cancel=()=>{this.onCancel.emit()},this.setForm=()=>{let Z={};Object.entries(p.Y[this.itemType.toString()]).map(([it,Ke])=>{if(Ke.visibleFrom&&(!Ke.visibleFrom||Ke.visibleFrom.includes(this.viewContext))){if("mrn"===it){const Je=new RegExp("urn:mrn:mcp:(entity|mir|mms|msr|device|org|user|vessel|service|mms):([a-z0-9]([a-z0-9]|-){0,20}[a-z0-9]):((([-._a-z0-9]|~)|%[0-9a-f][0-9a-f]|([!$&'()*+,;=])|:|@)((([-._a-z0-9]|~)|%[0-9a-f][0-9a-f]|([!$&'()*+,;=])|:|@)|)*)$");Z[it]=["",[c.k0.required,c.k0.pattern(Je)]]}else Z[it]=["",Ke.required?c.k0.required:void 0];this.columnForMenu[it]=Ke}}),this.itemForm=this.formBuilder.group(Z)},this.needShortId=Z=>void 0!==this.getShortIdType(Z),this.getShortIdType=Z=>this.columnForMenu[Z]?this.columnForMenu[Z].shortIdType:void 0,this.sortColumnForMenu=(Z,it)=>Z.order>it.order?-1:1,this.capitalize=Z=>Z[0].toUpperCase()+Z.slice(1)}ngOnInit(){this.itemType!==V.SP.OrgCandidate&&this.authService.getOrgMrn().then(H=>{this.roleService.getRoles(H).subscribe(J=>{this.roles=J})})}ngOnChanges(H){this.isForNew&&(this.viewContext="edit-new"),this.itemType!==V.SP.None&&(this.setForm(),this.item&&this.itemForm.patchValue(this.item)),0===this.title.length&&this.itemType!==V.SP.None&&(this.title=this.isForNew?"New "+this.capitalize(this.itemType):"Edit "+this.capitalize(this.itemType)),this.onSubmitIsGiven=0!==this.onSubmit.observers.length}onMrnKeyDown(H){const J=H.target.value;J.includes(this.mrnPrefix)?this.item.mrn=J:H.target.value=this.mrnPrefix}onMrnChange(H){this.item.mrn=H.startsWith(this.mrnPrefix)?H:this.mrnPrefix}static#e=this.\u0275fac=function(J){return new(J||Y)(n.rXU(c.ok),n.rXU(F.Ky),n.rXU(w.u),n.rXU(B.iJ),n.rXU(y.c$))};static#t=this.\u0275cmp=n.VBU({type:Y,selectors:[["app-item-form"]],viewQuery:function(J,_e){if(1&J&&n.GBs(b.mDd,7),2&J){let Ne;n.mGM(Ne=n.lsd())&&(_e.clrForm=Ne.first)}},inputs:{itemType:"itemType",isForNew:"isForNew",item:"item",mrnPrefix:"mrnPrefix",title:"title"},outputs:{onCancel:"onCancel",onSubmit:"onSubmit"},standalone:!0,features:[n.OA$,n.aNF],decls:11,vars:7,consts:[[1,"clr-row"],[1,"clr-col-lg-12","clr-col-md-8","clr-col-12"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"card-text"],["clrForm","",1,"ng-untouched",3,"formGroup"],[4,"ngFor","ngForOf"],[1,"card-footer"],["clrInput","",3,"ngModelChange","keydown","type","formControlName","required","placeholder"],["clrSelect","",3,"formControlName","required"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["clrInput","",3,"type","formControlName","required"],["type","submit",1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"btn","btn-danger"],[1,"btn","btn-danger",3,"click"]],template:function(J,_e){1&J&&(n.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),n.EFF(4),n.k0s(),n.j41(5,"div",4)(6,"div",5)(7,"form",6),n.DNE(8,D,5,1,"div",7),n.nI1(9,"keyvalue"),n.k0s()()(),n.DNE(10,W,6,1,"div",8),n.k0s()()()),2&J&&(n.R7$(4),n.SpI(" ",_e.title," "),n.R7$(3),n.Y8G("formGroup",_e.itemForm),n.R7$(),n.Y8G("ngForOf",n.i5U(9,4,_e.columnForMenu,_e.sortColumnForMenu)),n.R7$(2),n.vxM(_e.onSubmitIsGiven?10:-1))},dependencies:[P.G,E.Sq,E.lG,b.t5G,b.aZZ,b.Hpg,b.bnk,b.mDd,b.icl,b.Xu5,b.Yf6,b.hTQ,c.YN,c.qT,c.xH,c.y7,c.me,c.wz,c.BC,c.cb,c.YS,c.X1,c.j4,c.JD]})}return Y})()},3685:(Nt,M,j)=>{"use strict";j.d(M,{Y:()=>Hw});var n=j(5950),c=j(5166),b=j(2537),p=j(1066);const C={serialNumber:{title:"Serial number",type:"string"},start:{title:"Valid from",type:"string",valuePrepareFunction:s=>(0,p.t)(s)},end:{title:"Valid until",type:"string",valuePrepareFunction:s=>(0,p.t)(s)}},V={serialNumber:{title:"Serial number",type:"string"},revokedAt:{title:"Revoked from",type:"string",valuePrepareFunction:s=>(0,p.t)(s)},revokeReason:{title:"Reason",type:"string"}};function U(s,r){if(1&s&&n.nrm(0,"app-smart-table",0),2&s){const e=n.XpG();n.Y8G("labels",e.columnsForActive)("data",e.data)("onDelete",e.revoke)("onDownload",e.download)("onAdd",e.add)("itemType",e.itemType)}}function P(s,r){if(1&s&&n.nrm(0,"app-smart-table",1),2&s){const e=n.XpG();n.Y8G("labels",e.columnsForRevoked)("data",e.data)("itemType",e.itemType)}}function F(s,r){if(1&s&&(n.j41(0,"h1"),n.EFF(1),n.k0s()),2&s){const e=n.XpG();n.R7$(),n.SpI("The given context is wrong! : ",e.context,"")}}let w=(()=>{class s{constructor(){this.context="active",this.data=[],this.onAdd=new n.bkB,this.onDownload=new n.bkB,this.onRevoke=new n.bkB,this.itemType=c.SP.Certificate,this.download=e=>{this.onDownload.emit(e)},this.add=()=>{this.onAdd.emit()},this.revoke=e=>{this.onRevoke.emit(e)},this.empty=[],this.columnsForActive=C,this.columnsForRevoked=V}static#e=this.\u0275fac=function(t){return new(t||s)};static#t=this.\u0275cmp=n.VBU({type:s,selectors:[["app-cert-table"]],inputs:{context:"context",data:"data"},outputs:{onAdd:"onAdd",onDownload:"onDownload",onRevoke:"onRevoke"},standalone:!0,features:[n.aNF],decls:3,vars:1,consts:[["deleteText","Revoke","placeholder","There is no issued certificate.",3,"labels","data","onDelete","onDownload","onAdd","itemType"],["placeholder","There is no revoked certificate.",3,"labels","data","itemType"]],template:function(t,i){1&t&&n.DNE(0,U,1,6,"app-smart-table",0)(1,P,1,3,"app-smart-table",1)(2,F,2,1,"h1"),2&t&&n.vxM("active"===i.context?0:"revoked"===i.context?1:2)},dependencies:[b.B]})}return s})();var B=j(1748),y=j(7882),g=j(2047),S=j(58),_=j(3585),k=j(6994),A=j(153);function l(s,r,e){var t;return s instanceof Object&&null!==(t=s[r])&&void 0!==t?t:e}function ve(s,r=0,e=s.byteLength-r,t=!1){let i="";for(const a of new Uint8Array(s,r,e)){const o=a.toString(16).toUpperCase();1===o.length&&(i+="0"),i+=o,t&&(i+=" ")}return i.trim()}function Se(s,r){let e=0;if(1===s.length)return s[0];for(let t=s.length-1;t>=0;t--)e+=s[s.length-1-t]*Math.pow(2,r*t);return e}function Oe(s,r,e=-1){const t=e;let i=s,a=0,o=Math.pow(2,r);for(let u=1;u<8;u++){if(s<o){let h;if(t<0)h=new ArrayBuffer(u),a=u;else{if(t<u)return new ArrayBuffer(0);h=new ArrayBuffer(t),a=t}const m=new Uint8Array(h);for(let N=u-1;N>=0;N--){const T=Math.pow(2,N*r);m[a-N-1]=Math.floor(i/T),i-=m[a-N-1]*T}return h}o*=Math.pow(2,r)}return new ArrayBuffer(0)}function R(...s){let r=0,e=0;for(const a of s)r+=a.byteLength;const t=new ArrayBuffer(r),i=new Uint8Array(t);for(const a of s)i.set(new Uint8Array(a),e),e+=a.byteLength;return t}function $(...s){let r=0,e=0;for(const a of s)r+=a.length;const t=new ArrayBuffer(r),i=new Uint8Array(t);for(const a of s)i.set(a,e),e+=a.length;return i}function d(){const s=new Uint8Array(this.valueHex);this.valueHex.byteLength>=2&&(255===s[0]&&128&s[1]||0===s[0]&&!(128&s[1]))&&this.warnings.push("Needlessly long format");const r=new ArrayBuffer(this.valueHex.byteLength),e=new Uint8Array(r);for(let u=0;u<this.valueHex.byteLength;u++)e[u]=0;e[0]=128&s[0];const t=Se(e,8),i=new ArrayBuffer(this.valueHex.byteLength),a=new Uint8Array(i);for(let u=0;u<this.valueHex.byteLength;u++)a[u]=s[u];return a[0]&=127,Se(a,8)-t}function ne(s,r){if(s.byteLength!==r.byteLength)return!1;const e=new Uint8Array(s),t=new Uint8Array(r);for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function W(s,r){const e=s.toString(10);if(r<e.length)return"";const t=r-e.length,i=new Array(t);for(let o=0;o<t;o++)i[o]="0";return i.join("").concat(e)}const Ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function Te(s,r=!1,e=!1,t=!1){let i=0,a=0,o=0,u="";const h=r?Y:Ie;if(t){let m=0;for(let N=0;N<s.length;N++)if(0!==s.charCodeAt(N)){m=N;break}s=s.slice(m)}for(;i<s.length;){const m=s.charCodeAt(i++);i>=s.length&&(a=1);const N=s.charCodeAt(i++);i>=s.length&&(o=1);const T=s.charCodeAt(i++),K=m>>2,L=(3&m)<<4|N>>4;let re=(15&N)<<2|T>>6,Ae=63&T;1===a?re=Ae=64:1===o&&(Ae=64),u+=e?64===re?`${h.charAt(K)}${h.charAt(L)}`:64===Ae?`${h.charAt(K)}${h.charAt(L)}${h.charAt(re)}`:`${h.charAt(K)}${h.charAt(L)}${h.charAt(re)}${h.charAt(Ae)}`:`${h.charAt(K)}${h.charAt(L)}${h.charAt(re)}${h.charAt(Ae)}`}return u}function H(s,r=!1,e=!1){const t=r?Y:Ie;function i(h){for(let m=0;m<64;m++)if(t.charAt(m)===h)return m;return 64}function a(h){return 64===h?0:h}let o=0,u="";for(;o<s.length;){const h=i(s.charAt(o++)),m=o>=s.length?0:i(s.charAt(o++)),N=o>=s.length?0:i(s.charAt(o++)),T=o>=s.length?0:i(s.charAt(o++)),K=a(h)<<2|a(m)>>4,L=(15&a(m))<<4|a(N)>>2,re=(3&a(N))<<6|a(T);u+=String.fromCharCode(K),64!==N&&(u+=String.fromCharCode(L)),64!==T&&(u+=String.fromCharCode(re))}if(e){let m=-1;for(let N=u.length-1;N>=0;N--)if(0!==u.charCodeAt(N)){m=N;break}u=-1!==m?u.slice(0,m+1):""}return u}function J(s){let r="";const e=new Uint8Array(s);for(const t of e)r+=String.fromCharCode(t);return r}function _e(s){const r=s.length,e=new ArrayBuffer(r),t=new Uint8Array(e);for(let i=0;i<r;i++)t[i]=s.charCodeAt(i);return e}const Ne=Math.log(2);function ke(s){const r=Math.log(s)/Ne,e=Math.floor(r),t=Math.round(r);return e===t?e:t}function Z(s,r){for(const e of r)delete s[e]}function it(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function Ke(s){let r=0,e=0;for(let i=0;i<s.length;i++)r+=s[i].byteLength;const t=new Uint8Array(r);for(let i=0;i<s.length;i++){const a=s[i];t.set(new Uint8Array(a),e),e+=a.byteLength}return t.buffer}function Je(s,r,e,t){return r instanceof Uint8Array?r.byteLength?e<0?(s.error="Wrong parameter: inputOffset less than zero",!1):t<0?(s.error="Wrong parameter: inputLength less than zero",!1):!(r.byteLength-e-t<0&&(s.error="End of input reached before message was fully decoded (inconsistent offset and length values)",1)):(s.error="Wrong parameter: inputBuffer has zero length",!1):(s.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class At{constructor(){this.items=[]}write(r){this.items.push(r)}final(){return Ke(this.items)}}const at=[new Uint8Array([1])],Lt="0123456789",Pt="name",f="valueHexView",Ce=new ArrayBuffer(0),Ee=new Uint8Array(0),Ue="EndOfContent",rt="OCTET STRING",Xe="BIT STRING";function Et(s){var r;return(r=class extends s{constructor(...t){var i;super(...t);const a=t[0]||{};this.isHexOnly=null!==(i=a.isHexOnly)&&void 0!==i&&i,this.valueHexView=a.valueHex?A._H.toUint8Array(a.valueHex):Ee}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(t){this.valueHexView=new Uint8Array(t)}fromBER(t,i,a){const o=t instanceof ArrayBuffer?new Uint8Array(t):t;if(!Je(this,o,i,a))return-1;const u=i+a;return this.valueHexView=o.subarray(i,u),this.valueHexView.length?(this.blockLength=a,u):(this.warnings.push("Zero buffer length"),i)}toBER(t=!1){return this.isHexOnly?t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Ce)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:A.U$.ToHex(this.valueHexView)}}}).NAME="hexBlock",r}let $t=(()=>{class s{constructor({blockLength:e=0,error:t="",warnings:i=[],valueBeforeDecode:a=Ee}={}){this.blockLength=e,this.error=t,this.warnings=i,this.valueBeforeDecodeView=A._H.toUint8Array(a)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:A.U$.ToHex(this.valueBeforeDecodeView)}}}return s.NAME="baseBlock",s})(),pt=(()=>{class s extends $t{fromBER(e,t,i){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}return s.NAME="valueBlock",s})(),Si=(()=>{class s extends(Et($t)){constructor({idBlock:e={}}={}){var t,i,a,o;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?A._H.toUint8Array(e.valueHex):Ee,this.tagClass=null!==(i=e.tagClass)&&void 0!==i?i:-1,this.tagNumber=null!==(a=e.tagNumber)&&void 0!==a?a:-1,this.isConstructed=null!==(o=e.isConstructed)&&void 0!==o&&o):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",Ce}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const a=new Uint8Array(1);if(!e){let o=this.tagNumber;o&=31,t|=o,a[0]=t}return a.buffer}if(!this.isHexOnly){const a=Oe(this.tagNumber,7),o=new Uint8Array(a),u=a.byteLength,h=new Uint8Array(u+1);if(h[0]=31|t,!e){for(let m=0;m<u-1;m++)h[m+1]=128|o[m];h[u]=o[u-1]}return h.buffer}const i=new Uint8Array(this.valueHexView.byteLength+1);if(i[0]=31|t,!e){const a=this.valueHexView;for(let o=0;o<a.length-1;o++)i[o+1]=128|a[o];i[this.valueHexView.byteLength]=a[a.length-1]}return i.buffer}fromBER(e,t,i){const a=A._H.toUint8Array(e);if(!Je(this,a,t,i))return-1;const o=a.subarray(t,t+i);if(0===o.length)return this.error="Zero buffer length",-1;switch(192&o[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=!(32&~o[0]),this.isHexOnly=!1;const h=31&o[0];if(31!==h)this.tagNumber=h,this.blockLength=1;else{let m=1,N=this.valueHexView=new Uint8Array(255),T=255;for(;128&o[m];){if(N[m-1]=127&o[m],m++,m>=o.length)return this.error="End of input reached before message was fully decoded",-1;if(m===T){T+=255;const L=new Uint8Array(T);for(let re=0;re<N.length;re++)L[re]=N[re];N=this.valueHexView=new Uint8Array(T)}}this.blockLength=m+1,N[m-1]=127&o[m];const K=new Uint8Array(m);for(let L=0;L<m;L++)K[L]=N[L];N=this.valueHexView=new Uint8Array(m),N.set(K),this.blockLength<=9?this.tagNumber=Se(N,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}return s.NAME="identificationBlock",s})(),yt=(()=>{class s extends $t{constructor({lenBlock:e={}}={}){var t,i,a;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(i=e.longFormUsed)&&void 0!==i&&i,this.length=null!==(a=e.length)&&void 0!==a?a:0}fromBER(e,t,i){const a=A._H.toUint8Array(e);if(!Je(this,a,t,i))return-1;const o=a.subarray(t,t+i);if(0===o.length)return this.error="Zero buffer length",-1;if(255===o[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===o[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&o[0]),!1===this.longFormUsed)return this.length=o[0],this.blockLength=1,t+this.blockLength;const u=127&o[0];if(u>8)return this.error="Too big integer",-1;if(u+1>o.length)return this.error="End of input reached before message was fully decoded",-1;const h=t+1,m=a.subarray(h,h+u);return 0===m[u-1]&&this.warnings.push("Needlessly long encoded length"),this.length=Se(m,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=u+1,t+this.blockLength}toBER(e=!1){let t,i;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(i=new Uint8Array(t),i[0]=128),t;if(this.longFormUsed){const a=Oe(this.length,8);if(a.byteLength>127)return this.error="Too big length",Ce;if(t=new ArrayBuffer(a.byteLength+1),e)return t;const o=new Uint8Array(a);i=new Uint8Array(t),i[0]=128|a.byteLength;for(let u=0;u<a.byteLength;u++)i[u+1]=o[u];return t}return t=new ArrayBuffer(1),!1===e&&(i=new Uint8Array(t),i[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}return s.NAME="lengthBlock",s})();const Be={};let It=(()=>{class s extends $t{constructor({name:e="",optional:t=!1,primitiveSchema:i,...a}={},o){super(a),this.name=e,this.optional=t,i&&(this.primitiveSchema=i),this.idBlock=new Si(a),this.lenBlock=new yt(a),this.valueBlock=o?new o(a):new pt(a)}fromBER(e,t,i){const a=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return-1===a?(this.error=this.valueBlock.error,a):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),a)}toBER(e,t){const i=t||new At;t||Kt(this);const a=this.idBlock.toBER(e);if(i.write(a),this.lenBlock.isIndefiniteForm)i.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,i),i.write(new ArrayBuffer(2));else{const o=this.valueBlock.toBER(e);this.lenBlock.length=o.byteLength;const u=this.lenBlock.toBER(e);i.write(u),i.write(o)}return t?Ce:i.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():A.U$.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${A.U$.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){return this===e||e instanceof this.constructor&&ne(this.toBER(),e.toBER())}}return s.NAME="BaseBlock",s})();function Kt(s){if(s instanceof Be.Constructed)for(const r of s.valueBlock.value)Kt(r)&&(s.lenBlock.isIndefiniteForm=!0);return!!s.lenBlock.isIndefiniteForm}let xl=(()=>{class s extends It{constructor({value:e="",...t}={},i){super(t,i),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,i){const a=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return-1===a?(this.error=this.valueBlock.error,a):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),a)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}return s.NAME="BaseStringBlock",s})(),eu=(()=>{class s extends(Et(pt)){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}return s.NAME="PrimitiveValueBlock",s})();class Le extends It{constructor(r={}){super(r,eu),this.idBlock.isConstructed=!1}}function Gt(s,r=0,e=s.length){const t=r;let i=new It({},pt);const a=new $t;if(!Je(a,s,r,e))return i.error=a.error,{offset:-1,result:i};if(!s.subarray(r,r+e).length)return i.error="Zero buffer length",{offset:-1,result:i};let u=i.idBlock.fromBER(s,r,e);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),-1===u)return i.error=i.idBlock.error,{offset:-1,result:i};if(u=i.lenBlock.fromBER(s,r=u,e-=i.idBlock.blockLength),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),-1===u)return i.error=i.lenBlock.error,{offset:-1,result:i};if(r=u,e-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let h=It;if(1===i.idBlock.tagClass){if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};h=Be.EndOfContent;break;case 1:h=Be.Boolean;break;case 2:h=Be.Integer;break;case 3:h=Be.BitString;break;case 4:h=Be.OctetString;break;case 5:h=Be.Null;break;case 6:h=Be.ObjectIdentifier;break;case 10:h=Be.Enumerated;break;case 12:h=Be.Utf8String;break;case 13:h=Be.RelativeObjectIdentifier;break;case 14:h=Be.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:h=Be.Sequence;break;case 17:h=Be.Set;break;case 18:h=Be.NumericString;break;case 19:h=Be.PrintableString;break;case 20:h=Be.TeletexString;break;case 21:h=Be.VideotexString;break;case 22:h=Be.IA5String;break;case 23:h=Be.UTCTime;break;case 24:h=Be.GeneralizedTime;break;case 25:h=Be.GraphicString;break;case 26:h=Be.VisibleString;break;case 27:h=Be.GeneralString;break;case 28:h=Be.UniversalString;break;case 29:h=Be.CharacterString;break;case 30:h=Be.BmpString;break;case 31:h=Be.DATE;break;case 32:h=Be.TimeOfDay;break;case 33:h=Be.DateTime;break;case 34:h=Be.Duration;break;default:{const m=i.idBlock.isConstructed?new Be.Constructed:new Be.Primitive;m.idBlock=i.idBlock,m.lenBlock=i.lenBlock,m.warnings=i.warnings,i=m}}}else h=i.idBlock.isConstructed?Be.Constructed:Be.Primitive;return i=function Ol(s,r){if(s instanceof r)return s;const e=new r;return e.idBlock=s.idBlock,e.lenBlock=s.lenBlock,e.warnings=s.warnings,e.valueBeforeDecodeView=s.valueBeforeDecodeView,e}(i,h),u=i.fromBER(s,r,i.lenBlock.isIndefiniteForm?e:i.lenBlock.length),i.valueBeforeDecodeView=s.subarray(t,t+i.blockLength),{offset:u,result:i}}function ct(s){if(!s.byteLength){const r=new It({},pt);return r.error="Input buffer has zero length",{offset:-1,result:r}}return Gt(A._H.toUint8Array(s).slice(),0,s.byteLength)}function nm(s,r){return s?1:r}Be.Primitive=Le,Le.NAME="PRIMITIVE";let bi=(()=>{class s extends pt{constructor({value:e=[],isIndefiniteForm:t=!1,...i}={}){super(i),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,i){const a=A._H.toUint8Array(e);if(!Je(this,a,t,i))return-1;if(this.valueBeforeDecodeView=a.subarray(t,t+i),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let o=t;for(;nm(this.isIndefiniteForm,i)>0;){const u=Gt(a,o,i);if(-1===u.offset)return this.error=u.result.error,this.warnings.concat(u.result.warnings),-1;if(o=u.offset,this.blockLength+=u.result.blockLength,i-=u.result.blockLength,this.value.push(u.result),this.isIndefiniteForm&&u.result.constructor.NAME===Ue)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===Ue?this.value.pop():this.warnings.push("No EndOfContent block encoded")),o}toBER(e,t){const i=t||new At;for(let a=0;a<this.value.length;a++)this.value[a].toBER(e,i);return t?Ce:i.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}return s.NAME="ConstructedValueBlock",s})();class q extends It{constructor(r={}){super(r,bi),this.idBlock.isConstructed=!0}fromBER(r,e,t){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const i=this.valueBlock.fromBER(r,e,this.lenBlock.isIndefiniteForm?t:this.lenBlock.length);return-1===i?(this.error=this.valueBlock.error,i):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}onAsciiEncoding(){const r=[];for(const t of this.valueBlock.value)r.push(t.toString("ascii").split("\n").map(i=>`  ${i}`).join("\n"));const e=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return r.length?`${e} :\n${r.join("\n")}`:`${e} :`}}Be.Constructed=q,q.NAME="CONSTRUCTED";let am=(()=>{class s extends pt{fromBER(e,t,i){return t}toBER(e){return Ce}}return s.override="EndOfContentValueBlock",s})();class Yh extends It{constructor(r={}){super(r,am),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}Be.EndOfContent=Yh,Yh.NAME=Ue;class kt extends It{constructor(r={}){super(r,pt),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(r,e,t){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=t,e+t>r.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):e+t}toBER(r,e){const t=new ArrayBuffer(2);if(!r){const i=new Uint8Array(t);i[0]=5,i[1]=0}return e&&e.write(t),t}onAsciiEncoding(){return`${this.constructor.NAME}`}}Be.Null=kt,kt.NAME="NULL";let om=(()=>{class s extends(Et(pt)){constructor({value:e,...t}={}){super(t),this.valueHexView=t.valueHex?A._H.toUint8Array(t.valueHex):new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,i){const a=A._H.toUint8Array(e);return Je(this,a,t,i)?(this.valueHexView=a.subarray(t,t+i),i>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,d.call(this),this.blockLength=i,t+i):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}return s.NAME="BooleanValueBlock",s})();class ks extends It{constructor(r={}){super(r,om),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(r){this.valueBlock.value=r}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}Be.Boolean=ks,ks.NAME="BOOLEAN";let lm=(()=>{class s extends(Et(bi)){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,i){let a=0;if(this.isConstructed){if(this.isHexOnly=!1,a=bi.prototype.fromBER.call(this,e,t,i),-1===a)return a;for(let o=0;o<this.value.length;o++){const u=this.value[o].constructor.NAME;if(u===Ue){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(u!==rt)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,a=super.fromBER(e,t,i),this.blockLength=i;return a}toBER(e,t){return this.isConstructed?bi.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}return s.NAME="OctetStringValueBlock",s})();class de extends It{constructor({idBlock:r={},lenBlock:e={},...t}={}){var i,a;null!==(i=t.isConstructed)&&void 0!==i||(t.isConstructed=!(null===(a=t.value)||void 0===a||!a.length)),super({idBlock:{isConstructed:t.isConstructed,...r},lenBlock:{...e,isIndefiniteForm:!!t.isIndefiniteForm},...t},lm),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(r,e,t){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===t)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),e;if(!this.valueBlock.isConstructed){const a=(r instanceof ArrayBuffer?new Uint8Array(r):r).subarray(e,e+t);try{if(a.byteLength){const o=Gt(a,0,a.byteLength);-1!==o.offset&&o.offset===t&&(this.valueBlock.value=[o.result])}}catch{}}return super.fromBER(r,e,t)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?q.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${A.U$.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const r=[];for(const e of this.valueBlock.value)e instanceof de&&r.push(e.valueBlock.valueHexView);return A._H.concat(r)}}Be.OctetString=de,de.NAME=rt;let cm=(()=>{class s extends(Et(bi)){constructor({unusedBits:e=0,isConstructed:t=!1,...i}={}){super(i),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,i){if(!i)return t;let a=-1;if(this.isConstructed){if(a=bi.prototype.fromBER.call(this,e,t,i),-1===a)return a;for(const h of this.value){const m=h.constructor.NAME;if(m===Ue){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(m!==Xe)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const N=h.valueBlock;if(this.unusedBits>0&&N.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=N.unusedBits}return a}const o=A._H.toUint8Array(e);if(!Je(this,o,t,i))return-1;const u=o.subarray(t,t+i);if(this.unusedBits=u[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const h=u.subarray(1);try{if(h.byteLength){const m=Gt(h,0,h.byteLength);-1!==m.offset&&m.offset===i-1&&(this.value=[m.result])}}catch{}}return this.valueHexView=u.subarray(1),this.blockLength=u.length,t+i}toBER(e,t){if(this.isConstructed)return bi.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Ce;const i=new Uint8Array(this.valueHexView.length+1);return i[0]=this.unusedBits,i.set(this.valueHexView,1),i.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}return s.NAME="BitStringValueBlock",s})();var tf;class Ze extends It{constructor({idBlock:r={},lenBlock:e={},...t}={}){var i,a;null!==(i=t.isConstructed)&&void 0!==i||(t.isConstructed=!(null===(a=t.value)||void 0===a||!a.length)),super({idBlock:{isConstructed:t.isConstructed,...r},lenBlock:{...e,isIndefiniteForm:!!t.isIndefiniteForm},...t},cm),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(r,e,t){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(r,e,t)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return q.prototype.onAsciiEncoding.call(this);{const r=[],e=this.valueBlock.valueHexView;for(const i of e)r.push(i.toString(2).padStart(8,"0"));const t=r.join("");return`${this.constructor.NAME} : ${t.substring(0,t.length-this.valueBlock.unusedBits)}`}}}function um(s,r){const e=new Uint8Array([0]),t=new Uint8Array(s),i=new Uint8Array(r);let a=t.slice(0);const o=a.length-1,u=i.slice(0),h=u.length-1;let m=0,T=0;for(let K=h<o?o:h;K>=0;K--,T++)m=1==T<u.length?a[o-T]+u[h-T]+e[0]:a[o-T]+e[0],e[0]=m/10,1==T>=a.length?a=$(new Uint8Array([m%10]),a):a[o-T]=m%10;return e[0]>0&&(a=$(e,a)),a}function sf(s){if(s>=at.length)for(let r=at.length;r<=s;r++){const e=new Uint8Array([0]);let t=at[r-1].slice(0);for(let i=t.length-1;i>=0;i--){const a=new Uint8Array([(t[i]<<1)+e[0]]);e[0]=a[0]/10,t[i]=a[0]%10}e[0]>0&&(t=$(e,t)),at.push(t)}return at[s]}function hm(s,r){let e=0;const t=new Uint8Array(s),i=new Uint8Array(r),a=t.slice(0),o=a.length-1,u=i.slice(0),h=u.length-1;let m,N=0;for(let T=h;T>=0;T--,N++)m=a[o-N]-u[h-N]-e,1==m<0?(e=1,a[o-N]=m+10):(e=0,a[o-N]=m);if(e>0)for(let T=o-h+1;T>=0;T--,N++){if(m=a[o-N]-e,!(m<0)){e=0,a[o-N]=m;break}e=1,a[o-N]=m+10}return a.slice()}Be.BitString=Ze,Ze.NAME=Xe;class tu extends(Et(pt)){constructor({value:r,...e}={}){super(e),this._valueDec=0,e.valueHex&&this.setValueHex(),void 0!==r&&(this.valueDec=r)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=d.call(this)))}set valueDec(r){this._valueDec=r,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function D(s){const r=s<0?-1*s:s;let e=128;for(let t=1;t<8;t++){if(r<=e){if(s<0){const u=Oe(e-r,8,t);return new Uint8Array(u)[0]|=128,u}let i=Oe(r,8,t),a=new Uint8Array(i);if(128&a[0]){const o=i.slice(0),u=new Uint8Array(o);i=new ArrayBuffer(i.byteLength+1),a=new Uint8Array(i);for(let h=0;h<o.byteLength;h++)a[h+1]=u[h];a[0]=0}return i}e*=Math.pow(2,8)}return new ArrayBuffer(0)}(r))}get valueDec(){return this._valueDec}fromDER(r,e,t,i=0){const a=this.fromBER(r,e,t);if(-1===a)return a;const o=this.valueHexView;return 0===o[0]&&128&o[1]?this.valueHexView=o.subarray(1):0!==i&&o.length<i&&(i-o.length>1&&(i=o.length+1),this.valueHexView=o.subarray(i-o.length)),a}toDER(r=!1){const e=this.valueHexView;switch(!0){case!!(128&e[0]):{const t=new Uint8Array(this.valueHexView.length+1);t[0]=0,t.set(e,1),this.valueHexView=t}break;case 0===e[0]&&!(128&e[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(r)}fromBER(r,e,t){const i=super.fromBER(r,e,t);return-1===i||this.setValueHex(),i}toBER(r){return r?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const r=8*this.valueHexView.length-1;let i,e=new Uint8Array(8*this.valueHexView.length/3),t=0;const a=this.valueHexView;let o="",u=!1;for(let h=a.byteLength-1;h>=0;h--){i=a[h];for(let m=0;m<8;m++)1&~i||(t===r?(e=hm(sf(t),e),o="-"):e=um(e,sf(t))),t++,i>>=1}for(let h=0;h<e.length;h++)e[h]&&(u=!0),u&&(o+=Lt.charAt(e[h]));return!1===u&&(o+=Lt.charAt(0)),o}}tf=tu,tu.NAME="IntegerValueBlock",Object.defineProperty(tf.prototype,"valueHex",{set:function(s){this.valueHexView=new Uint8Array(s),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class X extends It{constructor(r={}){super(r,tu),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return it(),BigInt(this.valueBlock.toString())}static fromBigInt(r){it();const e=BigInt(r),t=new At,i=e.toString(16).replace(/^-/,""),a=new Uint8Array(A.U$.FromHex(i));if(e<0){const u=new Uint8Array(a.length+(128&a[0]?1:0));u[0]|=128;const m=BigInt(`0x${A.U$.ToHex(u)}`)+e,N=A._H.toUint8Array(A.U$.FromHex(m.toString(16)));N[0]|=128,t.write(N)}else 128&a[0]&&t.write(new Uint8Array([0])),t.write(a);return new X({valueHex:t.final()})}convertToDER(){const r=new X({valueHex:this.valueBlock.valueHexView});return r.valueBlock.toDER(),r}convertFromDER(){return new X({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}Be.Integer=X,X.NAME="INTEGER";class ua extends X{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}Be.Enumerated=ua,ua.NAME="ENUMERATED";let af=(()=>{class s extends(Et(pt)){constructor({valueDec:e=-1,isFirstSid:t=!1,...i}={}){super(i),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,i){if(!i)return t;const a=A._H.toUint8Array(e);if(!Je(this,a,t,i))return-1;const o=a.subarray(t,t+i);this.valueHexView=new Uint8Array(i);for(let h=0;h<i&&(this.valueHexView[h]=127&o[h],this.blockLength++,128&o[h]);h++);const u=new Uint8Array(this.blockLength);for(let h=0;h<this.blockLength;h++)u[h]=this.valueHexView[h];return this.valueHexView=u,128&o[this.blockLength-1]?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Se(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){it();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const i=new Uint8Array(t.length/7);for(let a=0;a<i.length;a++)i[a]=parseInt(t.slice(7*a,7*a+7),2)+(a+1<i.length?128:0);this.fromBER(i.buffer,0,i.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const a=this.valueHexView,o=new Uint8Array(this.blockLength);for(let u=0;u<this.blockLength-1;u++)o[u]=128|a[u];return o[this.blockLength-1]=a[this.blockLength-1],o.buffer}const t=Oe(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Ce;const i=new Uint8Array(t.byteLength);if(!e){const a=new Uint8Array(t),o=t.byteLength-1;for(let u=0;u<o;u++)i[u]=128|a[u];i[o]=a[o]}return i}toString(){let e="";if(this.isHexOnly)e=A.U$.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}return s.NAME="sidBlock",s})(),fm=(()=>{class s extends pt{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,i){let a=t;for(;i>0;){const o=new af;if(a=o.fromBER(e,a,i),-1===a)return this.blockLength=0,this.error=o.error,a;0===this.value.length&&(o.isFirstSid=!0),this.blockLength+=o.blockLength,i-=o.blockLength,this.value.push(o)}return a}toBER(e){const t=[];for(let i=0;i<this.value.length;i++){const a=this.value[i].toBER(e);if(0===a.byteLength)return this.error=this.value[i].error,Ce;t.push(a)}return Ke(t)}fromString(e){this.value=[];let t=0,i=0,a="",o=!1;do{if(i=e.indexOf(".",t),a=-1===i?e.substring(t):e.substring(t,i),t=i+1,o){const u=this.value[0];let h=0;switch(u.valueDec){case 0:break;case 1:h=40;break;case 2:h=80;break;default:return void(this.value=[])}const m=parseInt(a,10);if(isNaN(m))return;u.valueDec=m+h,o=!1}else{const u=new af;if(a>Number.MAX_SAFE_INTEGER){it();const h=BigInt(a);u.valueBigInt=h}else if(u.valueDec=parseInt(a,10),isNaN(u.valueDec))return;this.value.length||(u.isFirstSid=!0,o=!0),this.value.push(u)}}while(-1!==i)}toString(){let e="",t=!1;for(let i=0;i<this.value.length;i++){t=this.value[i].isHexOnly;let a=this.value[i].toString();0!==i&&(e=`${e}.`),t?(a=`{${a}}`,this.value[i].isFirstSid?e=`2.{${a} - 80}`:e+=a):e+=a}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}return s.NAME="ObjectIdentifierValueBlock",s})();class Ve extends It{constructor(r={}){super(r,fm),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(r){this.valueBlock.fromString(r)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Be.ObjectIdentifier=Ve,Ve.NAME="OBJECT IDENTIFIER";let lf=(()=>{class s extends(Et($t)){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,i){if(0===i)return t;const a=A._H.toUint8Array(e);if(!Je(this,a,t,i))return-1;const o=a.subarray(t,t+i);this.valueHexView=new Uint8Array(i);for(let h=0;h<i&&(this.valueHexView[h]=127&o[h],this.blockLength++,128&o[h]);h++);const u=new Uint8Array(this.blockLength);for(let h=0;h<this.blockLength;h++)u[h]=this.valueHexView[h];return this.valueHexView=u,128&o[this.blockLength-1]?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Se(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const a=this.valueHexView,o=new Uint8Array(this.blockLength);for(let u=0;u<this.blockLength-1;u++)o[u]=128|a[u];return o[this.blockLength-1]=a[this.blockLength-1],o.buffer}const t=Oe(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Ce;const i=new Uint8Array(t.byteLength);if(!e){const a=new Uint8Array(t),o=t.byteLength-1;for(let u=0;u<o;u++)i[u]=128|a[u];i[o]=a[o]}return i.buffer}toString(){let e="";return e=this.isHexOnly?A.U$.ToHex(this.valueHexView):this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}return s.NAME="relativeSidBlock",s})(),dm=(()=>{class s extends pt{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,i){let a=t;for(;i>0;){const o=new lf;if(a=o.fromBER(e,a,i),-1===a)return this.blockLength=0,this.error=o.error,a;this.blockLength+=o.blockLength,i-=o.blockLength,this.value.push(o)}return a}toBER(e,t){const i=[];for(let a=0;a<this.value.length;a++){const o=this.value[a].toBER(e);if(0===o.byteLength)return this.error=this.value[a].error,Ce;i.push(o)}return Ke(i)}fromString(e){this.value=[];let t=0,i=0,a="";do{i=e.indexOf(".",t),a=-1===i?e.substring(t):e.substring(t,i),t=i+1;const o=new lf;if(o.valueDec=parseInt(a,10),isNaN(o.valueDec))return!0;this.value.push(o)}while(-1!==i);return!0}toString(){let e="",t=!1;for(let i=0;i<this.value.length;i++){t=this.value[i].isHexOnly;let a=this.value[i].toString();0!==i&&(e=`${e}.`),t&&(a=`{${a}}`),e+=a}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}return s.NAME="RelativeObjectIdentifierValueBlock",s})();class uf extends It{constructor(r={}){super(r,dm),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(r){this.valueBlock.fromString(r)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Be.RelativeObjectIdentifier=uf,uf.NAME="RelativeObjectIdentifier";class O extends q{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}Be.Sequence=O,O.NAME="SEQUENCE";class _t extends q{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}Be.Set=_t,_t.NAME="SET";let mm=(()=>{class s extends(Et(pt)){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=""}toJSON(){return{...super.toJSON(),value:this.value}}}return s.NAME="StringValueBlock",s})(),gm=(()=>{class s extends mm{}return s.NAME="SimpleStringValueBlock",s})(),Jt=(()=>{class s extends xl{constructor({...e}={}){super(e,gm)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,A._H.toUint8Array(e))}fromString(e){const t=e.length,i=this.valueBlock.valueHexView=new Uint8Array(t);for(let a=0;a<t;a++)i[a]=e.charCodeAt(a);this.valueBlock.value=e}}return s.NAME="SIMPLE STRING",s})(),pm=(()=>{class s extends Jt{fromBuffer(e){this.valueBlock.valueHexView=A._H.toUint8Array(e);try{this.valueBlock.value=A.U$.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=A.U$.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(A.U$.FromUtf8String(e)),this.valueBlock.value=e}}return s.NAME="Utf8StringValueBlock",s})();class is extends pm{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Be.Utf8String=is,is.NAME="UTF8String";let vm=(()=>{class s extends Jt{fromBuffer(e){this.valueBlock.value=A.U$.ToUtf16String(e),this.valueBlock.valueHexView=A._H.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(A.U$.FromUtf16String(e))}}return s.NAME="BmpStringValueBlock",s})();class Xt extends vm{constructor({...r}={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}Be.BmpString=Xt,Xt.NAME="BMPString";let wm=(()=>{class s extends Jt{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),i=new Uint8Array(t);for(let a=0;a<i.length;a+=4)i[a]=i[a+3],i[a+1]=i[a+2],i[a+2]=0,i[a+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,i=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let a=0;a<t;a++){const o=Oe(e.charCodeAt(a),8),u=new Uint8Array(o);if(u.length>4)continue;const h=4-u.length;for(let m=u.length-1;m>=0;m--)i[4*a+m+h]=u[m]}this.valueBlock.value=e}}return s.NAME="UniversalStringValueBlock",s})();class ha extends wm{constructor({...r}={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}Be.UniversalString=ha,ha.NAME="UniversalString";class Ur extends Jt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}Be.NumericString=Ur,Ur.NAME="NumericString";class qt extends Jt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}Be.PrintableString=qt,qt.NAME="PrintableString";class fa extends Jt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}Be.TeletexString=fa,fa.NAME="TeletexString";class su extends Jt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}Be.VideotexString=su,su.NAME="VideotexString";class Pl extends Jt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}Be.IA5String=Pl,Pl.NAME="IA5String";class iu extends Jt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}Be.GraphicString=iu,iu.NAME="GraphicString";class Dl extends Jt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}Be.VisibleString=Dl,Dl.NAME="VisibleString";class ru extends Jt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}Be.GeneralString=ru,ru.NAME="GeneralString";class nu extends Jt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}Be.CharacterString=nu,nu.NAME="CharacterString";class Mr extends Dl{constructor({value:r,valueDate:e,...t}={}){if(super(t),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,r){this.fromString(r),this.valueBlock.valueHexView=new Uint8Array(r.length);for(let i=0;i<r.length;i++)this.valueBlock.valueHexView[i]=r.charCodeAt(i)}e&&(this.fromDate(e),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(r){this.fromString(String.fromCharCode.apply(null,A._H.toUint8Array(r)))}toBuffer(){const r=this.toString(),e=new ArrayBuffer(r.length),t=new Uint8Array(e);for(let i=0;i<r.length;i++)t[i]=r.charCodeAt(i);return e}fromDate(r){this.year=r.getUTCFullYear(),this.month=r.getUTCMonth()+1,this.day=r.getUTCDate(),this.hour=r.getUTCHours(),this.minute=r.getUTCMinutes(),this.second=r.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(r){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(r);if(null===t)return void(this.error="Wrong input string for conversion");const i=parseInt(t[1],10);this.year=i>=50?1900+i:2e3+i,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(r="iso"){if("iso"===r){const e=new Array(7);return e[0]=W(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=W(this.month,2),e[2]=W(this.day,2),e[3]=W(this.hour,2),e[4]=W(this.minute,2),e[5]=W(this.second,2),e[6]="Z",e.join("")}return super.toString(r)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}Be.UTCTime=Mr,Mr.NAME="UTCTime";class ht extends Mr{constructor(r={}){var e;super(r),null!==(e=this.millisecond)&&void 0!==e||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(r){super.fromDate(r),this.millisecond=r.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(r){let o,e=!1,t="",i="",a=0,u=0,h=0;if("Z"===r[r.length-1])t=r.substring(0,r.length-1),e=!0;else{const T=new Number(r[r.length-1]);if(isNaN(T.valueOf()))throw new Error("Wrong input string for conversion");t=r}if(e){if(-1!==t.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==t.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let T=1,K=t.indexOf("+"),L="";if(-1===K&&(K=t.indexOf("-"),T=-1),-1!==K){if(L=t.substring(K+1),t=t.substring(0,K),2!==L.length&&4!==L.length)throw new Error("Wrong input string for conversion");let re=parseInt(L.substring(0,2),10);if(isNaN(re.valueOf()))throw new Error("Wrong input string for conversion");if(u=T*re,4===L.length){if(re=parseInt(L.substring(2,4),10),isNaN(re.valueOf()))throw new Error("Wrong input string for conversion");h=T*re}}}let m=t.indexOf(".");if(-1===m&&(m=t.indexOf(",")),-1!==m){const T=new Number(`0${t.substring(m)}`);if(isNaN(T.valueOf()))throw new Error("Wrong input string for conversion");a=T.valueOf(),i=t.substring(0,m)}else i=t;switch(!0){case 8===i.length:if(o=/(\d{4})(\d{2})(\d{2})/gi,-1!==m)throw new Error("Wrong input string for conversion");break;case 10===i.length:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==m){let T=60*a;this.minute=Math.floor(T),T=60*(T-this.minute),this.second=Math.floor(T),T=1e3*(T-this.second),this.millisecond=Math.floor(T)}break;case 12===i.length:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==m){let T=60*a;this.second=Math.floor(T),T=1e3*(T-this.second),this.millisecond=Math.floor(T)}break;case 14===i.length:o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==m&&(this.millisecond=Math.floor(1e3*a));break;default:throw new Error("Wrong input string for conversion")}const N=o.exec(i);if(null===N)throw new Error("Wrong input string for conversion");for(let T=1;T<N.length;T++)switch(T){case 1:this.year=parseInt(N[T],10);break;case 2:this.month=parseInt(N[T],10);break;case 3:this.day=parseInt(N[T],10);break;case 4:this.hour=parseInt(N[T],10)+u;break;case 5:this.minute=parseInt(N[T],10)+h;break;case 6:this.second=parseInt(N[T],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===e){const T=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=T.getUTCFullYear(),this.month=T.getUTCMonth(),this.day=T.getUTCDay(),this.hour=T.getUTCHours(),this.minute=T.getUTCMinutes(),this.second=T.getUTCSeconds(),this.millisecond=T.getUTCMilliseconds()}}toString(r="iso"){if("iso"===r){const e=[];return e.push(W(this.year,4)),e.push(W(this.month,2)),e.push(W(this.day,2)),e.push(W(this.hour,2)),e.push(W(this.minute,2)),e.push(W(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(W(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(r)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}Be.GeneralizedTime=ht,ht.NAME="GeneralizedTime";class If extends is{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}Be.DATE=If,If.NAME="DATE";class Rf extends is{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}Be.TimeOfDay=Rf,Rf.NAME="TimeOfDay";class xf extends is{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}Be.DateTime=xf,xf.NAME="DateTime";class Of extends is{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}Be.Duration=Of,Of.NAME="Duration";class Df extends is{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}Be.TIME=Df,Df.NAME="TIME";class Fe{constructor({name:r="",optional:e=!1}={}){this.name=r,this.optional=e}}class ft extends Fe{constructor({value:r=[],...e}={}){super(e),this.value=r}}class $e extends Fe{constructor({value:r=new Fe,local:e=!1,...t}={}){super(t),this.value=r,this.local=e}}class Ul{constructor({data:r=Ee}={}){this.dataView=A._H.toUint8Array(r)}get data(){return this.dataView.slice().buffer}set data(r){this.dataView=A._H.toUint8Array(r)}fromBER(r,e,t){const i=e+t;return this.dataView=A._H.toUint8Array(r).subarray(e,i),i}toBER(r){return this.dataView.slice().buffer}}function he(s,r,e){if(e instanceof ft){for(let a=0;a<e.value.length;a++)if(he(s,r,e.value[a]).verified)return{verified:!0,result:s};{const a={verified:!1,result:{error:"Wrong values for Choice type"}};return e.hasOwnProperty(Pt)&&(a.name=e.name),a}}if(e instanceof Fe)return e.hasOwnProperty(Pt)&&(s[e.name]=r),{verified:!0,result:s};if(!(s instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(r instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!("idBlock"in e))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!("fromBER"in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!("toBER"in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const t=e.idBlock.toBER(!1);if(0===t.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===e.idBlock.fromBER(t,0,t.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===e.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagClass!==r.idBlock.tagClass)return{verified:!1,result:s};if(!1===e.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagNumber!==r.idBlock.tagNumber)return{verified:!1,result:s};if(!1===e.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isConstructed!==r.idBlock.isConstructed)return{verified:!1,result:s};if(!("isHexOnly"in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isHexOnly!==r.idBlock.isHexOnly)return{verified:!1,result:s};if(e.idBlock.isHexOnly){if(!(f in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const a=e.idBlock.valueHexView,o=r.idBlock.valueHexView;if(a.length!==o.length)return{verified:!1,result:s};for(let u=0;u<a.length;u++)if(a[u]!==o[1])return{verified:!1,result:s}}if(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&(s[e.name]=r)),e instanceof Be.Constructed){let a=0,o={verified:!1,result:{error:"Unknown error"}},u=e.valueBlock.value.length;if(u>0&&e.valueBlock.value[0]instanceof $e&&(u=r.valueBlock.value.length),0===u)return{verified:!0,result:s};if(0===r.valueBlock.value.length&&0!==e.valueBlock.value.length){let h=!0;for(let m=0;m<e.valueBlock.value.length;m++)h=h&&(e.valueBlock.value[m].optional||!1);return h?{verified:!0,result:s}:(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&delete s[e.name]),s.error="Inconsistent object length",{verified:!1,result:s})}for(let h=0;h<u;h++)if(h-a>=r.valueBlock.value.length){if(!1===e.valueBlock.value[h].optional){const m={verified:!1,result:s};return s.error="Inconsistent length between ASN.1 data and schema",e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&(delete s[e.name],m.name=e.name)),m}}else if(e.valueBlock.value[0]instanceof $e){if(o=he(s,r.valueBlock.value[h],e.valueBlock.value[0].value),!1===o.verified){if(!e.valueBlock.value[0].optional)return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&delete s[e.name]),o;a++}if(Pt in e.valueBlock.value[0]&&e.valueBlock.value[0].name.length>0){let m={};m="local"in e.valueBlock.value[0]&&e.valueBlock.value[0].local?r:s,typeof m[e.valueBlock.value[0].name]>"u"&&(m[e.valueBlock.value[0].name]=[]),m[e.valueBlock.value[0].name].push(r.valueBlock.value[h])}}else if(o=he(s,r.valueBlock.value[h-a],e.valueBlock.value[h]),!1===o.verified){if(!e.valueBlock.value[h].optional)return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&delete s[e.name]),o;a++}if(!1===o.verified){const h={verified:!1,result:s};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&(delete s[e.name],h.name=e.name)),h}return{verified:!0,result:s}}if(e.primitiveSchema&&f in r.valueBlock){const a=Gt(r.valueBlock.valueHexView);if(-1===a.offset){const o={verified:!1,result:a.result};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&(delete s[e.name],o.name=e.name)),o}return he(s,a.result,e.primitiveSchema)}return{verified:!0,result:s}}class vt{constructor(r={}){if("view"in r)this.fromUint8Array(r.view);else if("buffer"in r)this.fromArrayBuffer(r.buffer);else if("string"in r)this.fromString(r.string);else if("hexstring"in r)this.fromHexString(r.hexstring);else if("length"in r&&r.length>0){if(this.length=r.length,r.stub)for(let e=0;e<this._view.length;e++)this._view[e]=r.stub}else this.length=0}set buffer(r){this._buffer=r,this._view=new Uint8Array(this._buffer)}get buffer(){return this._buffer}set view(r){this._buffer=new ArrayBuffer(r.length),this._view=new Uint8Array(this._buffer),this._view.set(r)}get view(){return this._view}get length(){return this.view.byteLength}set length(r){this._buffer=new ArrayBuffer(r),this._view=new Uint8Array(this._buffer)}clear(){this._buffer=new ArrayBuffer(0),this._view=new Uint8Array(this._buffer)}fromArrayBuffer(r){this._buffer=r,this._view=new Uint8Array(this._buffer)}fromUint8Array(r){this.fromArrayBuffer(new Uint8Array(r).buffer)}fromString(r){const e=r.length;this.length=e;for(let t=0;t<e;t++)this.view[t]=r.charCodeAt(t)}toString(r=0,e=this.view.length-r){let t="";(r>=this.view.length||r<0)&&(r=0),(e>=this.view.length||e<0)&&(e=this.view.length-r);for(let i=r;i<r+e;i++)t+=String.fromCharCode(this.view[i]);return t}fromHexString(r){const e=r.length;this.buffer=new ArrayBuffer(e>>1),this.view=new Uint8Array(this.buffer);const t=new Map;t.set("0",0),t.set("1",1),t.set("2",2),t.set("3",3),t.set("4",4),t.set("5",5),t.set("6",6),t.set("7",7),t.set("8",8),t.set("9",9),t.set("A",10),t.set("a",10),t.set("B",11),t.set("b",11),t.set("C",12),t.set("c",12),t.set("D",13),t.set("d",13),t.set("E",14),t.set("e",14),t.set("F",15),t.set("f",15);let i=0,a=0;for(let o=0;o<e;o++)o%2?(a|=t.get(r.charAt(o)),this.view[i]=a,i++):a=t.get(r.charAt(o))<<4}toHexString(r=0,e=this.view.length-r){let t="";(r>=this.view.length||r<0)&&(r=0),(e>=this.view.length||e<0)&&(e=this.view.length-r);for(let i=r;i<r+e;i++){const a=this.view[i].toString(16).toUpperCase();t=t+(1==a.length?"0":"")+a}return t}copy(r=0,e=this.length-r){if(!r&&!this.length)return new vt;if(r<0||r>this.length-1)throw new Error(`Wrong start position: ${r}`);return new vt({buffer:this._buffer.slice(r,r+e)})}slice(r=0,e=this.length){if(!r&&!this.length)return new vt;if(r<0||r>this.length-1)throw new Error(`Wrong start position: ${r}`);return new vt({buffer:this._buffer.slice(r,e)})}realloc(r){const e=new ArrayBuffer(r);new Uint8Array(e).set(r>this._view.length?this._view:new Uint8Array(this._buffer,0,r)),this._buffer=e,this._view=new Uint8Array(this._buffer)}append(r){const e=this.length,t=r.length,i=r._view.subarray();this.realloc(e+t),this._view.set(i,e)}insert(r,e=0,t=this.length-e){return!(e>this.length-1||(t>this.length-e&&(t=this.length-e),t>r.length&&(t=r.length),this._view.set(t==r.length?r._view:r._view.subarray(0,t),e),0))}isEqual(r){if(this.length!=r.length)return!1;for(let e=0;e<r.length;e++)if(this.view[e]!=r.view[e])return!1;return!0}isEqualView(r){if(r.length!=this.view.length)return!1;for(let e=0;e<r.length;e++)if(this.view[e]!=r[e])return!1;return!0}findPattern(r,e,t,i){const{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,i),h=r.length;if(h>o)return-1;const m=[];for(let N=0;N<h;N++)m.push(r.view[N]);for(let N=0;N<=o-h;N++){let T=!0;const K=u?a-h-N:a+N;for(let L=0;L<h;L++)if(this.view[L+K]!=m[L]){T=!1;break}if(T)return u?a-h-N:a+h+N}return-1}findFirstIn(r,e,t,i){const{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,i),h={id:-1,position:u?0:a+o,length:0};for(let m=0;m<r.length;m++){const N=this.findPattern(r[m],a,o,u);if(-1!=N){let T=!1;const K=r[m].length;u?N-K>=h.position-h.length&&(T=!0):N-K<=h.position-h.length&&(T=!0),T&&(h.position=N,h.id=m,h.length=K)}}return h}findAllIn(r,e,t){let{start:i,length:a}=this.prepareFindParameters(e,t);const o=[];let u={id:-1,position:i};for(;;){const h=u.position;if(u=this.findFirstIn(r,u.position,a),-1==u.id)break;a-=u.position-h,o.push({id:u.id,position:u.position})}return o}findAllPatternIn(r,e,t){const{start:i,length:a}=this.prepareFindParameters(e,t),o=[],u=r.length;if(u>a)return-1;const h=Array.from(r.view);for(let m=0;m<=a-u;m++){let N=!0;const T=i+m;for(let K=0;K<u;K++)if(this.view[K+T]!=h[K]){N=!1;break}N&&(o.push(i+u+m),m+=u-1)}return o}findFirstNotIn(r,e,t,i){let{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,i);const h={left:{id:-1,position:a},right:{id:-1,position:0},value:new vt};let m=o;for(;m>0;){if(h.right=this.findFirstIn(r,u?a-o+m:a+o-m,m,u),-1==h.right.id){o=m,u?a-=o:a=h.left.position,h.value=new vt({buffer:this._buffer.slice(a,a+o)});break}if(h.right.position!=(u?h.left.position-r[h.right.id].length:h.left.position+r[h.right.id].length)){u?(a=h.right.position+r[h.right.id].length,o=h.left.position-h.right.position-r[h.right.id].length):(a=h.left.position,o=h.right.position-h.left.position-r[h.right.id].length),h.value=new vt({buffer:this._buffer.slice(a,a+o)});break}h.left=h.right,m-=r[h.right.id].length}if(u){const N=h.right;h.right=h.left,h.left=N}return h}findAllNotIn(r,e,t){let{start:i,length:a}=this.prepareFindParameters(e,t);const o=[];let u={left:{id:-1,position:i},right:{id:-1,position:i},value:new vt};do{const h=u.right.position;u=this.findFirstNotIn(r,u.right.position,a),a-=u.right.position-h,o.push({left:{id:u.left.id,position:u.left.position},right:{id:u.right.id,position:u.right.position},value:u.value})}while(-1!=u.right.id);return o}findFirstSequence(r,e,t,i){let{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,i);const h=this.skipNotPatterns(r,a,o,u);if(-1==h)return{position:-1,value:new vt};const m=this.skipPatterns(r,h,o-(u?a-h:h-a),u);return u?(a=m,o=h-m):(a=h,o=m-h),{position:m,value:new vt({buffer:this._buffer.slice(a,a+o)})}}findAllSequences(r,e,t){let{start:i,length:a}=this.prepareFindParameters(e,t);const o=[];let u={position:i,value:new vt};do{const h=u.position;u=this.findFirstSequence(r,u.position,a),-1!=u.position&&(a-=u.position-h,o.push({position:u.position,value:u.value}))}while(-1!=u.position);return o}findPairedPatterns(r,e,t,i){const a=[];if(r.isEqual(e))return a;const{start:o,length:u}=this.prepareFindParameters(t,i);let h=0;const m=this.findAllPatternIn(r,o,u);if(!Array.isArray(m)||0==m.length)return a;const N=this.findAllPatternIn(e,o,u);if(!Array.isArray(N)||0==N.length)return a;for(;h<m.length&&0!=N.length;)if(m[0]!=N[0]){if(m[h]>N[0])break;for(;m[h]<N[0]&&(h++,!(h>=m.length)););a.push({left:m[h-1],right:N[0]}),m.splice(h-1,1),N.splice(0,1),h=0}else a.push({left:m[0],right:N[0]}),m.splice(0,1),N.splice(0,1);return a.sort((T,K)=>T.left-K.left),a}findPairedArrays(r,e,t,i){const{start:a,length:o}=this.prepareFindParameters(t,i),u=[];let h=0;const m=this.findAllIn(r,a,o);if(0==m.length)return u;const N=this.findAllIn(e,a,o);if(0==N.length)return u;for(;h<m.length&&0!=N.length;)if(m[0].position!=N[0].position){if(m[h].position>N[0].position)break;for(;m[h].position<N[0].position&&(h++,!(h>=m.length)););u.push({left:m[h-1],right:N[0]}),m.splice(h-1,1),N.splice(0,1),h=0}else u.push({left:m[0],right:N[0]}),m.splice(0,1),N.splice(0,1);return u.sort((T,K)=>T.left.position-K.left.position),u}replacePattern(r,e,t,i,a=null){let u,o=[];const h={status:-1,searchPatternPositions:[],replacePatternPositions:[]},{start:m,length:N}=this.prepareFindParameters(t,i);if(null==a){if(o=this.findAllIn([r],m,N),0==o.length)return h}else o=a;h.searchPatternPositions.push(...Array.from(o,re=>re.position));const T=r.length-e.length,K=new ArrayBuffer(this.view.length-o.length*T),L=new Uint8Array(K);for(L.set(new Uint8Array(this.buffer,0,m)),u=0;u<o.length;u++){const re=0==u?m:o[u-1].position;L.set(new Uint8Array(this.buffer,re,o[u].position-r.length-re),re-u*T),L.set(e.view,o[u].position-r.length-u*T),h.replacePatternPositions.push(o[u].position-r.length-u*T)}return u--,L.set(new Uint8Array(this.buffer,o[u].position,this.length-o[u].position),o[u].position-r.length+e.length-u*T),this.buffer=K,this.view=new Uint8Array(this.buffer),h.status=1,h}skipPatterns(r,e,t,i){const{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,i);let h=a;for(let m=0;m<r.length;m++){const N=r[m].length,T=u?h-N:h;let K=!0;for(let L=0;L<N;L++)if(this.view[L+T]!=r[m].view[L]){K=!1;break}if(K)if(m=-1,u){if(h-=N,h<=0)return h}else if(h+=N,h>=a+o)return h}return h}skipNotPatterns(r,e,t,i){const{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,i);let h=-1;for(let m=0;m<o;m++){for(let N=0;N<r.length;N++){const T=r[N].length,K=u?a-m-T:a+m;let L=!0;for(let re=0;re<T;re++)if(this.view[re+K]!=r[N].view[re]){L=!1;break}if(L){h=u?a-m:a+m;break}}if(-1!=h)break}return h}prepareFindParameters(r=null,e=null,t=!1){return null===r&&(r=t?this.length:0),r>this.length&&(r=this.length),t?(null===e&&(e=r),e>r&&(e=r)):(null===e&&(e=this.length-r),e>this.length-r&&(e=this.length-r)),{start:r,length:e,backward:t}}}let da=(()=>{class s{constructor(e={}){this._stream=new vt,this._length=0,this._start=0,this.backward=!1,this.appendBlock=0,this.prevLength=0,this.prevStart=0,this.stream="view"in e?new vt({view:e.view}):"buffer"in e?new vt({buffer:e.buffer}):"string"in e?new vt({string:e.string}):"hexstring"in e?new vt({hexstring:e.hexstring}):"stream"in e?e.stream.slice():new vt,"backward"in e&&e.backward&&(this.backward=e.backward,this._start=this.stream.length),"length"in e&&e.length>0&&(this._length=e.length),"start"in e&&e.start&&e.start>0&&(this._start=e.start),"appendBlock"in e&&e.appendBlock&&e.appendBlock>0&&(this.appendBlock=e.appendBlock)}set stream(e){this._stream=e,this.prevLength=this._length,this._length=e.length,this.prevStart=this._start,this._start=0}get stream(){return this._stream}set length(e){this.prevLength=this._length,this._length=e}get length(){return this.appendBlock?this.start:this._length}set start(e){e>this.stream.length||(this.prevStart=this._start,this.prevLength=this._length,this._length-=this.backward?this._start-e:e-this._start,this._start=e)}get start(){return this._start}get buffer(){return this._stream.buffer.slice(0,this._length)}resetPosition(){this._start=this.prevStart,this._length=this.prevLength}findPattern(e,t=null){(null==t||t>this.length)&&(t=this.length);const i=this.stream.findPattern(e,this.start,this.length,this.backward);if(-1==i)return i;if(this.backward){if(i<this.start-e.length-t)return-1}else if(i>this.start+e.length+t)return-1;return this.start=i,i}findFirstIn(e,t=null){(null==t||t>this.length)&&(t=this.length);const i=this.stream.findFirstIn(e,this.start,this.length,this.backward);if(-1==i.id)return i;if(this.backward){if(i.position<this.start-e[i.id].length-t)return{id:-1,position:this.backward?0:this.start+this.length}}else if(i.position>this.start+e[i.id].length+t)return{id:-1,position:this.backward?0:this.start+this.length};return this.start=i.position,i}findAllIn(e){return this.stream.findAllIn(e,this.backward?this.start-this.length:this.start,this.length)}findFirstNotIn(e,t=null){(null==t||t>this._length)&&(t=this._length);const i=this._stream.findFirstNotIn(e,this._start,this._length,this.backward);if(-1==i.left.id&&-1==i.right.id)return i;if(this.backward){if(-1!=i.right.id&&i.right.position<this._start-e[i.right.id].length-t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new vt}}else if(-1!=i.left.id&&i.left.position>this._start+e[i.left.id].length+t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new vt};return this.start=this.backward?-1==i.left.id?0:i.left.position:-1==i.right.id?this._start+this._length:i.right.position,i}findAllNotIn(e){return this._stream.findAllNotIn(e,this.backward?this._start-this._length:this._start,this._length)}findFirstSequence(e,t=null,i=null){(null==t||t>this._length)&&(t=this._length),(null==i||i>t)&&(i=t);const a=this._stream.findFirstSequence(e,this._start,t,this.backward);if(0==a.value.length)return a;if(this.backward){if(a.position<this._start-a.value.length-i)return{position:-1,value:new vt}}else if(a.position>this._start+a.value.length+i)return{position:-1,value:new vt};return this.start=a.position,a}findAllSequences(e){return this.stream.findAllSequences(e,this.backward?this.start-this.length:this.start,this.length)}findPairedPatterns(e,t,i=null){(null==i||i>this.length)&&(i=this.length);const o=this.stream.findPairedPatterns(e,t,this.backward?this.start-this.length:this.start,this.length);if(o.length)if(this.backward){if(o[0].right<this.start-t.length-i)return[]}else if(o[0].left>this.start+e.length+i)return[];return o}findPairedArrays(e,t,i=null){(null==i||i>this.length)&&(i=this.length);const o=this.stream.findPairedArrays(e,t,this.backward?this.start-this.length:this.start,this.length);if(o.length)if(this.backward){if(o[0].right.position<this.start-t[o[0].right.id].length-i)return[]}else if(o[0].left.position>this.start+e[o[0].left.id].length+i)return[];return o}replacePattern(e,t){return this.stream.replacePattern(e,t,this.backward?this.start-this.length:this.start,this.length)}skipPatterns(e){const t=this.stream.skipPatterns(e,this.start,this.length,this.backward);return this.start=t,t}skipNotPatterns(e){const t=this.stream.skipNotPatterns(e,this.start,this.length,this.backward);return-1==t?-1:(this.start=t,t)}append(e){this.beforeAppend(e.length),this._stream.view.set(e.view,this._start),this._length+=2*e.length,this.start=this._start+e.length,this.prevLength-=2*e.length}appendView(e){this.beforeAppend(e.length),this._stream.view.set(e,this._start),this._length+=2*e.length,this.start=this._start+e.length,this.prevLength-=2*e.length}appendChar(e){this.beforeAppend(1),this._stream.view[this._start]=e,this._length+=2,this.start=this._start+1,this.prevLength-=2}appendUint16(e){this.beforeAppend(2);const t=new Uint16Array([e]),i=new Uint8Array(t.buffer);this.stream.view[this._start]=i[1],this._stream.view[this._start+1]=i[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendUint24(e){this.beforeAppend(3);const t=new Uint32Array([e]),i=new Uint8Array(t.buffer);this._stream.view[this._start]=i[2],this._stream.view[this._start+1]=i[1],this._stream.view[this._start+2]=i[0],this._length+=6,this.start=this._start+3,this.prevLength-=6}appendUint32(e){this.beforeAppend(4);const t=new Uint32Array([e]),i=new Uint8Array(t.buffer);this._stream.view[this._start]=i[3],this._stream.view[this._start+1]=i[2],this._stream.view[this._start+2]=i[1],this._stream.view[this._start+3]=i[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}appendInt16(e){this.beforeAppend(2);const t=new Int16Array([e]),i=new Uint8Array(t.buffer);this._stream.view[this._start]=i[1],this._stream.view[this._start+1]=i[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendInt32(e){this.beforeAppend(4);const t=new Int32Array([e]),i=new Uint8Array(t.buffer);this._stream.view[this._start]=i[3],this._stream.view[this._start+1]=i[2],this._stream.view[this._start+2]=i[1],this._stream.view[this._start+3]=i[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}getBlock(e,t=!0){if(this._length<=0)return new Uint8Array(0);let i;if(this._length<e&&(e=this._length),this.backward){const a=this._stream.view.subarray(this._length-e,this._length);i=new Uint8Array(e);for(let o=0;o<e;o++)i[e-1-o]=a[o]}else i=this._stream.view.subarray(this._start,this._start+e);return t&&(this.start+=this.backward?-1*e:e),i}getUint16(e=!0){const t=this.getBlock(2,e);return t.length<2?0:t[0]<<8|t[1]}getInt16(e=!0){const t=this.getUint16(e),i=32768;return t&i?-(i-(t^i)):t}getUint24(e=!0){const t=this.getBlock(4,e);return t.length<3?0:t[0]<<16|t[1]<<8|t[2]}getUint32(e=!0){const t=this.getBlock(4,e);return t.length<4?0:16777216*t[0]+(t[1]<<16)+(t[2]<<8)+t[3]}getInt32(e=!0){const t=this.getUint32(e),i=2147483648;return t&i?-(i-(t^i)):t}beforeAppend(e){this._start+e>this._stream.length&&(e>this.appendBlock&&(this.appendBlock=e+s.APPEND_BLOCK),this._stream.realloc(this._stream.length+this.appendBlock))}}return s.APPEND_BLOCK=1e3,s})();function ou(s,...r){if(!function bm(s){return s instanceof Uint8Array||null!=s&&"object"==typeof s&&"Uint8Array"===s.constructor.name}(s))throw new Error("Uint8Array expected");if(r.length>0&&!r.includes(s.length))throw new Error(`Uint8Array expected of length ${r}, not of length=${s.length}`)}function lu(s,r=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(r&&s.finished)throw new Error("Hash#digest() has already been called")}const cu=s=>new DataView(s.buffer,s.byteOffset,s.byteLength),rs=(s,r)=>s<<32-r|s>>>r,uu=(s,r)=>s<<r|s>>>32-r>>>0;function Ml(s){return"string"==typeof s&&(s=function Cm(s){if("string"!=typeof s)throw new Error("utf8ToBytes expected string, got "+typeof s);return new Uint8Array((new TextEncoder).encode(s))}(s)),ou(s),s}new Uint8Array(new Uint32Array([287454020]).buffer);class Nm{clone(){return this._cloneInto()}}function Ll(s){const r=t=>s().update(Ml(t)).digest(),e=s();return r.outputLen=e.outputLen,r.blockLen=e.blockLen,r.create=()=>s(),r}const Lf=(s,r,e)=>s&r^~s&e,Ff=(s,r,e)=>s&r^s&e^r&e;class fu extends Nm{constructor(r,e,t,i){super(),this.blockLen=r,this.outputLen=e,this.padOffset=t,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(r),this.view=cu(this.buffer)}update(r){lu(this);const{view:e,buffer:t,blockLen:i}=this,a=(r=Ml(r)).length;for(let o=0;o<a;){const u=Math.min(i-this.pos,a-o);if(u!==i)t.set(r.subarray(o,o+u),this.pos),this.pos+=u,o+=u,this.pos===i&&(this.process(e,0),this.pos=0);else{const h=cu(r);for(;i<=a-o;o+=i)this.process(h,o)}}return this.length+=r.length,this.roundClean(),this}digestInto(r){lu(this),function Uf(s,r){ou(s);const e=r.outputLen;if(s.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}(r,this),this.finished=!0;const{buffer:e,view:t,blockLen:i,isLE:a}=this;let{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(t,0),o=0);for(let T=o;T<i;T++)e[T]=0;(function Bm(s,r,e,t){if("function"==typeof s.setBigUint64)return s.setBigUint64(r,e,t);const i=BigInt(32),a=BigInt(4294967295),o=Number(e>>i&a),u=Number(e&a),m=t?0:4;s.setUint32(r+(t?4:0),o,t),s.setUint32(r+m,u,t)})(t,i-8,BigInt(8*this.length),a),this.process(t,0);const u=cu(r),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const m=h/4,N=this.get();if(m>N.length)throw new Error("_sha2: outputLen bigger than state");for(let T=0;T<m;T++)u.setUint32(4*T,N[T],a)}digest(){const{buffer:r,outputLen:e}=this;this.digestInto(r);const t=r.slice(0,e);return this.destroy(),t}_cloneInto(r){r||(r=new this.constructor),r.set(...this.get());const{blockLen:e,buffer:t,length:i,finished:a,destroyed:o,pos:u}=this;return r.length=i,r.pos=u,r.finished=a,r.destroyed=o,i%e&&r.buffer.set(t),r}}const ma=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),_s=new Uint32Array(80);class Rm extends fu{constructor(){super(64,20,8,!1),this.A=0|ma[0],this.B=0|ma[1],this.C=0|ma[2],this.D=0|ma[3],this.E=0|ma[4]}get(){const{A:r,B:e,C:t,D:i,E:a}=this;return[r,e,t,i,a]}set(r,e,t,i,a){this.A=0|r,this.B=0|e,this.C=0|t,this.D=0|i,this.E=0|a}process(r,e){for(let h=0;h<16;h++,e+=4)_s[h]=r.getUint32(e,!1);for(let h=16;h<80;h++)_s[h]=uu(_s[h-3]^_s[h-8]^_s[h-14]^_s[h-16],1);let{A:t,B:i,C:a,D:o,E:u}=this;for(let h=0;h<80;h++){let m,N;h<20?(m=Lf(i,a,o),N=1518500249):h<40?(m=i^a^o,N=1859775393):h<60?(m=Ff(i,a,o),N=2400959708):(m=i^a^o,N=3395469782);const T=uu(t,5)+m+u+N+_s[h]|0;u=o,o=a,a=uu(i,30),i=t,t=T}t=t+this.A|0,i=i+this.B|0,a=a+this.C|0,o=o+this.D|0,u=u+this.E|0,this.set(t,i,a,o,u)}roundClean(){_s.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}const Tm=Ll(()=>new Rm),xm=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Cs=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ns=new Uint32Array(64);class Hf extends fu{constructor(){super(64,32,8,!1),this.A=0|Cs[0],this.B=0|Cs[1],this.C=0|Cs[2],this.D=0|Cs[3],this.E=0|Cs[4],this.F=0|Cs[5],this.G=0|Cs[6],this.H=0|Cs[7]}get(){const{A:r,B:e,C:t,D:i,E:a,F:o,G:u,H:h}=this;return[r,e,t,i,a,o,u,h]}set(r,e,t,i,a,o,u,h){this.A=0|r,this.B=0|e,this.C=0|t,this.D=0|i,this.E=0|a,this.F=0|o,this.G=0|u,this.H=0|h}process(r,e){for(let T=0;T<16;T++,e+=4)Ns[T]=r.getUint32(e,!1);for(let T=16;T<64;T++){const K=Ns[T-15],L=Ns[T-2],re=rs(K,7)^rs(K,18)^K>>>3,Ae=rs(L,17)^rs(L,19)^L>>>10;Ns[T]=Ae+Ns[T-7]+re+Ns[T-16]|0}let{A:t,B:i,C:a,D:o,E:u,F:h,G:m,H:N}=this;for(let T=0;T<64;T++){const L=N+(rs(u,6)^rs(u,11)^rs(u,25))+Lf(u,h,m)+xm[T]+Ns[T]|0,Ae=(rs(t,2)^rs(t,13)^rs(t,22))+Ff(t,i,a)|0;N=m,m=h,h=u,u=o+L|0,o=a,a=i,i=t,t=L+Ae|0}t=t+this.A|0,i=i+this.B|0,a=a+this.C|0,o=o+this.D|0,u=u+this.E|0,h=h+this.F|0,m=m+this.G|0,N=N+this.H|0,this.set(t,i,a,o,u,h,m,N)}roundClean(){Ns.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Vm=Ll(()=>new Hf),Fl=BigInt(2**32-1),du=BigInt(32);function jf(s,r=!1){return r?{h:Number(s&Fl),l:Number(s>>du&Fl)}:{h:0|Number(s>>du&Fl),l:0|Number(s&Fl)}}const qe_split=function Om(s,r=!1){let e=new Uint32Array(s.length),t=new Uint32Array(s.length);for(let i=0;i<s.length;i++){const{h:a,l:o}=jf(s[i],r);[e[i],t[i]]=[a,o]}return[e,t]},qe_shrSH=(s,r,e)=>s>>>e,qe_shrSL=(s,r,e)=>s<<32-e|r>>>e,qe_rotrSH=(s,r,e)=>s>>>e|r<<32-e,qe_rotrSL=(s,r,e)=>s<<32-e|r>>>e,qe_rotrBH=(s,r,e)=>s<<64-e|r>>>e-32,qe_rotrBL=(s,r,e)=>s>>>e-32|r<<64-e,qe_add=function Wm(s,r,e,t){const i=(r>>>0)+(t>>>0);return{h:s+e+(i/2**32|0)|0,l:0|i}},qe_add3L=(s,r,e)=>(s>>>0)+(r>>>0)+(e>>>0),qe_add3H=(s,r,e,t)=>r+e+t+(s/2**32|0)|0,qe_add4L=(s,r,e,t)=>(s>>>0)+(r>>>0)+(e>>>0)+(t>>>0),qe_add4H=(s,r,e,t,i)=>r+e+t+i+(s/2**32|0)|0,qe_add5H=(s,r,e,t,i,a)=>r+e+t+i+a+(s/2**32|0)|0,qe_add5L=(s,r,e,t,i)=>(s>>>0)+(r>>>0)+(e>>>0)+(t>>>0)+(i>>>0),[zm,Ym]=qe_split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(s=>BigInt(s))),Is=new Uint32Array(80),Bs=new Uint32Array(80);class Hl extends fu{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:r,Al:e,Bh:t,Bl:i,Ch:a,Cl:o,Dh:u,Dl:h,Eh:m,El:N,Fh:T,Fl:K,Gh:L,Gl:re,Hh:Ae,Hl:we}=this;return[r,e,t,i,a,o,u,h,m,N,T,K,L,re,Ae,we]}set(r,e,t,i,a,o,u,h,m,N,T,K,L,re,Ae,we){this.Ah=0|r,this.Al=0|e,this.Bh=0|t,this.Bl=0|i,this.Ch=0|a,this.Cl=0|o,this.Dh=0|u,this.Dl=0|h,this.Eh=0|m,this.El=0|N,this.Fh=0|T,this.Fl=0|K,this.Gh=0|L,this.Gl=0|re,this.Hh=0|Ae,this.Hl=0|we}process(r,e){for(let ae=0;ae<16;ae++,e+=4)Is[ae]=r.getUint32(e),Bs[ae]=r.getUint32(e+=4);for(let ae=16;ae<80;ae++){const le=0|Is[ae-15],pe=0|Bs[ae-15],be=qe_rotrSH(le,pe,1)^qe_rotrSH(le,pe,8)^qe_shrSH(le,pe,7),Re=qe_rotrSL(le,pe,1)^qe_rotrSL(le,pe,8)^qe_shrSL(le,pe,7),xe=0|Is[ae-2],Me=0|Bs[ae-2],ze=qe_rotrSH(xe,Me,19)^qe_rotrBH(xe,Me,61)^qe_shrSH(xe,Me,6),bt=qe_rotrSL(xe,Me,19)^qe_rotrBL(xe,Me,61)^qe_shrSL(xe,Me,6),Ye=qe_add4L(Re,bt,Bs[ae-7],Bs[ae-16]),lt=qe_add4H(Ye,be,ze,Is[ae-7],Is[ae-16]);Is[ae]=0|lt,Bs[ae]=0|Ye}let{Ah:t,Al:i,Bh:a,Bl:o,Ch:u,Cl:h,Dh:m,Dl:N,Eh:T,El:K,Fh:L,Fl:re,Gh:Ae,Gl:we,Hh:se,Hl:ye}=this;for(let ae=0;ae<80;ae++){const le=qe_rotrSH(T,K,14)^qe_rotrSH(T,K,18)^qe_rotrBH(T,K,41),pe=qe_rotrSL(T,K,14)^qe_rotrSL(T,K,18)^qe_rotrBL(T,K,41),be=T&L^~T&Ae,xe=qe_add5L(ye,pe,K&re^~K&we,Ym[ae],Bs[ae]),Me=qe_add5H(xe,se,le,be,zm[ae],Is[ae]),ze=0|xe,bt=qe_rotrSH(t,i,28)^qe_rotrBH(t,i,34)^qe_rotrBH(t,i,39),Ye=qe_rotrSL(t,i,28)^qe_rotrBL(t,i,34)^qe_rotrBL(t,i,39),lt=t&a^t&u^a&u,jt=i&o^i&h^o&h;se=0|Ae,ye=0|we,Ae=0|L,we=0|re,L=0|T,re=0|K,({h:T,l:K}=qe_add(0|m,0|N,0|Me,0|ze)),m=0|u,N=0|h,u=0|a,h=0|o,a=0|t,o=0|i;const Ot=qe_add3L(ze,Ye,jt);t=qe_add3H(Ot,Me,bt,lt),i=0|Ot}({h:t,l:i}=qe_add(0|this.Ah,0|this.Al,0|t,0|i)),({h:a,l:o}=qe_add(0|this.Bh,0|this.Bl,0|a,0|o)),({h:u,l:h}=qe_add(0|this.Ch,0|this.Cl,0|u,0|h)),({h:m,l:N}=qe_add(0|this.Dh,0|this.Dl,0|m,0|N)),({h:T,l:K}=qe_add(0|this.Eh,0|this.El,0|T,0|K)),({h:L,l:re}=qe_add(0|this.Fh,0|this.Fl,0|L,0|re)),({h:Ae,l:we}=qe_add(0|this.Gh,0|this.Gl,0|Ae,0|we)),({h:se,l:ye}=qe_add(0|this.Hh,0|this.Hl,0|se,0|ye)),this.set(t,i,a,o,u,h,m,N,T,K,L,re,Ae,we,se,ye)}roundClean(){Is.fill(0),Bs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Xm extends Hl{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const Qm=Ll(()=>new Hl),Zm=Ll(()=>new Xm),Ct=new ArrayBuffer(0),v="";let ot=(()=>{class s extends TypeError{constructor(){super(...arguments),this.name=s.NAME}static isType(e,t){if("string"==typeof t){if("Array"===t&&Array.isArray(e))return!0;if("ArrayBuffer"===t&&e instanceof ArrayBuffer)return!0;if("ArrayBufferView"===t&&ArrayBuffer.isView(e))return!0;if(typeof e===t)return!0}else if(e instanceof t)return!0;return!1}static assert(e,t,...i){for(const o of i)if(this.isType(e,o))return;const a=i.map(o=>o instanceof Function&&"name"in o?o.name:`${o}`);throw new s(`Parameter '${t}' is not of type ${a.length>1?`(${a.join(" or ")})`:a[0]}`)}}return s.NAME="ArgumentError",s})(),et=(()=>{class s extends TypeError{static assert(...e){let i,a,t=null;"string"==typeof e[0]?(t=e[0],i=e[1],a=e.slice(2)):(i=e[0],a=e.slice(1)),ot.assert(i,"parameters","object");for(const o of a)if(null==i[o])throw new s(o,t)}static assertEmpty(e,t,i){if(null==e)throw new s(t,i)}constructor(e,t=null,i){super(),this.name=s.NAME,this.field=e,t&&(this.target=t),this.message=i||`Absent mandatory parameter '${e}' ${t?` in '${t}'`:v}`}}return s.NAME="ParameterError",s})();class oe extends Error{static assertSchema(r,e){if(!r.verified)throw new Error(`Object's schema was not verified against input data for ${e}`)}static assert(r,e){if(-1===r.offset)throw new oe(`Error during parsing of ASN.1 data. Data is not correct for '${e}'.`)}constructor(r){super(r),this.name="AsnError"}}let fe=(()=>{class s{static blockName(){return this.CLASS_NAME}static fromBER(e){const t=ct(e);oe.assert(t,this.name);try{return new this({schema:t.result})}catch{throw new oe(`Cannot create '${this.CLASS_NAME}' from ASN.1 object`)}}static defaultValues(e){throw new Error(`Invalid member name for ${this.CLASS_NAME} class: ${e}`)}static schema(e={}){throw new Error(`Method '${this.CLASS_NAME}.schema' should be overridden`)}get className(){return this.constructor.CLASS_NAME}toString(e="hex"){let t;try{t=this.toSchema()}catch{t=this.toSchema(!0)}return A.U$.ToString(t.toBER(),e)}}return s.CLASS_NAME="PkiObject",s})();function Rs(s){let r=!1,e=v;const t=s.trim();for(let i=0;i<t.length;i++)32===t.charCodeAt(i)?!1===r&&(r=!0):(r&&(e+=" ",r=!1),e+=t[i]);return e.toLowerCase()}const ga="type",mu="value";let gu=(()=>{class s extends fe{constructor(e={}){super(),this.type=l(e,ga,s.defaultValues(ga)),this.value=l(e,mu,s.defaultValues(mu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ga:return v;case mu:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.type||v}),new Fe({name:t.value||v})]})}fromSchema(e){Z(e,[ga,"typeValue"]);const t=he(e,e,s.schema({names:{type:ga,value:"typeValue"}}));oe.assertSchema(t,this.className),this.type=t.result.type.valueBlock.toString(),this.value=t.result.typeValue}toSchema(){return new O({value:[new Ve({value:this.type}),this.value]})}toJSON(){const e={type:this.type};return e.value=0!==Object.keys(this.value).length?this.value.toJSON():this.value,e}isEqual(e){const t=[is.blockName(),Xt.blockName(),ha.blockName(),Ur.blockName(),qt.blockName(),fa.blockName(),su.blockName(),Pl.blockName(),iu.blockName(),Dl.blockName(),ru.blockName(),nu.blockName()];if(e instanceof ArrayBuffer)return A._H.isEqual(this.value.valueBeforeDecodeView,e);if(e.constructor.blockName()===s.blockName()){if(this.type!==e.type)return!1;const i=[!1,!1],a=this.value.constructor.blockName();for(const u of t)a===u&&(i[0]=!0),e.value.constructor.blockName()===u&&(i[1]=!0);if(i[0]!==i[1])return!1;if(i[0]&&i[1]){const u=Rs(this.value.valueBlock.value),h=Rs(e.value.valueBlock.value);if(0!==u.localeCompare(h))return!1}else if(!A._H.isEqual(this.value.valueBeforeDecodeView,e.value.valueBeforeDecodeView))return!1;return!0}return!1}}return s.CLASS_NAME="AttributeTypeAndValue",s})();const Ai="typesAndValues",jl="valueBeforeDecode";let dt=(()=>{class s extends fe{constructor(e={}){super(),this.typesAndValues=l(e,Ai,s.defaultValues(Ai)),this.valueBeforeDecode=l(e,jl,s.defaultValues(jl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ai:return[];case jl:return Ct;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ai:return 0===t.length;case jl:return 0===t.byteLength;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new $e({name:t.repeatedSequence||v,value:new _t({value:[new $e({name:t.repeatedSet||v,value:gu.schema(t.typeAndValue||{})})]})})]})}fromSchema(e){Z(e,["RDN",Ai]);const t=he(e,e,s.schema({names:{blockName:"RDN",repeatedSet:Ai}}));oe.assertSchema(t,this.className),Ai in t.result&&(this.typesAndValues=Array.from(t.result.typesAndValues,i=>new gu({schema:i}))),this.valueBeforeDecode=t.result.RDN.valueBeforeDecodeView.slice().buffer}toSchema(){if(0===this.valueBeforeDecode.byteLength)return new O({value:[new _t({value:Array.from(this.typesAndValues,t=>t.toSchema())})]});const e=ct(this.valueBeforeDecode);if(oe.assert(e,"RelativeDistinguishedNames"),!(e.result instanceof O))throw new Error("ASN.1 result should be SEQUENCE");return e.result}toJSON(){return{typesAndValues:Array.from(this.typesAndValues,e=>e.toJSON())}}isEqual(e){if(e instanceof s){if(this.typesAndValues.length!==e.typesAndValues.length)return!1;for(const[t,i]of this.typesAndValues.entries())if(!1===i.isEqual(e.typesAndValues[t]))return!1;return!0}return e instanceof ArrayBuffer&&ne(this.valueBeforeDecode,e)}}return s.CLASS_NAME="RelativeDistinguishedNames",s})();const pa="type",va="value";function eg(s={},r=!1){const e=l(s,"names",{});return new O({optional:r,value:[new q({optional:!0,idBlock:{tagClass:2,tagNumber:1},name:e.country_name||v,value:[new ft({value:[new Ur,new qt]})]}),new q({optional:!0,idBlock:{tagClass:2,tagNumber:2},name:e.administration_domain_name||v,value:[new ft({value:[new Ur,new qt]})]}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:0},name:e.network_address||v,isHexOnly:!0}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:1},name:e.terminal_identifier||v,isHexOnly:!0}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:2},name:e.private_domain_name||v,value:[new ft({value:[new Ur,new qt]})]}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:3},name:e.organization_name||v,isHexOnly:!0}),new Le({optional:!0,name:e.numeric_user_identifier||v,idBlock:{tagClass:3,tagNumber:4},isHexOnly:!0}),new q({optional:!0,name:e.personal_name||v,idBlock:{tagClass:3,tagNumber:5},value:[new Le({idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:1},isHexOnly:!0}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:2},isHexOnly:!0}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:3},isHexOnly:!0})]}),new q({optional:!0,name:e.organizational_unit_names||v,idBlock:{tagClass:3,tagNumber:6},value:[new $e({value:new qt})]})]})}function tg(s=!1){return new O({optional:s,value:[new qt,new qt]})}function sg(s=!1){return new _t({optional:s,value:[new Le({optional:!0,idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Fe]})]})}let St=(()=>{class s extends fe{constructor(e={}){super(),this.type=l(e,pa,s.defaultValues(pa)),this.value=l(e,va,s.defaultValues(va)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case pa:return 9;case va:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case pa:return t===s.defaultValues(e);case va:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new ft({value:[new q({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||v,value:[new Ve,new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe]})]}),new Le({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:1}}),new Le({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:2}}),new q({idBlock:{tagClass:3,tagNumber:3},name:t.blockName||v,value:[eg(t.builtInStandardAttributes||{},!1),tg(!0),sg(!0)]}),new q({idBlock:{tagClass:3,tagNumber:4},name:t.blockName||v,value:[dt.schema(t.directoryName||{})]}),new q({idBlock:{tagClass:3,tagNumber:5},name:t.blockName||v,value:[new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ft({value:[new fa,new qt,new ha,new is,new Xt]})]}),new q({idBlock:{tagClass:3,tagNumber:1},value:[new ft({value:[new fa,new qt,new ha,new is,new Xt]})]})]}),new Le({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:6}}),new Le({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:7}}),new Le({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:8}})]})}fromSchema(e){Z(e,["blockName","otherName","rfc822Name","dNSName","x400Address","directoryName","ediPartyName","uniformResourceIdentifier","iPAddress","registeredID"]);const t=he(e,e,s.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));switch(oe.assertSchema(t,this.className),this.type=t.result.blockName.idBlock.tagNumber,this.type){case 0:case 3:this.value=t.result.blockName;break;case 1:case 2:case 6:{const i=t.result.blockName;i.idBlock.tagClass=1,i.idBlock.tagNumber=22;const o=ct(i.toBER(!1));oe.assert(o,"GeneralName value"),this.value=o.result.valueBlock.value}break;case 4:this.value=new dt({schema:t.result.directoryName});break;case 5:this.value=t.result.ediPartyName;break;case 7:this.value=new de({valueHex:t.result.blockName.valueBlock.valueHex});break;case 8:{const i=t.result.blockName;i.idBlock.tagClass=1,i.idBlock.tagNumber=6;const o=ct(i.toBER(!1));oe.assert(o,"GeneralName registeredID"),this.value=o.result.valueBlock.toString()}}}toSchema(){switch(this.type){case 0:case 3:case 5:return new q({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:{const e=new Pl({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 4:return new q({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:{const e=this.value;return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 8:{const e=new Ve({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}default:return s.schema()}}toJSON(){const e={type:this.type,value:v};if("string"==typeof this.value)e.value=this.value;else try{e.value=this.value.toJSON()}catch{}return e}}return s.CLASS_NAME="GeneralName",s})();const wa="accessMethod",ya="accessLocation",ig=[wa,ya];let Kf=(()=>{class s extends fe{constructor(e={}){super(),this.accessMethod=l(e,wa,s.defaultValues(wa)),this.accessLocation=l(e,ya,s.defaultValues(ya)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wa:return v;case ya:return new St;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.accessMethod||v}),St.schema(t.accessLocation||{})]})}fromSchema(e){Z(e,ig);const t=he(e,e,s.schema({names:{accessMethod:wa,accessLocation:{names:{blockName:ya}}}}));oe.assertSchema(t,this.className),this.accessMethod=t.result.accessMethod.valueBlock.toString(),this.accessLocation=new St({schema:t.result.accessLocation})}toSchema(){return new O({value:[new Ve({value:this.accessMethod}),this.accessLocation.toSchema()]})}toJSON(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}return s.CLASS_NAME="AccessDescription",s})();const Ts="seconds",xs="millis",Vs="micros";let Lr=(()=>{class s extends fe{constructor(e={}){super(),Ts in e&&(this.seconds=l(e,Ts,s.defaultValues(Ts))),xs in e&&(this.millis=l(e,xs,s.defaultValues(xs))),Vs in e&&(this.micros=l(e,Vs,s.defaultValues(Vs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ts:case xs:case Vs:return 0;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ts:case xs:case Vs:return t===s.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,optional:!0,value:[new X({optional:!0,name:t.seconds||v}),new Le({name:t.millis||v,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Le({name:t.micros||v,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){Z(e,[Ts,xs,Vs]);const t=he(e,e,s.schema({names:{seconds:Ts,millis:xs,micros:Vs}}));if(oe.assertSchema(t,this.className),"seconds"in t.result&&(this.seconds=t.result.seconds.valueBlock.valueDec),"millis"in t.result){const i=new X({valueHex:t.result.millis.valueBlock.valueHex});this.millis=i.valueBlock.valueDec}if("micros"in t.result){const i=new X({valueHex:t.result.micros.valueBlock.valueHex});this.micros=i.valueBlock.valueDec}}toSchema(){const e=[];if(void 0!==this.seconds&&e.push(new X({value:this.seconds})),void 0!==this.millis){const t=new X({value:this.millis});e.push(new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:t.valueBlock.valueHexView}))}if(void 0!==this.micros){const t=new X({value:this.micros});e.push(new Le({idBlock:{tagClass:3,tagNumber:1},valueHex:t.valueBlock.valueHexView}))}return new O({value:e})}toJSON(){const e={};return void 0!==this.seconds&&(e.seconds=this.seconds),void 0!==this.millis&&(e.millis=this.millis),void 0!==this.micros&&(e.micros=this.micros),e}}return s.CLASS_NAME="Accuracy",s})();const $l="algorithmId",Sa="algorithmParams",Gf="algorithm",pu="params",rg=[Gf,pu];let Q=(()=>{class s extends fe{constructor(e={}){super(),this.algorithmId=l(e,$l,s.defaultValues($l)),Sa in e&&(this.algorithmParams=l(e,Sa,s.defaultValues(Sa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $l:return v;case Sa:return new Fe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case $l:return t===v;case Sa:return t instanceof Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,optional:t.optional||!1,value:[new Ve({name:t.algorithmIdentifier||v}),new Fe({name:t.algorithmParams||v,optional:!0})]})}fromSchema(e){Z(e,rg);const t=he(e,e,s.schema({names:{algorithmIdentifier:Gf,algorithmParams:pu}}));oe.assertSchema(t,this.className),this.algorithmId=t.result.algorithm.valueBlock.toString(),pu in t.result&&(this.algorithmParams=t.result.params)}toSchema(){const e=[];return e.push(new Ve({value:this.algorithmId})),this.algorithmParams&&!(this.algorithmParams instanceof Fe)&&e.push(this.algorithmParams),new O({value:e})}toJSON(){const e={algorithmId:this.algorithmId};return this.algorithmParams&&!(this.algorithmParams instanceof Fe)&&(e.algorithmParams=this.algorithmParams.toJSON()),e}isEqual(e){return e instanceof s&&this.algorithmId===e.algorithmId&&(this.algorithmParams?!!e.algorithmParams&&JSON.stringify(this.algorithmParams)===JSON.stringify(e.algorithmParams):!e.algorithmParams)}}return s.CLASS_NAME="AlgorithmIdentifier",s})();const Fr="altNames",ng=[Fr];let Jf=(()=>{class s extends fe{constructor(e={}){super(),this.altNames=l(e,Fr,s.defaultValues(Fr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Fr?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new $e({name:t.altNames||v,value:St.schema()})]})}fromSchema(e){Z(e,ng);const t=he(e,e,s.schema({names:{altNames:Fr}}));oe.assertSchema(t,this.className),Fr in t.result&&(this.altNames=Array.from(t.result.altNames,i=>new St({schema:i})))}toSchema(){return new O({value:Array.from(this.altNames,e=>e.toSchema())})}toJSON(){return{altNames:Array.from(this.altNames,e=>e.toJSON())}}}return s.CLASS_NAME="AltName",s})();const Hr="type",jr="values",ag=[Hr,jr];let tt=(()=>{class s extends fe{constructor(e={}){super(),this.type=l(e,Hr,s.defaultValues(Hr)),this.values=l(e,jr,s.defaultValues(jr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Hr:return v;case jr:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Hr:return t===v;case jr:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.type||v}),new _t({name:t.setName||v,value:[new $e({name:t.values||v,value:new Fe})]})]})}fromSchema(e){Z(e,ag);const t=he(e,e,s.schema({names:{type:Hr,values:jr}}));oe.assertSchema(t,this.className),this.type=t.result.type.valueBlock.toString(),this.values=t.result.values}toSchema(){return new O({value:[new Ve({value:this.type}),new _t({value:this.values})]})}toJSON(){return{type:this.type,values:Array.from(this.values,e=>e.toJSON())}}}return s.CLASS_NAME="Attribute",s})();const ba="notBeforeTime",Aa="notAfterTime",og=[ba,Aa];let $r=(()=>{class s extends fe{constructor(e={}){super(),this.notBeforeTime=l(e,ba,s.defaultValues(ba)),this.notAfterTime=l(e,Aa,s.defaultValues(Aa)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ba:case Aa:return new Date(0,0,0);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new ht({name:t.notBeforeTime||v}),new ht({name:t.notAfterTime||v})]})}fromSchema(e){Z(e,og);const t=he(e,e,s.schema({names:{notBeforeTime:ba,notAfterTime:Aa}}));oe.assertSchema(t,this.className),this.notBeforeTime=t.result.notBeforeTime.toDate(),this.notAfterTime=t.result.notAfterTime.toDate()}toSchema(){return new O({value:[new ht({valueDate:this.notBeforeTime}),new ht({valueDate:this.notAfterTime})]})}toJSON(){return{notBeforeTime:this.notBeforeTime,notAfterTime:this.notAfterTime}}}return s.CLASS_NAME="AttCertValidityPeriod",s})();const Ea="names",qf="generalNames";let Bt=(()=>{class s extends fe{constructor(e={}){super(),this.names=l(e,Ea,s.defaultValues(Ea)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return"names"===e?[]:super.defaultValues(e)}static schema(e={},t=!1){const i=l(e,Ea,{});return new O({optional:t,name:i.blockName||v,value:[new $e({name:i.generalNames||v,value:St.schema()})]})}fromSchema(e){Z(e,[Ea,qf]);const t=he(e,e,s.schema({names:{blockName:Ea,generalNames:qf}}));oe.assertSchema(t,this.className),this.names=Array.from(t.result.generalNames,i=>new St({schema:i}))}toSchema(){return new O({value:Array.from(this.names,e=>e.toSchema())})}toJSON(){return{names:Array.from(this.names,e=>e.toJSON())}}}return s.CLASS_NAME="GeneralNames",s})();const Wf="2.5.29.17",zf="2.5.29.18",vu="2.5.29.19",Yf="2.5.29.28",Xf="2.5.29.29",Qf="2.5.29.30",Zf="2.5.29.31",wu="2.5.29.46",ed="2.5.29.32",Wt="2.5.29.32.0",td="2.5.29.33",yu="2.5.29.35",sd="2.5.29.36",Su="1.3.6.1.5.5.7.1.1",bu="1.2.840.113549.1.7.1",rd="1.2.840.113549.1.7.3",nd="1.2.840.113549.1.7.6",ad="1.2.840.113549.1.9.22.1",od="1.2.840.113549.1.9.22.3",ld="1.2.840.113549.1.9.23.1",Ei="keyIdentifier",ki="authorityCertIssuer",_i="authorityCertSerialNumber",Ng=[Ei,ki,_i];let cd=(()=>{class s extends fe{constructor(e={}){super(),Ei in e&&(this.keyIdentifier=l(e,Ei,s.defaultValues(Ei))),ki in e&&(this.authorityCertIssuer=l(e,ki,s.defaultValues(ki))),_i in e&&(this.authorityCertSerialNumber=l(e,_i,s.defaultValues(_i))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ei:return new de;case ki:return[];case _i:return new X;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Le({name:t.keyIdentifier||v,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new $e({name:t.authorityCertIssuer||v,value:St.schema()})]}),new Le({name:t.authorityCertSerialNumber||v,optional:!0,idBlock:{tagClass:3,tagNumber:2}})]})}fromSchema(e){Z(e,Ng);const t=he(e,e,s.schema({names:{keyIdentifier:Ei,authorityCertIssuer:ki,authorityCertSerialNumber:_i}}));oe.assertSchema(t,this.className),Ei in t.result&&(this.keyIdentifier=new de({valueHex:t.result.keyIdentifier.valueBlock.valueHex})),ki in t.result&&(this.authorityCertIssuer=Array.from(t.result.authorityCertIssuer,i=>new St({schema:i}))),_i in t.result&&(this.authorityCertSerialNumber=new X({valueHex:t.result.authorityCertSerialNumber.valueBlock.valueHex}))}toSchema(){const e=[];return this.keyIdentifier&&e.push(new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:this.keyIdentifier.valueBlock.valueHexView})),this.authorityCertIssuer&&e.push(new q({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.authorityCertIssuer,t=>t.toSchema())})),this.authorityCertSerialNumber&&e.push(new Le({idBlock:{tagClass:3,tagNumber:2},valueHex:this.authorityCertSerialNumber.valueBlock.valueHexView})),new O({value:e})}toJSON(){const e={};return this.keyIdentifier&&(e.keyIdentifier=this.keyIdentifier.toJSON()),this.authorityCertIssuer&&(e.authorityCertIssuer=Array.from(this.authorityCertIssuer,t=>t.toJSON())),this.authorityCertSerialNumber&&(e.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),e}}return s.CLASS_NAME="AuthorityKeyIdentifier",s})();const Ci="pathLenConstraint",Ni="cA";let ud=(()=>{class s extends fe{constructor(e={}){super(),this.cA=l(e,Ni,!1),Ci in e&&(this.pathLenConstraint=l(e,Ci,0)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e!==Ni&&super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new ks({optional:!0,name:t.cA||v}),new X({optional:!0,name:t.pathLenConstraint||v})]})}fromSchema(e){Z(e,[Ni,Ci]);const t=he(e,e,s.schema({names:{cA:Ni,pathLenConstraint:Ci}}));oe.assertSchema(t,this.className),Ni in t.result&&(this.cA=t.result.cA.valueBlock.value),Ci in t.result&&(this.pathLenConstraint=t.result.pathLenConstraint.valueBlock.isHexOnly?t.result.pathLenConstraint:t.result.pathLenConstraint.valueBlock.valueDec)}toSchema(){const e=[];return this.cA!==s.defaultValues(Ni)&&e.push(new ks({value:this.cA})),Ci in this&&e.push(this.pathLenConstraint instanceof X?this.pathLenConstraint:new X({value:this.pathLenConstraint})),new O({value:e})}toJSON(){const e={};return this.cA!==s.defaultValues(Ni)&&(e.cA=this.cA),Ci in this&&(e.pathLenConstraint=this.pathLenConstraint instanceof X?this.pathLenConstraint.toJSON():this.pathLenConstraint),e}}return s.CLASS_NAME="BasicConstraints",s})();const Au="certificateIndex",Eu="keyIndex";let Ig=(()=>{class s extends fe{constructor(e={}){super(),this.certificateIndex=l(e,Au,s.defaultValues(Au)),this.keyIndex=l(e,Eu,s.defaultValues(Eu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Au:case Eu:return 0;default:return super.defaultValues(e)}}static schema(){return new X}fromSchema(e){if(e.constructor.blockName()!==X.blockName())throw new Error("Object's schema was not verified against input data for CAVersion");let t=e.valueBlock.valueHex.slice(0);const i=new Uint8Array(t);switch(!0){case t.byteLength<4:{const K=new ArrayBuffer(4);new Uint8Array(K).set(i,4-t.byteLength),t=K.slice(0)}break;case t.byteLength>4:{const K=new ArrayBuffer(4);new Uint8Array(K).set(i.slice(0,4)),t=K.slice(0)}}const a=t.slice(0,2),o=new Uint8Array(a);let u=o[0];o[0]=o[1],o[1]=u;const h=new Uint16Array(a);this.keyIndex=h[0];const m=t.slice(2),N=new Uint8Array(m);u=N[0],N[0]=N[1],N[1]=u;const T=new Uint16Array(m);this.certificateIndex=T[0]}toSchema(){const e=new ArrayBuffer(2);new Uint16Array(e)[0]=this.certificateIndex;const i=new Uint8Array(e);let a=i[0];i[0]=i[1],i[1]=a;const o=new ArrayBuffer(2);new Uint16Array(o)[0]=this.keyIndex;const h=new Uint8Array(o);return a=h[0],h[0]=h[1],h[1]=a,new X({valueHex:R(o,e)})}toJSON(){return{certificateIndex:this.certificateIndex,keyIndex:this.keyIndex}}}return s.CLASS_NAME="CAVersion",s})();const ka="policyQualifierId",_a="qualifier",Bg=[ka,_a];let hd=(()=>{class s extends fe{constructor(e={}){super(),this.policyQualifierId=l(e,ka,s.defaultValues(ka)),this.qualifier=l(e,_a,s.defaultValues(_a)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ka:return v;case _a:return new Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.policyQualifierId||v}),new Fe({name:t.qualifier||v})]})}fromSchema(e){Z(e,Bg);const t=he(e,e,s.schema({names:{policyQualifierId:ka,qualifier:_a}}));oe.assertSchema(t,this.className),this.policyQualifierId=t.result.policyQualifierId.valueBlock.toString(),this.qualifier=t.result.qualifier}toSchema(){return new O({value:[new Ve({value:this.policyQualifierId}),this.qualifier]})}toJSON(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}return s.CLASS_NAME="PolicyQualifierInfo",s})();const Ca="policyIdentifier",Ii="policyQualifiers",Rg=[Ca,Ii];let fd=(()=>{class s extends fe{constructor(e={}){super(),this.policyIdentifier=l(e,Ca,s.defaultValues(Ca)),Ii in e&&(this.policyQualifiers=l(e,Ii,s.defaultValues(Ii))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ca:return v;case Ii:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.policyIdentifier||v}),new O({optional:!0,value:[new $e({name:t.policyQualifiers||v,value:hd.schema()})]})]})}fromSchema(e){Z(e,Rg);const t=he(e,e,s.schema({names:{policyIdentifier:Ca,policyQualifiers:Ii}}));oe.assertSchema(t,this.className),this.policyIdentifier=t.result.policyIdentifier.valueBlock.toString(),Ii in t.result&&(this.policyQualifiers=Array.from(t.result.policyQualifiers,i=>new hd({schema:i})))}toSchema(){const e=[];return e.push(new Ve({value:this.policyIdentifier})),this.policyQualifiers&&e.push(new O({value:Array.from(this.policyQualifiers,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={policyIdentifier:this.policyIdentifier};return this.policyQualifiers&&(e.policyQualifiers=Array.from(this.policyQualifiers,t=>t.toJSON())),e}}return s.CLASS_NAME="PolicyInformation",s})();const Na="certificatePolicies",Tg=[Na];let dd=(()=>{class s extends fe{constructor(e={}){super(),this.certificatePolicies=l(e,Na,s.defaultValues(Na)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Na?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new $e({name:t.certificatePolicies||v,value:fd.schema()})]})}fromSchema(e){Z(e,Tg);const t=he(e,e,s.schema({names:{certificatePolicies:Na}}));oe.assertSchema(t,this.className),this.certificatePolicies=Array.from(t.result.certificatePolicies,i=>new fd({schema:i}))}toSchema(){return new O({value:Array.from(this.certificatePolicies,e=>e.toSchema())})}toJSON(){return{certificatePolicies:Array.from(this.certificatePolicies,e=>e.toJSON())}}}return s.CLASS_NAME="CertificatePolicies",s})();const Ia="templateID",cs="templateMajorVersion",us="templateMinorVersion",xg=[Ia,cs,us];class Kr extends fe{constructor(r={}){super(),this.templateID=l(r,Ia,Kr.defaultValues(Ia)),cs in r&&(this.templateMajorVersion=l(r,cs,Kr.defaultValues(cs))),us in r&&(this.templateMinorVersion=l(r,us,Kr.defaultValues(us))),r.schema&&this.fromSchema(r.schema)}static defaultValues(r){switch(r){case Ia:return v;case cs:case us:return 0;default:return super.defaultValues(r)}}static schema(r={}){const e=l(r,"names",{});return new O({name:e.blockName||v,value:[new Ve({name:e.templateID||v}),new X({name:e.templateMajorVersion||v,optional:!0}),new X({name:e.templateMinorVersion||v,optional:!0})]})}fromSchema(r){Z(r,xg);const e=he(r,r,Kr.schema({names:{templateID:Ia,templateMajorVersion:cs,templateMinorVersion:us}}));oe.assertSchema(e,this.className),this.templateID=e.result.templateID.valueBlock.toString(),cs in e.result&&(this.templateMajorVersion=e.result.templateMajorVersion.valueBlock.valueDec),us in e.result&&(this.templateMinorVersion=e.result.templateMinorVersion.valueBlock.valueDec)}toSchema(){const r=[];return r.push(new Ve({value:this.templateID})),cs in this&&r.push(new X({value:this.templateMajorVersion})),us in this&&r.push(new X({value:this.templateMinorVersion})),new O({value:r})}toJSON(){const r={templateID:this.templateID};return cs in this&&(r.templateMajorVersion=this.templateMajorVersion),us in this&&(r.templateMinorVersion=this.templateMinorVersion),r}}const Bi="distributionPoint",md="distributionPointNames",Ri="reasons",Ti="cRLIssuer",gd="cRLIssuerNames",Vg=[Bi,md,Ri,Ti,gd];let pd=(()=>{class s extends fe{constructor(e={}){super(),Bi in e&&(this.distributionPoint=l(e,Bi,s.defaultValues(Bi))),Ri in e&&(this.reasons=l(e,Ri,s.defaultValues(Ri))),Ti in e&&(this.cRLIssuer=l(e,Ti,s.defaultValues(Ti))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Bi:return[];case Ri:return new Ze;case Ti:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ft({value:[new q({name:t.distributionPoint||v,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new $e({name:t.distributionPointNames||v,value:St.schema()})]}),new q({name:t.distributionPoint||v,optional:!0,idBlock:{tagClass:3,tagNumber:1},value:dt.schema().valueBlock.value})]})]}),new Le({name:t.reasons||v,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new q({name:t.cRLIssuer||v,optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[new $e({name:t.cRLIssuerNames||v,value:St.schema()})]})]})}fromSchema(e){Z(e,Vg);const t=he(e,e,s.schema({names:{distributionPoint:Bi,distributionPointNames:md,reasons:Ri,cRLIssuer:Ti,cRLIssuerNames:gd}}));oe.assertSchema(t,this.className),Bi in t.result&&(0===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=Array.from(t.result.distributionPointNames,i=>new St({schema:i}))),1===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=new dt({schema:new O({value:t.result.distributionPoint.valueBlock.value})}))),Ri in t.result&&(this.reasons=new Ze({valueHex:t.result.reasons.valueBlock.valueHex})),Ti in t.result&&(this.cRLIssuer=Array.from(t.result.cRLIssuerNames,i=>new St({schema:i})))}toSchema(){const e=[];if(this.distributionPoint){let t;t=new q(this.distributionPoint instanceof Array?{idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,i=>i.toSchema())}:{idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]}),e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}return this.reasons&&e.push(new Le({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHexView})),this.cRLIssuer&&e.push(new q({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={};return this.distributionPoint&&(e.distributionPoint=this.distributionPoint instanceof Array?Array.from(this.distributionPoint,t=>t.toJSON()):this.distributionPoint.toJSON()),this.reasons&&(e.reasons=this.reasons.toJSON()),this.cRLIssuer&&(e.cRLIssuer=Array.from(this.cRLIssuer,t=>t.toJSON())),e}}return s.CLASS_NAME="DistributionPoint",s})();const Ba="distributionPoints",Og=[Ba];let vd=(()=>{class s extends fe{constructor(e={}){super(),this.distributionPoints=l(e,Ba,s.defaultValues(Ba)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Ba?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new $e({name:t.distributionPoints||v,value:pd.schema()})]})}fromSchema(e){Z(e,Og);const t=he(e,e,s.schema({names:{distributionPoints:Ba}}));oe.assertSchema(t,this.className),this.distributionPoints=Array.from(t.result.distributionPoints,i=>new pd({schema:i}))}toSchema(){return new O({value:Array.from(this.distributionPoints,e=>e.toSchema())})}toJSON(){return{distributionPoints:Array.from(this.distributionPoints,e=>e.toJSON())}}}return s.CLASS_NAME="CRLDistributionPoints",s})();const Ra="keyPurposes",Pg=[Ra];let Dg=(()=>{class s extends fe{constructor(e={}){super(),this.keyPurposes=l(e,Ra,s.defaultValues(Ra)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Ra?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new $e({name:t.keyPurposes||v,value:new Ve})]})}fromSchema(e){Z(e,Pg);const t=he(e,e,s.schema({names:{keyPurposes:Ra}}));oe.assertSchema(t,this.className),this.keyPurposes=Array.from(t.result.keyPurposes,i=>i.valueBlock.toString())}toSchema(){return new O({value:Array.from(this.keyPurposes,e=>new Ve({value:e}))})}toJSON(){return{keyPurposes:Array.from(this.keyPurposes)}}}return s.CLASS_NAME="ExtKeyUsage",s})();const Ta="accessDescriptions";let wd=(()=>{class s extends fe{constructor(e={}){super(),this.accessDescriptions=l(e,Ta,s.defaultValues(Ta)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Ta?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new $e({name:t.accessDescriptions||v,value:Kf.schema()})]})}fromSchema(e){Z(e,[Ta]);const t=he(e,e,s.schema({names:{accessDescriptions:Ta}}));oe.assertSchema(t,this.className),this.accessDescriptions=Array.from(t.result.accessDescriptions,i=>new Kf({schema:i}))}toSchema(){return new O({value:Array.from(this.accessDescriptions,e=>e.toSchema())})}toJSON(){return{accessDescriptions:Array.from(this.accessDescriptions,e=>e.toJSON())}}}return s.CLASS_NAME="InfoAccess",s})();const xi="distributionPoint",yd="distributionPointNames",Os="onlyContainsUserCerts",Ps="onlyContainsCACerts",Ds="onlySomeReasons",Us="indirectCRL",Ms="onlyContainsAttributeCerts",Ug=[xi,yd,Os,Ps,Ds,Us,Ms];let Mg=(()=>{class s extends fe{constructor(e={}){super(),xi in e&&(this.distributionPoint=l(e,xi,s.defaultValues(xi))),this.onlyContainsUserCerts=l(e,Os,s.defaultValues(Os)),this.onlyContainsCACerts=l(e,Ps,s.defaultValues(Ps)),Ds in e&&(this.onlySomeReasons=l(e,Ds,s.defaultValues(Ds))),this.indirectCRL=l(e,Us,s.defaultValues(Us)),this.onlyContainsAttributeCerts=l(e,Ms,s.defaultValues(Ms)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xi:return[];case Os:case Ps:return!1;case Ds:return 0;case Us:case Ms:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ft({value:[new q({name:t.distributionPoint||v,idBlock:{tagClass:3,tagNumber:0},value:[new $e({name:t.distributionPointNames||v,value:St.schema()})]}),new q({name:t.distributionPoint||v,idBlock:{tagClass:3,tagNumber:1},value:dt.schema().valueBlock.value})]})]}),new Le({name:t.onlyContainsUserCerts||v,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Le({name:t.onlyContainsCACerts||v,optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new Le({name:t.onlySomeReasons||v,optional:!0,idBlock:{tagClass:3,tagNumber:3}}),new Le({name:t.indirectCRL||v,optional:!0,idBlock:{tagClass:3,tagNumber:4}}),new Le({name:t.onlyContainsAttributeCerts||v,optional:!0,idBlock:{tagClass:3,tagNumber:5}})]})}fromSchema(e){Z(e,Ug);const t=he(e,e,s.schema({names:{distributionPoint:xi,distributionPointNames:yd,onlyContainsUserCerts:Os,onlyContainsCACerts:Ps,onlySomeReasons:Ds,indirectCRL:Us,onlyContainsAttributeCerts:Ms}}));if(oe.assertSchema(t,this.className),xi in t.result)switch(!0){case 0===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=Array.from(t.result.distributionPointNames,i=>new St({schema:i}));break;case 1===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=new dt({schema:new O({value:t.result.distributionPoint.valueBlock.value})});break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}if(Os in t.result){const i=new Uint8Array(t.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=0!==i[0]}if(Ps in t.result){const i=new Uint8Array(t.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=0!==i[0]}if(Ds in t.result){const i=new Uint8Array(t.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=i[0]}if(Us in t.result){const i=new Uint8Array(t.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=0!==i[0]}if(Ms in t.result){const i=new Uint8Array(t.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=0!==i[0]}}toSchema(){const e=[];if(this.distributionPoint){let t;this.distributionPoint instanceof Array?t=new q({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,i=>i.toSchema())}):(t=this.distributionPoint.toSchema(),t.idBlock.tagClass=3,t.idBlock.tagNumber=1),e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(this.onlyContainsUserCerts!==s.defaultValues(Os)&&e.push(new Le({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsCACerts!==s.defaultValues(Ps)&&e.push(new Le({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer})),void 0!==this.onlySomeReasons){const t=new ArrayBuffer(1);new Uint8Array(t)[0]=this.onlySomeReasons,e.push(new Le({idBlock:{tagClass:3,tagNumber:3},valueHex:t}))}return this.indirectCRL!==s.defaultValues(Us)&&e.push(new Le({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsAttributeCerts!==s.defaultValues(Ms)&&e.push(new Le({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer})),new O({value:e})}toJSON(){const e={};return this.distributionPoint&&(e.distributionPoint=this.distributionPoint instanceof Array?Array.from(this.distributionPoint,t=>t.toJSON()):this.distributionPoint.toJSON()),this.onlyContainsUserCerts!==s.defaultValues(Os)&&(e.onlyContainsUserCerts=this.onlyContainsUserCerts),this.onlyContainsCACerts!==s.defaultValues(Ps)&&(e.onlyContainsCACerts=this.onlyContainsCACerts),Ds in this&&(e.onlySomeReasons=this.onlySomeReasons),this.indirectCRL!==s.defaultValues(Us)&&(e.indirectCRL=this.indirectCRL),this.onlyContainsAttributeCerts!==s.defaultValues(Ms)&&(e.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),e}}return s.CLASS_NAME="IssuingDistributionPoint",s})();const xa="base",Gr="minimum",Ls="maximum",Lg=[xa,Gr,Ls];let Kl=(()=>{class s extends fe{constructor(e={}){super(),this.base=l(e,xa,s.defaultValues(xa)),this.minimum=l(e,Gr,s.defaultValues(Gr)),Ls in e&&(this.maximum=l(e,Ls,s.defaultValues(Ls))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xa:return new St;case Gr:case Ls:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[St.schema(t.base||{}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new X({name:t.minimum||v})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new X({name:t.maximum||v})]})]})}fromSchema(e){Z(e,Lg);const t=he(e,e,s.schema({names:{base:{names:{blockName:xa}},minimum:Gr,maximum:Ls}}));oe.assertSchema(t,this.className),this.base=new St({schema:t.result.base}),Gr in t.result&&(this.minimum=t.result.minimum.valueBlock.isHexOnly?t.result.minimum:t.result.minimum.valueBlock.valueDec),Ls in t.result&&(this.maximum=t.result.maximum.valueBlock.isHexOnly?t.result.maximum:t.result.maximum.valueBlock.valueDec)}toSchema(){const e=[];if(e.push(this.base.toSchema()),0!==this.minimum){let t=0;t=this.minimum instanceof X?this.minimum:new X({value:this.minimum}),e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(Ls in this){let t=0;t=this.maximum instanceof X?this.maximum:new X({value:this.maximum}),e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[t]}))}return new O({value:e})}toJSON(){const e={base:this.base.toJSON()};return 0!==this.minimum&&(e.minimum="number"==typeof this.minimum?this.minimum:this.minimum.toJSON()),void 0!==this.maximum&&(e.maximum="number"==typeof this.maximum?this.maximum:this.maximum.toJSON()),e}}return s.CLASS_NAME="GeneralSubtree",s})();const Vi="permittedSubtrees",Oi="excludedSubtrees",Fg=[Vi,Oi];let Hg=(()=>{class s extends fe{constructor(e={}){super(),Vi in e&&(this.permittedSubtrees=l(e,Vi,s.defaultValues(Vi))),Oi in e&&(this.excludedSubtrees=l(e,Oi,s.defaultValues(Oi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Vi:case Oi:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new $e({name:t.permittedSubtrees||v,value:Kl.schema()})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new $e({name:t.excludedSubtrees||v,value:Kl.schema()})]})]})}fromSchema(e){Z(e,Fg);const t=he(e,e,s.schema({names:{permittedSubtrees:Vi,excludedSubtrees:Oi}}));oe.assertSchema(t,this.className),Vi in t.result&&(this.permittedSubtrees=Array.from(t.result.permittedSubtrees,i=>new Kl({schema:i}))),Oi in t.result&&(this.excludedSubtrees=Array.from(t.result.excludedSubtrees,i=>new Kl({schema:i})))}toSchema(){const e=[];return this.permittedSubtrees&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.permittedSubtrees,t=>t.toSchema())})),this.excludedSubtrees&&e.push(new q({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.excludedSubtrees,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={};return this.permittedSubtrees&&(e.permittedSubtrees=Array.from(this.permittedSubtrees,t=>t.toJSON())),this.excludedSubtrees&&(e.excludedSubtrees=Array.from(this.excludedSubtrees,t=>t.toJSON())),e}}return s.CLASS_NAME="NameConstraints",s})();const hs="requireExplicitPolicy",fs="inhibitPolicyMapping",jg=[hs,fs];let $g=(()=>{class s extends fe{constructor(e={}){super(),hs in e&&(this.requireExplicitPolicy=l(e,hs,s.defaultValues(hs))),fs in e&&(this.inhibitPolicyMapping=l(e,fs,s.defaultValues(fs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hs:case fs:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Le({name:t.requireExplicitPolicy||v,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Le({name:t.inhibitPolicyMapping||v,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){Z(e,jg);const t=he(e,e,s.schema({names:{requireExplicitPolicy:hs,inhibitPolicyMapping:fs}}));if(oe.assertSchema(t,this.className),hs in t.result){const i=t.result.requireExplicitPolicy;i.idBlock.tagClass=1,i.idBlock.tagNumber=2;const o=ct(i.toBER(!1));oe.assert(o,"Integer"),this.requireExplicitPolicy=o.result.valueBlock.valueDec}if(fs in t.result){const i=t.result.inhibitPolicyMapping;i.idBlock.tagClass=1,i.idBlock.tagNumber=2;const o=ct(i.toBER(!1));oe.assert(o,"Integer"),this.inhibitPolicyMapping=o.result.valueBlock.valueDec}}toSchema(){const e=[];if(hs in this){const t=new X({value:this.requireExplicitPolicy});t.idBlock.tagClass=3,t.idBlock.tagNumber=0,e.push(t)}if(fs in this){const t=new X({value:this.inhibitPolicyMapping});t.idBlock.tagClass=3,t.idBlock.tagNumber=1,e.push(t)}return new O({value:e})}toJSON(){const e={};return hs in this&&(e.requireExplicitPolicy=this.requireExplicitPolicy),fs in this&&(e.inhibitPolicyMapping=this.inhibitPolicyMapping),e}}return s.CLASS_NAME="PolicyConstraints",s})();const Va="issuerDomainPolicy",Oa="subjectDomainPolicy",Kg=[Va,Oa];let Sd=(()=>{class s extends fe{constructor(e={}){super(),this.issuerDomainPolicy=l(e,Va,s.defaultValues(Va)),this.subjectDomainPolicy=l(e,Oa,s.defaultValues(Oa)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Va:case Oa:return v;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.issuerDomainPolicy||v}),new Ve({name:t.subjectDomainPolicy||v})]})}fromSchema(e){Z(e,Kg);const t=he(e,e,s.schema({names:{issuerDomainPolicy:Va,subjectDomainPolicy:Oa}}));oe.assertSchema(t,this.className),this.issuerDomainPolicy=t.result.issuerDomainPolicy.valueBlock.toString(),this.subjectDomainPolicy=t.result.subjectDomainPolicy.valueBlock.toString()}toSchema(){return new O({value:[new Ve({value:this.issuerDomainPolicy}),new Ve({value:this.subjectDomainPolicy})]})}toJSON(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}return s.CLASS_NAME="PolicyMapping",s})();const Pa="mappings",Gg=[Pa];let Jg=(()=>{class s extends fe{constructor(e={}){super(),this.mappings=l(e,Pa,s.defaultValues(Pa)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Pa?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new $e({name:t.mappings||v,value:Sd.schema()})]})}fromSchema(e){Z(e,Gg);const t=he(e,e,s.schema({names:{mappings:Pa}}));oe.assertSchema(t,this.className),this.mappings=Array.from(t.result.mappings,i=>new Sd({schema:i}))}toSchema(){return new O({value:Array.from(this.mappings,e=>e.toSchema())})}toJSON(){return{mappings:Array.from(this.mappings,e=>e.toJSON())}}}return s.CLASS_NAME="PolicyMappings",s})();const Fs="notBefore",Hs="notAfter",qg=[Fs,Hs];let Wg=(()=>{class s extends fe{constructor(e={}){super(),Fs in e&&(this.notBefore=l(e,Fs,s.defaultValues(Fs))),Hs in e&&(this.notAfter=l(e,Hs,s.defaultValues(Hs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fs:case Hs:return new Date;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Le({name:t.notBefore||v,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Le({name:t.notAfter||v,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){Z(e,qg);const t=he(e,e,s.schema({names:{notBefore:Fs,notAfter:Hs}}));if(oe.assertSchema(t,this.className),Fs in t.result){const i=new ht;i.fromBuffer(t.result.notBefore.valueBlock.valueHex),this.notBefore=i.toDate()}if(Hs in t.result){const i=new ht({valueHex:t.result.notAfter.valueBlock.valueHex});i.fromBuffer(t.result.notAfter.valueBlock.valueHex),this.notAfter=i.toDate()}}toSchema(){const e=[];return Fs in this&&e.push(new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:new ht({valueDate:this.notBefore}).valueBlock.valueHexView})),Hs in this&&e.push(new Le({idBlock:{tagClass:3,tagNumber:1},valueHex:new ht({valueDate:this.notAfter}).valueBlock.valueHexView})),new O({value:e})}toJSON(){const e={};return this.notBefore&&(e.notBefore=this.notBefore),this.notAfter&&(e.notAfter=this.notAfter),e}}return s.CLASS_NAME="PrivateKeyUsagePeriod",s})();const Jr="id",ds="type",qr="values",zg=[Jr,ds],Yg=[qr];let bd=(()=>{class s extends fe{constructor(e={}){super(),this.id=l(e,Jr,s.defaultValues(Jr)),ds in e&&(this.type=l(e,ds,s.defaultValues(ds))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Jr:return v;case ds:return new kt;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Jr:return t===v;case ds:return t instanceof kt;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.id||v}),new Fe({name:t.type||v,optional:!0})]})}fromSchema(e){Z(e,zg);const t=he(e,e,s.schema({names:{id:Jr,type:ds}}));oe.assertSchema(t,this.className),this.id=t.result.id.valueBlock.toString(),ds in t.result&&(this.type=t.result.type)}toSchema(){const e=[new Ve({value:this.id})];return ds in this&&e.push(this.type),new O({value:e})}toJSON(){const e={id:this.id};return this.type&&(e.type=this.type.toJSON()),e}}return s.CLASS_NAME="QCStatement",s})(),Xg=(()=>{class s extends fe{constructor(e={}){super(),this.values=l(e,qr,s.defaultValues(qr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===qr?[]:super.defaultValues(e)}static compareWithDefault(e,t){return e===qr?0===t.length:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new $e({name:t.values||v,value:bd.schema(t.value||{})})]})}fromSchema(e){Z(e,Yg);const t=he(e,e,s.schema({names:{values:qr}}));oe.assertSchema(t,this.className),this.values=Array.from(t.result.values,i=>new bd({schema:i}))}toSchema(){return new O({value:Array.from(this.values,e=>e.toSchema())})}toJSON(){return{values:Array.from(this.values,e=>e.toJSON())}}}return s.CLASS_NAME="QCStatements",s})();var Pi;class js{static register(r,e,t){this.namedCurves[r.toLowerCase()]=this.namedCurves[e]={name:r,id:e,size:t}}static find(r){return this.namedCurves[r.toLowerCase()]||null}}Pi=js,js.namedCurves={},Pi.register("P-256","1.2.840.10045.3.1.7",32),Pi.register("P-384","1.3.132.0.34",48),Pi.register("P-521","1.3.132.0.35",66),Pi.register("brainpoolP256r1","1.3.36.3.3.2.8.1.1.7",32),Pi.register("brainpoolP384r1","1.3.36.3.3.2.8.1.1.11",48),Pi.register("brainpoolP512r1","1.3.36.3.3.2.8.1.1.13",64);const ql="namedCurve";let $s=(()=>{class s extends fe{constructor(e={}){super(),this.x=l(e,"x",s.defaultValues("x")),this.y=l(e,"y",s.defaultValues("y")),this.namedCurve=l(e,ql,s.defaultValues(ql)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"x":case"y":return Ct;case ql:return v;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"x":case"y":return t instanceof ArrayBuffer&&ne(t,s.defaultValues(e));case ql:return"string"==typeof t&&t===s.defaultValues(e);default:return super.defaultValues(e)}}static schema(){return new Ul}fromSchema(e){const t=A._H.toUint8Array(e);if(4!==t[0])throw new Error("Object's schema was not verified against input data for ECPublicKey");const i=js.find(this.namedCurve);if(!i)throw new Error(`Incorrect curve OID: ${this.namedCurve}`);const a=i.size;if(t.byteLength!==2*a+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.namedCurve=i.name,this.x=t.slice(1,a+1).buffer,this.y=t.slice(1+a,2*a+1).buffer}toSchema(){return new Ul({data:R(new Uint8Array([4]).buffer,this.x,this.y)})}toJSON(){const e=js.find(this.namedCurve);return{crv:e?e.name:this.namedCurve,x:Te(J(this.x),!0,!0,!1),y:Te(J(this.y),!0,!0,!1)}}fromJSON(e){et.assert("json",e,"crv","x","y");let t=0;const i=js.find(e.crv);i&&(this.namedCurve=i.id,t=i.size);const a=_e(H(e.x,!0));if(a.byteLength<t){this.x=new ArrayBuffer(t);const u=new Uint8Array(this.x),h=new Uint8Array(a);u.set(h,1)}else this.x=a.slice(0,t);const o=_e(H(e.y,!0));if(o.byteLength<t){this.y=new ArrayBuffer(t);const u=new Uint8Array(this.y),h=new Uint8Array(o);u.set(h,1)}else this.y=o.slice(0,t)}}return s.CLASS_NAME="ECPublicKey",s})();const Da="modulus",Ua="publicExponent",Qg=[Da,Ua];let Ad=(()=>{class s extends fe{constructor(e={}){super(),this.modulus=l(e,Da,s.defaultValues(Da)),this.publicExponent=l(e,Ua,s.defaultValues(Ua)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Da:case Ua:return new X;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.modulus||v}),new X({name:t.publicExponent||v})]})}fromSchema(e){Z(e,Qg);const t=he(e,e,s.schema({names:{modulus:Da,publicExponent:Ua}}));oe.assertSchema(t,this.className),this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent}toSchema(){return new O({value:[this.modulus.convertToDER(),this.publicExponent]})}toJSON(){return{n:A.U$.ToBase64Url(this.modulus.valueBlock.valueHexView),e:A.U$.ToBase64Url(this.publicExponent.valueBlock.valueHexView)}}fromJSON(e){et.assert("json",e,"n","e");const t=_e(H(e.n,!0));this.modulus=new X({valueHex:t.slice(0,Math.pow(2,ke(t.byteLength)))}),this.publicExponent=new X({valueHex:_e(H(e.e,!0)).slice(0,3)})}}return s.CLASS_NAME="RSAPublicKey",s})();const Ma="algorithm",La="subjectPublicKey",Zg=[Ma,La];let ns=(()=>{class s extends fe{get parsedKey(){if(void 0===this._parsedKey){switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":if("algorithmParams"in this.algorithm&&this.algorithm.algorithmParams.constructor.blockName()===Ve.blockName())try{this._parsedKey=new $s({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHexView})}catch{}break;case"1.2.840.113549.1.1.1":{const e=ct(this.subjectPublicKey.valueBlock.valueHexView);if(-1!==e.offset)try{this._parsedKey=new Ad({schema:e.result})}catch{}}}this._parsedKey||(this._parsedKey=null)}return this._parsedKey||void 0}set parsedKey(e){this._parsedKey=e}constructor(e={}){super(),this.algorithm=l(e,Ma,s.defaultValues(Ma)),this.subjectPublicKey=l(e,La,s.defaultValues(La));const t=l(e,"parsedKey",null);t&&(this.parsedKey=t),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ma:return new Q;case La:return new Ze;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Q.schema(t.algorithm||{}),new Ze({name:t.subjectPublicKey||v})]})}fromSchema(e){Z(e,Zg);const t=he(e,e,s.schema({names:{algorithm:{names:{blockName:Ma}},subjectPublicKey:La}}));oe.assertSchema(t,this.className),this.algorithm=new Q({schema:t.result.algorithm}),this.subjectPublicKey=t.result.subjectPublicKey}toSchema(){return new O({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}toJSON(){if(!this.parsedKey)return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()};const e={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();return Object.assign(e,t),e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new $s({json:e}),this.algorithm=new Q({algorithmId:"1.2.840.10045.2.1",algorithmParams:new Ve({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new Ad({json:e}),this.algorithm=new Q({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new kt});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.subjectPublicKey=new Ze({valueHex:this.parsedKey.toSchema().toBER(!1)})}}importKey(e,t=Ge(!0)){var i=this;return(0,k.A)(function*(){try{if(!e)throw new Error("Need to provide publicKey input parameter");const o=ct(yield t.exportKey("spki",e));try{i.fromSchema(o.result)}catch{throw new Error("Error during initializing object from schema")}}catch(a){const o=a instanceof Error?a.message:`${a}`;throw new Error(`Error during exporting public key: ${o}`)}})()}}return s.CLASS_NAME="PublicKeyInfo",s})();const Wr="version",zr="privateKey",Qt="namedCurve",Ks="publicKey",ep=[Wr,zr,Qt,Ks];let Ed=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,Wr,s.defaultValues(Wr)),this.privateKey=l(e,zr,s.defaultValues(zr)),Qt in e&&(this.namedCurve=l(e,Qt,s.defaultValues(Qt))),Ks in e&&(this.publicKey=l(e,Ks,s.defaultValues(Ks))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Wr:return 1;case zr:return new de;case Qt:return v;case Ks:return new $s;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Wr:return t===s.defaultValues(e);case zr:return t.isEqual(s.defaultValues(e));case Qt:return t===v;case Ks:return $s.compareWithDefault(Qt,t.namedCurve)&&$s.compareWithDefault("x",t.x)&&$s.compareWithDefault("y",t.y);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.version||v}),new de({name:t.privateKey||v}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ve({name:t.namedCurve||v})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Ze({name:t.publicKey||v})]})]})}fromSchema(e){Z(e,ep);const t=he(e,e,s.schema({names:{version:Wr,privateKey:zr,namedCurve:Qt,publicKey:Ks}}));if(oe.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.privateKey=t.result.privateKey,Qt in t.result&&(this.namedCurve=t.result.namedCurve.valueBlock.toString()),Ks in t.result){const i={schema:t.result.publicKey.valueBlock.valueHex};Qt in this&&(i.namedCurve=this.namedCurve),this.publicKey=new $s(i)}}toSchema(){const e=[new X({value:this.version}),this.privateKey];return this.namedCurve&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[new Ve({value:this.namedCurve})]})),this.publicKey&&e.push(new q({idBlock:{tagClass:3,tagNumber:1},value:[new Ze({valueHex:this.publicKey.toSchema().toBER(!1)})]})),new O({value:e})}toJSON(){if(!this.namedCurve||s.compareWithDefault(Qt,this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');const e=js.find(this.namedCurve),t={crv:e?e.name:this.namedCurve,d:A.U$.ToBase64Url(this.privateKey.valueBlock.valueHexView)};if(this.publicKey){const i=this.publicKey.toJSON();t.x=i.x,t.y=i.y}return t}fromJSON(e){et.assert("json",e,"crv","d");let t=0;const i=js.find(e.crv);i&&(this.namedCurve=i.id,t=i.size);const a=A.U$.FromBase64Url(e.d);if(a.byteLength<t){const o=new ArrayBuffer(t),u=new Uint8Array(o),h=new Uint8Array(a);u.set(h,1),this.privateKey=new de({valueHex:o})}else this.privateKey=new de({valueHex:a.slice(0,t)});e.x&&e.y&&(this.publicKey=new $s({json:e}))}}return s.CLASS_NAME="ECPrivateKey",s})();const Fa="prime",Ha="exponent",ja="coefficient",tp=[Fa,Ha,ja];let ku=(()=>{class s extends fe{constructor(e={}){super(),this.prime=l(e,Fa,s.defaultValues(Fa)),this.exponent=l(e,Ha,s.defaultValues(Ha)),this.coefficient=l(e,ja,s.defaultValues(ja)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fa:case Ha:case ja:return new X;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.prime||v}),new X({name:t.exponent||v}),new X({name:t.coefficient||v})]})}fromSchema(e){Z(e,tp);const t=he(e,e,s.schema({names:{prime:Fa,exponent:Ha,coefficient:ja}}));oe.assertSchema(t,this.className),this.prime=t.result.prime.convertFromDER(),this.exponent=t.result.exponent.convertFromDER(),this.coefficient=t.result.coefficient.convertFromDER()}toSchema(){return new O({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}toJSON(){return{r:A.U$.ToBase64Url(this.prime.valueBlock.valueHexView),d:A.U$.ToBase64Url(this.exponent.valueBlock.valueHexView),t:A.U$.ToBase64Url(this.coefficient.valueBlock.valueHexView)}}fromJSON(e){et.assert("json",e,"r","d","r"),this.prime=new X({valueHex:A.U$.FromBase64Url(e.r)}),this.exponent=new X({valueHex:A.U$.FromBase64Url(e.d)}),this.coefficient=new X({valueHex:A.U$.FromBase64Url(e.t)})}}return s.CLASS_NAME="OtherPrimeInfo",s})();const $a="version",Ka="modulus",Ga="publicExponent",Ja="privateExponent",qa="prime1",Wa="prime2",za="exponent1",Ya="exponent2",Xa="coefficient",Di="otherPrimeInfos",sp=[$a,Ka,Ga,Ja,qa,Wa,za,Ya,Xa,Di];let kd=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,$a,s.defaultValues($a)),this.modulus=l(e,Ka,s.defaultValues(Ka)),this.publicExponent=l(e,Ga,s.defaultValues(Ga)),this.privateExponent=l(e,Ja,s.defaultValues(Ja)),this.prime1=l(e,qa,s.defaultValues(qa)),this.prime2=l(e,Wa,s.defaultValues(Wa)),this.exponent1=l(e,za,s.defaultValues(za)),this.exponent2=l(e,Ya,s.defaultValues(Ya)),this.coefficient=l(e,Xa,s.defaultValues(Xa)),Di in e&&(this.otherPrimeInfos=l(e,Di,s.defaultValues(Di))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $a:return 0;case Ka:case Ga:case Ja:case qa:case Wa:case za:case Ya:case Xa:return new X;case Di:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.version||v}),new X({name:t.modulus||v}),new X({name:t.publicExponent||v}),new X({name:t.privateExponent||v}),new X({name:t.prime1||v}),new X({name:t.prime2||v}),new X({name:t.exponent1||v}),new X({name:t.exponent2||v}),new X({name:t.coefficient||v}),new O({optional:!0,value:[new $e({name:t.otherPrimeInfosName||v,value:ku.schema(t.otherPrimeInfo||{})})]})]})}fromSchema(e){Z(e,sp);const t=he(e,e,s.schema({names:{version:$a,modulus:Ka,publicExponent:Ga,privateExponent:Ja,prime1:qa,prime2:Wa,exponent1:za,exponent2:Ya,coefficient:Xa,otherPrimeInfo:{names:{blockName:Di}}}}));oe.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent,this.privateExponent=t.result.privateExponent.convertFromDER(256),this.prime1=t.result.prime1.convertFromDER(128),this.prime2=t.result.prime2.convertFromDER(128),this.exponent1=t.result.exponent1.convertFromDER(128),this.exponent2=t.result.exponent2.convertFromDER(128),this.coefficient=t.result.coefficient.convertFromDER(128),Di in t.result&&(this.otherPrimeInfos=Array.from(t.result.otherPrimeInfos,i=>new ku({schema:i})))}toSchema(){const e=[];return e.push(new X({value:this.version})),e.push(this.modulus.convertToDER()),e.push(this.publicExponent),e.push(this.privateExponent.convertToDER()),e.push(this.prime1.convertToDER()),e.push(this.prime2.convertToDER()),e.push(this.exponent1.convertToDER()),e.push(this.exponent2.convertToDER()),e.push(this.coefficient.convertToDER()),this.otherPrimeInfos&&e.push(new O({value:Array.from(this.otherPrimeInfos,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={n:A.U$.ToBase64Url(this.modulus.valueBlock.valueHexView),e:A.U$.ToBase64Url(this.publicExponent.valueBlock.valueHexView),d:A.U$.ToBase64Url(this.privateExponent.valueBlock.valueHexView),p:A.U$.ToBase64Url(this.prime1.valueBlock.valueHexView),q:A.U$.ToBase64Url(this.prime2.valueBlock.valueHexView),dp:A.U$.ToBase64Url(this.exponent1.valueBlock.valueHexView),dq:A.U$.ToBase64Url(this.exponent2.valueBlock.valueHexView),qi:A.U$.ToBase64Url(this.coefficient.valueBlock.valueHexView)};return this.otherPrimeInfos&&(e.oth=Array.from(this.otherPrimeInfos,t=>t.toJSON())),e}fromJSON(e){et.assert("json",e,"n","e","d","p","q","dp","dq","qi"),this.modulus=new X({valueHex:A.U$.FromBase64Url(e.n)}),this.publicExponent=new X({valueHex:A.U$.FromBase64Url(e.e)}),this.privateExponent=new X({valueHex:A.U$.FromBase64Url(e.d)}),this.prime1=new X({valueHex:A.U$.FromBase64Url(e.p)}),this.prime2=new X({valueHex:A.U$.FromBase64Url(e.q)}),this.exponent1=new X({valueHex:A.U$.FromBase64Url(e.dp)}),this.exponent2=new X({valueHex:A.U$.FromBase64Url(e.dq)}),this.coefficient=new X({valueHex:A.U$.FromBase64Url(e.qi)}),e.oth&&(this.otherPrimeInfos=Array.from(e.oth,t=>new ku({json:t})))}}return s.CLASS_NAME="RSAPrivateKey",s})();const Qa="version",Za="privateKeyAlgorithm",eo="privateKey",Ui="attributes",Wl="parsedKey",ip=[Qa,Za,eo,Ui];let Yr=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,Qa,s.defaultValues(Qa)),this.privateKeyAlgorithm=l(e,Za,s.defaultValues(Za)),this.privateKey=l(e,eo,s.defaultValues(eo)),Ui in e&&(this.attributes=l(e,Ui,s.defaultValues(Ui))),Wl in e&&(this.parsedKey=l(e,Wl,s.defaultValues(Wl))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qa:return 0;case Za:return new Q;case eo:return new de;case Ui:return[];case Wl:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.version||v}),Q.schema(t.privateKeyAlgorithm||{}),new de({name:t.privateKey||v}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new $e({name:t.attributes||v,value:tt.schema()})]})]})}fromSchema(e){Z(e,ip);const t=he(e,e,s.schema({names:{version:Qa,privateKeyAlgorithm:{names:{blockName:Za}},privateKey:eo,attributes:Ui}}));switch(oe.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.privateKeyAlgorithm=new Q({schema:t.result.privateKeyAlgorithm}),this.privateKey=t.result.privateKey,Ui in t.result&&(this.attributes=Array.from(t.result.attributes,i=>new tt({schema:i}))),this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":{const i=ct(this.privateKey.valueBlock.valueHexView);-1!==i.offset&&(this.parsedKey=new kd({schema:i.result}))}break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm&&this.privateKeyAlgorithm.algorithmParams instanceof Ve){const i=ct(this.privateKey.valueBlock.valueHexView);-1!==i.offset&&(this.parsedKey=new Ed({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:i.result}))}}}toSchema(){const e=[new X({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];return this.attributes&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,t=>t.toSchema())})),new O({value:e})}toJSON(){if(!this.parsedKey){const i={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};return this.attributes&&(i.attributes=Array.from(this.attributes,a=>a.toJSON())),i}const e={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();return Object.assign(e,t),e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new Ed({json:e}),this.privateKeyAlgorithm=new Q({algorithmId:"1.2.840.10045.2.1",algorithmParams:new Ve({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new kd({json:e}),this.privateKeyAlgorithm=new Q({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new kt});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.privateKey=new de({valueHex:this.parsedKey.toSchema().toBER(!1)})}}}return s.CLASS_NAME="PrivateKeyInfo",s})();const Xr="contentType",Qr="contentEncryptionAlgorithm",Mi="encryptedContent",rp=[Xr,Qr,Mi];let Dt=(()=>{class s extends fe{constructor(e={}){if(super(),this.contentType=l(e,Xr,s.defaultValues(Xr)),this.contentEncryptionAlgorithm=l(e,Qr,s.defaultValues(Qr)),Mi in e&&e.encryptedContent&&(this.encryptedContent=e.encryptedContent,1===this.encryptedContent.idBlock.tagClass&&4===this.encryptedContent.idBlock.tagNumber&&!1===this.encryptedContent.idBlock.isConstructed&&!e.disableSplit)){const t=new de({idBlock:{isConstructed:!0},isConstructed:!0});let i=0;const a=this.encryptedContent.valueBlock.valueHexView.slice().buffer;let o=a.byteLength;for(;o>0;){const u=new Uint8Array(a,i,i+1024>a.byteLength?a.byteLength-i:1024),h=new ArrayBuffer(u.length),m=new Uint8Array(h);for(let N=0;N<m.length;N++)m[N]=u[N];t.valueBlock.value.push(new de({valueHex:h})),o-=u.length,i+=u.length}this.encryptedContent=t}e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Xr:return v;case Qr:return new Q;case Mi:return new de;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Xr:return t===v;case Qr:return t.algorithmId===v&&!("algorithmParams"in t);case Mi:return t.isEqual(s.defaultValues(Mi));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.contentType||v}),Q.schema(t.contentEncryptionAlgorithm||{}),new ft({value:[new q({name:t.encryptedContent||v,idBlock:{tagClass:3,tagNumber:0},value:[new $e({value:new de})]}),new Le({name:t.encryptedContent||v,idBlock:{tagClass:3,tagNumber:0}})]})]})}fromSchema(e){Z(e,rp);const t=he(e,e,s.schema({names:{contentType:Xr,contentEncryptionAlgorithm:{names:{blockName:Qr}},encryptedContent:Mi}}));oe.assertSchema(t,this.className),this.contentType=t.result.contentType.valueBlock.toString(),this.contentEncryptionAlgorithm=new Q({schema:t.result.contentEncryptionAlgorithm}),Mi in t.result&&(this.encryptedContent=t.result.encryptedContent,this.encryptedContent.idBlock.tagClass=1,this.encryptedContent.idBlock.tagNumber=4)}toSchema(){const e={isIndefiniteForm:!1},t=[];if(t.push(new Ve({value:this.contentType})),t.push(this.contentEncryptionAlgorithm.toSchema()),this.encryptedContent){e.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;const i=this.encryptedContent;i.idBlock.tagClass=3,i.idBlock.tagNumber=0,i.lenBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed,t.push(i)}return new O({lenBlock:e,value:t})}toJSON(){const e={contentType:this.contentType,contentEncryptionAlgorithm:this.contentEncryptionAlgorithm.toJSON()};return this.encryptedContent&&(e.encryptedContent=this.encryptedContent.toJSON()),e}getEncryptedContent(){if(!this.encryptedContent)throw new Error("Parameter 'encryptedContent' is undefined");return de.prototype.getValue.call(this.encryptedContent)}}return s.CLASS_NAME="EncryptedContentInfo",s})();const Gs="hashAlgorithm",Js="maskGenAlgorithm",qs="saltLength",Ws="trailerField",np=[Gs,Js,qs,Ws];let _u=(()=>{class s extends fe{constructor(e={}){super(),this.hashAlgorithm=l(e,Gs,s.defaultValues(Gs)),this.maskGenAlgorithm=l(e,Js,s.defaultValues(Js)),this.saltLength=l(e,qs,s.defaultValues(qs)),this.trailerField=l(e,Ws,s.defaultValues(Ws)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Gs:return new Q({algorithmId:"1.3.14.3.2.26",algorithmParams:new kt});case Js:return new Q({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new Q({algorithmId:"1.3.14.3.2.26",algorithmParams:new kt}).toSchema()});case qs:return 20;case Ws:return 1;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[Q.schema(t.hashAlgorithm||{})]}),new q({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[Q.schema(t.maskGenAlgorithm||{})]}),new q({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[new X({name:t.saltLength||v})]}),new q({idBlock:{tagClass:3,tagNumber:3},optional:!0,value:[new X({name:t.trailerField||v})]})]})}fromSchema(e){Z(e,np);const t=he(e,e,s.schema({names:{hashAlgorithm:{names:{blockName:Gs}},maskGenAlgorithm:{names:{blockName:Js}},saltLength:qs,trailerField:Ws}}));oe.assertSchema(t,this.className),Gs in t.result&&(this.hashAlgorithm=new Q({schema:t.result.hashAlgorithm})),Js in t.result&&(this.maskGenAlgorithm=new Q({schema:t.result.maskGenAlgorithm})),qs in t.result&&(this.saltLength=t.result.saltLength.valueBlock.valueDec),Ws in t.result&&(this.trailerField=t.result.trailerField.valueBlock.valueDec)}toSchema(){const e=[];return this.hashAlgorithm.isEqual(s.defaultValues(Gs))||e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(s.defaultValues(Js))||e.push(new q({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.saltLength!==s.defaultValues(qs)&&e.push(new q({idBlock:{tagClass:3,tagNumber:2},value:[new X({value:this.saltLength})]})),this.trailerField!==s.defaultValues(Ws)&&e.push(new q({idBlock:{tagClass:3,tagNumber:3},value:[new X({value:this.trailerField})]})),new O({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(s.defaultValues(Gs))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(s.defaultValues(Js))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.saltLength!==s.defaultValues(qs)&&(e.saltLength=this.saltLength),this.trailerField!==s.defaultValues(Ws)&&(e.trailerField=this.trailerField),e}}return s.CLASS_NAME="RSASSAPSSParams",s})();const Zr="salt",to="iterationCount",Zt="keyLength",ms="prf",ap=[Zr,to,Zt,ms];let so=(()=>{class s extends fe{constructor(e={}){super(),this.salt=l(e,Zr,s.defaultValues(Zr)),this.iterationCount=l(e,to,s.defaultValues(to)),Zt in e&&(this.keyLength=l(e,Zt,s.defaultValues(Zt))),ms in e&&(this.prf=l(e,ms,s.defaultValues(ms))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Zr:return{};case to:return-1;case Zt:return 0;case ms:return new Q({algorithmId:"1.3.14.3.2.26",algorithmParams:new kt});default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new ft({value:[new de({name:t.saltPrimitive||v}),Q.schema(t.saltConstructed||{})]}),new X({name:t.iterationCount||v}),new X({name:t.keyLength||v,optional:!0}),Q.schema(t.prf||{names:{optional:!0}})]})}fromSchema(e){Z(e,ap);const t=he(e,e,s.schema({names:{saltPrimitive:Zr,saltConstructed:{names:{blockName:Zr}},iterationCount:to,keyLength:Zt,prf:{names:{blockName:ms,optional:!0}}}}));oe.assertSchema(t,this.className),this.salt=t.result.salt,this.iterationCount=t.result.iterationCount.valueBlock.valueDec,Zt in t.result&&(this.keyLength=t.result.keyLength.valueBlock.valueDec),ms in t.result&&(this.prf=new Q({schema:t.result.prf}))}toSchema(){const e=[];return e.push(this.salt),e.push(new X({value:this.iterationCount})),Zt in this&&s.defaultValues(Zt)!==this.keyLength&&e.push(new X({value:this.keyLength})),this.prf&&!1===s.defaultValues(ms).isEqual(this.prf)&&e.push(this.prf.toSchema()),new O({value:e})}toJSON(){const e={salt:this.salt.toJSON(),iterationCount:this.iterationCount};return Zt in this&&s.defaultValues(Zt)!==this.keyLength&&(e.keyLength=this.keyLength),this.prf&&!1===s.defaultValues(ms).isEqual(this.prf)&&(e.prf=this.prf.toJSON()),e}}return s.CLASS_NAME="PBKDF2Params",s})();const io="keyDerivationFunc",ro="encryptionScheme",op=[io,ro];let Cd=(()=>{class s extends fe{constructor(e={}){super(),this.keyDerivationFunc=l(e,io,s.defaultValues(io)),this.encryptionScheme=l(e,ro,s.defaultValues(ro)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case io:case ro:return new Q;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Q.schema(t.keyDerivationFunc||{}),Q.schema(t.encryptionScheme||{})]})}fromSchema(e){Z(e,op);const t=he(e,e,s.schema({names:{keyDerivationFunc:{names:{blockName:io}},encryptionScheme:{names:{blockName:ro}}}}));oe.assertSchema(t,this.className),this.keyDerivationFunc=new Q({schema:t.result.keyDerivationFunc}),this.encryptionScheme=new Q({schema:t.result.encryptionScheme})}toSchema(){return new O({value:[this.keyDerivationFunc.toSchema(),this.encryptionScheme.toSchema()]})}toJSON(){return{keyDerivationFunc:this.keyDerivationFunc.toJSON(),encryptionScheme:this.encryptionScheme.toJSON()}}}return s.CLASS_NAME="PBES2Params",s})();class lp{constructor(r){this.crypto=r.crypto,this.subtle="webkitSubtle"in r.crypto?r.crypto.webkitSubtle:r.crypto.subtle,this.name=l(r,"name",v)}encrypt(...r){var e=this;return(0,k.A)(function*(){return e.subtle.encrypt(...r)})()}decrypt(...r){var e=this;return(0,k.A)(function*(){return e.subtle.decrypt(...r)})()}sign(...r){return this.subtle.sign(...r)}verify(...r){var e=this;return(0,k.A)(function*(){return e.subtle.verify(...r)})()}digest(...r){var e=this;return(0,k.A)(function*(){return e.subtle.digest(...r)})()}generateKey(...r){var e=this;return(0,k.A)(function*(){return e.subtle.generateKey(...r)})()}deriveKey(...r){var e=this;return(0,k.A)(function*(){return e.subtle.deriveKey(...r)})()}deriveBits(...r){var e=this;return(0,k.A)(function*(){return e.subtle.deriveBits(...r)})()}wrapKey(...r){var e=this;return(0,k.A)(function*(){return e.subtle.wrapKey(...r)})()}unwrapKey(...r){var e=this;return(0,k.A)(function*(){return e.subtle.unwrapKey(...r)})()}exportKey(...r){return this.subtle.exportKey(...r)}importKey(...r){return this.subtle.importKey(...r)}getRandomValues(r){return this.crypto.getRandomValues(r)}}function Nd(s,r,e,t,i){return Cu.apply(this,arguments)}function Cu(){return(Cu=(0,k.A)(function*(s,r,e,t,i){let a,o,u;switch(s.toUpperCase()){case"SHA-1":a=20,o=64,u=Tm;break;case"SHA-256":a=32,o=64,u=Vm;break;case"SHA-384":a=48,o=128,u=Zm;break;case"SHA-512":a=64,o=128,u=Qm;break;default:throw new Error("Unsupported hashing algorithm")}const h=new Uint8Array(e);let m=(new TextDecoder).decode(e);(new TextEncoder).encode(m).some((le,pe)=>le!==h[pe])&&(m=String.fromCharCode(...h));const T=new Uint8Array(2*m.length+2),K=new DataView(T.buffer);for(let le=0;le<m.length;le++)K.setUint16(2*le,m.charCodeAt(le),!1);K.setUint16(2*m.length,0,!1);const L=new Uint8Array(o).fill(3),re=new Uint8Array(t),Ae=new Uint8Array(o*Math.ceil(re.length/o)).map((le,pe)=>re[pe%re.length]),we=new Uint8Array(o*Math.ceil(T.length/o)).map((le,pe)=>T[pe%T.length]);let se=new Uint8Array(Ae.length+we.length);se.set(Ae),se.set(we,Ae.length);const ye=Math.ceil((r>>3)/a),ae=[];for(let le=0;le<ye;le++){let pe=new Uint8Array(L.length+se.length);pe.set(L),pe.set(se,L.length);for(let Me=0;Me<i;Me++)pe=u(pe);const be=new Uint8Array(o).map((Me,ze)=>pe[ze%pe.length]),Re=Math.ceil(re.length/o)+Math.ceil(T.length/o),xe=[];for(let Me=0;Me<Re;Me++){const ze=Array.from(se.slice(Me*o,(Me+1)*o));let bt=511;for(let Ye=be.length-1;Ye>=0;Ye--)bt>>=8,bt+=be[Ye]+(ze[Ye]||0),ze[Ye]=255&bt;xe.push(...ze)}se=new Uint8Array(xe),ae.push(...pe)}return new Uint8Array(ae.slice(0,r>>3)).buffer})).apply(this,arguments)}function Id(s){const r="string"==typeof s?{name:s}:s;return"hash"in r?{...r,hash:Id(r.hash)}:r}class zl extends lp{importKey(r,e,t,i,a){var o=this;return(0,k.A)(function*(){var u,h,m,N,T,K;let L={};const re=Id(t);switch(r.toLowerCase()){case"raw":return o.subtle.importKey("raw",e,t,i,a);case"spki":{const Ae=ct(A._H.toArrayBuffer(e));oe.assert(Ae,"keyData");const we=new ns;try{we.fromSchema(Ae.result)}catch{throw new ot("Incorrect keyData")}switch(re.name.toUpperCase()){case"RSA-PSS":if(!re.hash)throw new et("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(re.hash.name.toUpperCase()){case"SHA-1":L.alg="PS1";break;case"SHA-256":L.alg="PS256";break;case"SHA-384":L.alg="PS384";break;case"SHA-512":L.alg="PS512";break;default:throw new Error(`Incorrect hash algorithm: ${re.hash.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(a=["verify"],L.kty="RSA",L.ext=i,L.key_ops=a,"1.2.840.113549.1.1.1"!==we.algorithm.algorithmId)throw new Error(`Incorrect public key algorithm: ${we.algorithm.algorithmId}`);if(!L.alg){if(!re.hash)throw new et("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(re.hash.name.toUpperCase()){case"SHA-1":L.alg="RS1";break;case"SHA-256":L.alg="RS256";break;case"SHA-384":L.alg="RS384";break;case"SHA-512":L.alg="RS512";break;default:throw new Error(`Incorrect hash algorithm: ${re.hash.name.toUpperCase()}`)}}const se=we.toJSON();Object.assign(L,se)}break;case"ECDSA":a=["verify"];case"ECDH":{if(L={kty:"EC",ext:i,key_ops:a},"1.2.840.10045.2.1"!==we.algorithm.algorithmId)throw new Error(`Incorrect public key algorithm: ${we.algorithm.algorithmId}`);const se=we.toJSON();Object.assign(L,se)}break;case"RSA-OAEP":{if(L.kty="RSA",L.ext=i,L.key_ops=a,"safari"===o.name.toLowerCase())L.alg="RSA-OAEP";else{if(!re.hash)throw new et("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(re.hash.name.toUpperCase()){case"SHA-1":L.alg="RSA-OAEP";break;case"SHA-256":L.alg="RSA-OAEP-256";break;case"SHA-384":L.alg="RSA-OAEP-384";break;case"SHA-512":L.alg="RSA-OAEP-512";break;default:throw new Error(`Incorrect hash algorithm: ${re.hash.name.toUpperCase()}`)}}const se=we.toJSON();Object.assign(L,se)}break;case"RSAES-PKCS1-V1_5":{L.kty="RSA",L.ext=i,L.key_ops=a,L.alg="PS1";const se=we.toJSON();Object.assign(L,se)}break;default:throw new Error(`Incorrect algorithm name: ${re.name.toUpperCase()}`)}}break;case"pkcs8":{const Ae=new Yr,we=ct(A._H.toArrayBuffer(e));oe.assert(we,"keyData");try{Ae.fromSchema(we.result)}catch{throw new Error("Incorrect keyData")}if(!Ae.parsedKey)throw new Error("Incorrect keyData");switch(re.name.toUpperCase()){case"RSA-PSS":switch(null===(u=re.hash)||void 0===u?void 0:u.name.toUpperCase()){case"SHA-1":L.alg="PS1";break;case"SHA-256":L.alg="PS256";break;case"SHA-384":L.alg="PS384";break;case"SHA-512":L.alg="PS512";break;default:throw new Error(`Incorrect hash algorithm: ${null===(h=re.hash)||void 0===h?void 0:h.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(a=["sign"],L.kty="RSA",L.ext=i,L.key_ops=a,"1.2.840.113549.1.1.1"!==Ae.privateKeyAlgorithm.algorithmId)throw new Error(`Incorrect private key algorithm: ${Ae.privateKeyAlgorithm.algorithmId}`);if(!("alg"in L))switch(null===(m=re.hash)||void 0===m?void 0:m.name.toUpperCase()){case"SHA-1":L.alg="RS1";break;case"SHA-256":L.alg="RS256";break;case"SHA-384":L.alg="RS384";break;case"SHA-512":L.alg="RS512";break;default:throw new Error(`Incorrect hash algorithm: ${null===(N=re.hash)||void 0===N?void 0:N.name.toUpperCase()}`)}const se=Ae.toJSON();Object.assign(L,se)}break;case"ECDSA":a=["sign"];case"ECDH":{if(L={kty:"EC",ext:i,key_ops:a},"1.2.840.10045.2.1"!==Ae.privateKeyAlgorithm.algorithmId)throw new Error(`Incorrect algorithm: ${Ae.privateKeyAlgorithm.algorithmId}`);const se=Ae.toJSON();Object.assign(L,se)}break;case"RSA-OAEP":{if(L.kty="RSA",L.ext=i,L.key_ops=a,"safari"===o.name.toLowerCase())L.alg="RSA-OAEP";else switch(null===(T=re.hash)||void 0===T?void 0:T.name.toUpperCase()){case"SHA-1":L.alg="RSA-OAEP";break;case"SHA-256":L.alg="RSA-OAEP-256";break;case"SHA-384":L.alg="RSA-OAEP-384";break;case"SHA-512":L.alg="RSA-OAEP-512";break;default:throw new Error(`Incorrect hash algorithm: ${null===(K=re.hash)||void 0===K?void 0:K.name.toUpperCase()}`)}const se=Ae.toJSON();Object.assign(L,se)}break;case"RSAES-PKCS1-V1_5":{a=["decrypt"],L.kty="RSA",L.ext=i,L.key_ops=a,L.alg="PS1";const se=Ae.toJSON();Object.assign(L,se)}break;default:throw new Error(`Incorrect algorithm name: ${re.name.toUpperCase()}`)}}break;case"jwk":L=e;break;default:throw new Error(`Incorrect format: ${r}`)}if("safari"===o.name.toLowerCase())try{return o.subtle.importKey("jwk",_e(JSON.stringify(L)),t,i,a)}catch{return o.subtle.importKey("jwk",L,t,i,a)}return o.subtle.importKey("jwk",L,t,i,a)})()}exportKey(r,e){var t=this;return(0,k.A)(function*(){let i=yield t.subtle.exportKey("jwk",e);switch("safari"===t.name.toLowerCase()&&i instanceof ArrayBuffer&&(i=JSON.parse(J(i))),r.toLowerCase()){case"raw":return t.subtle.exportKey("raw",e);case"spki":{const a=new ns;try{a.fromJSON(i)}catch{throw new Error("Incorrect key data")}return a.toSchema().toBER(!1)}case"pkcs8":{const a=new Yr;try{a.fromJSON(i)}catch{throw new Error("Incorrect key data")}return a.toSchema().toBER(!1)}case"jwk":return i;default:throw new Error(`Incorrect format: ${r}`)}})()}convert(r,e,t,i,a,o){var u=this;return(0,k.A)(function*(){if(r.toLowerCase()===e.toLowerCase())return t;const h=yield u.importKey(r,t,i,a,o);return u.exportKey(e,h)})()}getAlgorithmByOID(r,e=!1,t){switch(r){case"1.2.840.113549.1.1.1":return{name:"RSAES-PKCS1-v1_5"};case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"}}if(e)throw new Error(`Unsupported algorithm identifier ${t?`for ${t} `:v}: ${r}`);return{}}getOIDByAlgorithm(r,e=!1,t){let i=v;switch(r.name.toUpperCase()){case"RSAES-PKCS1-V1_5":i="1.2.840.113549.1.1.1";break;case"RSASSA-PKCS1-V1_5":switch(r.hash.name.toUpperCase()){case"SHA-1":i="1.2.840.113549.1.1.5";break;case"SHA-256":i="1.2.840.113549.1.1.11";break;case"SHA-384":i="1.2.840.113549.1.1.12";break;case"SHA-512":i="1.2.840.113549.1.1.13"}break;case"RSA-PSS":i="1.2.840.113549.1.1.10";break;case"RSA-OAEP":i="1.2.840.113549.1.1.7";break;case"ECDSA":switch(r.hash.name.toUpperCase()){case"SHA-1":i="1.2.840.10045.4.1";break;case"SHA-256":i="1.2.840.10045.4.3.2";break;case"SHA-384":i="1.2.840.10045.4.3.3";break;case"SHA-512":i="1.2.840.10045.4.3.4"}break;case"ECDH":switch(r.kdf.toUpperCase()){case"SHA-1":i="1.3.133.16.840.63.0.2";break;case"SHA-256":i="1.3.132.1.11.1";break;case"SHA-384":i="1.3.132.1.11.2";break;case"SHA-512":i="1.3.132.1.11.3"}break;case"AES-CTR":case"AES-CMAC":case"CONCAT":case"HKDF":break;case"AES-CBC":switch(r.length){case 128:i="2.16.840.1.101.3.4.1.2";break;case 192:i="2.16.840.1.101.3.4.1.22";break;case 256:i="2.16.840.1.101.3.4.1.42"}break;case"AES-GCM":switch(r.length){case 128:i="2.16.840.1.101.3.4.1.6";break;case 192:i="2.16.840.1.101.3.4.1.26";break;case 256:i="2.16.840.1.101.3.4.1.46"}break;case"AES-CFB":switch(r.length){case 128:i="2.16.840.1.101.3.4.1.4";break;case 192:i="2.16.840.1.101.3.4.1.24";break;case 256:i="2.16.840.1.101.3.4.1.44"}break;case"AES-KW":switch(r.length){case 128:i="2.16.840.1.101.3.4.1.5";break;case 192:i="2.16.840.1.101.3.4.1.25";break;case 256:i="2.16.840.1.101.3.4.1.45"}break;case"HMAC":switch(r.hash.name.toUpperCase()){case"SHA-1":i="1.2.840.113549.2.7";break;case"SHA-256":i="1.2.840.113549.2.9";break;case"SHA-384":i="1.2.840.113549.2.10";break;case"SHA-512":i="1.2.840.113549.2.11"}break;case"DH":i="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":i="1.3.14.3.2.26";break;case"SHA-256":i="2.16.840.1.101.3.4.2.1";break;case"SHA-384":i="2.16.840.1.101.3.4.2.2";break;case"SHA-512":i="2.16.840.1.101.3.4.2.3";break;case"PBKDF2":i="1.2.840.113549.1.5.12";break;case"P-256":i="1.2.840.10045.3.1.7";break;case"P-384":i="1.3.132.0.34";break;case"P-521":i="1.3.132.0.35"}if(!i&&e)throw new Error(`Unsupported algorithm ${t?`for ${t} `:v}: ${r.name}`);return i}getAlgorithmParameters(r,e){let t={algorithm:{},usages:[]};switch(r.toUpperCase()){case"RSAES-PKCS1-V1_5":case"RSASSA-PKCS1-V1_5":switch(e.toLowerCase()){case"generatekey":t={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":t={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(e.toLowerCase()){case"sign":case"verify":t={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":t={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":t={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(e.toLowerCase()){case"encrypt":case"decrypt":t={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":t={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":t={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(e.toLowerCase()){case"generatekey":t={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":t={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":t={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(e.toLowerCase()){case"exportkey":case"importkey":case"generatekey":t={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":t={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(e.toLowerCase()){case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":t={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(e.toLowerCase()){case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":t={algorithm:{name:"AES-CBC",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(e.toLowerCase()){case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":t={algorithm:{name:"AES-GCM",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(e.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":t={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(e.toLowerCase()){case"sign":case"verify":t={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":if("derivekey"!==e.toLowerCase())return{algorithm:{name:"HKDF"},usages:[]};t={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;case"PBKDF2":if("derivekey"!==e.toLowerCase())return{algorithm:{name:"PBKDF2"},usages:[]};t={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e4},usages:["encrypt","decrypt"]}}return t}getHashAlgorithm(r){let e=v;switch(r.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":e="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":e="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":e="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":e="SHA-512";break;case"1.2.840.113549.1.1.10":try{const t=new _u({schema:r.algorithmParams});if(t.hashAlgorithm){const i=this.getAlgorithmByOID(t.hashAlgorithm.algorithmId);if(!("name"in i))return v;e=i.name}else e="SHA-1"}catch{}}return e}encryptEncryptedContentInfo(r){var e=this;return(0,k.A)(function*(){et.assert(r,"password","contentEncryptionAlgorithm","hmacHashAlgorithm","iterationCount","contentToEncrypt","contentToEncrypt","contentType");const t=e.getOIDByAlgorithm(r.contentEncryptionAlgorithm,!0,"contentEncryptionAlgorithm"),i=e.getOIDByAlgorithm({name:"PBKDF2"},!0,"PBKDF2"),a=e.getOIDByAlgorithm({name:"HMAC",hash:{name:r.hmacHashAlgorithm}},!0,"hmacHashAlgorithm"),o=new ArrayBuffer(16),u=new Uint8Array(o);e.getRandomValues(u);const h=new ArrayBuffer(64),m=new Uint8Array(h);e.getRandomValues(m);const N=new Uint8Array(r.contentToEncrypt),T=new so({salt:new de({valueHex:h}),iterationCount:r.iterationCount,prf:new Q({algorithmId:a,algorithmParams:new kt})}),K=new Uint8Array(r.password),L=yield e.importKey("raw",K,"PBKDF2",!1,["deriveKey"]),re=yield e.deriveKey({name:"PBKDF2",hash:{name:r.hmacHashAlgorithm},salt:m,iterations:r.iterationCount},L,r.contentEncryptionAlgorithm,!1,["encrypt"]),Ae=yield e.encrypt({name:r.contentEncryptionAlgorithm.name,iv:u},re,N),we=new Cd({keyDerivationFunc:new Q({algorithmId:i,algorithmParams:T.toSchema()}),encryptionScheme:new Q({algorithmId:t,algorithmParams:new de({valueHex:o})})});return new Dt({contentType:r.contentType,contentEncryptionAlgorithm:new Q({algorithmId:"1.2.840.113549.1.5.13",algorithmParams:we.toSchema()}),encryptedContent:new de({valueHex:Ae})})})()}decryptEncryptedContentInfo(r){var e=this;return(0,k.A)(function*(){if(et.assert(r,"password","encryptedContentInfo"),"1.2.840.113549.1.5.13"!==r.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId)throw new Error(`Unknown "contentEncryptionAlgorithm": ${r.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId}`);let t,i;try{t=new Cd({schema:r.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams})}catch{throw new Error('Incorrectly encoded "pbes2Parameters"')}try{i=new so({schema:t.keyDerivationFunc.algorithmParams})}catch{throw new Error('Incorrectly encoded "pbkdf2Params"')}const a=e.getAlgorithmByOID(t.encryptionScheme.algorithmId,!0),u=new Uint8Array(t.encryptionScheme.algorithmParams.valueBlock.valueHex),m=new Uint8Array(i.salt.valueBlock.valueHex),N=i.iterationCount;let T="SHA-1";i.prf&&(T=e.getAlgorithmByOID(i.prf.algorithmId,!0).hash.name);const K=yield e.importKey("raw",r.password,"PBKDF2",!1,["deriveKey"]),L=yield e.deriveKey({name:"PBKDF2",hash:{name:T},salt:m,iterations:N},K,a,!1,["decrypt"]),re=r.encryptedContentInfo.getEncryptedContent();return e.decrypt({name:a.name,iv:u},L,re)})()}stampDataWithPassword(r){var e=this;return(0,k.A)(function*(){if(!(r instanceof Object))throw new Error('Parameters must have type "Object"');let t;switch(et.assert(r,"password","hashAlgorithm","iterationCount","salt","contentToStamp"),r.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:throw new Error(`Incorrect "parameters.hashAlgorithm" parameter: ${r.hashAlgorithm}`)}const i={name:"HMAC",length:t,hash:{name:r.hashAlgorithm}},a=yield Nd(r.hashAlgorithm,t,r.password,r.salt,r.iterationCount),o=yield e.importKey("raw",new Uint8Array(a),i,!1,["sign"]);return e.sign(i,o,new Uint8Array(r.contentToStamp))})()}verifyDataStampedWithPassword(r){var e=this;return(0,k.A)(function*(){et.assert(r,"password","hashAlgorithm","salt","iterationCount","contentToVerify","signatureToVerify");let t=0;switch(r.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:throw new Error(`Incorrect "parameters.hashAlgorithm" parameter: ${r.hashAlgorithm}`)}const i={name:"HMAC",length:t,hash:{name:r.hashAlgorithm}},a=yield Nd(r.hashAlgorithm,t,r.password,r.salt,r.iterationCount),o=yield e.importKey("raw",new Uint8Array(a),i,!1,["verify"]);return e.verify(i,o,new Uint8Array(r.signatureToVerify),new Uint8Array(r.contentToVerify))})()}getSignatureParameters(r,e="SHA-1"){var t=this;return(0,k.A)(function*(){t.getOIDByAlgorithm({name:e},!0,"hashAlgorithm");const i=new Q,a=t.getAlgorithmParameters(r.algorithm.name,"sign");if(!Object.keys(a.algorithm).length)throw new Error("Parameter 'algorithm' is empty");const o=a.algorithm;switch(o.hash.name="hash"in r.algorithm&&r.algorithm.hash&&r.algorithm.hash.name?r.algorithm.hash.name:e,r.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":i.algorithmId=t.getOIDByAlgorithm(o,!0);break;case"RSA-PSS":{switch(o.hash.name.toUpperCase()){case"SHA-256":o.saltLength=32;break;case"SHA-384":o.saltLength=48;break;case"SHA-512":o.saltLength=64}const u={};if("SHA-1"!==o.hash.name.toUpperCase()){const m=t.getOIDByAlgorithm({name:o.hash.name},!0,"hashAlgorithm");u.hashAlgorithm=new Q({algorithmId:m,algorithmParams:new kt}),u.maskGenAlgorithm=new Q({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:u.hashAlgorithm.toSchema()})}20!==o.saltLength&&(u.saltLength=o.saltLength);const h=new _u(u);i.algorithmId="1.2.840.113549.1.1.10",i.algorithmParams=h.toSchema()}break;default:throw new Error(`Unsupported signature algorithm: ${r.algorithm.name}`)}return{signatureAlgorithm:i,parameters:a}})()}signWithPrivateKey(r,e,t){var i=this;return(0,k.A)(function*(){const a=yield i.sign(t.algorithm,e,r);return"ECDSA"===t.algorithm.name?function up(s){if(s.byteLength%2!=0)return Ct;const r=s.byteLength/2,e=new ArrayBuffer(r);new Uint8Array(e).set(new Uint8Array(s,0,r));const i=new X({valueHex:e}),a=new ArrayBuffer(r);new Uint8Array(a).set(new Uint8Array(s,r,r));const u=new X({valueHex:a});return new O({value:[i.convertToDER(),u.convertToDER()]}).toBER(!1)}(a):a})()}fillPublicKeyParameters(r,e){const t={},i=this.getHashAlgorithm(e);if(i===v)throw new Error(`Unsupported signature algorithm: ${e.algorithmId}`);let a;a="1.2.840.113549.1.1.10"===e.algorithmId?e.algorithmId:r.algorithm.algorithmId;const o=this.getAlgorithmByOID(a,!0);if(t.algorithm=this.getAlgorithmParameters(o.name,"importKey"),"hash"in t.algorithm.algorithm&&(t.algorithm.algorithm.hash.name=i),"ECDSA"===o.name){const u=r.algorithm;if(!u.algorithmParams)throw new Error("Algorithm parameters for ECDSA public key are missed");const h=u.algorithmParams;if("idBlock"in u.algorithmParams&&(1!==h.idBlock.tagClass||6!==h.idBlock.tagNumber))throw new Error("Incorrect type for ECDSA public key parameters");const m=this.getAlgorithmByOID(h.valueBlock.toString(),!0);t.algorithm.algorithm.namedCurve=m.name}return t}getPublicKey(r,e,t){var i=this;return(0,k.A)(function*(){t||(t=i.fillPublicKeyParameters(r,e));const a=r.toSchema().toBER(!1);return i.importKey("spki",a,t.algorithm.algorithm,!0,t.algorithm.usages)})()}verifyWithPublicKey(r,e,t,i,a){var o=this;return(0,k.A)(function*(){let u;if(a){const N={};let T;T="1.2.840.113549.1.1.10"===i.algorithmId?i.algorithmId:t.algorithm.algorithmId;const K=o.getAlgorithmByOID(T,!0);if(N.algorithm=o.getAlgorithmParameters(K.name,"importKey"),"hash"in N.algorithm.algorithm&&(N.algorithm.algorithm.hash.name=a),"ECDSA"===K.name){let L=!1;if("algorithmParams"in t.algorithm&&"idBlock"in t.algorithm.algorithmParams&&1===t.algorithm.algorithmParams.idBlock.tagClass&&6===t.algorithm.algorithmParams.idBlock.tagNumber&&(L=!0),!1===L)throw new Error("Incorrect type for ECDSA public key parameters");const re=o.getAlgorithmByOID(t.algorithm.algorithmParams.valueBlock.toString(),!0);N.algorithm.algorithm.namedCurve=re.name}u=yield o.getPublicKey(t,null,N)}else{if(!(a=o.getHashAlgorithm(i)))throw new Error(`Unsupported signature algorithm: ${i.algorithmId}`);u=yield o.getPublicKey(t,i)}const h=o.getAlgorithmParameters(u.algorithm.name,"verify");"hash"in h.algorithm&&(h.algorithm.hash.name=a);let m=e.valueBlock.valueHexView;if("ECDSA"===u.algorithm.name){const N=js.find(u.algorithm.namedCurve);if(!N)throw new Error("Unsupported named curve in use");const T=ct(m);oe.assert(T,"Signature value"),m=function hp(s,r){if(!(s instanceof O&&2===s.valueBlock.value.length&&s.valueBlock.value[0]instanceof X&&s.valueBlock.value[1]instanceof X))return Ct;const e=s.valueBlock.value[0].convertFromDER().valueBlock.valueHexView,t=s.valueBlock.value[1].convertFromDER().valueBlock.valueHexView,i=new Uint8Array(2*r);return i.set(e,r-e.byteLength),i.set(t,2*r-t.byteLength),i.buffer}(T.result,N.size)}if("RSA-PSS"===u.algorithm.name){const N=new _u({schema:i.algorithmParams});h.algorithm.saltLength="saltLength"in N?N.saltLength:20;let T="SHA-1";"hashAlgorithm"in N&&(T=o.getAlgorithmByOID(N.hashAlgorithm.algorithmId,!0).name),h.algorithm.hash.name=T}return o.verify(h.algorithm,u,m,r)})()}}let Bd={name:"none",crypto:null};function Rd(s){return!(!s||"object"!=typeof s||!("crypto"in s))}function Td(s,...r){let e=null;if(r.length<2)e=r.length?r[0]:typeof self<"u"&&self.crypto?new zl({name:"browser",crypto:self.crypto}):null;else{const t=r[0],i=r[1];Rd(i)?e=i:Rd(t)?e=t:"subtle"in t&&"getRandomValues"in t&&(e=new zl({crypto:t}))}if(typeof process<"u"&&"pid"in process&&typeof global<"u"&&typeof window>"u"){if(typeof global[process.pid]>"u")global[process.pid]={};else if("object"!=typeof global[process.pid])throw new Error(`Name global.${process.pid} already exists and it is not an object`);if(typeof global[process.pid].pkijs>"u")global[process.pid].pkijs={};else if("object"!=typeof global[process.pid].pkijs)throw new Error(`Name global.${process.pid}.pkijs already exists and it is not an object`);global[process.pid].pkijs.engine={name:s,crypto:e}}else Bd={name:s,crypto:e}}function Ge(s=!1){const r=function cp(){if(typeof process<"u"&&"pid"in process&&typeof global<"u"&&typeof window>"u"){let s;try{s=global[process.pid].pkijs.engine}catch{throw new Error("Please call 'setEngine' before call to 'getEngine'")}return s}return Bd}();if(!r.crypto&&s)throw new Error("Unable to create WebCrypto object");return r.crypto}function Nu(s){return Ge(!0).getRandomValues(s)}function fp(s,r,e,t,i){return Iu.apply(this,arguments)}function Iu(){return(Iu=(0,k.A)(function*(s,r,e,t,i){switch(s.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;default:throw new ot(`Unknown hash function: ${s}`)}if(ot.assert(r,"zBuffer","ArrayBuffer"),0===r.byteLength)throw new ot("'zBuffer' has zero length, error");if(ot.assert(t,"SharedInfo","ArrayBuffer"),e>255)throw new ot("Please set 'Counter' argument to value less or equal to 255");const a=new ArrayBuffer(4),o=new Uint8Array(a);o[0]=0,o[1]=0,o[2]=0,o[3]=e;let u=Ct;return u=R(u,r),u=R(u,a),u=R(u,t),{counter:e,result:yield i.digest({name:s},u)}})).apply(this,arguments)}function xd(s,r,e,t){return Bu.apply(this,arguments)}function Bu(){return(Bu=(0,k.A)(function*(s,r,e,t,i=Ge(!0)){let a=0,o=1;switch(s.toUpperCase()){case"SHA-1":a=160;break;case"SHA-256":a=256;break;case"SHA-384":a=384;break;case"SHA-512":a=512;break;default:throw new ot(`Unknown hash function: ${s}`)}if(ot.assert(r,"Zbuffer","ArrayBuffer"),0===r.byteLength)throw new ot("'Zbuffer' has zero length, error");ot.assert(t,"SharedInfo","ArrayBuffer");const u=e/a;Math.floor(u)>0&&(o=Math.floor(u),u-o>0&&o++);const h=[];for(let K=1;K<=o;K++)h.push(yield fp(s,r,K,t,i));let m=Ct,N=1,T=!0;for(;T;){T=!1;for(const K of h)if(K.counter===N){m=R(m,K.result),T=!0;break}N++}if(m.byteLength>(e>>=3)){const K=new ArrayBuffer(e),L=new Uint8Array(K),re=new Uint8Array(m);for(let Ae=0;Ae<e;Ae++)L[Ae]=re[Ae];return K}return m})).apply(this,arguments)}const Ru="version",Tu="logID",xu="extensions",Vu="timestamp",Ou="hashAlgorithm",Pu="signatureAlgorithm",Du="signature",Fd="anonymous";let dp=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,Ru,s.defaultValues(Ru)),this.logID=l(e,Tu,s.defaultValues(Tu)),this.timestamp=l(e,Vu,s.defaultValues(Vu)),this.extensions=l(e,xu,s.defaultValues(xu)),this.hashAlgorithm=l(e,Ou,s.defaultValues(Ou)),this.signatureAlgorithm=l(e,Pu,s.defaultValues(Pu)),this.signature=l(e,Du,s.defaultValues(Du)),"stream"in e&&e.stream&&this.fromStream(e.stream),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ru:return 0;case Tu:case xu:return Ct;case Vu:return new Date(0);case Ou:case Pu:return v;case Du:return new Fe;default:return super.defaultValues(e)}}fromSchema(e){if(!(e instanceof Ul))throw new Error("Object's schema was not verified against input data for SignedCertificateTimestamp");const t=new da({stream:new vt({buffer:e.data})});this.fromStream(t)}fromStream(e){const t=e.getUint16();if(this.version=e.getBlock(1)[0],0===this.version){this.logID=new Uint8Array(e.getBlock(32)).buffer.slice(0),this.timestamp=new Date(Se(new Uint8Array(e.getBlock(8)),8));const i=e.getUint16();switch(this.extensions=new Uint8Array(e.getBlock(i)).buffer.slice(0),e.getBlock(1)[0]){case 0:this.hashAlgorithm="none";break;case 1:this.hashAlgorithm="md5";break;case 2:this.hashAlgorithm="sha1";break;case 3:this.hashAlgorithm="sha224";break;case 4:this.hashAlgorithm="sha256";break;case 5:this.hashAlgorithm="sha384";break;case 6:this.hashAlgorithm="sha512";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}switch(e.getBlock(1)[0]){case 0:this.signatureAlgorithm=Fd;break;case 1:this.signatureAlgorithm="rsa";break;case 2:this.signatureAlgorithm="dsa";break;case 3:this.signatureAlgorithm="ecdsa";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}const a=e.getUint16(),u=ct(new Uint8Array(e.getBlock(a)).buffer.slice(0));if(oe.assert(u,"SignedCertificateTimestamp"),this.signature=u.result,t!==47+i+a)throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}}toSchema(){const e=this.toStream();return new Ul({data:e.stream.buffer})}toStream(){const e=new da;e.appendUint16(47+this.extensions.byteLength+this.signature.valueBeforeDecodeView.byteLength),e.appendChar(this.version),e.appendView(new Uint8Array(this.logID));const t=new ArrayBuffer(8),i=new Uint8Array(t),a=Oe(this.timestamp.valueOf(),8);let o,u;switch(i.set(new Uint8Array(a),8-a.byteLength),e.appendView(i),e.appendUint16(this.extensions.byteLength),this.extensions.byteLength&&e.appendView(new Uint8Array(this.extensions)),this.hashAlgorithm.toLowerCase()){case"none":o=0;break;case"md5":o=1;break;case"sha1":o=2;break;case"sha224":o=3;break;case"sha256":o=4;break;case"sha384":o=5;break;case"sha512":o=6;break;default:throw new Error(`Incorrect data for hashAlgorithm: ${this.hashAlgorithm}`)}switch(e.appendChar(o),this.signatureAlgorithm.toLowerCase()){case Fd:u=0;break;case"rsa":u=1;break;case"dsa":u=2;break;case"ecdsa":u=3;break;default:throw new Error(`Incorrect data for signatureAlgorithm: ${this.signatureAlgorithm}`)}e.appendChar(u);const h=this.signature.toBER(!1);return e.appendUint16(h.byteLength),e.appendView(new Uint8Array(h)),e}toJSON(){return{version:this.version,logID:ve(this.logID),timestamp:this.timestamp,extensions:ve(this.extensions),hashAlgorithm:this.hashAlgorithm,signatureAlgorithm:this.signatureAlgorithm,signature:this.signature.toJSON()}}verify(e,t,i=0,a=Ge(!0)){var o=this;return(0,k.A)(function*(){const u=Te(J(o.logID));let h=null;const m=new da;for(const Ae of e)if(Ae.log_id===u){h=Ae.key;break}if(!h)throw new Error(`Public key not found for CT with logId: ${u}`);const N=_e(H(h)),T=ns.fromBER(N);m.appendChar(0),m.appendChar(0);const K=new ArrayBuffer(8),L=new Uint8Array(K),re=Oe(o.timestamp.valueOf(),8);return L.set(new Uint8Array(re),8-re.byteLength),m.appendView(L),m.appendUint16(i),0===i&&m.appendUint24(t.byteLength),m.appendView(new Uint8Array(t)),m.appendUint16(o.extensions.byteLength),0!==o.extensions.byteLength&&m.appendView(new Uint8Array(o.extensions)),a.verifyWithPublicKey(m.buffer.slice(0,m.length),new de({valueHex:o.signature.toBER(!1)}),T,{algorithmId:v},"SHA-256")})()}}return s.CLASS_NAME="SignedCertificateTimestamp",s})();const Yl="timestamps";let mp=(()=>{class s extends fe{constructor(e={}){super(),this.timestamps=l(e,Yl,s.defaultValues(Yl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Yl?[]:super.defaultValues(e)}static compareWithDefault(e,t){return e===Yl?0===t.length:super.defaultValues(e)}static schema(e={}){var t;const i=l(e,"names",{});return null!==(t=i.optional)&&void 0!==t||(i.optional=!1),new de({name:i.blockName||"SignedCertificateTimestampList",optional:i.optional})}fromSchema(e){if(!(e instanceof de))throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");const t=new da({stream:new vt({buffer:e.valueBlock.valueHex})});if(t.getUint16()!==t.length)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");for(;t.length;)this.timestamps.push(new dp({stream:t}))}toSchema(){const e=new da;let t=0;const i=[];for(const a of this.timestamps){const o=a.toStream();i.push(o),t+=o.stream.buffer.byteLength}e.appendUint16(t);for(const a of i)e.appendView(a.stream.view);return new de({valueHex:e.stream.buffer.slice(0)})}toJSON(){return{timestamps:Array.from(this.timestamps,e=>e.toJSON())}}}return s.CLASS_NAME="SignedCertificateTimestampList",s})();const no="attributes",gp=[no];let pp=(()=>{class s extends fe{constructor(e={}){super(),this.attributes=l(e,no,s.defaultValues(no)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===no?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new $e({name:t.attributes||v,value:tt.schema()})]})}fromSchema(e){Z(e,gp);const t=he(e,e,s.schema({names:{attributes:no}}));oe.assertSchema(t,this.className),this.attributes=Array.from(t.result.attributes,i=>new tt({schema:i}))}toSchema(){return new O({value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){return{attributes:Array.from(this.attributes,e=>e.toJSON())}}}return s.CLASS_NAME="SubjectDirectoryAttributes",s})();class wt{static getItems(){return this.types||(this.types={},wt.register(Wf,"SubjectAltName",Jf),wt.register(zf,"IssuerAltName",Jf),wt.register(yu,"AuthorityKeyIdentifier",cd),wt.register(vu,"BasicConstraints",ud),wt.register("1.3.6.1.4.1.311.21.1","MicrosoftCaVersion",Ig),wt.register(ed,"CertificatePolicies",dd),wt.register("1.3.6.1.4.1.311.21.10","CertificatePoliciesMicrosoft",dd),wt.register("1.3.6.1.4.1.311.21.7","MicrosoftCertTemplateV2",Kr),wt.register(Zf,"CRLDistributionPoints",vd),wt.register(wu,"FreshestCRL",vd),wt.register("2.5.29.37","ExtKeyUsage",Dg),wt.register(Xf,"CertificateIssuer",Bt),wt.register(Su,"AuthorityInfoAccess",wd),wt.register("1.3.6.1.5.5.7.1.11","SubjectInfoAccess",wd),wt.register(Yf,"IssuingDistributionPoint",Mg),wt.register(Qf,"NameConstraints",Hg),wt.register(sd,"PolicyConstraints",$g),wt.register(td,"PolicyMappings",Jg),wt.register("2.5.29.16","PrivateKeyUsagePeriod",Wg),wt.register("1.3.6.1.5.5.7.1.3","QCStatements",Xg),wt.register("1.3.6.1.4.1.11129.2.4.2","SignedCertificateTimestampList",mp),wt.register("2.5.29.9","SubjectDirectoryAttributes",pp)),this.types}static fromBER(r,e){const t=ct(e);if(-1===t.offset)return null;const i=this.find(r);if(i)try{return new i.type({schema:t.result})}catch{const o=new i.type;return o.parsingError=`Incorrectly formatted value of extension ${i.name} (${r})`,o}return t.result}static find(r){return this.getItems()[r]||null}static register(r,e,t){this.getItems()[r]={name:e,type:t}}}const ao="extnID",zs="critical",oo="extnValue",Xl="parsedValue",vp=[ao,zs,oo];let Li=(()=>{class s extends fe{get parsedValue(){if(void 0===this._parsedValue){const e=wt.fromBER(this.extnID,this.extnValue.valueBlock.valueHexView);this._parsedValue=e}return this._parsedValue||void 0}set parsedValue(e){this._parsedValue=e}constructor(e={}){super(),this.extnID=l(e,ao,s.defaultValues(ao)),this.critical=l(e,zs,s.defaultValues(zs)),this.extnValue=oo in e?new de({valueHex:e.extnValue}):s.defaultValues(oo),Xl in e&&(this.parsedValue=l(e,Xl,s.defaultValues(Xl))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ao:return v;case zs:return!1;case oo:return new de;case Xl:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.extnID||v}),new ks({name:t.critical||v,optional:!0}),new de({name:t.extnValue||v})]})}fromSchema(e){Z(e,vp);const t=he(e,e,s.schema({names:{extnID:ao,critical:zs,extnValue:oo}}));oe.assertSchema(t,this.className),this.extnID=t.result.extnID.valueBlock.toString(),zs in t.result&&(this.critical=t.result.critical.valueBlock.value),this.extnValue=t.result.extnValue}toSchema(){const e=[];return e.push(new Ve({value:this.extnID})),this.critical!==s.defaultValues(zs)&&e.push(new ks({value:this.critical})),e.push(this.extnValue),new O({value:e})}toJSON(){const e={extnID:this.extnID,extnValue:this.extnValue.toJSON()};return this.critical!==s.defaultValues(zs)&&(e.critical=this.critical),this.parsedValue&&this.parsedValue.toJSON&&(e.parsedValue=this.parsedValue.toJSON()),e}}return s.CLASS_NAME="Extension",s})();const lo="extensions",wp=[lo];let Rt=(()=>{class s extends fe{constructor(e={}){super(),this.extensions=l(e,lo,s.defaultValues(lo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===lo?[]:super.defaultValues(e)}static schema(e={},t=!1){const i=l(e,"names",{});return new O({optional:t,name:i.blockName||v,value:[new $e({name:i.extensions||v,value:Li.schema(i.extension||{})})]})}fromSchema(e){Z(e,wp);const t=he(e,e,s.schema({names:{extensions:lo}}));oe.assertSchema(t,this.className),this.extensions=Array.from(t.result.extensions,i=>new Li({schema:i}))}toSchema(){return new O({value:Array.from(this.extensions,e=>e.toSchema())})}toJSON(){return{extensions:this.extensions.map(e=>e.toJSON())}}}return s.CLASS_NAME="Extensions",s})();const co="issuer",uo="serialNumber",Fi="issuerUID",yp=[co,uo,Fi];let gs=(()=>{class s extends fe{constructor(e={}){super(),this.issuer=l(e,co,s.defaultValues(co)),this.serialNumber=l(e,uo,s.defaultValues(uo)),Fi in e&&(this.issuerUID=l(e,Fi,s.defaultValues(Fi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case co:return new Bt;case uo:return new X;case Fi:return new Ze;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Bt.schema(t.issuer||{}),new X({name:t.serialNumber||v}),new Ze({optional:!0,name:t.issuerUID||v})]})}fromSchema(e){Z(e,yp);const t=he(e,e,s.schema({names:{issuer:{names:{blockName:co}},serialNumber:uo,issuerUID:Fi}}));oe.assertSchema(t,this.className),this.issuer=new Bt({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber,Fi in t.result&&(this.issuerUID=t.result.issuerUID)}toSchema(){const e=new O({value:[this.issuer.toSchema(),this.serialNumber]});return this.issuerUID&&e.valueBlock.value.push(this.issuerUID),e}toJSON(){const e={issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()};return this.issuerUID&&(e.issuerUID=this.issuerUID.toJSON()),e}}return s.CLASS_NAME="IssuerSerial",s})();const ho="version",Hi="baseCertificateID",ji="subjectName",fo="issuer",mo="signature",go="serialNumber",po="attrCertValidityPeriod",vo="attributes",$i="issuerUniqueID",Ki="extensions",Sp=[ho,Hi,ji,fo,mo,go,po,vo,$i,Ki];let Mu=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,ho,s.defaultValues(ho)),Hi in e&&(this.baseCertificateID=l(e,Hi,s.defaultValues(Hi))),ji in e&&(this.subjectName=l(e,ji,s.defaultValues(ji))),this.issuer=l(e,fo,s.defaultValues(fo)),this.signature=l(e,mo,s.defaultValues(mo)),this.serialNumber=l(e,go,s.defaultValues(go)),this.attrCertValidityPeriod=l(e,po,s.defaultValues(po)),this.attributes=l(e,vo,s.defaultValues(vo)),$i in e&&(this.issuerUniqueID=l(e,$i,s.defaultValues($i))),Ki in e&&(this.extensions=l(e,Ki,s.defaultValues(Ki))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ho:return 0;case Hi:return new gs;case ji:case fo:return new Bt;case mo:return new Q;case go:return new X;case po:return new $r;case vo:return[];case $i:return new Ze;case Ki:return new Rt;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.version||v}),new ft({value:[new q({name:t.baseCertificateID||v,idBlock:{tagClass:3,tagNumber:0},value:gs.schema().valueBlock.value}),new q({name:t.subjectName||v,idBlock:{tagClass:3,tagNumber:1},value:Bt.schema().valueBlock.value})]}),Bt.schema({names:{blockName:t.issuer||v}}),Q.schema(t.signature||{}),new X({name:t.serialNumber||v}),$r.schema(t.attrCertValidityPeriod||{}),new O({name:t.attributes||v,value:[new $e({value:tt.schema()})]}),new Ze({optional:!0,name:t.issuerUniqueID||v}),Rt.schema(t.extensions||{},!0)]})}fromSchema(e){Z(e,Sp);const t=he(e,e,s.schema({names:{version:ho,baseCertificateID:Hi,subjectName:ji,issuer:fo,signature:{names:{blockName:mo}},serialNumber:go,attrCertValidityPeriod:{names:{blockName:po}},attributes:vo,issuerUniqueID:$i,extensions:{names:{blockName:Ki}}}}));oe.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,Hi in t.result&&(this.baseCertificateID=new gs({schema:new O({value:t.result.baseCertificateID.valueBlock.value})})),ji in t.result&&(this.subjectName=new Bt({schema:new O({value:t.result.subjectName.valueBlock.value})})),this.issuer=t.result.issuer,this.signature=new Q({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new $r({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,i=>new tt({schema:i})),$i in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),Ki in t.result&&(this.extensions=new Rt({schema:t.result.extensions}))}toSchema(){const e=new O({value:[new X({value:this.version})]});return this.baseCertificateID&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.subjectName&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:1},value:this.subjectName.toSchema().valueBlock.value})),e.valueBlock.value.push(this.issuer.toSchema()),e.valueBlock.value.push(this.signature.toSchema()),e.valueBlock.value.push(this.serialNumber),e.valueBlock.value.push(this.attrCertValidityPeriod.toSchema()),e.valueBlock.value.push(new O({value:Array.from(this.attributes,t=>t.toSchema())})),this.issuerUniqueID&&e.valueBlock.value.push(this.issuerUniqueID),this.extensions&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version};return this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.subjectName&&(e.subjectName=this.subjectName.toJSON()),e.issuer=this.issuer.toJSON(),e.signature=this.signature.toJSON(),e.serialNumber=this.serialNumber.toJSON(),e.attrCertValidityPeriod=this.attrCertValidityPeriod.toJSON(),e.attributes=Array.from(this.attributes,t=>t.toJSON()),this.issuerUniqueID&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),this.extensions&&(e.extensions=this.extensions.toJSON()),e}}return s.CLASS_NAME="AttributeCertificateInfoV1",s})();const wo="acinfo",yo="signatureAlgorithm",So="signatureValue",bp=[wo,So,yo];let Lu=(()=>{class s extends fe{constructor(e={}){super(),this.acinfo=l(e,wo,s.defaultValues(wo)),this.signatureAlgorithm=l(e,yo,s.defaultValues(yo)),this.signatureValue=l(e,So,s.defaultValues(So)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wo:return new Mu;case yo:return new Q;case So:return new Ze;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Mu.schema(t.acinfo||{}),Q.schema(t.signatureAlgorithm||{}),new Ze({name:t.signatureValue||v})]})}fromSchema(e){Z(e,bp);const t=he(e,e,s.schema({names:{acinfo:{names:{blockName:wo}},signatureAlgorithm:{names:{blockName:yo}},signatureValue:So}}));oe.assertSchema(t,this.className),this.acinfo=new Mu({schema:t.result.acinfo}),this.signatureAlgorithm=new Q({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new O({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}return s.CLASS_NAME="AttributeCertificateV1",s})();const bo="digestedObjectType",Gi="otherObjectTypeID",Ao="digestAlgorithm",Eo="objectDigest",Ap=[bo,Gi,Ao,Eo];let en=(()=>{class s extends fe{constructor(e={}){super(),this.digestedObjectType=l(e,bo,s.defaultValues(bo)),Gi in e&&(this.otherObjectTypeID=l(e,Gi,s.defaultValues(Gi))),this.digestAlgorithm=l(e,Ao,s.defaultValues(Ao)),this.objectDigest=l(e,Eo,s.defaultValues(Eo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case bo:return new ua;case Gi:return new Ve;case Ao:return new Q;case Eo:return new Ze;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new ua({name:t.digestedObjectType||v}),new Ve({optional:!0,name:t.otherObjectTypeID||v}),Q.schema(t.digestAlgorithm||{}),new Ze({name:t.objectDigest||v})]})}fromSchema(e){Z(e,Ap);const t=he(e,e,s.schema({names:{digestedObjectType:bo,otherObjectTypeID:Gi,digestAlgorithm:{names:{blockName:Ao}},objectDigest:Eo}}));oe.assertSchema(t,this.className),this.digestedObjectType=t.result.digestedObjectType,Gi in t.result&&(this.otherObjectTypeID=t.result.otherObjectTypeID),this.digestAlgorithm=new Q({schema:t.result.digestAlgorithm}),this.objectDigest=t.result.objectDigest}toSchema(){const e=new O({value:[this.digestedObjectType]});return this.otherObjectTypeID&&e.valueBlock.value.push(this.otherObjectTypeID),e.valueBlock.value.push(this.digestAlgorithm.toSchema()),e.valueBlock.value.push(this.objectDigest),e}toJSON(){const e={digestedObjectType:this.digestedObjectType.toJSON(),digestAlgorithm:this.digestAlgorithm.toJSON(),objectDigest:this.objectDigest.toJSON()};return this.otherObjectTypeID&&(e.otherObjectTypeID=this.otherObjectTypeID.toJSON()),e}}return s.CLASS_NAME="ObjectDigestInfo",s})();const Ji="issuerName",qi="baseCertificateID",Wi="objectDigestInfo",Ep=[Ji,qi,Wi];let Kd=(()=>{class s extends fe{constructor(e={}){super(),Ji in e&&(this.issuerName=l(e,Ji,s.defaultValues(Ji))),qi in e&&(this.baseCertificateID=l(e,qi,s.defaultValues(qi))),Wi in e&&(this.objectDigestInfo=l(e,Wi,s.defaultValues(Wi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ji:return new Bt;case qi:return new gs;case Wi:return new en;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Bt.schema({names:{blockName:t.issuerName}},!0),new q({optional:!0,name:t.baseCertificateID||v,idBlock:{tagClass:3,tagNumber:0},value:gs.schema().valueBlock.value}),new q({optional:!0,name:t.objectDigestInfo||v,idBlock:{tagClass:3,tagNumber:1},value:en.schema().valueBlock.value})]})}fromSchema(e){Z(e,Ep);const t=he(e,e,s.schema({names:{issuerName:Ji,baseCertificateID:qi,objectDigestInfo:Wi}}));oe.assertSchema(t,this.className),Ji in t.result&&(this.issuerName=new Bt({schema:t.result.issuerName})),qi in t.result&&(this.baseCertificateID=new gs({schema:new O({value:t.result.baseCertificateID.valueBlock.value})})),Wi in t.result&&(this.objectDigestInfo=new en({schema:new O({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new O;return this.issuerName&&e.valueBlock.value.push(this.issuerName.toSchema()),this.baseCertificateID&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.objectDigestInfo&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:1},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return this.issuerName&&(e.issuerName=this.issuerName.toJSON()),this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.objectDigestInfo&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}return s.CLASS_NAME="V2Form",s})();const zi="baseCertificateID",Yi="entityName",Xi="objectDigestInfo",kp=[zi,Yi,Xi];let Fu=(()=>{class s extends fe{constructor(e={}){super(),zi in e&&(this.baseCertificateID=l(e,zi,s.defaultValues(zi))),Yi in e&&(this.entityName=l(e,Yi,s.defaultValues(Yi))),Xi in e&&(this.objectDigestInfo=l(e,Xi,s.defaultValues(Xi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case zi:return new gs;case Yi:return new Bt;case Xi:return new en;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({optional:!0,name:t.baseCertificateID||v,idBlock:{tagClass:3,tagNumber:0},value:gs.schema().valueBlock.value}),new q({optional:!0,name:t.entityName||v,idBlock:{tagClass:3,tagNumber:1},value:Bt.schema().valueBlock.value}),new q({optional:!0,name:t.objectDigestInfo||v,idBlock:{tagClass:3,tagNumber:2},value:en.schema().valueBlock.value})]})}fromSchema(e){Z(e,kp);const t=he(e,e,s.schema({names:{baseCertificateID:zi,entityName:Yi,objectDigestInfo:Xi}}));oe.assertSchema(t,this.className),zi in t.result&&(this.baseCertificateID=new gs({schema:new O({value:t.result.baseCertificateID.valueBlock.value})})),Yi in t.result&&(this.entityName=new Bt({schema:new O({value:t.result.entityName.valueBlock.value})})),Xi in t.result&&(this.objectDigestInfo=new en({schema:new O({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new O;return this.baseCertificateID&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.entityName&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:1},value:this.entityName.toSchema().valueBlock.value})),this.objectDigestInfo&&e.valueBlock.value.push(new q({idBlock:{tagClass:3,tagNumber:2},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.entityName&&(e.entityName=this.entityName.toJSON()),this.objectDigestInfo&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}return s.CLASS_NAME="Holder",s})();const ko="version",_o="holder",Co="issuer",No="signature",Io="serialNumber",Bo="attrCertValidityPeriod",Ro="attributes",Qi="issuerUniqueID",Zi="extensions",_p=[ko,_o,Co,No,Io,Bo,Ro,Qi,Zi];let Hu=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,ko,s.defaultValues(ko)),this.holder=l(e,_o,s.defaultValues(_o)),this.issuer=l(e,Co,s.defaultValues(Co)),this.signature=l(e,No,s.defaultValues(No)),this.serialNumber=l(e,Io,s.defaultValues(Io)),this.attrCertValidityPeriod=l(e,Bo,s.defaultValues(Bo)),this.attributes=l(e,Ro,s.defaultValues(Ro)),Qi in e&&(this.issuerUniqueID=l(e,Qi,s.defaultValues(Qi))),Zi in e&&(this.extensions=l(e,Zi,s.defaultValues(Zi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ko:return 1;case _o:return new Fu;case Co:return{};case No:return new Q;case Io:return new X;case Bo:return new $r;case Ro:return[];case Qi:return new Ze;case Zi:return new Rt;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.version||v}),Fu.schema(t.holder||{}),new ft({value:[Bt.schema({names:{blockName:t.issuer||v}}),new q({name:t.issuer||v,idBlock:{tagClass:3,tagNumber:0},value:Kd.schema().valueBlock.value})]}),Q.schema(t.signature||{}),new X({name:t.serialNumber||v}),$r.schema(t.attrCertValidityPeriod||{}),new O({name:t.attributes||v,value:[new $e({value:tt.schema()})]}),new Ze({optional:!0,name:t.issuerUniqueID||v}),Rt.schema(t.extensions||{},!0)]})}fromSchema(e){Z(e,_p);const t=he(e,e,s.schema({names:{version:ko,holder:{names:{blockName:_o}},issuer:Co,signature:{names:{blockName:No}},serialNumber:Io,attrCertValidityPeriod:{names:{blockName:Bo}},attributes:Ro,issuerUniqueID:Qi,extensions:{names:{blockName:Zi}}}}));if(3!==(oe.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.holder=new Fu({schema:t.result.holder}),t.result.issuer.idBlock.tagClass))throw new Error("Incorrect value for 'issuer' in AttributeCertificateInfoV2");this.issuer=new Kd({schema:new O({value:t.result.issuer.valueBlock.value})}),this.signature=new Q({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new $r({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,i=>new tt({schema:i})),Qi in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),Zi in t.result&&(this.extensions=new Rt({schema:t.result.extensions}))}toSchema(){const e=new O({value:[new X({value:this.version}),this.holder.toSchema(),new q({idBlock:{tagClass:3,tagNumber:0},value:this.issuer.toSchema().valueBlock.value}),this.signature.toSchema(),this.serialNumber,this.attrCertValidityPeriod.toSchema(),new O({value:Array.from(this.attributes,t=>t.toSchema())})]});return this.issuerUniqueID&&e.valueBlock.value.push(this.issuerUniqueID),this.extensions&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version,holder:this.holder.toJSON(),issuer:this.issuer.toJSON(),signature:this.signature.toJSON(),serialNumber:this.serialNumber.toJSON(),attrCertValidityPeriod:this.attrCertValidityPeriod.toJSON(),attributes:Array.from(this.attributes,t=>t.toJSON())};return this.issuerUniqueID&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),this.extensions&&(e.extensions=this.extensions.toJSON()),e}}return s.CLASS_NAME="AttributeCertificateInfoV2",s})();const To="acinfo",xo="signatureAlgorithm",Vo="signatureValue",Cp=[To,xo,Vo];let er=(()=>{class s extends fe{constructor(e={}){super(),this.acinfo=l(e,To,s.defaultValues(To)),this.signatureAlgorithm=l(e,xo,s.defaultValues(xo)),this.signatureValue=l(e,Vo,s.defaultValues(Vo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case To:return new Hu;case xo:return new Q;case Vo:return new Ze;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Hu.schema(t.acinfo||{}),Q.schema(t.signatureAlgorithm||{}),new Ze({name:t.signatureValue||v})]})}fromSchema(e){Z(e,Cp);const t=he(e,e,s.schema({names:{acinfo:{names:{blockName:To}},signatureAlgorithm:{names:{blockName:xo}},signatureValue:Vo}}));oe.assertSchema(t,this.className),this.acinfo=new Hu({schema:t.result.acinfo}),this.signatureAlgorithm=new Q({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new O({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}return s.CLASS_NAME="AttributeCertificateV2",s})();const tr="contentType",tn="content",Np=[tr,tn];let Ut=(()=>{class s extends fe{constructor(e={}){super(),this.contentType=l(e,tr,s.defaultValues(tr)),this.content=l(e,tn,s.defaultValues(tn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case tr:return v;case tn:return new Fe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case tr:return"string"==typeof t&&t===this.defaultValues(tr);case tn:return t instanceof Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return"optional"in t||(t.optional=!1),new O({name:t.blockName||"ContentInfo",optional:t.optional,value:[new Ve({name:t.contentType||tr}),new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.content||tn})]})]})}fromSchema(e){Z(e,Np);const t=he(e,e,s.schema());oe.assertSchema(t,this.className),this.contentType=t.result.contentType.valueBlock.toString(),this.content=t.result.content}toSchema(){return new O({value:[new Ve({value:this.contentType}),new q({idBlock:{tagClass:3,tagNumber:0},value:[this.content]})]})}toJSON(){const e={contentType:this.contentType};return this.content instanceof Fe||(e.content=this.content.toJSON()),e}}return s.CLASS_NAME="ContentInfo",s.DATA=bu,s.SIGNED_DATA="1.2.840.113549.1.7.2",s.ENVELOPED_DATA=rd,s.ENCRYPTED_DATA=nd,s})();const ju="type",$u="value",Ku="utcTimeName",Gu="generalTimeName",Ip=[Ku,Gu];let Tt=(()=>{class s extends fe{constructor(e={}){super(),this.type=l(e,ju,s.defaultValues(ju)),this.value=l(e,$u,s.defaultValues($u)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ju:return 0;case $u:return new Date(0,0,0);default:return super.defaultValues(e)}}static schema(e={},t=!1){const i=l(e,"names",{});return new ft({optional:t,value:[new Mr({name:i.utcTimeName||v}),new ht({name:i.generalTimeName||v})]})}fromSchema(e){Z(e,Ip);const t=he(e,e,s.schema({names:{utcTimeName:Ku,generalTimeName:Gu}}));oe.assertSchema(t,this.className),Ku in t.result&&(this.type=0,this.value=t.result.utcTimeName.toDate()),Gu in t.result&&(this.type=1,this.value=t.result.generalTimeName.toDate())}toSchema(){return 0===this.type?new Mr({valueDate:this.value}):1===this.type?new ht({valueDate:this.value}):{}}toJSON(){return{type:this.type,value:this.value}}}return s.CLASS_NAME="Time",s})();const Ys="version",Ql="serialNumber",Zl="signature",ec="issuer",tc="notBefore",sc="notAfter",ic="subject",rc="subjectPublicKeyInfo",Oo="issuerUniqueID",Po="subjectUniqueID",Do="extensions",Uo="signatureAlgorithm",Mo="signatureValue",Ft="tbsCertificate",nc=`${Ft}.${Ys}`,qu=`${Ft}.${Ql}`,Wu=`${Ft}.${Zl}`,zu=`${Ft}.${ec}`,ac=`${Ft}.${tc}`,oc=`${Ft}.${sc}`,Yu=`${Ft}.${ic}`,Xu=`${Ft}.${rc}`,lc=`${Ft}.${Oo}`,cc=`${Ft}.${Po}`,Lo=`${Ft}.${Do}`,Rp=[Ft,nc,qu,Wu,zu,ac,oc,Yu,Xu,lc,cc,Lo,Uo,Mo];function Tp(s={}){const r=l(s,"names",{});return new O({name:r.blockName||Ft,value:[new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new X({name:r.tbsCertificateVersion||nc})]}),new X({name:r.tbsCertificateSerialNumber||qu}),Q.schema(r.signature||{names:{blockName:Wu}}),dt.schema(r.issuer||{names:{blockName:zu}}),new O({name:r.tbsCertificateValidity||"tbsCertificate.validity",value:[Tt.schema(r.notBefore||{names:{utcTimeName:ac,generalTimeName:ac}}),Tt.schema(r.notAfter||{names:{utcTimeName:oc,generalTimeName:oc}})]}),dt.schema(r.subject||{names:{blockName:Yu}}),ns.schema(r.subjectPublicKeyInfo||{names:{blockName:Xu}}),new Le({name:r.tbsCertificateIssuerUniqueID||lc,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Le({name:r.tbsCertificateSubjectUniqueID||cc,optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[Rt.schema(r.extensions||{names:{blockName:Lo}})]})]})}let zt=(()=>{class s extends fe{get tbs(){return A._H.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(l(e,"tbs",s.defaultValues("tbs"))),this.version=l(e,Ys,s.defaultValues(Ys)),this.serialNumber=l(e,Ql,s.defaultValues(Ql)),this.signature=l(e,Zl,s.defaultValues(Zl)),this.issuer=l(e,ec,s.defaultValues(ec)),this.notBefore=l(e,tc,s.defaultValues(tc)),this.notAfter=l(e,sc,s.defaultValues(sc)),this.subject=l(e,ic,s.defaultValues(ic)),this.subjectPublicKeyInfo=l(e,rc,s.defaultValues(rc)),Oo in e&&(this.issuerUniqueID=l(e,Oo,s.defaultValues(Oo))),Po in e&&(this.subjectUniqueID=l(e,Po,s.defaultValues(Po))),Do in e&&(this.extensions=l(e,Do,s.defaultValues(Do))),this.signatureAlgorithm=l(e,Uo,s.defaultValues(Uo)),this.signatureValue=l(e,Mo,s.defaultValues(Mo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return Ct;case Ys:return 0;case Ql:return new X;case Zl:return new Q;case ec:return new dt;case tc:case sc:return new Tt;case ic:return new dt;case rc:return new ns;case Oo:case Po:return Ct;case Do:return[];case Uo:return new Q;case Mo:return new Ze;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Tp(t.tbsCertificate),Q.schema(t.signatureAlgorithm||{names:{blockName:Uo}}),new Ze({name:t.signatureValue||Mo})]})}fromSchema(e){Z(e,Rp);const t=he(e,e,s.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:Lo}}}}}}));oe.assertSchema(t,this.className),this.tbsView=t.result.tbsCertificate.valueBeforeDecodeView,nc in t.result&&(this.version=t.result[nc].valueBlock.valueDec),this.serialNumber=t.result[qu],this.signature=new Q({schema:t.result[Wu]}),this.issuer=new dt({schema:t.result[zu]}),this.notBefore=new Tt({schema:t.result[ac]}),this.notAfter=new Tt({schema:t.result[oc]}),this.subject=new dt({schema:t.result[Yu]}),this.subjectPublicKeyInfo=new ns({schema:t.result[Xu]}),lc in t.result&&(this.issuerUniqueID=t.result[lc].valueBlock.valueHex),cc in t.result&&(this.subjectUniqueID=t.result[cc].valueBlock.valueHex),Lo in t.result&&(this.extensions=Array.from(t.result[Lo],i=>new Li({schema:i}))),this.signatureAlgorithm=new Q({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return Ys in this&&this.version!==s.defaultValues(Ys)&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new X({value:this.version})]})),e.push(this.serialNumber),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(new O({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),e.push(this.subject.toSchema()),e.push(this.subjectPublicKeyInfo.toSchema()),this.issuerUniqueID&&e.push(new Le({optional:!0,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID})),this.subjectUniqueID&&e.push(new Le({optional:!0,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID})),this.extensions&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[new O({value:Array.from(this.extensions,t=>t.toSchema())})]})),new O({value:e})}toSchema(e=!1){let t;if(!1===e){if(!this.tbsView.byteLength)return s.schema().value[0];const i=ct(this.tbsView);oe.assert(i,"TBS Certificate"),t=i.result}else t=this.encodeTBS();return new O({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:A.U$.ToHex(this.tbsView),version:this.version,serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return Ys in this&&this.version!==s.defaultValues(Ys)&&(e.version=this.version),this.issuerUniqueID&&(e.issuerUniqueID=A.U$.ToHex(this.issuerUniqueID)),this.subjectUniqueID&&(e.subjectUniqueID=A.U$.ToHex(this.subjectUniqueID)),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}getPublicKey(e,t=Ge(!0)){var i=this;return(0,k.A)(function*(){return t.getPublicKey(i.subjectPublicKeyInfo,i.signatureAlgorithm,e)})()}getKeyHash(e="SHA-1",t=Ge(!0)){var i=this;return(0,k.A)(function*(){return t.digest({name:e},i.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView)})()}sign(e,t="SHA-1",i=Ge(!0)){var a=this;return(0,k.A)(function*(){if(!e)throw new Error("Need to provide a private key for signing");const o=yield i.getSignatureParameters(e,t),u=o.parameters;a.signature=o.signatureAlgorithm,a.signatureAlgorithm=o.signatureAlgorithm,a.tbsView=new Uint8Array(a.encodeTBS().toBER());const h=yield i.signWithPrivateKey(a.tbsView,e,u);a.signatureValue=new Ze({valueHex:h})})()}verify(e,t=Ge(!0)){var i=this;return(0,k.A)(function*(){let a;if(e?a=e.subjectPublicKeyInfo:i.issuer.isEqual(i.subject)&&(a=i.subjectPublicKeyInfo),!(a instanceof ns))throw new Error("Please provide issuer certificate as a parameter");return t.verifyWithPublicKey(i.tbsView,i.signatureValue,a,i.signatureAlgorithm)})()}}return s.CLASS_NAME="Certificate",s})();function Gd(s,r=null){if(r&&s.issuer.isEqual(r.issuer)&&s.serialNumber.isEqual(r.serialNumber))return null;let e=!1;if(s.extensions)for(const t of s.extensions)if(t.extnID===vu&&t.parsedValue instanceof ud&&t.parsedValue.cA){e=!0;break}return e?s:null}const sn="certId",rn="certValue",nn="parsedValue",xp=[sn,rn];let Qu=(()=>{class s extends fe{constructor(e={}){super(),this.certId=l(e,sn,s.defaultValues(sn)),this.certValue=l(e,rn,s.defaultValues(rn)),nn in e&&(this.parsedValue=l(e,nn,s.defaultValues(nn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case sn:return v;case rn:return new Fe;case nn:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case sn:return t===v;case rn:return t instanceof Fe;case nn:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.id||"id"}),new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.value||"value"})]})]})}fromSchema(e){Z(e,xp);const t=he(e,e,s.schema({names:{id:sn,value:rn}}));oe.assertSchema(t,this.className),this.certId=t.result.certId.valueBlock.toString(),this.certValue=t.result.certValue;const i=this.certValue.valueBlock.valueHexView;switch(this.certId){case ad:try{this.parsedValue=zt.fromBER(i)}catch{er.fromBER(i)}break;case od:this.parsedValue=er.fromBER(i);break;default:throw new Error(`Incorrect CERT_ID value in CertBag: ${this.certId}`)}}toSchema(){return nn in this&&(this.certId="acinfo"in this.parsedValue?od:ad,this.certValue=new de({valueHex:this.parsedValue.toSchema().toBER(!1)})),new O({value:[new Ve({value:this.certId}),new q({idBlock:{tagClass:3,tagNumber:0},value:["toSchema"in this.certValue?this.certValue.toSchema():this.certValue]})]})}toJSON(){return{certId:this.certId,certValue:this.certValue.toJSON()}}}return s.CLASS_NAME="CertBag",s})();const Fo="userCertificate",an="revocationDate",sr="crlEntryExtensions",Vp=[Fo,an,sr];let Op=(()=>{class s extends fe{constructor(e={}){super(),this.userCertificate=l(e,Fo,s.defaultValues(Fo)),this.revocationDate=l(e,an,s.defaultValues(an)),sr in e&&(this.crlEntryExtensions=l(e,sr,s.defaultValues(sr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fo:return new X;case an:return new Tt;case sr:return new Rt;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.userCertificate||Fo}),Tt.schema({names:{utcTimeName:t.revocationDate||an,generalTimeName:t.revocationDate||an}}),Rt.schema({names:{blockName:t.crlEntryExtensions||sr}},!0)]})}fromSchema(e){Z(e,Vp);const t=he(e,e,s.schema());oe.assertSchema(t,this.className),this.userCertificate=t.result.userCertificate,this.revocationDate=new Tt({schema:t.result.revocationDate}),sr in t.result&&(this.crlEntryExtensions=new Rt({schema:t.result.crlEntryExtensions}))}toSchema(){const e=[this.userCertificate,this.revocationDate.toSchema()];return this.crlEntryExtensions&&e.push(this.crlEntryExtensions.toSchema()),new O({value:e})}toJSON(){const e={userCertificate:this.userCertificate.toJSON(),revocationDate:this.revocationDate.toJSON()};return this.crlEntryExtensions&&(e.crlEntryExtensions=this.crlEntryExtensions.toJSON()),e}}return s.CLASS_NAME="RevokedCertificate",s})();const Ho="version",eh="signature",th="issuer",sh="thisUpdate",uc="nextUpdate",hc="revokedCertificates",fc="crlExtensions",jo="signatureAlgorithm",$o="signatureValue",ps="tbsCertList",dc=`${ps}.version`,ih=`${ps}.signature`,rh=`${ps}.issuer`,mc=`${ps}.thisUpdate`,Ko=`${ps}.nextUpdate`,gc=`${ps}.revokedCertificates`,pc=`${ps}.extensions`,Pp=[ps,dc,ih,rh,mc,Ko,gc,pc,jo,$o];function Dp(s={}){const r=l(s,"names",{});return new O({name:r.blockName||ps,value:[new X({optional:!0,name:r.tbsCertListVersion||dc,value:2}),Q.schema(r.signature||{names:{blockName:ih}}),dt.schema(r.issuer||{names:{blockName:rh}}),Tt.schema(r.tbsCertListThisUpdate||{names:{utcTimeName:mc,generalTimeName:mc}}),Tt.schema(r.tbsCertListNextUpdate||{names:{utcTimeName:Ko,generalTimeName:Ko}},!0),new O({optional:!0,value:[new $e({name:r.tbsCertListRevokedCertificates||gc,value:new O({value:[new X,Tt.schema(),Rt.schema({},!0)]})})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[Rt.schema(r.crlExtensions||{names:{blockName:pc}})]})]})}const Up=[yu,zf,"2.5.29.20","2.5.29.27",Yf,wu,Su,"2.5.29.21","2.5.29.24",Xf];let vc=(()=>{class s extends fe{get tbs(){return A._H.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(l(e,"tbs",s.defaultValues("tbs"))),this.version=l(e,Ho,s.defaultValues(Ho)),this.signature=l(e,eh,s.defaultValues(eh)),this.issuer=l(e,th,s.defaultValues(th)),this.thisUpdate=l(e,sh,s.defaultValues(sh)),uc in e&&(this.nextUpdate=l(e,uc,s.defaultValues(uc))),hc in e&&(this.revokedCertificates=l(e,hc,s.defaultValues(hc))),fc in e&&(this.crlExtensions=l(e,fc,s.defaultValues(fc))),this.signatureAlgorithm=l(e,jo,s.defaultValues(jo)),this.signatureValue=l(e,$o,s.defaultValues($o)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return Ct;case Ho:return 0;case eh:return new Q;case th:return new dt;case sh:case uc:return new Tt;case hc:return[];case fc:return new Rt;case jo:return new Q;case $o:return new Ze;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||"CertificateList",value:[Dp(e),Q.schema(t.signatureAlgorithm||{names:{blockName:jo}}),new Ze({name:t.signatureValue||$o})]})}fromSchema(e){Z(e,Pp);const t=he(e,e,s.schema());oe.assertSchema(t,this.className),this.tbsView=t.result.tbsCertList.valueBeforeDecodeView,dc in t.result&&(this.version=t.result[dc].valueBlock.valueDec),this.signature=new Q({schema:t.result[ih]}),this.issuer=new dt({schema:t.result[rh]}),this.thisUpdate=new Tt({schema:t.result[mc]}),Ko in t.result&&(this.nextUpdate=new Tt({schema:t.result[Ko]})),gc in t.result&&(this.revokedCertificates=Array.from(t.result[gc],i=>new Op({schema:i}))),pc in t.result&&(this.crlExtensions=new Rt({schema:t.result[pc]})),this.signatureAlgorithm=new Q({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return this.version!==s.defaultValues(Ho)&&e.push(new X({value:this.version})),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(this.thisUpdate.toSchema()),this.nextUpdate&&e.push(this.nextUpdate.toSchema()),this.revokedCertificates&&e.push(new O({value:Array.from(this.revokedCertificates,t=>t.toSchema())})),this.crlExtensions&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.crlExtensions.toSchema()]})),new O({value:e})}toSchema(e=!1){let t;if(e)t=this.encodeTBS();else{if(!this.tbsView.byteLength)return s.schema();const i=ct(this.tbsView);oe.assert(i,"TBS Certificate Revocation List"),t=i.result}return new O({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:A.U$.ToHex(this.tbsView),version:this.version,signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),thisUpdate:this.thisUpdate.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return this.version!==s.defaultValues(Ho)&&(e.version=this.version),this.nextUpdate&&(e.nextUpdate=this.nextUpdate.toJSON()),this.revokedCertificates&&(e.revokedCertificates=Array.from(this.revokedCertificates,t=>t.toJSON())),this.crlExtensions&&(e.crlExtensions=this.crlExtensions.toJSON()),e}isCertificateRevoked(e){if(!this.issuer.isEqual(e.issuer)||!this.revokedCertificates)return!1;for(const t of this.revokedCertificates)if(t.userCertificate.isEqual(e.serialNumber))return!0;return!1}sign(e,t="SHA-1",i=Ge(!0)){var a=this;return(0,k.A)(function*(){if(!e)throw new Error("Need to provide a private key for signing");const o=yield i.getSignatureParameters(e,t),{parameters:u}=o;a.signature=o.signatureAlgorithm,a.signatureAlgorithm=o.signatureAlgorithm,a.tbsView=new Uint8Array(a.encodeTBS().toBER());const h=yield i.signWithPrivateKey(a.tbsView,e,u);a.signatureValue=new Ze({valueHex:h})})()}verify(e={},t=Ge(!0)){var i=this;return(0,k.A)(function*(){let a;if(e.issuerCertificate&&(a=e.issuerCertificate.subjectPublicKeyInfo,!i.issuer.isEqual(e.issuerCertificate.subject)))return!1;if(e.publicKeyInfo&&(a=e.publicKeyInfo),!a)throw new Error("Issuer's certificate must be provided as an input parameter");if(i.crlExtensions)for(const o of i.crlExtensions.extensions)if(o.critical&&!Up.includes(o.extnID))return!1;return t.verifyWithPublicKey(i.tbsView,i.signatureValue,a,i.signatureAlgorithm)})()}}return s.CLASS_NAME="CertificateRevocationList",s})();const on="crlId",ln="crlValue",Go="parsedValue",Mp=[on,ln];let Lp=(()=>{class s extends fe{constructor(e={}){super(),this.crlId=l(e,on,s.defaultValues(on)),this.crlValue=l(e,ln,s.defaultValues(ln)),Go in e&&(this.parsedValue=l(e,Go,s.defaultValues(Go))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case on:return v;case ln:return new Fe;case Go:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case on:return t===v;case ln:return t instanceof Fe;case Go:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.id||"id"}),new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.value||"value"})]})]})}fromSchema(e){Z(e,Mp);const t=he(e,e,s.schema({names:{id:on,value:ln}}));if(oe.assertSchema(t,this.className),this.crlId=t.result.crlId.valueBlock.toString(),this.crlValue=t.result.crlValue,this.crlId!==ld)throw new Error(`Incorrect CRL_ID value in CRLBag: ${this.crlId}`);this.parsedValue=vc.fromBER(this.certValue.valueBlock.valueHex)}toSchema(){return this.parsedValue&&(this.crlId=ld,this.crlValue=new de({valueHex:this.parsedValue.toSchema().toBER(!1)})),new O({value:[new Ve({value:this.crlId}),new q({idBlock:{tagClass:3,tagNumber:0},value:[this.crlValue.toSchema()]})]})}toJSON(){return{crlId:this.crlId,crlValue:this.crlValue.toJSON()}}}return s.CLASS_NAME="CRLBag",s})();const cn="version",un="encryptedContentInfo",Xs="unprotectedAttrs",Fp=[cn,un,Xs];let wc=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,cn,s.defaultValues(cn)),this.encryptedContentInfo=l(e,un,s.defaultValues(un)),Xs in e&&(this.unprotectedAttrs=l(e,Xs,s.defaultValues(Xs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case cn:return 0;case un:return new Dt;case Xs:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case cn:return 0===t;case un:return Dt.compareWithDefault("contentType",t.contentType)&&Dt.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&Dt.compareWithDefault("encryptedContent",t.encryptedContent);case Xs:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.version||v}),Dt.schema(t.encryptedContentInfo||{}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new $e({name:t.unprotectedAttrs||v,value:tt.schema()})]})]})}fromSchema(e){Z(e,Fp);const t=he(e,e,s.schema({names:{version:cn,encryptedContentInfo:{names:{blockName:un}},unprotectedAttrs:Xs}}));oe.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.encryptedContentInfo=new Dt({schema:t.result.encryptedContentInfo}),Xs in t.result&&(this.unprotectedAttrs=Array.from(t.result.unprotectedAttrs,i=>new tt({schema:i})))}toSchema(){const e=[];return e.push(new X({value:this.version})),e.push(this.encryptedContentInfo.toSchema()),this.unprotectedAttrs&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={version:this.version,encryptedContentInfo:this.encryptedContentInfo.toJSON()};return this.unprotectedAttrs&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,t=>t.toJSON())),e}encrypt(e,t=Ge(!0)){var i=this;return(0,k.A)(function*(){ot.assert(e,"parameters","object");const a={...e,contentType:"1.2.840.113549.1.7.1"};i.encryptedContentInfo=yield t.encryptEncryptedContentInfo(a)})()}decrypt(e,t=Ge(!0)){var i=this;return(0,k.A)(function*(){ot.assert(e,"parameters","object");const a={...e,encryptedContentInfo:i.encryptedContentInfo};return t.decryptEncryptedContentInfo(a)})()}}return s.CLASS_NAME="EncryptedData",s})();const ir="encryptionAlgorithm",Qs="encryptedData",Jo="parsedValue",Hp=[ir,Qs];let Jd=(()=>{class s extends fe{constructor(e={}){super(),this.encryptionAlgorithm=l(e,ir,s.defaultValues(ir)),this.encryptedData=l(e,Qs,s.defaultValues(Qs)),Jo in e&&(this.parsedValue=l(e,Jo,s.defaultValues(Jo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ir:return new Q;case Qs:return new de;case Jo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ir:return Q.compareWithDefault("algorithmId",t.algorithmId)&&!("algorithmParams"in t);case Qs:return t.isEqual(s.defaultValues(e));case Jo:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Q.schema(t.encryptionAlgorithm||{names:{blockName:ir}}),new ft({value:[new de({name:t.encryptedData||Qs}),new de({idBlock:{isConstructed:!0},name:t.encryptedData||Qs})]})]})}fromSchema(e){Z(e,Hp);const t=he(e,e,s.schema({names:{encryptionAlgorithm:{names:{blockName:ir}},encryptedData:Qs}}));oe.assertSchema(t,this.className),this.encryptionAlgorithm=new Q({schema:t.result.encryptionAlgorithm}),this.encryptedData=t.result.encryptedData}toSchema(){return new O({value:[this.encryptionAlgorithm.toSchema(),this.encryptedData]})}toJSON(){return{encryptionAlgorithm:this.encryptionAlgorithm.toJSON(),encryptedData:this.encryptedData.toJSON()}}parseInternalValues(e,t=Ge(!0)){var i=this;return(0,k.A)(function*(){const o=yield new wc({encryptedContentInfo:new Dt({contentEncryptionAlgorithm:i.encryptionAlgorithm,encryptedContent:i.encryptedData})}).decrypt(e,t);i.parsedValue=Yr.fromBER(o)})()}makeInternalValues(e,t=Ge(!0)){var i=this;return(0,k.A)(function*(){if(!i.parsedValue)throw new Error('Please initialize "parsedValue" first');const a=new wc,o={...e,contentToEncrypt:i.parsedValue.toSchema().toBER(!1)};if(yield a.encrypt(o,t),!a.encryptedContentInfo.encryptedContent)throw new Error("The filed `encryptedContent` in EncryptedContentInfo is empty");i.encryptionAlgorithm=a.encryptedContentInfo.contentEncryptionAlgorithm,i.encryptedData=a.encryptedContentInfo.encryptedContent})()}}return s.CLASS_NAME="PKCS8ShroudedKeyBag",s})();const hn="secretTypeId",fn="secretValue",jp=[hn,fn];let $p=(()=>{class s extends fe{constructor(e={}){super(),this.secretTypeId=l(e,hn,s.defaultValues(hn)),this.secretValue=l(e,fn,s.defaultValues(fn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hn:return v;case fn:return new Fe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case hn:return t===v;case fn:return t instanceof Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.id||"id"}),new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.value||"value"})]})]})}fromSchema(e){Z(e,jp);const t=he(e,e,s.schema({names:{id:hn,value:fn}}));oe.assertSchema(t,this.className),this.secretTypeId=t.result.secretTypeId.valueBlock.toString(),this.secretValue=t.result.secretValue}toSchema(){return new O({value:[new Ve({value:this.secretTypeId}),new q({idBlock:{tagClass:3,tagNumber:0},value:[this.secretValue.toSchema()]})]})}toJSON(){return{secretTypeId:this.secretTypeId,secretValue:this.secretValue.toJSON()}}}return s.CLASS_NAME="SecretBag",s})();class Zs{static getItems(){return this.items||(this.items={},Zs.register("1.2.840.113549.1.12.10.1.1",Yr),Zs.register("1.2.840.113549.1.12.10.1.2",Jd),Zs.register("1.2.840.113549.1.12.10.1.3",Qu),Zs.register("1.2.840.113549.1.12.10.1.4",Lp),Zs.register("1.2.840.113549.1.12.10.1.5",$p),Zs.register("1.2.840.113549.1.12.10.1.6",ar)),this.items}static register(r,e){this.getItems()[r]=e}static find(r){return this.getItems()[r]||null}}const rr="bagId",nr="bagValue",vs="bagAttributes",Kp=[rr,nr,vs];let qo=(()=>{class s extends fe{constructor(e={}){super(),this.bagId=l(e,rr,s.defaultValues(rr)),this.bagValue=l(e,nr,s.defaultValues(nr)),vs in e&&(this.bagAttributes=l(e,vs,s.defaultValues(vs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case rr:return v;case nr:return new Fe;case vs:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case rr:return t===v;case nr:return t instanceof Fe;case vs:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.bagId||rr}),new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.bagValue||nr})]}),new _t({optional:!0,value:[new $e({name:t.bagAttributes||vs,value:tt.schema()})]})]})}fromSchema(e){Z(e,Kp);const t=he(e,e,s.schema({names:{bagId:rr,bagValue:nr,bagAttributes:vs}}));oe.assertSchema(t,this.className),this.bagId=t.result.bagId.valueBlock.toString();const i=Zs.find(this.bagId);if(!i)throw new Error(`Invalid BAG_ID for SafeBag: ${this.bagId}`);this.bagValue=new i({schema:t.result.bagValue}),vs in t.result&&(this.bagAttributes=Array.from(t.result.bagAttributes,a=>new tt({schema:a})))}toSchema(){const e=[new Ve({value:this.bagId}),new q({idBlock:{tagClass:3,tagNumber:0},value:[this.bagValue.toSchema()]})];return this.bagAttributes&&e.push(new _t({value:Array.from(this.bagAttributes,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={bagId:this.bagId,bagValue:this.bagValue.toJSON()};return this.bagAttributes&&(e.bagAttributes=Array.from(this.bagAttributes,t=>t.toJSON())),e}}return s.CLASS_NAME="SafeBag",s})();const dn="safeBags";let ar=(()=>{class s extends fe{constructor(e={}){super(),this.safeBags=l(e,dn,s.defaultValues(dn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===dn?[]:super.defaultValues(e)}static compareWithDefault(e,t){return e===dn?0===t.length:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new $e({name:t.safeBags||v,value:qo.schema()})]})}fromSchema(e){Z(e,[dn]);const t=he(e,e,s.schema({names:{safeBags:dn}}));oe.assertSchema(t,this.className),this.safeBags=Array.from(t.result.safeBags,i=>new qo({schema:i}))}toSchema(){return new O({value:Array.from(this.safeBags,e=>e.toSchema())})}toJSON(){return{safeBags:Array.from(this.safeBags,e=>e.toJSON())}}}return s.CLASS_NAME="SafeContents",s})();const Wo="otherCertFormat",zo="otherCert",Gp=[Wo,zo];class ei extends fe{constructor(r={}){super(),this.otherCertFormat=l(r,Wo,ei.defaultValues(Wo)),this.otherCert=l(r,zo,ei.defaultValues(zo)),r.schema&&this.fromSchema(r.schema)}static defaultValues(r){switch(r){case Wo:return v;case zo:return new Fe;default:return super.defaultValues(r)}}static schema(r={}){const e=l(r,"names",{});return new O({name:e.blockName||v,value:[new Ve({name:e.otherCertFormat||Wo}),new Fe({name:e.otherCert||zo})]})}fromSchema(r){Z(r,Gp);const e=he(r,r,ei.schema());oe.assertSchema(e,this.className),this.otherCertFormat=e.result.otherCertFormat.valueBlock.toString(),this.otherCert=e.result.otherCert}toSchema(){return new O({value:[new Ve({value:this.otherCertFormat}),this.otherCert]})}toJSON(){const r={otherCertFormat:this.otherCertFormat};return this.otherCert instanceof Fe||(r.otherCert=this.otherCert.toJSON()),r}}const Yo="certificates",Jp=[Yo];let mn=(()=>{class s extends fe{constructor(e={}){super(),this.certificates=l(e,Yo,s.defaultValues(Yo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Yo?[]:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new _t({name:t.blockName||v,value:[new $e({name:t.certificates||Yo,value:new ft({value:[zt.schema(),new q({idBlock:{tagClass:3,tagNumber:0},value:[new Fe]}),new q({idBlock:{tagClass:3,tagNumber:1},value:[new O]}),new q({idBlock:{tagClass:3,tagNumber:2},value:er.schema().valueBlock.value}),new q({idBlock:{tagClass:3,tagNumber:3},value:ei.schema().valueBlock.value})]})})]})}fromSchema(e){Z(e,Jp);const t=he(e,e,s.schema());oe.assertSchema(t,this.className),this.certificates=Array.from(t.result.certificates||[],i=>{const a=i.idBlock.tagNumber;if(1===i.idBlock.tagClass)return new zt({schema:i});const o=new O({value:i.valueBlock.value});switch(a){case 1:return 1===o.valueBlock.value[0].valueBlock.value[0].valueBlock.valueDec?new er({schema:o}):new Lu({schema:o});case 2:return new er({schema:o});case 3:return new ei({schema:o})}return i})}toSchema(){return new _t({value:Array.from(this.certificates,e=>{switch(!0){case e instanceof zt:return e.toSchema();case e instanceof Lu:return new q({idBlock:{tagClass:3,tagNumber:1},value:e.toSchema().valueBlock.value});case e instanceof er:return new q({idBlock:{tagClass:3,tagNumber:2},value:e.toSchema().valueBlock.value});case e instanceof ei:return new q({idBlock:{tagClass:3,tagNumber:3},value:e.toSchema().valueBlock.value})}return e.toSchema()})})}toJSON(){return{certificates:Array.from(this.certificates,e=>e.toJSON())}}}return s.CLASS_NAME="CertificateSet",s})();const Xo="otherRevInfoFormat",Qo="otherRevInfo",qp=[Xo,Qo];let yc=(()=>{class s extends fe{constructor(e={}){super(),this.otherRevInfoFormat=l(e,Xo,s.defaultValues(Xo)),this.otherRevInfo=l(e,Qo,s.defaultValues(Qo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Xo:return v;case Qo:return new Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.otherRevInfoFormat||Xo}),new Fe({name:t.otherRevInfo||Qo})]})}fromSchema(e){Z(e,qp);const t=he(e,e,s.schema());oe.assertSchema(t,this.className),this.otherRevInfoFormat=t.result.otherRevInfoFormat.valueBlock.toString(),this.otherRevInfo=t.result.otherRevInfo}toSchema(){return new O({value:[new Ve({value:this.otherRevInfoFormat}),this.otherRevInfo]})}toJSON(){const e={otherRevInfoFormat:this.otherRevInfoFormat};return this.otherRevInfo instanceof Fe||(e.otherRevInfo=this.otherRevInfo.toJSON()),e}}return s.CLASS_NAME="OtherRevocationInfoFormat",s})();const Zo="crls",nh="otherRevocationInfos",Wp=[Zo];let Sc=(()=>{class s extends fe{constructor(e={}){super(),this.crls=l(e,Zo,s.defaultValues(Zo)),this.otherRevocationInfos=l(e,nh,s.defaultValues(nh)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Zo:case nh:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new _t({name:t.blockName||v,value:[new $e({name:t.crls||v,value:new ft({value:[vc.schema(),new q({idBlock:{tagClass:3,tagNumber:1},value:[new Ve,new Fe]})]})})]})}fromSchema(e){Z(e,Wp);const t=he(e,e,s.schema({names:{crls:Zo}}));if(oe.assertSchema(t,this.className),t.result.crls)for(const i of t.result.crls)1===i.idBlock.tagClass?this.crls.push(new vc({schema:i})):this.otherRevocationInfos.push(new yc({schema:i}))}toSchema(){const e=[];return e.push(...Array.from(this.crls,t=>t.toSchema())),e.push(...Array.from(this.otherRevocationInfos,t=>{const i=t.toSchema();return i.idBlock.tagClass=3,i.idBlock.tagNumber=1,i})),new _t({value:e})}toJSON(){return{crls:Array.from(this.crls,e=>e.toJSON()),otherRevocationInfos:Array.from(this.otherRevocationInfos,e=>e.toJSON())}}}return s.CLASS_NAME="RevocationInfoChoices",s})();const el="certs",or="crls",zp=[el,or];let ah=(()=>{class s extends fe{constructor(e={}){super(),this.crls=l(e,or,s.defaultValues(or)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case el:return new mn;case or:return new Sc;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case el:return 0===t.certificates.length;case or:return 0===t.crls.length&&0===t.otherRevocationInfos.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({name:t.certs||v,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:mn.schema().valueBlock.value}),new q({name:t.crls||v,optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Sc.schema().valueBlock.value})]})}fromSchema(e){Z(e,zp);const t=he(e,e,s.schema({names:{certs:el,crls:or}}));oe.assertSchema(t,this.className),el in t.result&&(this.certs=new mn({schema:new _t({value:t.result.certs.valueBlock.value})})),or in t.result&&(this.crls=new Sc({schema:new _t({value:t.result.crls.valueBlock.value})}))}toSchema(){const e=[];return this.certs&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:this.certs.toSchema().valueBlock.value})),this.crls&&e.push(new q({idBlock:{tagClass:3,tagNumber:1},value:this.crls.toSchema().valueBlock.value})),new O({value:e})}toJSON(){const e={};return this.certs&&(e.certs=this.certs.toJSON()),this.crls&&(e.crls=this.crls.toJSON()),e}}return s.CLASS_NAME="OriginatorInfo",s})();const tl="issuer",sl="serialNumber",Yp=[tl,sl];let xt=(()=>{class s extends fe{constructor(e={}){super(),this.issuer=l(e,tl,s.defaultValues(tl)),this.serialNumber=l(e,sl,s.defaultValues(sl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case tl:return new dt;case sl:return new X;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[dt.schema(t.issuer||{}),new X({name:t.serialNumber||v})]})}fromSchema(e){Z(e,Yp);const t=he(e,e,s.schema({names:{issuer:{names:{blockName:tl}},serialNumber:sl}}));oe.assertSchema(t,this.className),this.issuer=new dt({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber}toSchema(){return new O({value:[this.issuer.toSchema(),this.serialNumber]})}toJSON(){return{issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()}}}return s.CLASS_NAME="IssuerAndSerialNumber",s})();const bc="variant",il="value",Xp=["blockName"];let Qp=(()=>{class s extends fe{constructor(e={}){super(),this.variant=l(e,bc,s.defaultValues(bc)),il in e&&(this.value=l(e,il,s.defaultValues(il))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case bc:return-1;case il:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case bc:return-1===t;case il:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new ft({value:[xt.schema({names:{blockName:t.blockName||v}}),new Le({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:0}})]})}fromSchema(e){Z(e,Xp);const t=he(e,e,s.schema({names:{blockName:"blockName"}}));oe.assertSchema(t,this.className),1===t.result.blockName.idBlock.tagClass?(this.variant=1,this.value=new xt({schema:t.result.blockName})):(this.variant=2,this.value=new de({valueHex:t.result.blockName.valueBlock.valueHex}))}toSchema(){switch(this.variant){case 1:if(!(this.value instanceof xt))throw new Error("Incorrect type of RecipientIdentifier.value. It should be IssuerAndSerialNumber.");return this.value.toSchema();case 2:if(!(this.value instanceof de))throw new Error("Incorrect type of RecipientIdentifier.value. It should be ASN.1 OctetString.");return new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:this.value.valueBlock.valueHexView});default:return new Fe}}toJSON(){const e={variant:this.variant};return(1===this.variant||2===this.variant)&&this.value&&(e.value=this.value.toJSON()),e}}return s.CLASS_NAME="RecipientIdentifier",s})();const lr="version",gn="rid",pn="keyEncryptionAlgorithm",vn="encryptedKey",Ac="recipientCertificate",Zp=[lr,gn,pn,vn];let oh=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,lr,s.defaultValues(lr)),this.rid=l(e,gn,s.defaultValues(gn)),this.keyEncryptionAlgorithm=l(e,pn,s.defaultValues(pn)),this.encryptedKey=l(e,vn,s.defaultValues(vn)),this.recipientCertificate=l(e,Ac,s.defaultValues(Ac)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case lr:return-1;case gn:return{};case pn:return new Q;case vn:return new de;case Ac:return new zt;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case lr:return t===s.defaultValues(lr);case gn:return 0===Object.keys(t).length;case pn:case vn:return t.isEqual(s.defaultValues(e));case Ac:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.version||v}),Qp.schema(t.rid||{}),Q.schema(t.keyEncryptionAlgorithm||{}),new de({name:t.encryptedKey||v})]})}fromSchema(e){Z(e,Zp);const t=he(e,e,s.schema({names:{version:lr,rid:{names:{blockName:gn}},keyEncryptionAlgorithm:{names:{blockName:pn}},encryptedKey:vn}}));oe.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.rid=3===t.result.rid.idBlock.tagClass?new de({valueHex:t.result.rid.valueBlock.valueHex}):new xt({schema:t.result.rid}),this.keyEncryptionAlgorithm=new Q({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){const e=[];return this.rid instanceof xt?(this.version=0,e.push(new X({value:this.version})),e.push(this.rid.toSchema())):(this.version=2,e.push(new X({value:this.version})),e.push(new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:this.rid.valueBlock.valueHexView}))),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new O({value:e})}toJSON(){return{version:this.version,rid:this.rid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}return s.CLASS_NAME="KeyTransRecipientInfo",s})();const wn="algorithm",yn="publicKey",ev=[wn,yn];let lh=(()=>{class s extends fe{constructor(e={}){super(),this.algorithm=l(e,wn,s.defaultValues(wn)),this.publicKey=l(e,yn,s.defaultValues(yn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wn:return new Q;case yn:return new Ze;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case wn:case yn:return t.isEqual(s.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Q.schema(t.algorithm||{}),new Ze({name:t.publicKey||v})]})}fromSchema(e){Z(e,ev);const t=he(e,e,s.schema({names:{algorithm:{names:{blockName:wn}},publicKey:yn}}));oe.assertSchema(t,this.className),this.algorithm=new Q({schema:t.result.algorithm}),this.publicKey=t.result.publicKey}toSchema(){return new O({value:[this.algorithm.toSchema(),this.publicKey]})}toJSON(){return{algorithm:this.algorithm.toJSON(),publicKey:this.publicKey.toJSON()}}}return s.CLASS_NAME="OriginatorPublicKey",s})();const Ec="variant",rl="value",tv=["blockName"];let kc=(()=>{class s extends fe{constructor(e={}){super(),this.variant=l(e,Ec,s.defaultValues(Ec)),rl in e&&(this.value=l(e,rl,s.defaultValues(rl))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ec:return-1;case rl:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ec:return-1===t;case rl:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new ft({value:[xt.schema({names:{blockName:t.blockName||v}}),new Le({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||v}),new q({idBlock:{tagClass:3,tagNumber:1},name:t.blockName||v,value:lh.schema().valueBlock.value})]})}fromSchema(e){Z(e,tv);const t=he(e,e,s.schema({names:{blockName:"blockName"}}));oe.assertSchema(t,this.className),1===t.result.blockName.idBlock.tagClass?(this.variant=1,this.value=new xt({schema:t.result.blockName})):0===t.result.blockName.idBlock.tagNumber?(t.result.blockName.idBlock.tagClass=1,t.result.blockName.idBlock.tagNumber=4,this.variant=2,this.value=t.result.blockName):(this.variant=3,this.value=new lh({schema:new O({value:t.result.blockName.valueBlock.value})}))}toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return this.value.idBlock.tagClass=3,this.value.idBlock.tagNumber=0,this.value;case 3:{const e=this.value.toSchema();return e.idBlock.tagClass=3,e.idBlock.tagNumber=1,e}default:return new Fe}}toJSON(){const e={variant:this.variant};return(1===this.variant||2===this.variant||3===this.variant)&&(e.value=this.value.toJSON()),e}}return s.CLASS_NAME="OriginatorIdentifierOrKey",s})();const Sn="keyAttrId",as="keyAttr",sv=[Sn,as];let bn=(()=>{class s extends fe{constructor(e={}){super(),this.keyAttrId=l(e,Sn,s.defaultValues(Sn)),as in e&&(this.keyAttr=l(e,as,s.defaultValues(as))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Sn:return v;case as:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Sn:return"string"==typeof t&&t===v;case as:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({optional:t.optional||!0,name:t.blockName||v,value:[new Ve({name:t.keyAttrId||v}),new Fe({optional:!0,name:t.keyAttr||v})]})}fromSchema(e){Z(e,sv);const t=he(e,e,s.schema({names:{keyAttrId:Sn,keyAttr:as}}));oe.assertSchema(t,this.className),this.keyAttrId=t.result.keyAttrId.valueBlock.toString(),as in t.result&&(this.keyAttr=t.result.keyAttr)}toSchema(){const e=[];return e.push(new Ve({value:this.keyAttrId})),as in this&&e.push(this.keyAttr),new O({value:e})}toJSON(){const e={keyAttrId:this.keyAttrId};return as in this&&(e.keyAttr=this.keyAttr.toJSON()),e}}return s.CLASS_NAME="OtherKeyAttribute",s})();const cr="subjectKeyIdentifier",ti="date",si="other",iv=[cr,ti,si];let ch=(()=>{class s extends fe{constructor(e={}){super(),this.subjectKeyIdentifier=l(e,cr,s.defaultValues(cr)),ti in e&&(this.date=l(e,ti,s.defaultValues(ti))),si in e&&(this.other=l(e,si,s.defaultValues(si))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case cr:return new de;case ti:return new ht;case si:return new bn;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case cr:return t.isEqual(s.defaultValues(cr));case ti:return 0===t.year&&0===t.month&&0===t.day&&0===t.hour&&0===t.minute&&0===t.second&&0===t.millisecond;case si:return t.keyAttrId===v&&!("keyAttr"in t);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new de({name:t.subjectKeyIdentifier||v}),new ht({optional:!0,name:t.date||v}),bn.schema(t.other||{})]})}fromSchema(e){Z(e,iv);const t=he(e,e,s.schema({names:{subjectKeyIdentifier:cr,date:ti,other:{names:{blockName:si}}}}));oe.assertSchema(t,this.className),this.subjectKeyIdentifier=t.result.subjectKeyIdentifier,ti in t.result&&(this.date=t.result.date),si in t.result&&(this.other=new bn({schema:t.result.other}))}toSchema(){const e=[];return e.push(this.subjectKeyIdentifier),this.date&&e.push(this.date),this.other&&e.push(this.other.toSchema()),new O({value:e})}toJSON(){const e={subjectKeyIdentifier:this.subjectKeyIdentifier.toJSON()};return this.date&&(e.date=this.date.toJSON()),this.other&&(e.other=this.other.toJSON()),e}}return s.CLASS_NAME="RecipientKeyIdentifier",s})();const _c="variant",Cc="value",rv=["blockName"];let nl=(()=>{class s extends fe{constructor(e={}){super(),this.variant=l(e,_c,s.defaultValues(_c)),this.value=l(e,Cc,s.defaultValues(Cc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case _c:return-1;case Cc:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case _c:return-1===t;case Cc:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new ft({value:[xt.schema(t.issuerAndSerialNumber||{names:{blockName:t.blockName||v}}),new q({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:0},value:ch.schema(t.rKeyId||{names:{blockName:t.blockName||v}}).valueBlock.value})]})}fromSchema(e){Z(e,rv);const t=he(e,e,s.schema({names:{blockName:"blockName"}}));oe.assertSchema(t,this.className),1===t.result.blockName.idBlock.tagClass?(this.variant=1,this.value=new xt({schema:t.result.blockName})):(this.variant=2,this.value=new ch({schema:new O({value:t.result.blockName.valueBlock.value})}))}toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return new q({idBlock:{tagClass:3,tagNumber:0},value:this.value.toSchema().valueBlock.value});default:return new Fe}}toJSON(){const e={variant:this.variant};return(1===this.variant||2===this.variant)&&(e.value=this.value.toJSON()),e}}return s.CLASS_NAME="KeyAgreeRecipientIdentifier",s})();const An="rid",ur="encryptedKey",nv=[An,ur];let uh=(()=>{class s extends fe{constructor(e={}){super(),this.rid=l(e,An,s.defaultValues(An)),this.encryptedKey=l(e,ur,s.defaultValues(ur)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case An:return new nl;case ur:return new de;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case An:return-1===t.variant&&!("value"in t);case ur:return t.isEqual(s.defaultValues(ur));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[nl.schema(t.rid||{}),new de({name:t.encryptedKey||v})]})}fromSchema(e){Z(e,nv);const t=he(e,e,s.schema({names:{rid:{names:{blockName:An}},encryptedKey:ur}}));oe.assertSchema(t,this.className),this.rid=new nl({schema:t.result.rid}),this.encryptedKey=t.result.encryptedKey}toSchema(){return new O({value:[this.rid.toSchema(),this.encryptedKey]})}toJSON(){return{rid:this.rid.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}return s.CLASS_NAME="RecipientEncryptedKey",s})();const Nc="encryptedKeys",qd="RecipientEncryptedKeys",av=[qd];let Ic=(()=>{class s extends fe{constructor(e={}){super(),this.encryptedKeys=l(e,Nc,s.defaultValues(Nc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Nc?[]:super.defaultValues(e)}static compareWithDefault(e,t){return e===Nc?0===t.length:super.defaultValues(e)}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new $e({name:t.RecipientEncryptedKeys||v,value:uh.schema()})]})}fromSchema(e){Z(e,av);const t=he(e,e,s.schema({names:{RecipientEncryptedKeys:qd}}));oe.assertSchema(t,this.className),this.encryptedKeys=Array.from(t.result.RecipientEncryptedKeys,i=>new uh({schema:i}))}toSchema(){return new O({value:Array.from(this.encryptedKeys,e=>e.toSchema())})}toJSON(){return{encryptedKeys:Array.from(this.encryptedKeys,e=>e.toJSON())}}}return s.CLASS_NAME="RecipientEncryptedKeys",s})();const En="version",kn="originator",ws="ukm",_n="keyEncryptionAlgorithm",Cn="recipientEncryptedKeys",Bc="recipientCertificate",Rc="recipientPublicKey",ov=[En,kn,ws,_n,Cn];let hh=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,En,s.defaultValues(En)),this.originator=l(e,kn,s.defaultValues(kn)),ws in e&&(this.ukm=l(e,ws,s.defaultValues(ws))),this.keyEncryptionAlgorithm=l(e,_n,s.defaultValues(_n)),this.recipientEncryptedKeys=l(e,Cn,s.defaultValues(Cn)),this.recipientCertificate=l(e,Bc,s.defaultValues(Bc)),this.recipientPublicKey=l(e,Rc,s.defaultValues(Rc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case En:return 0;case kn:return new kc;case ws:return new de;case _n:return new Q;case Cn:return new Ic;case Bc:return new zt;case Rc:return null;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case En:return 0===t;case kn:return-1===t.variant&&!("value"in t);case ws:return t.isEqual(s.defaultValues(ws));case _n:return t.algorithmId===v&&!("algorithmParams"in t);case Cn:return 0===t.encryptedKeys.length;case Bc:case Rc:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.version||v}),new q({idBlock:{tagClass:3,tagNumber:0},value:[kc.schema(t.originator||{})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new de({name:t.ukm||v})]}),Q.schema(t.keyEncryptionAlgorithm||{}),Ic.schema(t.recipientEncryptedKeys||{})]})}fromSchema(e){Z(e,ov);const t=he(e,e,s.schema({names:{version:En,originator:{names:{blockName:kn}},ukm:ws,keyEncryptionAlgorithm:{names:{blockName:_n}},recipientEncryptedKeys:{names:{blockName:Cn}}}}));oe.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.originator=new kc({schema:t.result.originator}),ws in t.result&&(this.ukm=t.result.ukm),this.keyEncryptionAlgorithm=new Q({schema:t.result.keyEncryptionAlgorithm}),this.recipientEncryptedKeys=new Ic({schema:t.result.recipientEncryptedKeys})}toSchema(){const e=[];return e.push(new X({value:this.version})),e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[this.originator.toSchema()]})),this.ukm&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[this.ukm]})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.recipientEncryptedKeys.toSchema()),new O({value:e})}toJSON(){const e={version:this.version,originator:this.originator.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),recipientEncryptedKeys:this.recipientEncryptedKeys.toJSON()};return this.ukm&&(e.ukm=this.ukm.toJSON()),e}}return s.CLASS_NAME="KeyAgreeRecipientInfo",s})();const hr="keyIdentifier",ii="date",ri="other",lv=[hr,ii,ri];let Tc=(()=>{class s extends fe{constructor(e={}){super(),this.keyIdentifier=l(e,hr,s.defaultValues(hr)),ii in e&&(this.date=l(e,ii,s.defaultValues(ii))),ri in e&&(this.other=l(e,ri,s.defaultValues(ri))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hr:return new de;case ii:return new ht;case ri:return new bn;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case hr:return t.isEqual(s.defaultValues(hr));case ii:return 0===t.year&&0===t.month&&0===t.day&&0===t.hour&&0===t.minute&&0===t.second&&0===t.millisecond;case ri:return t.compareWithDefault("keyAttrId",t.keyAttrId)&&!("keyAttr"in t);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new de({name:t.keyIdentifier||v}),new ht({optional:!0,name:t.date||v}),bn.schema(t.other||{})]})}fromSchema(e){Z(e,lv);const t=he(e,e,s.schema({names:{keyIdentifier:hr,date:ii,other:{names:{blockName:ri}}}}));oe.assertSchema(t,this.className),this.keyIdentifier=t.result.keyIdentifier,ii in t.result&&(this.date=t.result.date),ri in t.result&&(this.other=new bn({schema:t.result.other}))}toSchema(){const e=[];return e.push(this.keyIdentifier),this.date&&e.push(this.date),this.other&&e.push(this.other.toSchema()),new O({value:e})}toJSON(){const e={keyIdentifier:this.keyIdentifier.toJSON()};return this.date&&(e.date=this.date),this.other&&(e.other=this.other.toJSON()),e}}return s.CLASS_NAME="KEKIdentifier",s})();const Nn="version",In="kekid",Bn="keyEncryptionAlgorithm",fr="encryptedKey",xc="preDefinedKEK",cv=[Nn,In,Bn,fr];let fh=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,Nn,s.defaultValues(Nn)),this.kekid=l(e,In,s.defaultValues(In)),this.keyEncryptionAlgorithm=l(e,Bn,s.defaultValues(Bn)),this.encryptedKey=l(e,fr,s.defaultValues(fr)),this.preDefinedKEK=l(e,xc,s.defaultValues(xc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Nn:return 0;case In:return new Tc;case Bn:return new Q;case fr:return new de;case xc:return Ct;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"KEKRecipientInfo":return t===s.defaultValues(Nn);case In:return t.compareWithDefault("keyIdentifier",t.keyIdentifier)&&!("date"in t)&&!("other"in t);case Bn:return t.algorithmId===v&&!("algorithmParams"in t);case fr:return t.isEqual(s.defaultValues(fr));case xc:return 0===t.byteLength;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.version||v}),Tc.schema(t.kekid||{}),Q.schema(t.keyEncryptionAlgorithm||{}),new de({name:t.encryptedKey||v})]})}fromSchema(e){Z(e,cv);const t=he(e,e,s.schema({names:{version:Nn,kekid:{names:{blockName:In}},keyEncryptionAlgorithm:{names:{blockName:Bn}},encryptedKey:fr}}));oe.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.kekid=new Tc({schema:t.result.kekid}),this.keyEncryptionAlgorithm=new Q({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){return new O({value:[new X({value:this.version}),this.kekid.toSchema(),this.keyEncryptionAlgorithm.toSchema(),this.encryptedKey]})}toJSON(){return{version:this.version,kekid:this.kekid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}return s.CLASS_NAME="KEKRecipientInfo",s})();const Rn="version",ni="keyDerivationAlgorithm",Tn="keyEncryptionAlgorithm",dr="encryptedKey",Vc="password",uv=[Rn,ni,Tn,dr];let dh=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,Rn,s.defaultValues(Rn)),ni in e&&(this.keyDerivationAlgorithm=l(e,ni,s.defaultValues(ni))),this.keyEncryptionAlgorithm=l(e,Tn,s.defaultValues(Tn)),this.encryptedKey=l(e,dr,s.defaultValues(dr)),this.password=l(e,Vc,s.defaultValues(Vc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Rn:return-1;case ni:case Tn:return new Q;case dr:return new de;case Vc:return Ct;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Rn:return-1===t;case ni:case Tn:return t.algorithmId===v&&!("algorithmParams"in t);case dr:return t.isEqual(s.defaultValues(dr));case Vc:return 0===t.byteLength;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.version||v}),new q({name:t.keyDerivationAlgorithm||v,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Q.schema().valueBlock.value}),Q.schema(t.keyEncryptionAlgorithm||{}),new de({name:t.encryptedKey||v})]})}fromSchema(e){Z(e,uv);const t=he(e,e,s.schema({names:{version:Rn,keyDerivationAlgorithm:ni,keyEncryptionAlgorithm:{names:{blockName:Tn}},encryptedKey:dr}}));oe.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,ni in t.result&&(this.keyDerivationAlgorithm=new Q({schema:new O({value:t.result.keyDerivationAlgorithm.valueBlock.value})})),this.keyEncryptionAlgorithm=new Q({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){const e=[];return e.push(new X({value:this.version})),this.keyDerivationAlgorithm&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:this.keyDerivationAlgorithm.toSchema().valueBlock.value})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new O({value:e})}toJSON(){const e={version:this.version,keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()};return this.keyDerivationAlgorithm&&(e.keyDerivationAlgorithm=this.keyDerivationAlgorithm.toJSON()),e}}return s.CLASS_NAME="PasswordRecipientInfo",s})();const xn="oriType",mr="oriValue",hv=[xn,mr];let Wd=(()=>{class s extends fe{constructor(e={}){super(),this.oriType=l(e,xn,s.defaultValues(xn)),this.oriValue=l(e,mr,s.defaultValues(mr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xn:return v;case mr:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case xn:return t===v;case mr:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.oriType||v}),new Fe({name:t.oriValue||v})]})}fromSchema(e){Z(e,hv);const t=he(e,e,s.schema({names:{oriType:xn,oriValue:mr}}));oe.assertSchema(t,this.className),this.oriType=t.result.oriType.valueBlock.toString(),this.oriValue=t.result.oriValue}toSchema(){return new O({value:[new Ve({value:this.oriType}),this.oriValue]})}toJSON(){const e={oriType:this.oriType};return s.compareWithDefault(mr,this.oriValue)||(e.oriValue=this.oriValue.toJSON()),e}}return s.CLASS_NAME="OtherRecipientInfo",s})();const Oc="variant",al="value",fv=["blockName"];let Vn=(()=>{class s extends fe{constructor(e={}){super(),this.variant=l(e,Oc,s.defaultValues(Oc)),al in e&&(this.value=l(e,al,s.defaultValues(al))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Oc:return-1;case al:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Oc:return t===s.defaultValues(e);case al:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new ft({value:[oh.schema({names:{blockName:t.blockName||v}}),new q({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:1},value:hh.schema().valueBlock.value}),new q({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:2},value:fh.schema().valueBlock.value}),new q({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:3},value:dh.schema().valueBlock.value}),new q({name:t.blockName||v,idBlock:{tagClass:3,tagNumber:4},value:Wd.schema().valueBlock.value})]})}fromSchema(e){Z(e,fv);const t=he(e,e,s.schema({names:{blockName:"blockName"}}));if(oe.assertSchema(t,this.className),1===t.result.blockName.idBlock.tagClass)this.variant=1,this.value=new oh({schema:t.result.blockName});else{const i=new O({value:t.result.blockName.valueBlock.value});switch(t.result.blockName.idBlock.tagNumber){case 1:this.variant=2,this.value=new hh({schema:i});break;case 2:this.variant=3,this.value=new fh({schema:i});break;case 3:this.variant=4,this.value=new dh({schema:i});break;case 4:this.variant=5,this.value=new Wd({schema:i});break;default:throw new Error("Incorrect structure of RecipientInfo block")}}}toSchema(){et.assertEmpty(this.value,"value","RecipientInfo");const e=this.value.toSchema();switch(this.variant){case 1:return e;case 2:case 3:case 4:return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.variant-1,e;default:return new Fe}}toJSON(){const e={variant:this.variant};return this.value&&this.variant>=1&&this.variant<=4&&(e.value=this.value.toJSON()),e}}return s.CLASS_NAME="RecipientInfo",s})();const ai="hashAlgorithm",oi="maskGenAlgorithm",li="pSourceAlgorithm",dv=[ai,oi,li];let mh=(()=>{class s extends fe{constructor(e={}){super(),this.hashAlgorithm=l(e,ai,s.defaultValues(ai)),this.maskGenAlgorithm=l(e,oi,s.defaultValues(oi)),this.pSourceAlgorithm=l(e,li,s.defaultValues(li)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ai:return new Q({algorithmId:"1.3.14.3.2.26",algorithmParams:new kt});case oi:return new Q({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new Q({algorithmId:"1.3.14.3.2.26",algorithmParams:new kt}).toSchema()});case li:return new Q({algorithmId:"1.2.840.113549.1.1.9",algorithmParams:new de({valueHex:new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer})});default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new q({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[Q.schema(t.hashAlgorithm||{})]}),new q({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[Q.schema(t.maskGenAlgorithm||{})]}),new q({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[Q.schema(t.pSourceAlgorithm||{})]})]})}fromSchema(e){Z(e,dv);const t=he(e,e,s.schema({names:{hashAlgorithm:{names:{blockName:ai}},maskGenAlgorithm:{names:{blockName:oi}},pSourceAlgorithm:{names:{blockName:li}}}}));oe.assertSchema(t,this.className),ai in t.result&&(this.hashAlgorithm=new Q({schema:t.result.hashAlgorithm})),oi in t.result&&(this.maskGenAlgorithm=new Q({schema:t.result.maskGenAlgorithm})),li in t.result&&(this.pSourceAlgorithm=new Q({schema:t.result.pSourceAlgorithm}))}toSchema(){const e=[];return this.hashAlgorithm.isEqual(s.defaultValues(ai))||e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(s.defaultValues(oi))||e.push(new q({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.pSourceAlgorithm.isEqual(s.defaultValues(li))||e.push(new q({idBlock:{tagClass:3,tagNumber:2},value:[this.pSourceAlgorithm.toSchema()]})),new O({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(s.defaultValues(ai))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(s.defaultValues(oi))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.pSourceAlgorithm.isEqual(s.defaultValues(li))||(e.pSourceAlgorithm=this.pSourceAlgorithm.toJSON()),e}}return s.CLASS_NAME="RSAESOAEPParams",s})();const On="keyInfo",ci="entityUInfo",Pn="suppPubInfo",mv=[On,ci,Pn];let zd=(()=>{class s extends fe{constructor(e={}){super(),this.keyInfo=l(e,On,s.defaultValues(On)),ci in e&&(this.entityUInfo=l(e,ci,s.defaultValues(ci))),this.suppPubInfo=l(e,Pn,s.defaultValues(Pn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case On:return new Q;case ci:case Pn:return new de;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case On:case ci:case Pn:return t.isEqual(s.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Q.schema(t.keyInfo||{}),new q({name:t.entityUInfo||v,idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[new de]}),new q({name:t.suppPubInfo||v,idBlock:{tagClass:3,tagNumber:2},value:[new de]})]})}fromSchema(e){Z(e,mv);const t=he(e,e,s.schema({names:{keyInfo:{names:{blockName:On}},entityUInfo:ci,suppPubInfo:Pn}}));oe.assertSchema(t,this.className),this.keyInfo=new Q({schema:t.result.keyInfo}),ci in t.result&&(this.entityUInfo=t.result.entityUInfo.valueBlock.value[0]),this.suppPubInfo=t.result.suppPubInfo.valueBlock.value[0]}toSchema(){const e=[];return e.push(this.keyInfo.toSchema()),this.entityUInfo&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[this.entityUInfo]})),e.push(new q({idBlock:{tagClass:3,tagNumber:2},value:[this.suppPubInfo]})),new O({value:e})}toJSON(){const e={keyInfo:this.keyInfo.toJSON(),suppPubInfo:this.suppPubInfo.toJSON()};return this.entityUInfo&&(e.entityUInfo=this.entityUInfo.toJSON()),e}}return s.CLASS_NAME="ECCCMSSharedInfo",s})();const Dn="version",ui="originatorInfo",Un="recipientInfos",Mn="encryptedContentInfo",hi="unprotectedAttrs",gv=[Dn,ui,Un,Mn,hi],Yd={kdfAlgorithm:"SHA-512",kekEncryptionLength:256},pv={"P-256":256,"P-384":384,"P-521":528};let Xd=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,Dn,s.defaultValues(Dn)),ui in e&&(this.originatorInfo=l(e,ui,s.defaultValues(ui))),this.recipientInfos=l(e,Un,s.defaultValues(Un)),this.encryptedContentInfo=l(e,Mn,s.defaultValues(Mn)),hi in e&&(this.unprotectedAttrs=l(e,hi,s.defaultValues(hi))),this.policy={disableSplit:!!e.disableSplit},e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Dn:return 0;case ui:return new ah;case Un:return[];case Mn:return new Dt;case hi:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Dn:return t===s.defaultValues(e);case ui:return 0===t.certs.certificates.length&&0===t.crls.crls.length;case Un:case hi:return 0===t.length;case Mn:return Dt.compareWithDefault("contentType",t.contentType)&&Dt.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&Dt.compareWithDefault("encryptedContent",t.encryptedContent);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.version||v}),new q({name:t.originatorInfo||v,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:ah.schema().valueBlock.value}),new _t({value:[new $e({name:t.recipientInfos||v,value:Vn.schema()})]}),Dt.schema(t.encryptedContentInfo||{}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new $e({name:t.unprotectedAttrs||v,value:tt.schema()})]})]})}fromSchema(e){Z(e,gv);const t=he(e,e,s.schema({names:{version:Dn,originatorInfo:ui,recipientInfos:Un,encryptedContentInfo:{names:{blockName:Mn}},unprotectedAttrs:hi}}));oe.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,ui in t.result&&(this.originatorInfo=new ah({schema:new O({value:t.result.originatorInfo.valueBlock.value})})),this.recipientInfos=Array.from(t.result.recipientInfos,i=>new Vn({schema:i})),this.encryptedContentInfo=new Dt({schema:t.result.encryptedContentInfo}),hi in t.result&&(this.unprotectedAttrs=Array.from(t.result.unprotectedAttrs,i=>new tt({schema:i})))}toSchema(){const e=[];return e.push(new X({value:this.version})),this.originatorInfo&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:this.originatorInfo.toSchema().valueBlock.value})),e.push(new _t({value:Array.from(this.recipientInfos,t=>t.toSchema())})),e.push(this.encryptedContentInfo.toSchema()),this.unprotectedAttrs&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={version:this.version,recipientInfos:Array.from(this.recipientInfos,t=>t.toJSON()),encryptedContentInfo:this.encryptedContentInfo.toJSON()};return this.originatorInfo&&(e.originatorInfo=this.originatorInfo.toJSON()),this.unprotectedAttrs&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,t=>t.toJSON())),e}addRecipientByCertificate(e,t,i,a=Ge(!0)){const o=Object.assign({useOAEP:!0,oaepHashAlgorithm:"SHA-512"},Yd,t||{});if(-1!==e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.113549"))i=1;else{if(-1===e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.10045"))throw new Error(`Unknown type of certificate's public key: ${e.subjectPublicKeyInfo.algorithm.algorithmId}`);i=2}switch(i){case 1:{let u,h;if(!0===o.useOAEP){u=a.getOIDByAlgorithm({name:"RSA-OAEP"},!0,"keyEncryptionAlgorithm");const N=a.getOIDByAlgorithm({name:o.oaepHashAlgorithm},!0,"RSAES-OAEP-params"),T=new Q({algorithmId:N,algorithmParams:new kt});h=new mh({hashAlgorithm:T,maskGenAlgorithm:new Q({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:T.toSchema()})}).toSchema()}else{if(u=a.getOIDByAlgorithm({name:"RSAES-PKCS1-v1_5"}),u===v)throw new Error("Can not find OID for RSAES-PKCS1-v1_5");h=new kt}const m=new oh({version:0,rid:new xt({issuer:e.issuer,serialNumber:e.serialNumber}),keyEncryptionAlgorithm:new Q({algorithmId:u,algorithmParams:h}),recipientCertificate:e});this.recipientInfos.push(new Vn({variant:1,value:m}))}break;case 2:{const u=new nl({variant:1,value:new xt({issuer:e.issuer,serialNumber:e.serialNumber})});this._addKeyAgreeRecipientInfo(u,o,{recipientCertificate:e},a)}break;default:throw new Error(`Unknown "variant" value: ${i}`)}return!0}addRecipientByPreDefinedData(e,t={},i,a=Ge(!0)){if(ot.assert(e,"preDefinedData","ArrayBuffer"),!e.byteLength)throw new Error("Pre-defined data could have zero length");if(!t.keyIdentifier){const o=new ArrayBuffer(16),u=new Uint8Array(o);a.getRandomValues(u),t.keyIdentifier=o}switch(t.hmacHashAlgorithm||(t.hmacHashAlgorithm="SHA-512"),void 0===t.iterationCount&&(t.iterationCount=2048),t.keyEncryptionAlgorithm||(t.keyEncryptionAlgorithm={name:"AES-KW",length:256}),t.keyEncryptionAlgorithmParams||(t.keyEncryptionAlgorithmParams=new kt),i){case 1:{const o=a.getOIDByAlgorithm(t.keyEncryptionAlgorithm,!0,"keyEncryptionAlgorithm"),u=new fh({version:4,kekid:new Tc({keyIdentifier:new de({valueHex:t.keyIdentifier})}),keyEncryptionAlgorithm:new Q({algorithmId:o,algorithmParams:t.keyEncryptionAlgorithmParams}),preDefinedKEK:e});this.recipientInfos.push(new Vn({variant:3,value:u}))}break;case 2:{const o=a.getOIDByAlgorithm({name:"PBKDF2"},!0,"keyDerivationAlgorithm"),u=new ArrayBuffer(64),h=new Uint8Array(u);a.getRandomValues(h);const m=a.getOIDByAlgorithm({name:"HMAC",hash:{name:t.hmacHashAlgorithm}},!0,"hmacHashAlgorithm"),N=new so({salt:new de({valueHex:u}),iterationCount:t.iterationCount,prf:new Q({algorithmId:m,algorithmParams:new kt})}),T=a.getOIDByAlgorithm(t.keyEncryptionAlgorithm,!0,"keyEncryptionAlgorithm"),K=new dh({version:0,keyDerivationAlgorithm:new Q({algorithmId:o,algorithmParams:N.toSchema()}),keyEncryptionAlgorithm:new Q({algorithmId:T,algorithmParams:t.keyEncryptionAlgorithmParams}),password:e});this.recipientInfos.push(new Vn({variant:4,value:K}))}break;default:throw new Error(`Unknown value for "variant": ${i}`)}}addRecipientByKeyIdentifier(e,t,i,a=Ge(!0)){const o=Object.assign({},Yd,i||{}),u=new nl({variant:2,value:new ch({subjectKeyIdentifier:new de({valueHex:t})})});this._addKeyAgreeRecipientInfo(u,o,{recipientPublicKey:e},a)}_addKeyAgreeRecipientInfo(e,t,i,a=Ge(!0)){const o=new uh({rid:e}),u=a.getOIDByAlgorithm({name:"AES-KW",length:t.kekEncryptionLength},!0,"keyEncryptionAlgorithm"),h=new Q({algorithmId:u}),m=a.getOIDByAlgorithm({name:"ECDH",kdf:t.kdfAlgorithm},!0,"KeyAgreeRecipientInfo"),N=new ArrayBuffer(64),T=new Uint8Array(N);a.getRandomValues(T);const K={version:3,ukm:new de({valueHex:N}),keyEncryptionAlgorithm:new Q({algorithmId:m,algorithmParams:h.toSchema()}),recipientEncryptedKeys:new Ic({encryptedKeys:[o]})},L=new hh(Object.assign(K,i));this.recipientInfos.push(new Vn({variant:2,value:L}))}encrypt(e,t,i=Ge(!0)){var a=this;return(0,k.A)(function*(){const o=new ArrayBuffer(16),u=new Uint8Array(o);i.getRandomValues(u);const h=new Uint8Array(t),m=i.getOIDByAlgorithm(e,!0,"contentEncryptionAlgorithm"),N=yield i.generateKey(e,!0,["encrypt"]),T=yield i.encrypt({name:e.name,iv:u},N,h),K=yield i.exportKey("raw",N);a.version=2,a.encryptedContentInfo=new Dt({disableSplit:a.policy.disableSplit,contentType:"1.2.840.113549.1.7.1",contentEncryptionAlgorithm:new Q({algorithmId:m,algorithmParams:new de({valueHex:o})}),encryptedContent:new de({valueHex:T})});const L=function(){var ye=(0,k.A)(function*(ae){const le=a.recipientInfos[ae].value;let pe,be;if(le.recipientPublicKey)pe=le.recipientPublicKey.algorithm.namedCurve,be=le.recipientPublicKey;else{if(!le.recipientCertificate)throw new Error("Unsupported RecipientInfo");{const Pe=le.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(Pe.constructor.blockName()!==Ve.blockName())throw new Error(`Incorrect "recipientCertificate" for index ${ae}`);switch(Pe.valueBlock.toString()){case"1.2.840.10045.3.1.7":pe="P-256";break;case"1.3.132.0.34":pe="P-384";break;case"1.3.132.0.35":pe="P-521";break;default:throw new Error(`Incorrect curve OID for index ${ae}`)}be=yield le.recipientCertificate.getPublicKey({algorithm:{algorithm:{name:"ECDH",namedCurve:pe},usages:[]}},i)}}const Re=pv[pe],xe=yield i.generateKey({name:"ECDH",namedCurve:pe},!0,["deriveBits"]),Me=yield i.exportKey("spki",xe.publicKey),ze=yield i.deriveBits({name:"ECDH",public:be},xe.privateKey,Re),bt=new Q({schema:le.keyEncryptionAlgorithm.algorithmParams}),Ye=i.getAlgorithmByOID(bt.algorithmId,!0,"aesKWAlgorithm");let lt=Ye.length;const jt=new ArrayBuffer(4),Ot=new Uint8Array(jt);for(let Pe=3;Pe>=0;Pe--)Ot[Pe]=lt,lt>>=8;const Es=new zd({keyInfo:new Q({algorithmId:bt.algorithmId}),entityUInfo:le.ukm,suppPubInfo:new de({valueHex:jt})}).toSchema().toBER(!1),Yt=i.getAlgorithmByOID(le.keyEncryptionAlgorithm.algorithmId,!0,"ecdhAlgorithm"),ut=yield xd(Yt.kdf,ze,Ye.length,Es,i),nt=yield i.importKey("raw",ut,{name:"AES-KW"},!0,["wrapKey"]),De=yield i.wrapKey("raw",N,nt,{name:"AES-KW"}),je=new kc;return je.variant=3,je.value=lh.fromBER(Me),le.originator=je,le.recipientEncryptedKeys.encryptedKeys[0].encryptedKey=new de({valueHex:De}),{ecdhPrivateKey:xe.privateKey}});return function(le){return ye.apply(this,arguments)}}(),re=function(){var ye=(0,k.A)(function*(ae){const le=a.recipientInfos[ae].value,pe=i.getAlgorithmByOID(le.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm");if("RSA-OAEP"===pe.name){const Re=new mh({schema:le.keyEncryptionAlgorithm.algorithmParams});if(pe.hash=i.getAlgorithmByOID(Re.hashAlgorithm.algorithmId),!("name"in pe.hash))throw new Error(`Incorrect OID for hash algorithm: ${Re.hashAlgorithm.algorithmId}`)}try{const be=yield le.recipientCertificate.getPublicKey({algorithm:{algorithm:pe,usages:["encrypt","wrapKey"]}},i),Re=yield i.encrypt(be.algorithm,be,K);le.encryptedKey=new de({valueHex:Re})}catch{}});return function(le){return ye.apply(this,arguments)}}(),Ae=function(){var ye=(0,k.A)(function*(ae){const le=a.recipientInfos[ae].value,pe=i.getAlgorithmByOID(le.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm"),be=yield i.importKey("raw",new Uint8Array(le.preDefinedKEK),pe,!0,["wrapKey"]),Re=yield i.wrapKey("raw",N,be,pe);le.encryptedKey=new de({valueHex:Re})});return function(le){return ye.apply(this,arguments)}}(),we=function(){var ye=(0,k.A)(function*(ae){const le=a.recipientInfos[ae].value;let pe;if(!le.keyDerivationAlgorithm)throw new Error('Please append encoded "keyDerivationAlgorithm"');if(!le.keyDerivationAlgorithm.algorithmParams)throw new Error('Incorrectly encoded "keyDerivationAlgorithm"');try{pe=new so({schema:le.keyDerivationAlgorithm.algorithmParams})}catch{throw new Error('Incorrectly encoded "keyDerivationAlgorithm"')}const be=new Uint8Array(le.password),Re=yield i.importKey("raw",be,"PBKDF2",!1,["deriveKey"]),xe=i.getAlgorithmByOID(le.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm");let Me="SHA-1";pe.prf&&(Me=i.getAlgorithmByOID(pe.prf.algorithmId,!0,"prfAlgorithm").hash.name);const ze=new Uint8Array(pe.salt.valueBlock.valueHex),bt=pe.iterationCount,Ye=yield i.deriveKey({name:"PBKDF2",hash:{name:Me},salt:ze,iterations:bt},Re,xe,!0,["wrapKey"]),lt=yield i.wrapKey("raw",N,Ye,xe);le.encryptedKey=new de({valueHex:lt})});return function(le){return ye.apply(this,arguments)}}(),se=[];for(let ye=0;ye<a.recipientInfos.length;ye++)switch(a.recipientInfos[ye].variant){case 1:se.push(yield re(ye));break;case 2:se.push(yield L(ye));break;case 3:se.push(yield Ae(ye));break;case 4:se.push(yield we(ye));break;default:throw new Error(`Unknown recipient type in array with index ${ye}`)}return se})()}decrypt(e,t,i=Ge(!0)){var a=this;return(0,k.A)(function*(){const o=t||{};if(e+1>a.recipientInfos.length)throw new Error('Maximum value for "index" is: '+(a.recipientInfos.length-1));const u=function(){var se=(0,k.A)(function*(ye){const ae=a.recipientInfos[ye].value;let le,pe,be;const Re=ae.originator;if(o.recipientCertificate){const ut=o.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(ut.constructor.blockName()!==Ve.blockName())throw new Error(`Incorrect "recipientCertificate" for index ${ye}`);le=ut.valueBlock.toString()}else{if(!Re.value.algorithm.algorithmParams)throw new Error('Parameter "recipientCertificate" is mandatory for "KeyAgreeRecipientInfo" if algorithm params are missing from originator');{const ut=Re.value.algorithm.algorithmParams;if(ut.constructor.blockName()!==Ve.blockName())throw new Error(`Incorrect originator for index ${ye}`);le=ut.valueBlock.toString()}}if(!o.recipientPrivateKey)throw new Error('Parameter "recipientPrivateKey" is mandatory for "KeyAgreeRecipientInfo"');switch(le){case"1.2.840.10045.3.1.7":pe="P-256",be=256;break;case"1.3.132.0.34":pe="P-384",be=384;break;case"1.3.132.0.35":pe="P-521",be=528;break;default:throw new Error(`Incorrect curve OID for index ${ye}`)}let xe,Me=i;A._H.isBufferSource(o.recipientPrivateKey)?xe=yield i.importKey("pkcs8",o.recipientPrivateKey,{name:"ECDH",namedCurve:pe},!0,["deriveBits"]):(xe=o.recipientPrivateKey,"crypto"in o&&o.crypto&&(Me=o.crypto.subtle)),"algorithmParams"in Re.value.algorithm||(Re.value.algorithm.algorithmParams=new Ve({value:le}));const ze=Re.value.toSchema().toBER(!1),bt=yield i.importKey("spki",ze,{name:"ECDH",namedCurve:pe},!0,[]),Ye=yield Me.deriveBits({name:"ECDH",public:bt},xe,be);function lt(ut){return jt.apply(this,arguments)}function jt(){return(jt=(0,k.A)(function*(ut){ut=ut||!1;const nt=new Q({schema:ae.keyEncryptionAlgorithm.algorithmParams}),De=i.getAlgorithmByOID(nt.algorithmId,!0,"kwAlgorithm");let je=De.length;const Pe=new ArrayBuffer(4),We=new Uint8Array(Pe);for(let Qe=3;Qe>=0;Qe--)We[Qe]=je,je>>=8;const st={algorithmId:nt.algorithmId};ut&&(st.algorithmParams=new kt);const ss=new zd({keyInfo:new Q(st),entityUInfo:ae.ukm,suppPubInfo:new de({valueHex:Pe})}).toSchema().toBER(!1),mt=i.getAlgorithmByOID(ae.keyEncryptionAlgorithm.algorithmId,!0,"ecdhAlgorithm");if(!mt.name)throw new Error(`Incorrect OID for key encryption algorithm: ${ae.keyEncryptionAlgorithm.algorithmId}`);return xd(mt.kdf,Ye,De.length,ss,i)})).apply(this,arguments)}const Ot=yield lt(),Pr=function(){var ut=(0,k.A)(function*(nt){return i.importKey("raw",nt,{name:"AES-KW"},!0,["unwrapKey"])});return function(De){return ut.apply(this,arguments)}}(),Es=yield Pr(Ot),Yt=function(){var ut=(0,k.A)(function*(nt){const je=i.getAlgorithmByOID(a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,!0,"contentEncryptionAlgorithm");return i.unwrapKey("raw",ae.recipientEncryptedKeys.encryptedKeys[0].encryptedKey.valueBlock.valueHexView,nt,{name:"AES-KW"},je,!0,["decrypt"])});return function(De){return ut.apply(this,arguments)}}();try{return yield Yt(Es)}catch{const ut=yield lt(!0);return Yt(yield Pr(ut))}});return function(ae){return se.apply(this,arguments)}}(),h=function(){var se=(0,k.A)(function*(ye){const ae=a.recipientInfos[ye].value;if(!o.recipientPrivateKey)throw new Error('Parameter "recipientPrivateKey" is mandatory for "KeyTransRecipientInfo"');const le=i.getAlgorithmByOID(ae.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm");if("RSA-OAEP"===le.name){const bt=new mh({schema:ae.keyEncryptionAlgorithm.algorithmParams});if(le.hash=i.getAlgorithmByOID(bt.hashAlgorithm.algorithmId),!("name"in le.hash))throw new Error(`Incorrect OID for hash algorithm: ${bt.hashAlgorithm.algorithmId}`)}let pe,be=i;A._H.isBufferSource(o.recipientPrivateKey)?pe=yield i.importKey("pkcs8",o.recipientPrivateKey,le,!0,["decrypt"]):(pe=o.recipientPrivateKey,"crypto"in o&&o.crypto&&(be=o.crypto.subtle));const Re=yield be.decrypt(pe.algorithm,pe,ae.encryptedKey.valueBlock.valueHexView),xe=a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,Me=i.getAlgorithmByOID(xe,!0,"contentEncryptionAlgorithm");if(!("name"in Me))throw new Error(`Incorrect "contentEncryptionAlgorithm": ${xe}`);return i.importKey("raw",Re,Me,!0,["decrypt"])});return function(ae){return se.apply(this,arguments)}}(),m=function(){var se=(0,k.A)(function*(ye){const ae=a.recipientInfos[ye].value;if(!o.preDefinedData)throw new Error('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');const le=i.getAlgorithmByOID(ae.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm"),pe=yield i.importKey("raw",o.preDefinedData,le,!0,["unwrapKey"]),be=a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,Re=i.getAlgorithmByOID(be,!0,"contentEncryptionAlgorithm");if(!Re.name)throw new Error(`Incorrect "contentEncryptionAlgorithm": ${be}`);return i.unwrapKey("raw",ae.encryptedKey.valueBlock.valueHexView,pe,le,Re,!0,["decrypt"])});return function(ae){return se.apply(this,arguments)}}(),N=function(){var se=(0,k.A)(function*(ye){const ae=a.recipientInfos[ye].value;let le;if(!o.preDefinedData)throw new Error('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');if(!ae.keyDerivationAlgorithm)throw new Error('Please append encoded "keyDerivationAlgorithm"');if(!ae.keyDerivationAlgorithm.algorithmParams)throw new Error('Incorrectly encoded "keyDerivationAlgorithm"');try{le=new so({schema:ae.keyDerivationAlgorithm.algorithmParams})}catch{throw new Error('Incorrectly encoded "keyDerivationAlgorithm"')}const pe=yield i.importKey("raw",o.preDefinedData,"PBKDF2",!1,["deriveKey"]),be=i.getAlgorithmByOID(ae.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm"),Re=le.prf?i.getAlgorithmByOID(le.prf.algorithmId,!0,"prfAlgorithm").hash.name:"SHA-1",xe=new Uint8Array(le.salt.valueBlock.valueHex),Me=le.iterationCount,ze=yield i.deriveKey({name:"PBKDF2",hash:{name:Re},salt:xe,iterations:Me},pe,be,!0,["unwrapKey"]),Ye=i.getAlgorithmByOID(a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,!0,"contentEncryptionAlgorithm");return i.unwrapKey("raw",ae.encryptedKey.valueBlock.valueHexView,ze,be,Ye,!0,["decrypt"])});return function(ae){return se.apply(this,arguments)}}();let T;switch(a.recipientInfos[e].variant){case 1:T=yield h(e);break;case 2:T=yield u(e);break;case 3:T=yield m(e);break;case 4:T=yield N(e);break;default:throw new Error(`Unknown recipient type in array with index ${e}`)}const L=i.getAlgorithmByOID(a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,!0,"contentEncryptionAlgorithm"),Ae=new Uint8Array(a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams.valueBlock.valueHex);if(!a.encryptedContentInfo.encryptedContent)throw new Error("Required property `encryptedContent` is empty");const we=a.encryptedContentInfo.getEncryptedContent();return i.decrypt({name:L.name,iv:Ae},T,we)})()}}return s.CLASS_NAME="EnvelopedData",s})();const Ln="safeContents",ol="parsedValue",Qd="contentInfos";let gh=(()=>{class s extends fe{constructor(e={}){super(),this.safeContents=l(e,Ln,s.defaultValues(Ln)),ol in e&&(this.parsedValue=l(e,ol,s.defaultValues(ol))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ln:return[];case ol:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ln:return 0===t.length;case ol:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new $e({name:t.contentInfos||v,value:Ut.schema()})]})}fromSchema(e){Z(e,[Qd]);const t=he(e,e,s.schema({names:{contentInfos:Qd}}));oe.assertSchema(t,this.className),this.safeContents=Array.from(t.result.contentInfos,i=>new Ut({schema:i}))}toSchema(){return new O({value:Array.from(this.safeContents,e=>e.toSchema())})}toJSON(){return{safeContents:Array.from(this.safeContents,e=>e.toJSON())}}parseInternalValues(e,t=Ge(!0)){var i=this;return(0,k.A)(function*(){if(et.assert(e,Ln),ot.assert(e.safeContents,Ln,"Array"),e.safeContents.length!==i.safeContents.length)throw new ot('Length of "parameters.safeContents" must be equal to "this.safeContents.length"');i.parsedValue={safeContents:[]};for(const[a,o]of i.safeContents.entries()){const u=e.safeContents[a],h=`parameters.safeContents[${a}]`;switch(o.contentType){case bu:{ot.assert(o.content,"this.safeContents[j].content",de);const m=o.content.getValue();i.parsedValue.safeContents.push({privacyMode:0,value:ar.fromBER(m)})}break;case rd:{const m=new Xd({schema:o.content});et.assert(h,u,"recipientCertificate","recipientKey");const T=u.recipientCertificate,K=u.recipientKey,L=yield m.decrypt(0,{recipientCertificate:T,recipientPrivateKey:K},t);i.parsedValue.safeContents.push({privacyMode:2,value:ar.fromBER(L)})}break;case nd:{const m=new wc({schema:o.content});et.assert(h,u,"password");const N=u.password,T=yield m.decrypt({password:N},t);i.parsedValue.safeContents.push({privacyMode:1,value:ar.fromBER(T)})}break;default:throw new Error(`Unknown "contentType" for AuthenticatedSafe: " ${o.contentType}`)}}})()}makeInternalValues(e,t=Ge(!0)){var i=this;return(0,k.A)(function*(){if(!i.parsedValue)throw new Error('Please run "parseValues" first or add "parsedValue" manually');if(ot.assert(i.parsedValue,"this.parsedValue","object"),ot.assert(i.parsedValue.safeContents,"this.parsedValue.safeContents","Array"),ot.assert(e,"parameters","object"),et.assert(e,"safeContents"),ot.assert(e.safeContents,"parameters.safeContents","Array"),e.safeContents.length!==i.parsedValue.safeContents.length)throw new ot('Length of "parameters.safeContents" must be equal to "this.parsedValue.safeContents"');i.safeContents=[];for(const[a,o]of i.parsedValue.safeContents.entries())switch(et.assert("content",o,"privacyMode","value"),ot.assert(o.value,"content.value",ar),o.privacyMode){case 0:{const u=o.value.toSchema().toBER(!1);i.safeContents.push(new Ut({contentType:"1.2.840.113549.1.7.1",content:new de({valueHex:u})}))}break;case 1:{const u=new wc,h=e.safeContents[a];h.contentToEncrypt=o.value.toSchema().toBER(!1),yield u.encrypt(h,t),i.safeContents.push(new Ut({contentType:"1.2.840.113549.1.7.6",content:u.toSchema()}))}break;case 2:{const u=new Xd,h=o.value.toSchema().toBER(!1),m=e.safeContents[a];switch(et.assert(`parameters.safeContents[${a}]`,m,"encryptingCertificate","encryptionAlgorithm"),!0){case"aes-cbc"===m.encryptionAlgorithm.name.toLowerCase():case"aes-gcm"===m.encryptionAlgorithm.name.toLowerCase():break;default:throw new Error(`Incorrect parameter "encryptionAlgorithm" in "parameters.safeContents[i]": ${m.encryptionAlgorithm}`)}switch(!0){case 128===m.encryptionAlgorithm.length:case 192===m.encryptionAlgorithm.length:case 256===m.encryptionAlgorithm.length:break;default:throw new Error(`Incorrect parameter "encryptionAlgorithm.length" in "parameters.safeContents[i]": ${m.encryptionAlgorithm.length}`)}const N=m.encryptionAlgorithm;u.addRecipientByCertificate(m.encryptingCertificate,{},void 0,t),yield u.encrypt(N,h,t),i.safeContents.push(new Ut({contentType:"1.2.840.113549.1.7.3",content:u.toSchema()}))}break;default:throw new Error(`Incorrect value for "content.privacyMode": ${o.privacyMode}`)}return i})()}}return s.CLASS_NAME="AuthenticatedSafe",s})();const gr="hashAlgorithm",Fn="issuerNameHash",Hn="issuerKeyHash",pr="serialNumber",vv=[gr,Fn,Hn,pr];let fi=(()=>{class s extends fe{static create(e,t,i=Ge(!0)){return(0,k.A)(function*(){const a=new s;return yield a.createForCertificate(e,t,i),a})()}constructor(e={}){super(),this.hashAlgorithm=l(e,gr,s.defaultValues(gr)),this.issuerNameHash=l(e,Fn,s.defaultValues(Fn)),this.issuerKeyHash=l(e,Hn,s.defaultValues(Hn)),this.serialNumber=l(e,pr,s.defaultValues(pr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case gr:return new Q;case Fn:case Hn:return new de;case pr:return new X;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case gr:return t.algorithmId===v&&!("algorithmParams"in t);case Fn:case Hn:case pr:return t.isEqual(s.defaultValues(pr));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Q.schema(t.hashAlgorithmObject||{names:{blockName:t.hashAlgorithm||v}}),new de({name:t.issuerNameHash||v}),new de({name:t.issuerKeyHash||v}),new X({name:t.serialNumber||v})]})}fromSchema(e){Z(e,vv);const t=he(e,e,s.schema({names:{hashAlgorithm:gr,issuerNameHash:Fn,issuerKeyHash:Hn,serialNumber:pr}}));oe.assertSchema(t,this.className),this.hashAlgorithm=new Q({schema:t.result.hashAlgorithm}),this.issuerNameHash=t.result.issuerNameHash,this.issuerKeyHash=t.result.issuerKeyHash,this.serialNumber=t.result.serialNumber}toSchema(){return new O({value:[this.hashAlgorithm.toSchema(),this.issuerNameHash,this.issuerKeyHash,this.serialNumber]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),issuerNameHash:this.issuerNameHash.toJSON(),issuerKeyHash:this.issuerKeyHash.toJSON(),serialNumber:this.serialNumber.toJSON()}}isEqual(e){return!(this.hashAlgorithm.algorithmId!==e.hashAlgorithm.algorithmId||!A._H.isEqual(this.issuerNameHash.valueBlock.valueHexView,e.issuerNameHash.valueBlock.valueHexView)||!A._H.isEqual(this.issuerKeyHash.valueBlock.valueHexView,e.issuerKeyHash.valueBlock.valueHexView)||!this.serialNumber.isEqual(e.serialNumber))}createForCertificate(e,t,i=Ge(!0)){var a=this;return(0,k.A)(function*(){et.assert(t,gr,"issuerCertificate");const o=i.getOIDByAlgorithm({name:t.hashAlgorithm},!0,"hashAlgorithm");a.hashAlgorithm=new Q({algorithmId:o,algorithmParams:new kt});const u=t.issuerCertificate;a.serialNumber=e.serialNumber;const h=yield i.digest({name:t.hashAlgorithm},u.subject.toSchema().toBER(!1));a.issuerNameHash=new de({valueHex:h});const m=u.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView,N=yield i.digest({name:t.hashAlgorithm},m);a.issuerKeyHash=new de({valueHex:N})})()}}return s.CLASS_NAME="CertID",s})();const jn="certID",$n="certStatus",Kn="thisUpdate",di="nextUpdate",vr="singleExtensions",wv=[jn,$n,Kn,di,vr];let Zd=(()=>{class s extends fe{constructor(e={}){super(),this.certID=l(e,jn,s.defaultValues(jn)),this.certStatus=l(e,$n,s.defaultValues($n)),this.thisUpdate=l(e,Kn,s.defaultValues(Kn)),di in e&&(this.nextUpdate=l(e,di,s.defaultValues(di))),vr in e&&(this.singleExtensions=l(e,vr,s.defaultValues(vr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case jn:return new fi;case $n:return{};case Kn:case di:return new Date(0,0,0);case vr:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case jn:return fi.compareWithDefault("hashAlgorithm",t.hashAlgorithm)&&fi.compareWithDefault("issuerNameHash",t.issuerNameHash)&&fi.compareWithDefault("issuerKeyHash",t.issuerKeyHash)&&fi.compareWithDefault("serialNumber",t.serialNumber);case $n:return 0===Object.keys(t).length;case Kn:case di:return t===s.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[fi.schema(t.certID||{}),new ft({value:[new Le({name:t.certStatus||v,idBlock:{tagClass:3,tagNumber:0}}),new q({name:t.certStatus||v,idBlock:{tagClass:3,tagNumber:1},value:[new ht,new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ua]})]}),new Le({name:t.certStatus||v,idBlock:{tagClass:3,tagNumber:2},lenBlock:{length:1}})]}),new ht({name:t.thisUpdate||v}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ht({name:t.nextUpdate||v})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[Rt.schema(t.singleExtensions||{})]})]})}fromSchema(e){Z(e,wv);const t=he(e,e,s.schema({names:{certID:{names:{blockName:jn}},certStatus:$n,thisUpdate:Kn,nextUpdate:di,singleExtensions:{names:{blockName:vr}}}}));oe.assertSchema(t,this.className),this.certID=new fi({schema:t.result.certID}),this.certStatus=t.result.certStatus,this.thisUpdate=t.result.thisUpdate.toDate(),di in t.result&&(this.nextUpdate=t.result.nextUpdate.toDate()),vr in t.result&&(this.singleExtensions=Array.from(t.result.singleExtensions.valueBlock.value,i=>new Li({schema:i})))}toSchema(){const e=[];return e.push(this.certID.toSchema()),e.push(this.certStatus),e.push(new ht({valueDate:this.thisUpdate})),this.nextUpdate&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[new ht({valueDate:this.nextUpdate})]})),this.singleExtensions&&e.push(new O({value:Array.from(this.singleExtensions,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={certID:this.certID.toJSON(),certStatus:this.certStatus.toJSON(),thisUpdate:this.thisUpdate};return this.nextUpdate&&(e.nextUpdate=this.nextUpdate),this.singleExtensions&&(e.singleExtensions=Array.from(this.singleExtensions,t=>t.toJSON())),e}}return s.CLASS_NAME="SingleResponse",s})();const Pc="tbs",wr="version",ll="responderID",cl="producedAt",ul="responses",Gn="responseExtensions",yr="ResponseData",Dc=`${yr}.${wr}`,Jn=`${yr}.${ll}`,ph=`${yr}.${cl}`,vh=`${yr}.${ul}`,Uc=`${yr}.${Gn}`,yv=[yr,Dc,Jn,ph,vh,Uc];let mi=(()=>{class s extends fe{get tbs(){return A._H.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(l(e,Pc,s.defaultValues(Pc))),wr in e&&(this.version=l(e,wr,s.defaultValues(wr))),this.responderID=l(e,ll,s.defaultValues(ll)),this.producedAt=l(e,cl,s.defaultValues(cl)),this.responses=l(e,ul,s.defaultValues(ul)),Gn in e&&(this.responseExtensions=l(e,Gn,s.defaultValues(Gn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wr:return 0;case Pc:return Ct;case ll:return{};case cl:return new Date(0,0,0);case ul:case Gn:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Pc:return 0===t.byteLength;case ll:return 0===Object.keys(t).length;case cl:return t===s.defaultValues(e);case ul:case Gn:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||yr,value:[new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new X({name:t.version||Dc})]}),new ft({value:[new q({name:t.responderID||Jn,idBlock:{tagClass:3,tagNumber:1},value:[dt.schema(t.ResponseDataByName||{names:{blockName:"ResponseData.byName"}})]}),new q({name:t.responderID||Jn,idBlock:{tagClass:3,tagNumber:2},value:[new de({name:t.ResponseDataByKey||"ResponseData.byKey"})]})]}),new ht({name:t.producedAt||ph}),new O({value:[new $e({name:vh,value:Zd.schema(t.response||{})})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[Rt.schema(t.extensions||{names:{blockName:Uc}})]})]})}fromSchema(e){Z(e,yv);const t=he(e,e,s.schema());oe.assertSchema(t,this.className),this.tbsView=t.result.ResponseData.valueBeforeDecodeView,Dc in t.result&&(this.version=t.result[Dc].valueBlock.valueDec),this.responderID=1===t.result[Jn].idBlock.tagNumber?new dt({schema:t.result[Jn].valueBlock.value[0]}):t.result[Jn].valueBlock.value[0],this.producedAt=t.result[ph].toDate(),this.responses=Array.from(t.result[vh],i=>new Zd({schema:i})),Uc in t.result&&(this.responseExtensions=Array.from(t.result[Uc].valueBlock.value,i=>new Li({schema:i})))}toSchema(e=!1){let t;if(!1===e){if(!this.tbsView.byteLength)return s.schema();const i=ct(this.tbsView);oe.assert(i,"TBS Response Data"),t=i.result}else{const i=[];wr in this&&i.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[new X({value:this.version})]})),i.push(new q(this.responderID instanceof dt?{idBlock:{tagClass:3,tagNumber:1},value:[this.responderID.toSchema()]}:{idBlock:{tagClass:3,tagNumber:2},value:[this.responderID]})),i.push(new ht({valueDate:this.producedAt})),i.push(new O({value:Array.from(this.responses,a=>a.toSchema())})),this.responseExtensions&&i.push(new q({idBlock:{tagClass:3,tagNumber:1},value:[new O({value:Array.from(this.responseExtensions,a=>a.toSchema())})]})),t=new O({value:i})}return t}toJSON(){const e={};return wr in this&&(e.version=this.version),this.responderID&&(e.responderID=this.responderID),this.producedAt&&(e.producedAt=this.producedAt),this.responses&&(e.responses=Array.from(this.responses,t=>t.toJSON())),this.responseExtensions&&(e.responseExtensions=Array.from(this.responseExtensions,t=>t.toJSON())),e}}return s.CLASS_NAME="ResponseData",s})();const wh="trustedCerts",yh="certs",Sh="crls",bh="ocsps",Ah="checkDate",Eh="findOrigin",kh="findIssuer";var qn=function(s){return s[s.unknown=-1]="unknown",s[s.success=0]="success",s[s.noRevocation=11]="noRevocation",s[s.noPath=60]="noPath",s[s.noValidPath=97]="noValidPath",s}(qn||{});let hl=(()=>{class s extends Error{constructor(e,t){super(t),this.name=s.NAME,this.code=e,this.message=t}}return s.NAME="ChainValidationError",s})();class Mc{constructor(r={}){this.trustedCerts=l(r,wh,this.defaultValues(wh)),this.certs=l(r,yh,this.defaultValues(yh)),this.crls=l(r,Sh,this.defaultValues(Sh)),this.ocsps=l(r,bh,this.defaultValues(bh)),this.checkDate=l(r,Ah,this.defaultValues(Ah)),this.findOrigin=l(r,Eh,this.defaultValues(Eh)),this.findIssuer=l(r,kh,this.defaultValues(kh))}static defaultFindOrigin(r,e){0===r.tbsView.byteLength&&(r.tbsView=new Uint8Array(r.encodeTBS().toBER()));for(const t of e.certs)if(0===t.tbsView.byteLength&&(t.tbsView=new Uint8Array(t.encodeTBS().toBER())),A._H.isEqual(r.tbsView,t.tbsView))return"Intermediate Certificates";for(const t of e.trustedCerts)if(0===t.tbsView.byteLength&&(t.tbsView=new Uint8Array(t.encodeTBS().toBER())),A._H.isEqual(r.tbsView,t.tbsView))return"Trusted Certificates";return"Unknown"}defaultFindIssuer(r,e,t=Ge(!0)){return(0,k.A)(function*(){const i=[];let a=null,o=null,u=null;if(r.subject.isEqual(r.issuer))try{if(yield r.verify(void 0,t))return[r]}catch{}if(r.extensions)for(const m of r.extensions)if(m.extnID===yu&&m.parsedValue instanceof cd){m.parsedValue.keyIdentifier?a=m.parsedValue.keyIdentifier:(m.parsedValue.authorityCertIssuer&&(o=m.parsedValue.authorityCertIssuer),m.parsedValue.authorityCertSerialNumber&&(u=m.parsedValue.authorityCertSerialNumber));break}function h(m){if(null!==a&&m.extensions){let T=!1;for(const K of m.extensions)if("2.5.29.14"===K.extnID&&K.parsedValue){T=!0,A._H.isEqual(K.parsedValue.valueBlock.valueHex,a.valueBlock.valueHexView)&&i.push(m);break}if(T)return}let N=!1;null!==u&&(N=m.serialNumber.isEqual(u)),null!==o?m.subject.isEqual(o)&&N&&i.push(m):r.issuer.isEqual(m.subject)&&i.push(m)}for(const m of e.trustedCerts)h(m);for(const m of e.certs)h(m);for(let m=i.length-1;m>=0;m--)try{!1===(yield r.verify(i[m],t))&&i.splice(m,1)}catch{i.splice(m,1)}return i})()}defaultValues(r){switch(r){case wh:case yh:case Sh:case bh:return[];case Ah:return new Date;case Eh:return Mc.defaultFindOrigin;case kh:return this.defaultFindIssuer;default:throw new Error(`Invalid member name for CertificateChainValidationEngine class: ${r}`)}}sort(r=!1,e=Ge(!0)){var t=this;return(0,k.A)(function*(){const i=[],a=function(){var we=(0,k.A)(function*(se,ye){const ae=[];function le(be){let Re=!0;for(let xe=0;xe<be.length;xe++){for(let Me=0;Me<be.length;Me++)if(Me!==xe&&be[xe]===be[Me]){Re=!1;break}if(!Re)break}return Re}if(function Sv(s,r){for(let e=0;e<r.length;e++)if(A._H.isEqual(s.tbsView,r[e].tbsView))return!0;return!1}(se,t.trustedCerts))return[[se]];const pe=yield t.findIssuer(se,t,ye);if(0===pe.length)throw new Error("No valid certificate paths found");for(let be=0;be<pe.length;be++){if(A._H.isEqual(pe[be].tbsView,se.tbsView)){ae.push([pe[be]]);continue}const Re=yield a(pe[be],ye);for(let xe=0;xe<Re.length;xe++){const Me=Re[xe].slice();Me.splice(0,0,pe[be]),le(Me)?ae.push(Me):ae.push(Re[xe])}}return ae});return function(ye,ae){return we.apply(this,arguments)}}(),o=function(){var we=(0,k.A)(function*(se){const ye=[],ae=[],le=[];if(ye.push(...i.filter(pe=>se.issuer.isEqual(pe.subject))),0===ye.length)return{status:1,statusMessage:"No certificate's issuers"};if(ae.push(...t.crls.filter(pe=>pe.issuer.isEqual(se.issuer))),0===ae.length)return{status:2,statusMessage:"No CRLs for specific certificate issuer"};for(let pe=0;pe<ae.length;pe++){const be=ae[pe];if(!(be.nextUpdate&&be.nextUpdate.value<t.checkDate))for(let Re=0;Re<ye.length;Re++)try{if(yield ae[pe].verify({issuerCertificate:ye[Re]},e)){le.push({crl:ae[pe],certificate:ye[Re]});break}}catch{}}return le.length?{status:0,statusMessage:v,result:le}:{status:3,statusMessage:"No valid CRLs found"}});return function(ye){return we.apply(this,arguments)}}(),u=function(){var we=(0,k.A)(function*(se,ye){const ae=e.getAlgorithmByOID(se.signatureAlgorithm.algorithmId);if(!ae.name||!ae.hash)return 1;for(let le=0;le<t.ocsps.length;le++){const be=yield t.ocsps[le].getCertificateStatus(se,ye,e);if(be.isForCertificate)return 0===be.status?0:1}return 2});return function(ye,ae){return we.apply(this,arguments)}}();function h(we){return m.apply(this,arguments)}function m(){return(m=(0,k.A)(function*(we,se=!1){let ye=!1,ae=!1,le=!1,pe=!1;if(we.extensions){for(let be=0;be<we.extensions.length;be++){const Re=we.extensions[be];if(Re.critical&&!Re.parsedValue)return{result:!1,resultCode:6,resultMessage:`Unable to parse critical certificate extension: ${Re.extnID}`};if("2.5.29.15"===Re.extnID){le=!0;const xe=new Uint8Array(Re.parsedValue.valueBlock.valueHex);!(4&~xe[0])&&(ae=!0),!(2&~xe[0])&&(pe=!0)}Re.extnID===vu&&"cA"in Re.parsedValue&&!0===Re.parsedValue.cA&&(ye=!0)}if(!0===ae&&!1===ye)return{result:!1,resultCode:3,resultMessage:'Unable to build certificate chain - using "keyCertSign" flag set without BasicConstraints'};if(!0===le&&!0===ye&&!1===ae)return{result:!1,resultCode:4,resultMessage:'Unable to build certificate chain - "keyCertSign" flag was not set'};if(!0===ye&&!0===le&&se&&!1===pe)return{result:!1,resultCode:5,resultMessage:'Unable to build certificate chain - intermediate certificate must have "cRLSign" key usage flag'}}return!1===ye?{result:!1,resultCode:7,resultMessage:"Unable to build certificate chain - more than one possible end-user certificate"}:{result:!0,resultCode:0,resultMessage:v}})).apply(this,arguments)}const N=function(){var we=(0,k.A)(function*(se,ye){for(let ae=0;ae<se.length;ae++)if(se[ae].notBefore.value>ye||se[ae].notAfter.value<ye)return{result:!1,resultCode:8,resultMessage:"The certificate is either not yet valid or expired"};if(se.length<2)return{result:!1,resultCode:9,resultMessage:"Too short certificate path"};for(let ae=se.length-2;ae>=0;ae--)if(!1===se[ae].issuer.isEqual(se[ae].subject)&&!1===se[ae].issuer.isEqual(se[ae+1].subject))return{result:!1,resultCode:10,resultMessage:"Incorrect name chaining"};if(0!==t.crls.length||0!==t.ocsps.length)for(let ae=0;ae<se.length-1;ae++){let le=2,pe={status:0,statusMessage:v};if(0!==t.ocsps.length)switch(le=yield u(se[ae],se[ae+1]),le){case 0:continue;case 1:return{result:!1,resultCode:12,resultMessage:"One of certificates was revoked via OCSP response"}}if(0!==t.crls.length){if(pe=yield o(se[ae]),0===pe.status&&pe.result)for(let be=0;be<pe.result.length;be++){if(pe.result[be].crl.isCertificateRevoked(se[ae]))return{result:!1,resultCode:12,resultMessage:"One of certificates had been revoked"};if(!1===(yield h(pe.result[be].certificate,!0)).result)return{result:!1,resultCode:13,resultMessage:"CRL issuer certificate is not a CA certificate or does not have crlSign flag"}}else if(!1===r)throw new hl(qn.noRevocation,`No revocation values found for one of certificates: ${pe.statusMessage}`)}else if(2===le)return{result:!1,resultCode:11,resultMessage:"No revocation values found for one of certificates"};if(2===le&&2===pe.status&&r){const be=se[ae+1];let Re=!1;if(be.extensions)for(const xe of be.extensions)switch(xe.extnID){case Zf:case wu:case Su:Re=!0}if(Re)throw new hl(qn.noRevocation,`No revocation values found for one of certificates: ${pe.statusMessage}`)}}for(const[ae,le]of se.entries())if(ae&&!(yield h(le)).result)return{result:!1,resultCode:14,resultMessage:"One of intermediate certificates is not a CA certificate"};return{result:!0}});return function(ye,ae){return we.apply(this,arguments)}}();i.push(...t.trustedCerts),i.push(...t.certs);for(let we=0;we<i.length;we++)for(let se=0;se<i.length;se++)if(we!==se&&A._H.isEqual(i[we].tbsView,i[se].tbsView)){i.splice(se,1),we=0;break}const T=i[i.length-1];let K;const L=[T];if(K=yield a(T,e),0===K.length)throw new hl(qn.noPath,"Unable to find certificate path");for(let we=K.length-1;we>=0;we--){let se=!1;for(let ye=0;ye<K[we].length;ye++){const ae=K[we][ye];for(let le=0;le<t.trustedCerts.length;le++)if(A._H.isEqual(ae.tbsView,t.trustedCerts[le].tbsView)){se=!0;break}if(se)break}se||K.splice(we,1)}if(0===K.length)throw new hl(qn.noValidPath,"No valid certificate paths found");let re=K[0].length,Ae=0;for(let we=0;we<K.length;we++)K[we].length<re&&(re=K[we].length,Ae=we);for(let we=0;we<K[Ae].length;we++)L.push(K[Ae][we]);if(K=yield N(L,t.checkDate),!1===K.result)throw K;return L})()}verify(r={},e=Ge(!0)){var t=this;return(0,k.A)(function*(){function i(m,N){const T=Rs(m),K=Rs(N),L=T.split("."),re=K.split("."),Ae=L.length,we=re.length;if(0===Ae||0===we||Ae<we)return!1;for(let se=0;se<Ae;se++)if(0===L[se].length)return!1;for(let se=0;se<we;se++)if(0===re[se].length){if(0===se){if(1===we)return!1;continue}return!1}for(let se=0;se<we;se++)if(0!==re[we-1-se].length&&0!==L[Ae-1-se].localeCompare(re[we-1-se]))return!1;return!0}function a(m,N){const T=Rs(m),K=Rs(N),L=T.split("@"),re=K.split("@");if(0===L.length||0===re.length||L.length<re.length)return!1;if(1===re.length){if(i(L[1],re[0])){const we=L[1].split("."),se=re[0].split(".");return 0===se[0].length||we.length===se.length}return!1}return 0===T.localeCompare(K)}function o(m,N){let T=Rs(m);const K=Rs(N),L=T.split("/");if(K.split("/").length>1)return!1;if(L.length>1)for(let we=0;we<L.length;we++)if(L[we].length>0&&":"!==L[we].charAt(L[we].length-1)){T=L[we].split(":")[0];break}if(i(T,K)){const we=T.split("."),se=K.split(".");return 0===se[0].length||we.length===se.length}return!1}function u(m,N){const T=m.valueBlock.valueHexView,K=N.valueBlock.valueHexView;if(4===T.length&&8===K.length){for(let L=0;L<4;L++)if((T[L]^K[L])&K[L+4])return!1;return!0}if(16===T.length&&32===K.length){for(let L=0;L<16;L++)if((T[L]^K[L])&K[L+16])return!1;return!0}return!1}function h(m,N){if(0===m.typesAndValues.length||0===N.typesAndValues.length)return!0;if(m.typesAndValues.length<N.typesAndValues.length)return!1;let T=!0,K=0;for(let L=0;L<N.typesAndValues.length;L++){let re=!1;for(let Ae=K;Ae<m.typesAndValues.length;Ae++)if(re=m.typesAndValues[Ae].isEqual(N.typesAndValues[L]),m.typesAndValues[Ae].type===N.typesAndValues[L].type&&(T=T&&re),!0===re){if(0===K||K===Ae){K=Ae+1;break}return!1}if(!1===re)return!1}return 0!==K&&T}try{if(0===t.certs.length)throw new Error("Empty certificate array");const m=r.passedWhenNotRevValues||!1,N=r.initialPolicySet||[Wt];let se=r.initialExplicitPolicy||!1,ye=r.initialPolicyMappingInhibit||!1,ae=r.initialInhibitPolicy||!1;const le=[!1,!1,!1];let pe=0,be=0,Re=0,xe=r.initialPermittedSubtreesSet||[],Me=r.initialExcludedSubtreesSet||[];const ze=r.initialRequiredNameForms||[];let bt=1;t.certs=yield t.sort(m,e);const Ye=[];Ye.push(Wt);const lt=[],jt=new Array(t.certs.length-1);for(let De=0;De<t.certs.length-1;De++)jt[De]=!0;lt.push(jt);const Ot=new Array(t.certs.length-1),Pr=new Array(t.certs.length-1);let Es=se?t.certs.length-1:-1;for(let De=t.certs.length-2;De>=0;De--,bt++){const je=t.certs[De];if(je.extensions){for(let Pe=0;Pe<je.extensions.length;Pe++){const We=je.extensions[Pe];if(We.extnID===ed){Pr[De]=We.parsedValue;for(let st=0;st<Ye.length;st++)if(Ye[st]===Wt){delete lt[st][De];break}for(let st=0;st<We.parsedValue.certificatePolicies.length;st++){let Mt=-1;const ss=We.parsedValue.certificatePolicies[st].policyIdentifier;for(let mt=0;mt<Ye.length;mt++)if(ss===Ye[mt]){Mt=mt;break}if(-1===Mt){Ye.push(ss);const mt=new Array(t.certs.length-1);mt[De]=!0,lt.push(mt)}else lt[Mt][De]=!0}}if(We.extnID===td){if(ye)return{result:!1,resultCode:98,resultMessage:"Policy mapping prohibited"};Ot[De]=We.parsedValue}We.extnID===sd&&!1===se&&(0===We.parsedValue.requireExplicitPolicy?(se=!0,Es=De):!1===le[0]?(le[0]=!0,pe=We.parsedValue.requireExplicitPolicy):pe=pe>We.parsedValue.requireExplicitPolicy?We.parsedValue.requireExplicitPolicy:pe,0===We.parsedValue.inhibitPolicyMapping?ye=!0:!1===le[1]?(le[1]=!0,be=We.parsedValue.inhibitPolicyMapping+1):be=be>We.parsedValue.inhibitPolicyMapping+1?We.parsedValue.inhibitPolicyMapping+1:be),"2.5.29.54"===We.extnID&&!1===ae&&(0===We.parsedValue.valueBlock.valueDec?ae=!0:!1===le[2]?(le[2]=!0,Re=We.parsedValue.valueBlock.valueDec):Re=Re>We.parsedValue.valueBlock.valueDec?We.parsedValue.valueBlock.valueDec:Re)}if(!0===ae){let Pe=-1;for(let We=0;We<Ye.length;We++)if(Ye[We]===Wt){Pe=We;break}-1!==Pe&&delete lt[0][De]}!1===se&&!0===le[0]&&(pe--,0===pe&&(se=!0,Es=De,le[0]=!1)),!1===ye&&!0===le[1]&&(be--,0===be&&(ye=!0,le[1]=!1)),!1===ae&&!0===le[2]&&(Re--,0===Re&&(ae=!0,le[2]=!1))}}for(let De=0;De<t.certs.length-1;De++)if(De<t.certs.length-2&&typeof Ot[De+1]<"u")for(let je=0;je<Ot[De+1].mappings.length;je++){if(Ot[De+1].mappings[je].issuerDomainPolicy===Wt||Ot[De+1].mappings[je].subjectDomainPolicy===Wt)return{result:!1,resultCode:99,resultMessage:'The "anyPolicy" should not be a part of policy mapping scheme'};let Pe=-1,We=-1;for(let st=0;st<Ye.length;st++)Ye[st]===Ot[De+1].mappings[je].issuerDomainPolicy&&(Pe=st),Ye[st]===Ot[De+1].mappings[je].subjectDomainPolicy&&(We=st);typeof lt[Pe][De]<"u"&&delete lt[Pe][De];for(let st=0;st<Pr[De].certificatePolicies.length;st++)if(Ot[De+1].mappings[je].subjectDomainPolicy===Pr[De].certificatePolicies[st].policyIdentifier&&-1!==Pe&&-1!==We)for(let Mt=0;Mt<=De;Mt++)typeof lt[We][Mt]<"u"&&(lt[Pe][Mt]=!0,delete lt[We][Mt])}for(let De=0;De<Ye.length;De++)if(Ye[De]===Wt)for(let je=0;je<Es;je++)delete lt[De][je];const Yt=[];for(let De=0;De<lt.length;De++){let je=!0;for(let Pe=0;Pe<t.certs.length-1;Pe++){let We=!1;if(Pe<Es&&Ye[De]===Wt&&Ye.length>1){je=!1;break}if(typeof lt[De][Pe]>"u"){if(Pe>=Es)for(let st=0;st<Ye.length;st++)if(Ye[st]===Wt){!0===lt[st][Pe]&&(We=!0);break}if(!We){je=!1;break}}}!0===je&&Yt.push(Ye[De])}let ut=[];if(1===N.length&&N[0]===Wt&&!1===se)ut=N;else if(1===Yt.length&&Yt[0]===Wt)ut=N;else for(let De=0;De<Yt.length;De++)for(let je=0;je<N.length;je++)if(N[je]===Yt[De]||N[je]===Wt){ut.push(Yt[De]);break}const nt={result:ut.length>0,resultCode:0,resultMessage:ut.length>0?v:'Zero "userConstrPolicies" array, no intersections with "authConstrPolicies"',authConstrPolicies:Yt,userConstrPolicies:ut,explicitPolicyIndicator:se,policyMappings:Ot,certificatePath:t.certs};if(0===ut.length||!1===nt.result)return nt;bt=1;for(let De=t.certs.length-2;De>=0;De--,bt++){const je=t.certs[De];let Pe=[],We=[],st=[];if(je.extensions)for(let Qe=0;Qe<je.extensions.length;Qe++){const He=je.extensions[Qe];He.extnID===Qf&&("permittedSubtrees"in He.parsedValue&&(We=We.concat(He.parsedValue.permittedSubtrees)),"excludedSubtrees"in He.parsedValue&&(st=st.concat(He.parsedValue.excludedSubtrees))),He.extnID===Wf&&(Pe=Pe.concat(He.parsedValue.altNames))}let Mt=ze.length<=0;for(let Qe=0;Qe<ze.length;Qe++)switch(ze[Qe].base.type){case 4:if(ze[Qe].base.value.typesAndValues.length!==je.subject.typesAndValues.length)continue;Mt=!0;for(let He=0;He<je.subject.typesAndValues.length;He++)if(je.subject.typesAndValues[He].type!==ze[Qe].base.value.typesAndValues[He].type){Mt=!1;break}if(!0===Mt)break}if(!1===Mt)throw nt.result=!1,nt.resultCode=21,nt.resultMessage="No necessary name form found",nt;const ss=[[],[],[],[],[]];for(let Qe=0;Qe<xe.length;Qe++)switch(xe[Qe].base.type){case 1:ss[0].push(xe[Qe]);break;case 2:ss[1].push(xe[Qe]);break;case 4:ss[2].push(xe[Qe]);break;case 6:ss[3].push(xe[Qe]);break;case 7:ss[4].push(xe[Qe])}for(let Qe=0;Qe<5;Qe++){let He=!1,Dr=!1;const wi=ss[Qe];for(let yi=0;yi<wi.length;yi++){switch(Qe){case 0:if(Pe.length>0)for(let gt=0;gt<Pe.length;gt++)1===Pe[gt].type&&(Dr=!0,He=He||a(Pe[gt].value,wi[yi].base.value));else for(let gt=0;gt<je.subject.typesAndValues.length;gt++)("1.2.840.113549.1.9.1"===je.subject.typesAndValues[gt].type||"0.9.2342.19200300.100.1.3"===je.subject.typesAndValues[gt].type)&&(Dr=!0,He=He||a(je.subject.typesAndValues[gt].value.valueBlock.value,wi[yi].base.value));break;case 1:if(Pe.length>0)for(let gt=0;gt<Pe.length;gt++)2===Pe[gt].type&&(Dr=!0,He=He||i(Pe[gt].value,wi[yi].base.value));break;case 2:Dr=!0,He=h(je.subject,wi[yi].base.value);break;case 3:if(Pe.length>0)for(let gt=0;gt<Pe.length;gt++)6===Pe[gt].type&&(Dr=!0,He=He||o(Pe[gt].value,wi[yi].base.value));break;case 4:if(Pe.length>0)for(let gt=0;gt<Pe.length;gt++)7===Pe[gt].type&&(Dr=!0,He=He||u(Pe[gt].value,wi[yi].base.value))}if(He)break}if(!1===He&&wi.length>0&&Dr)throw nt.result=!1,nt.resultCode=41,nt.resultMessage='Failed to meet "permitted sub-trees" name constraint',nt}let mt=!1;for(let Qe=0;Qe<Me.length;Qe++){switch(Me[Qe].base.type){case 1:if(Pe.length>=0)for(let He=0;He<Pe.length;He++)1===Pe[He].type&&(mt=mt||a(Pe[He].value,Me[Qe].base.value));else for(let He=0;He<je.subject.typesAndValues.length;He++)("1.2.840.113549.1.9.1"===je.subject.typesAndValues[He].type||"0.9.2342.19200300.100.1.3"===je.subject.typesAndValues[He].type)&&(mt=mt||a(je.subject.typesAndValues[He].value.valueBlock.value,Me[Qe].base.value));break;case 2:if(Pe.length>0)for(let He=0;He<Pe.length;He++)2===Pe[He].type&&(mt=mt||i(Pe[He].value,Me[Qe].base.value));break;case 4:mt=mt||h(je.subject,Me[Qe].base.value);break;case 6:if(Pe.length>0)for(let He=0;He<Pe.length;He++)6===Pe[He].type&&(mt=mt||o(Pe[He].value,Me[Qe].base.value));break;case 7:if(Pe.length>0)for(let He=0;He<Pe.length;He++)7===Pe[He].type&&(mt=mt||u(Pe[He].value,Me[Qe].base.value))}if(mt)break}if(!0===mt)throw nt.result=!1,nt.resultCode=42,nt.resultMessage='Failed to meet "excluded sub-trees" name constraint',nt;xe=xe.concat(We),Me=Me.concat(st)}return nt}catch(m){return m instanceof Error?m instanceof hl?{result:!1,resultCode:m.code,resultMessage:m.message,error:m}:{result:!1,resultCode:qn.unknown,resultMessage:m.message,error:m}:m&&"object"==typeof m&&"resultMessage"in m?m:{result:!1,resultCode:-1,resultMessage:`${m}`}}})()}}const Lc="tbsResponseData",fl="signatureAlgorithm",dl="signature",Wn="certs",ml="BasicOCSPResponse",_h=`${ml}.${Lc}`,Ch=`${ml}.${fl}`,Nh=`${ml}.${dl}`,Fc=`${ml}.${Wn}`,bv=[_h,Ch,Nh,Fc];let Av=(()=>{class s extends fe{constructor(e={}){super(),this.tbsResponseData=l(e,Lc,s.defaultValues(Lc)),this.signatureAlgorithm=l(e,fl,s.defaultValues(fl)),this.signature=l(e,dl,s.defaultValues(dl)),Wn in e&&(this.certs=l(e,Wn,s.defaultValues(Wn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Lc:return new mi;case fl:return new Q;case dl:return new Ze;case Wn:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"type":{let i=mi.compareWithDefault("tbs",t.tbs)&&mi.compareWithDefault("responderID",t.responderID)&&mi.compareWithDefault("producedAt",t.producedAt)&&mi.compareWithDefault("responses",t.responses);return"responseExtensions"in t&&(i=i&&mi.compareWithDefault("responseExtensions",t.responseExtensions)),i}case fl:return t.algorithmId===v&&!("algorithmParams"in t);case dl:return t.isEqual(s.defaultValues(e));case Wn:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||ml,value:[mi.schema(t.tbsResponseData||{names:{blockName:_h}}),Q.schema(t.signatureAlgorithm||{names:{blockName:Ch}}),new Ze({name:t.signature||Nh}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new O({value:[new $e({name:Fc,value:zt.schema(t.certs||{})})]})]})]})}fromSchema(e){Z(e,bv);const t=he(e,e,s.schema());oe.assertSchema(t,this.className),this.tbsResponseData=new mi({schema:t.result[_h]}),this.signatureAlgorithm=new Q({schema:t.result[Ch]}),this.signature=t.result[Nh],Fc in t.result&&(this.certs=Array.from(t.result[Fc],i=>new zt({schema:i})))}toSchema(){const e=[];return e.push(this.tbsResponseData.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.certs&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:[new O({value:Array.from(this.certs,t=>t.toSchema())})]})),new O({value:e})}toJSON(){const e={tbsResponseData:this.tbsResponseData.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.certs&&(e.certs=Array.from(this.certs,t=>t.toJSON())),e}getCertificateStatus(e,t,i=Ge(!0)){var a=this;return(0,k.A)(function*(){const o={isForCertificate:!1,status:2},u={},h=[];for(const m of a.tbsResponseData.responses){const N=i.getAlgorithmByOID(m.certID.hashAlgorithm.algorithmId,!0,"CertID.hashAlgorithm");if(!u[N.name]){u[N.name]=1;const T=new fi;h.push(T),yield T.createForCertificate(e,{hashAlgorithm:N.name,issuerCertificate:t},i)}}for(const m of a.tbsResponseData.responses)for(const N of h)if(m.certID.isEqual(N)){o.isForCertificate=!0;try{switch(m.certStatus.idBlock.isConstructed){case!0:1===m.certStatus.idBlock.tagNumber&&(o.status=1);break;case!1:switch(m.certStatus.idBlock.tagNumber){case 0:o.status=0;break;case 2:o.status=2}}}catch{}return o}return o})()}sign(e,t="SHA-1",i=Ge(!0)){var a=this;return(0,k.A)(function*(){if(!e)throw new Error("Need to provide a private key for signing");const o=yield i.getSignatureParameters(e,t),u=o.parameters.algorithm;if(!("name"in u))throw new Error("Empty algorithm");a.signatureAlgorithm=o.signatureAlgorithm,a.tbsResponseData.tbsView=new Uint8Array(a.tbsResponseData.toSchema(!0).toBER());const h=yield i.signWithPrivateKey(a.tbsResponseData.tbsView,e,{algorithm:u});a.signature=new Ze({valueHex:h})})()}verify(e={},t=Ge(!0)){var i=this;return(0,k.A)(function*(){let a=null,o=-1;const u=e.trustedCerts||[];if(!i.certs)throw new Error("No certificates attached to the BasicOCSPResponse");switch(!0){case i.tbsResponseData.responderID instanceof dt:for(const[T,K]of i.certs.entries())if(K.subject.isEqual(i.tbsResponseData.responderID)){o=T;break}break;case i.tbsResponseData.responderID instanceof de:for(const[T,K]of i.certs.entries())if(ne(yield t.digest({name:"sha-1"},K.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView),i.tbsResponseData.responderID.valueBlock.valueHex)){o=T;break}break;default:throw new Error("Wrong value for responderID")}if(-1===o)throw new Error("Correct certificate was not found in OCSP response");a=i.certs[o];const h=[a];for(const T of i.certs){const K=yield Gd(T,a);K&&h.push(K)}if(!(yield new Mc({certs:h,trustedCerts:u}).verify({},t)).result)throw new Error("Validation of signer's certificate failed");return t.verifyWithPublicKey(i.tbsResponseData.tbsView,i.signature,i.certs[o].subjectPublicKeyInfo,i.signatureAlgorithm)})()}}return s.CLASS_NAME="BasicOCSPResponse",s})();const Bh="version",Rh="subject",Th="subjectPublicKeyInfo",zn="attributes",gl="signatureAlgorithm",pl="signatureValue",Yn="CertificationRequestInfo",xh=`${Yn}.version`,Vh=`${Yn}.subject`,Oh=`${Yn}.subjectPublicKeyInfo`,Hc=`${Yn}.attributes`,Ev=[Yn,xh,Vh,Oh,Hc,gl,pl];function kv(s={}){const r=l(s,"names",{});return new O({name:r.CertificationRequestInfo||Yn,value:[new X({name:r.CertificationRequestInfoVersion||xh}),dt.schema(r.subject||{names:{blockName:Vh}}),ns.schema({names:{blockName:Oh}}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new $e({optional:!0,name:r.CertificationRequestInfoAttributes||Hc,value:tt.schema(r.attributes||{})})]})]})}let _v=(()=>{class s extends fe{get tbs(){return A._H.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(l(e,"tbs",s.defaultValues("tbs"))),this.version=l(e,Bh,s.defaultValues(Bh)),this.subject=l(e,Rh,s.defaultValues(Rh)),this.subjectPublicKeyInfo=l(e,Th,s.defaultValues(Th)),zn in e&&(this.attributes=l(e,zn,s.defaultValues(zn))),this.signatureAlgorithm=l(e,gl,s.defaultValues(gl)),this.signatureValue=l(e,pl,s.defaultValues(pl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return Ct;case Bh:return 0;case Rh:return new dt;case Th:return new ns;case zn:return[];case gl:return new Q;case pl:return new Ze;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({value:[kv(t.certificationRequestInfo||{}),new O({name:t.signatureAlgorithm||gl,value:[new Ve,new Fe({optional:!0})]}),new Ze({name:t.signatureValue||pl})]})}fromSchema(e){Z(e,Ev);const t=he(e,e,s.schema());oe.assertSchema(t,this.className),this.tbsView=t.result.CertificationRequestInfo.valueBeforeDecodeView,this.version=t.result[xh].valueBlock.valueDec,this.subject=new dt({schema:t.result[Vh]}),this.subjectPublicKeyInfo=new ns({schema:t.result[Oh]}),Hc in t.result&&(this.attributes=Array.from(t.result[Hc],i=>new tt({schema:i}))),this.signatureAlgorithm=new Q({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[new X({value:this.version}),this.subject.toSchema(),this.subjectPublicKeyInfo.toSchema()];return zn in this&&e.push(new q({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes||[],t=>t.toSchema())})),new O({value:e})}toSchema(e=!1){let t;if(!1===e){if(0===this.tbsView.byteLength)return s.schema();const i=ct(this.tbsView);oe.assert(i,"PKCS#10 Certificate Request"),t=i.result}else t=this.encodeTBS();return new O({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:A.U$.ToHex(this.tbsView),version:this.version,subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return zn in this&&(e.attributes=Array.from(this.attributes||[],t=>t.toJSON())),e}sign(e,t="SHA-1",i=Ge(!0)){var a=this;return(0,k.A)(function*(){if(!e)throw new Error("Need to provide a private key for signing");const o=yield i.getSignatureParameters(e,t),u=o.parameters;a.signatureAlgorithm=o.signatureAlgorithm,a.tbsView=new Uint8Array(a.encodeTBS().toBER());const h=yield i.signWithPrivateKey(a.tbsView,e,u);a.signatureValue=new Ze({valueHex:h})})()}verify(e=Ge(!0)){var t=this;return(0,k.A)(function*(){return e.verifyWithPublicKey(t.tbsView,t.signatureValue,t.subjectPublicKeyInfo,t.signatureAlgorithm)})()}getPublicKey(e,t=Ge(!0)){var i=this;return(0,k.A)(function*(){return t.getPublicKey(i.subjectPublicKeyInfo,i.signatureAlgorithm,e)})()}}return s.CLASS_NAME="CertificationRequest",s})();const Sr="digestAlgorithm",br="digest",Cv=[Sr,br];let Xn=(()=>{class s extends fe{constructor(e={}){super(),this.digestAlgorithm=l(e,Sr,s.defaultValues(Sr)),this.digest=l(e,br,s.defaultValues(br)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Sr:return new Q;case br:return new de;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Sr:return Q.compareWithDefault("algorithmId",t.algorithmId)&&!("algorithmParams"in t);case br:return t.isEqual(s.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Q.schema(t.digestAlgorithm||{names:{blockName:Sr}}),new de({name:t.digest||br})]})}fromSchema(e){Z(e,Cv);const t=he(e,e,s.schema({names:{digestAlgorithm:{names:{blockName:Sr}},digest:br}}));oe.assertSchema(t,this.className),this.digestAlgorithm=new Q({schema:t.result.digestAlgorithm}),this.digest=t.result.digest}toSchema(){return new O({value:[this.digestAlgorithm.toSchema(),this.digest]})}toJSON(){return{digestAlgorithm:this.digestAlgorithm.toJSON(),digest:this.digest.toJSON()}}}return s.CLASS_NAME="DigestInfo",s})();const Qn="eContentType",es="eContent",Nv=[Qn,es];let Zn=(()=>{class s extends fe{constructor(e={}){if(super(),this.eContentType=l(e,Qn,s.defaultValues(Qn)),es in e&&(this.eContent=l(e,es,s.defaultValues(es)),1===this.eContent.idBlock.tagClass&&4===this.eContent.idBlock.tagNumber&&!1===this.eContent.idBlock.isConstructed)){const t=new de({idBlock:{isConstructed:!0},isConstructed:!0});let i=0;const a=this.eContent.valueBlock.valueHexView.slice().buffer;let o=a.byteLength;for(;o>0;){const u=new Uint8Array(a,i,i+65536>a.byteLength?a.byteLength-i:65536),h=new ArrayBuffer(u.length),m=new Uint8Array(h);for(let N=0;N<m.length;N++)m[N]=u[N];t.valueBlock.value.push(new de({valueHex:h})),o-=u.length,i+=u.length}this.eContent=t}e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qn:return v;case es:return new de;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Qn:return t===v;case es:return 1===t.idBlock.tagClass&&4===t.idBlock.tagNumber&&t.isEqual(s.defaultValues(es));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new Ve({name:t.eContentType||v}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.eContent||v})]})]})}fromSchema(e){Z(e,Nv);const t=he(e,e,s.schema({names:{eContentType:Qn,eContent:es}}));oe.assertSchema(t,this.className),this.eContentType=t.result.eContentType.valueBlock.toString(),es in t.result&&(this.eContent=t.result.eContent)}toSchema(){const e=[];return e.push(new Ve({value:this.eContentType})),this.eContent&&!1===s.compareWithDefault(es,this.eContent)&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.eContent]})),new O({value:e})}toJSON(){const e={eContentType:this.eContentType};return this.eContent&&!1===s.compareWithDefault(es,this.eContent)&&(e.eContent=this.eContent.toJSON()),e}}return s.CLASS_NAME="EncapsulatedContentInfo",s})();const Ar="mac",Er="macSalt",ys="iterations",Iv=[Ar,Er,ys];let kr=(()=>{class s extends fe{constructor(e={}){super(),this.mac=l(e,Ar,s.defaultValues(Ar)),this.macSalt=l(e,Er,s.defaultValues(Er)),ys in e&&(this.iterations=l(e,ys,s.defaultValues(ys))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ar:return new Xn;case Er:return new de;case ys:return 1;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ar:return Xn.compareWithDefault("digestAlgorithm",t.digestAlgorithm)&&Xn.compareWithDefault("digest",t.digest);case Er:return t.isEqual(s.defaultValues(e));case ys:return t===s.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,optional:t.optional||!0,value:[Xn.schema(t.mac||{names:{blockName:Ar}}),new de({name:t.macSalt||Er}),new X({optional:!0,name:t.iterations||ys})]})}fromSchema(e){Z(e,Iv);const t=he(e,e,s.schema({names:{mac:{names:{blockName:Ar}},macSalt:Er,iterations:ys}}));oe.assertSchema(t,this.className),this.mac=new Xn({schema:t.result.mac}),this.macSalt=t.result.macSalt,ys in t.result&&(this.iterations=t.result.iterations.valueBlock.valueDec)}toSchema(){const e=[this.mac.toSchema(),this.macSalt];return void 0!==this.iterations&&e.push(new X({value:this.iterations})),new O({value:e})}toJSON(){const e={mac:this.mac.toJSON(),macSalt:this.macSalt.toJSON()};return void 0!==this.iterations&&(e.iterations=this.iterations),e}}return s.CLASS_NAME="MacData",s})();const _r="hashAlgorithm",Cr="hashedMessage",Bv=[_r,Cr];let vl=(()=>{class s extends fe{static create(e,t,i=Ge(!0)){return(0,k.A)(function*(){const a=i.getOIDByAlgorithm({name:e},!0,"hashAlgorithm"),o=yield i.digest(e,t);return new s({hashAlgorithm:new Q({algorithmId:a,algorithmParams:new kt}),hashedMessage:new de({valueHex:o})})})()}constructor(e={}){super(),this.hashAlgorithm=l(e,_r,s.defaultValues(_r)),this.hashedMessage=l(e,Cr,s.defaultValues(Cr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case _r:return new Q;case Cr:return new de;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case _r:return t.algorithmId===v&&!("algorithmParams"in t);case Cr:return 0===t.isEqual(s.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[Q.schema(t.hashAlgorithm||{}),new de({name:t.hashedMessage||v})]})}fromSchema(e){Z(e,Bv);const t=he(e,e,s.schema({names:{hashAlgorithm:{names:{blockName:_r}},hashedMessage:Cr}}));oe.assertSchema(t,this.className),this.hashAlgorithm=new Q({schema:t.result.hashAlgorithm}),this.hashedMessage=t.result.hashedMessage}toSchema(){return new O({value:[this.hashAlgorithm.toSchema(),this.hashedMessage]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),hashedMessage:this.hashedMessage.toJSON()}}}return s.CLASS_NAME="MessageImprint",s})();const Nr="type",Ss="attributes",jc="encodedValue",Uv=[Ss];let Ht=(()=>{class s extends fe{constructor(e={}){super(),this.type=l(e,Nr,s.defaultValues(Nr)),this.attributes=l(e,Ss,s.defaultValues(Ss)),this.encodedValue=l(e,jc,s.defaultValues(jc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Nr:return-1;case Ss:return[];case jc:return Ct;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Nr:return t===s.defaultValues(Nr);case Ss:return 0===t.length;case jc:return 0===t.byteLength;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new q({name:t.blockName||v,optional:!0,idBlock:{tagClass:3,tagNumber:t.tagNumber||0},value:[new $e({name:t.attributes||v,value:tt.schema()})]})}fromSchema(e){Z(e,Uv);const t=he(e,e,s.schema({names:{tagNumber:this.type,attributes:Ss}}));if(oe.assertSchema(t,this.className),this.type=t.result.idBlock.tagNumber,this.encodedValue=A._H.toArrayBuffer(t.result.valueBeforeDecodeView),new Uint8Array(this.encodedValue)[0]=49,Ss in t.result)this.attributes=Array.from(t.result.attributes,a=>new tt({schema:a}));else if(0===this.type)throw new Error("Wrong structure of SignedUnsignedAttributes")}toSchema(){if(s.compareWithDefault(Nr,this.type)||s.compareWithDefault(Ss,this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return new q({optional:!0,idBlock:{tagClass:3,tagNumber:this.type},value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){if(s.compareWithDefault(Nr,this.type)||s.compareWithDefault(Ss,this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return{type:this.type,attributes:Array.from(this.attributes,e=>e.toJSON())}}}return s.CLASS_NAME="SignedAndUnsignedAttributes",s})();const ea="version",Ir="sid",ta="digestAlgorithm",gi="signedAttrs",sa="signatureAlgorithm",yl="signature",pi="unsignedAttrs",vi="SignerInfo",Ph=`${vi}.${ea}`,Sl=`${vi}.${Ir}`,Dh=`${vi}.${ta}`,$c=`${vi}.${gi}`,Uh=`${vi}.${sa}`,Mh=`${vi}.${yl}`,Kc=`${vi}.${pi}`,Mv=[Ph,Sl,Dh,$c,Uh,Mh,Kc];let Lh=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,ea,s.defaultValues(ea)),this.sid=l(e,Ir,s.defaultValues(Ir)),this.digestAlgorithm=l(e,ta,s.defaultValues(ta)),gi in e&&(this.signedAttrs=l(e,gi,s.defaultValues(gi))),this.signatureAlgorithm=l(e,sa,s.defaultValues(sa)),this.signature=l(e,yl,s.defaultValues(yl)),pi in e&&(this.unsignedAttrs=l(e,pi,s.defaultValues(pi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ea:return 0;case Ir:return new Fe;case ta:return new Q;case gi:return new Ht({type:0});case sa:return new Q;case yl:return new de;case pi:return new Ht({type:1});default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ea:return s.defaultValues(ea)===t;case Ir:return t instanceof Fe;case ta:return t instanceof Q&&t.isEqual(s.defaultValues(ta));case gi:return Ht.compareWithDefault("type",t.type)&&Ht.compareWithDefault("attributes",t.attributes)&&Ht.compareWithDefault("encodedValue",t.encodedValue);case sa:return t instanceof Q&&t.isEqual(s.defaultValues(sa));case yl:case pi:return Ht.compareWithDefault("type",t.type)&&Ht.compareWithDefault("attributes",t.attributes)&&Ht.compareWithDefault("encodedValue",t.encodedValue);default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:vi,value:[new X({name:t.version||Ph}),new ft({value:[xt.schema(t.sidSchema||{names:{blockName:Sl}}),new ft({value:[new q({optional:!0,name:t.sid||Sl,idBlock:{tagClass:3,tagNumber:0},value:[new de]}),new Le({optional:!0,name:t.sid||Sl,idBlock:{tagClass:3,tagNumber:0}})]})]}),Q.schema(t.digestAlgorithm||{names:{blockName:Dh}}),Ht.schema(t.signedAttrs||{names:{blockName:$c,tagNumber:0}}),Q.schema(t.signatureAlgorithm||{names:{blockName:Uh}}),new de({name:t.signature||Mh}),Ht.schema(t.unsignedAttrs||{names:{blockName:Kc,tagNumber:1}})]})}fromSchema(e){Z(e,Mv);const t=he(e,e,s.schema());oe.assertSchema(t,this.className),this.version=t.result[Ph].valueBlock.valueDec;const i=t.result[Sl];this.sid=1===i.idBlock.tagClass?new xt({schema:i}):i,this.digestAlgorithm=new Q({schema:t.result[Dh]}),$c in t.result&&(this.signedAttrs=new Ht({type:0,schema:t.result[$c]})),this.signatureAlgorithm=new Q({schema:t.result[Uh]}),this.signature=t.result[Mh],Kc in t.result&&(this.unsignedAttrs=new Ht({type:1,schema:t.result[Kc]}))}toSchema(){if(s.compareWithDefault(Ir,this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e=[];return e.push(new X({value:this.version})),e.push(this.sid instanceof xt?this.sid.toSchema():this.sid),e.push(this.digestAlgorithm.toSchema()),this.signedAttrs&&!1===s.compareWithDefault(gi,this.signedAttrs)&&e.push(this.signedAttrs.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.unsignedAttrs&&!1===s.compareWithDefault(pi,this.unsignedAttrs)&&e.push(this.unsignedAttrs.toSchema()),new O({value:e})}toJSON(){if(s.compareWithDefault(Ir,this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e={version:this.version,digestAlgorithm:this.digestAlgorithm.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.sid instanceof Fe||(e.sid=this.sid.toJSON()),this.signedAttrs&&!1===s.compareWithDefault(gi,this.signedAttrs)&&(e.signedAttrs=this.signedAttrs.toJSON()),this.unsignedAttrs&&!1===s.compareWithDefault(pi,this.unsignedAttrs)&&(e.unsignedAttrs=this.unsignedAttrs.toJSON()),e}}return s.CLASS_NAME="SignerInfo",s})();const bl="version",Al="policy",El="messageImprint",kl="serialNumber",_l="genTime",Br="ordering",Rr="nonce",ia="accuracy",ra="tsa",na="extensions",ts="TSTInfo",Fh=`${ts}.${bl}`,Hh=`${ts}.${Al}`,jh=`${ts}.${El}`,$h=`${ts}.${kl}`,Kh=`${ts}.${_l}`,Gc=`${ts}.${ia}`,Jc=`${ts}.${Br}`,qc=`${ts}.${Rr}`,Wc=`${ts}.${ra}`,zc=`${ts}.${na}`,Lv=[Fh,Hh,jh,$h,Kh,Gc,Jc,qc,Wc,zc];let Fv=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,bl,s.defaultValues(bl)),this.policy=l(e,Al,s.defaultValues(Al)),this.messageImprint=l(e,El,s.defaultValues(El)),this.serialNumber=l(e,kl,s.defaultValues(kl)),this.genTime=l(e,_l,s.defaultValues(_l)),ia in e&&(this.accuracy=l(e,ia,s.defaultValues(ia))),Br in e&&(this.ordering=l(e,Br,s.defaultValues(Br))),Rr in e&&(this.nonce=l(e,Rr,s.defaultValues(Rr))),ra in e&&(this.tsa=l(e,ra,s.defaultValues(ra))),na in e&&(this.extensions=l(e,na,s.defaultValues(na))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case bl:return 0;case Al:return v;case El:return new vl;case kl:return new X;case _l:return new Date(0,0,0);case ia:return new Lr;case Br:return!1;case Rr:return new X;case ra:return new St;case na:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case bl:case Al:case _l:case Br:return t===s.defaultValues(Br);case El:return vl.compareWithDefault(_r,t.hashAlgorithm)&&vl.compareWithDefault(Cr,t.hashedMessage);case kl:case Rr:return t.isEqual(s.defaultValues(Rr));case ia:return Lr.compareWithDefault(Ts,t.seconds)&&Lr.compareWithDefault(xs,t.millis)&&Lr.compareWithDefault(Vs,t.micros);case ra:return St.compareWithDefault(pa,t.type)&&St.compareWithDefault(va,t.value);case na:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||ts,value:[new X({name:t.version||Fh}),new Ve({name:t.policy||Hh}),vl.schema(t.messageImprint||{names:{blockName:jh}}),new X({name:t.serialNumber||$h}),new ht({name:t.genTime||Kh}),Lr.schema(t.accuracy||{names:{blockName:Gc}}),new ks({name:t.ordering||Jc,optional:!0}),new X({name:t.nonce||qc,optional:!0}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[St.schema(t.tsa||{names:{blockName:Wc}})]}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new $e({name:t.extensions||zc,value:Li.schema(t.extension||{})})]})]})}fromSchema(e){Z(e,Lv);const t=he(e,e,s.schema());oe.assertSchema(t,this.className),this.version=t.result[Fh].valueBlock.valueDec,this.policy=t.result[Hh].valueBlock.toString(),this.messageImprint=new vl({schema:t.result[jh]}),this.serialNumber=t.result[$h],this.genTime=t.result[Kh].toDate(),Gc in t.result&&(this.accuracy=new Lr({schema:t.result[Gc]})),Jc in t.result&&(this.ordering=t.result[Jc].valueBlock.value),qc in t.result&&(this.nonce=t.result[qc]),Wc in t.result&&(this.tsa=new St({schema:t.result[Wc]})),zc in t.result&&(this.extensions=Array.from(t.result[zc],i=>new Li({schema:i})))}toSchema(){const e=[];return e.push(new X({value:this.version})),e.push(new Ve({value:this.policy})),e.push(this.messageImprint.toSchema()),e.push(this.serialNumber),e.push(new ht({valueDate:this.genTime})),this.accuracy&&e.push(this.accuracy.toSchema()),void 0!==this.ordering&&e.push(new ks({value:this.ordering})),this.nonce&&e.push(this.nonce),this.tsa&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.tsa.toSchema()]})),this.extensions&&e.push(new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.extensions,t=>t.toSchema())})),new O({value:e})}toJSON(){const e={version:this.version,policy:this.policy,messageImprint:this.messageImprint.toJSON(),serialNumber:this.serialNumber.toJSON(),genTime:this.genTime};return this.accuracy&&(e.accuracy=this.accuracy.toJSON()),void 0!==this.ordering&&(e.ordering=this.ordering),this.nonce&&(e.nonce=this.nonce.toJSON()),this.tsa&&(e.tsa=this.tsa.toJSON()),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}verify(e,t=Ge(!0)){var i=this;return(0,k.A)(function*(){if(!e.data)throw new Error('"data" is a mandatory attribute for TST_INFO verification');const a=e.data;if(e.notBefore&&i.genTime<e.notBefore)throw new Error("Generation time for TSTInfo object is less than notBefore value");if(e.notAfter&&i.genTime>e.notAfter)throw new Error("Generation time for TSTInfo object is more than notAfter value");const o=t.getAlgorithmByOID(i.messageImprint.hashAlgorithm.algorithmId,!0,"MessageImprint.hashAlgorithm"),u=yield t.digest(o.name,new Uint8Array(a));return A._H.isEqual(u,i.messageImprint.hashedMessage.valueBlock.valueHexView)})()}}return s.CLASS_NAME="TSTInfo",s})();const aa="version",Cl="digestAlgorithms",Nl="encapContentInfo",oa="certificates",la="crls",Il="signerInfos",Bl="ocsps",Tr="SignedData",Gh=`${Tr}.${aa}`,Yc=`${Tr}.${Cl}`,Jh=`${Tr}.${Nl}`,Xc=`${Tr}.${oa}`,Qc=`${Tr}.${la}`,Zc=`${Tr}.${Il}`,Hv=[Gh,Yc,Jh,Xc,Qc,Zc];class Vt extends Error{constructor({message:r,code:e=0,date:t=new Date,signatureVerified:i=null,signerCertificate:a=null,signerCertificateVerified:o=null,timestampSerial:u=null,certificatePath:h=[]}){super(r),this.name="SignedDataVerifyError",this.date=t,this.code=e,this.timestampSerial=u,this.signatureVerified=i,this.signerCertificate=a,this.signerCertificateVerified=o,this.certificatePath=h}}let em=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,aa,s.defaultValues(aa)),this.digestAlgorithms=l(e,Cl,s.defaultValues(Cl)),this.encapContentInfo=l(e,Nl,s.defaultValues(Nl)),oa in e&&(this.certificates=l(e,oa,s.defaultValues(oa))),la in e&&(this.crls=l(e,la,s.defaultValues(la))),Bl in e&&(this.ocsps=l(e,Bl,s.defaultValues(Bl))),this.signerInfos=l(e,Il,s.defaultValues(Il)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case aa:return 0;case Cl:return[];case Nl:return new Zn;case oa:case la:case Bl:case Il:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case aa:return t===s.defaultValues(aa);case Nl:return Zn.compareWithDefault("eContentType",t.eContentType)&&Zn.compareWithDefault("eContent",t.eContent);case Cl:case oa:case la:case Bl:case Il:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return void 0===t.optional&&(t.optional=!1),new O({name:t.blockName||Tr,optional:t.optional,value:[new X({name:t.version||Gh}),new _t({value:[new $e({name:t.digestAlgorithms||Yc,value:Q.schema()})]}),Zn.schema(t.encapContentInfo||{names:{blockName:Jh}}),new q({name:t.certificates||Xc,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:mn.schema().valueBlock.value}),new q({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Sc.schema(t.crls||{names:{crls:Qc}}).valueBlock.value}),new _t({value:[new $e({name:t.signerInfos||Zc,value:Lh.schema()})]})]})}fromSchema(e){Z(e,Hv);const t=he(e,e,s.schema());if(oe.assertSchema(t,this.className),this.version=t.result[Gh].valueBlock.valueDec,Yc in t.result&&(this.digestAlgorithms=Array.from(t.result[Yc],i=>new Q({schema:i}))),this.encapContentInfo=new Zn({schema:t.result[Jh]}),Xc in t.result){const i=new mn({schema:new _t({value:t.result[Xc].valueBlock.value})});this.certificates=i.certificates.slice(0)}Qc in t.result&&(this.crls=Array.from(t.result[Qc],i=>1===i.idBlock.tagClass?new vc({schema:i}):(i.idBlock.tagClass=1,i.idBlock.tagNumber=16,new yc({schema:i})))),Zc in t.result&&(this.signerInfos=Array.from(t.result[Zc],i=>new Lh({schema:i})))}toSchema(e=!1){const t=[];if(this.version=this.certificates&&this.certificates.length&&this.certificates.some(i=>i instanceof ei)||this.crls&&this.crls.length&&this.crls.some(i=>i instanceof yc)?5:this.certificates&&this.certificates.length&&this.certificates.some(i=>i instanceof er)?4:this.certificates&&this.certificates.length&&this.certificates.some(i=>i instanceof Lu)||this.signerInfos.some(i=>3===i.version)||this.encapContentInfo.eContentType!==s.ID_DATA?3:1,t.push(new X({value:this.version})),t.push(new _t({value:Array.from(this.digestAlgorithms,i=>i.toSchema())})),t.push(this.encapContentInfo.toSchema()),this.certificates){const a=new mn({certificates:this.certificates}).toSchema();t.push(new q({idBlock:{tagClass:3,tagNumber:0},value:a.valueBlock.value}))}return this.crls&&t.push(new q({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.crls,i=>{if(i instanceof yc){const a=i.toSchema();return a.idBlock.tagClass=3,a.idBlock.tagNumber=1,a}return i.toSchema(e)})})),t.push(new _t({value:Array.from(this.signerInfos,i=>i.toSchema())})),new O({value:t})}toJSON(){const e={version:this.version,digestAlgorithms:Array.from(this.digestAlgorithms,t=>t.toJSON()),encapContentInfo:this.encapContentInfo.toJSON(),signerInfos:Array.from(this.signerInfos,t=>t.toJSON())};return this.certificates&&(e.certificates=Array.from(this.certificates,t=>t.toJSON())),this.crls&&(e.crls=Array.from(this.crls,t=>t.toJSON())),e}verify({signer:e=-1,data:t=Ct,trustedCerts:i=[],checkDate:a=new Date,checkChain:o=!1,passedWhenNotRevValues:u=!1,extendedMode:h=!1,findOrigin:m=null,findIssuer:N=null}={},T=Ge(!0)){var K=this;return(0,k.A)(function*(){let L=null,re=null;try{let Ae=Ct,we=v,se=[];const ye=K.signerInfos[e];if(!ye)throw new Vt({date:a,code:1,message:"Unable to get signer by supplied index"});if(!K.certificates)throw new Vt({date:a,code:2,message:"No certificates attached to this signed data"});if(ye.sid instanceof xt){for(const be of K.certificates)if(be instanceof zt&&be.issuer.isEqual(ye.sid.issuer)&&be.serialNumber.isEqual(ye.sid.serialNumber)){L=be;break}}else{const be=ye.sid,Re=be.idBlock.isConstructed?be.valueBlock.value[0].valueBlock.valueHex:be.valueBlock.valueHex;for(const xe of K.certificates)if(xe instanceof zt&&ne(yield T.digest({name:"sha-1"},xe.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView),Re)){L=xe;break}}if(!L)throw new Vt({date:a,code:3,message:"Unable to find signer certificate"});if("1.2.840.113549.1.9.16.1.4"===K.encapContentInfo.eContentType){if(!K.encapContentInfo.eContent)throw new Vt({date:a,code:15,message:"Error during verification: TSTInfo eContent is empty",signatureVerified:null,signerCertificate:L,timestampSerial:re,signerCertificateVerified:!0});let be;try{be=Fv.fromBER(K.encapContentInfo.eContent.valueBlock.valueHexView)}catch{throw new Vt({date:a,code:15,message:"Error during verification: TSTInfo wrong ASN.1 schema ",signatureVerified:null,signerCertificate:L,timestampSerial:re,signerCertificateVerified:!0})}if(a=be.genTime,re=be.serialNumber.valueBlock.valueHexView.slice(),0===t.byteLength)throw new Vt({date:a,code:4,message:"Missed detached data input array"});if(!(yield be.verify({data:t},T)))throw new Vt({date:a,code:15,message:"Error during verification: TSTInfo verification is failed",signatureVerified:!1,signerCertificate:L,timestampSerial:re,signerCertificateVerified:!0})}if(o){const be=K.certificates.filter(ze=>ze instanceof zt&&!!Gd(ze,L)),Re={checkDate:a,certs:be,trustedCerts:i};N&&(Re.findIssuer=N),m&&(Re.findOrigin=m);const xe=new Mc(Re);if(xe.certs.push(L),K.crls)for(const ze of K.crls)"thisUpdate"in ze?xe.crls.push(ze):"1.3.6.1.5.5.7.48.1.1"===ze.otherRevInfoFormat&&xe.ocsps.push(new Av({schema:ze.otherRevInfo}));K.ocsps&&xe.ocsps.push(...K.ocsps);const Me=yield xe.verify({passedWhenNotRevValues:u},T).catch(ze=>{throw new Vt({date:a,code:5,message:`Validation of signer's certificate failed with error: ${ze instanceof Object?ze.resultMessage:ze}`,signerCertificate:L,signerCertificateVerified:!1})});if(Me.certificatePath&&(se=Me.certificatePath),!Me.result)throw new Vt({date:a,code:5,message:`Validation of signer's certificate failed: ${Me.resultMessage}`,signerCertificate:L,signerCertificateVerified:!1})}const ae=T.getAlgorithmByOID(ye.digestAlgorithm.algorithmId);if(!("name"in ae))throw new Vt({date:a,code:7,message:`Unsupported signature algorithm: ${ye.digestAlgorithm.algorithmId}`,signerCertificate:L,signerCertificateVerified:!0});we=ae.name;const le=K.encapContentInfo.eContent;if(le)t=1===le.idBlock.tagClass&&4===le.idBlock.tagNumber?le.getValue():le.valueBlock.valueBeforeDecodeView;else if(0===t.byteLength)throw new Vt({date:a,code:8,message:"Missed detached data input array",signerCertificate:L,signerCertificateVerified:!0});if(ye.signedAttrs){let be=!1,Re=!1;for(const xe of ye.signedAttrs.attributes)if("1.2.840.113549.1.9.3"===xe.type&&(be=!0),"1.2.840.113549.1.9.4"===xe.type&&(Re=!0,Ae=xe.values[0].valueBlock.valueHex),be&&Re)break;if(!1===be)throw new Vt({date:a,code:9,message:'Attribute "content-type" is a mandatory attribute for "signed attributes"',signerCertificate:L,signerCertificateVerified:!0});if(!1===Re)throw new Vt({date:a,code:10,message:'Attribute "message-digest" is a mandatory attribute for "signed attributes"',signatureVerified:null,signerCertificate:L,signerCertificateVerified:!0})}if(ye.signedAttrs){if(!ne(yield T.digest(we,new Uint8Array(t)),Ae))throw new Vt({date:a,code:15,message:"Error during verification: Message digest doesn't match",signatureVerified:null,signerCertificate:L,timestampSerial:re,signerCertificateVerified:!0});t=ye.signedAttrs.encodedValue}const pe="1.2.840.113549.1.1.1"===ye.signatureAlgorithm.algorithmId?yield T.verifyWithPublicKey(t,ye.signature,L.subjectPublicKeyInfo,ye.signatureAlgorithm,we):yield T.verifyWithPublicKey(t,ye.signature,L.subjectPublicKeyInfo,ye.signatureAlgorithm);return h?{date:a,code:14,message:v,signatureVerified:pe,signerCertificate:L,timestampSerial:re,signerCertificateVerified:!0,certificatePath:se}:pe}catch(Ae){throw Ae instanceof Vt?Ae:new Vt({date:a,code:15,message:`Error during verification: ${Ae instanceof Error?Ae.message:Ae}`,signatureVerified:null,signerCertificate:L,timestampSerial:re,signerCertificateVerified:!0})}})()}sign(e,t,i="SHA-1",a=Ct,o=Ge(!0)){var u=this;return(0,k.A)(function*(){var h;if(!e)throw new Error("Need to provide a private key for signing");const m=u.signerInfos[t];if(!m)throw new RangeError("SignerInfo index is out of range");(null===(h=m.signedAttrs)||void 0===h||!h.attributes.length)&&"hash"in e.algorithm&&"hash"in e.algorithm&&e.algorithm.hash&&(i=e.algorithm.hash.name);const N=o.getOIDByAlgorithm({name:i},!0,"hashAlgorithm");0===u.digestAlgorithms.filter(re=>re.algorithmId===N).length&&u.digestAlgorithms.push(new Q({algorithmId:N,algorithmParams:new kt})),m.digestAlgorithm=new Q({algorithmId:N,algorithmParams:new kt});const T=yield o.getSignatureParameters(e,i),K=T.parameters;if(m.signatureAlgorithm=T.signatureAlgorithm,m.signedAttrs)0!==m.signedAttrs.encodedValue.byteLength?a=m.signedAttrs.encodedValue:(a=m.signedAttrs.toSchema().toBER(),A._H.toUint8Array(a)[0]=49);else{const re=u.encapContentInfo.eContent;if(re)a=1===re.idBlock.tagClass&&4===re.idBlock.tagNumber?re.getValue():re.valueBlock.valueBeforeDecodeView;else if(0===a.byteLength)throw new Error("Missed detached data input array")}const L=yield o.signWithPrivateKey(a,e,K);m.signature=new de({valueHex:L})})()}}return s.CLASS_NAME="SignedData",s.ID_DATA=bu,s})();const xr="version",Vr="authSafe",As="macData",Rl="parsedValue",jv=[xr,Vr,As];let $v=(()=>{class s extends fe{constructor(e={}){super(),this.version=l(e,xr,s.defaultValues(xr)),this.authSafe=l(e,Vr,s.defaultValues(Vr)),As in e&&(this.macData=l(e,As,s.defaultValues(As))),Rl in e&&(this.parsedValue=l(e,Rl,s.defaultValues(Rl))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xr:return 3;case Vr:return new Ut;case As:return new kr;case Rl:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case xr:return t===s.defaultValues(e);case Vr:return Ut.compareWithDefault("contentType",t.contentType)&&Ut.compareWithDefault("content",t.content);case As:return kr.compareWithDefault("mac",t.mac)&&kr.compareWithDefault("macSalt",t.macSalt)&&kr.compareWithDefault("iterations",t.iterations);case Rl:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=l(e,"names",{});return new O({name:t.blockName||v,value:[new X({name:t.version||xr}),Ut.schema(t.authSafe||{names:{blockName:Vr}}),kr.schema(t.macData||{names:{blockName:As,optional:!0}})]})}fromSchema(e){Z(e,jv);const t=he(e,e,s.schema({names:{version:xr,authSafe:{names:{blockName:Vr}},macData:{names:{blockName:As}}}}));oe.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.authSafe=new Ut({schema:t.result.authSafe}),As in t.result&&(this.macData=new kr({schema:t.result.macData}))}toSchema(){const e=[new X({value:this.version}),this.authSafe.toSchema()];return this.macData&&e.push(this.macData.toSchema()),new O({value:e})}toJSON(){const e={version:this.version,authSafe:this.authSafe.toJSON()};return this.macData&&(e.macData=this.macData.toJSON()),e}makeInternalValues(e={},t=Ge(!0)){var i=this;return(0,k.A)(function*(){if(ot.assert(e,"parameters","object"),!i.parsedValue)throw new Error('Please call "parseValues" function first in order to make "parsedValue" data');switch(et.assertEmpty(i.parsedValue.integrityMode,"integrityMode","parsedValue"),et.assertEmpty(i.parsedValue.authenticatedSafe,"authenticatedSafe","parsedValue"),i.parsedValue.integrityMode){case 0:{if(!("iterations"in e))throw new et("iterations");et.assertEmpty(e.pbkdf2HashAlgorithm,"pbkdf2HashAlgorithm"),et.assertEmpty(e.hmacHashAlgorithm,"hmacHashAlgorithm"),et.assertEmpty(e.password,"password");const a=new ArrayBuffer(64),o=new Uint8Array(a);t.getRandomValues(o);const u=i.parsedValue.authenticatedSafe.toSchema().toBER(!1);i.authSafe=new Ut({contentType:Ut.DATA,content:new de({valueHex:u})});const h=yield t.stampDataWithPassword({password:e.password,hashAlgorithm:e.hmacHashAlgorithm,salt:a,iterationCount:e.iterations,contentToStamp:u});i.macData=new kr({mac:new Xn({digestAlgorithm:new Q({algorithmId:t.getOIDByAlgorithm({name:e.hmacHashAlgorithm},!0,"hmacHashAlgorithm")}),digest:new de({valueHex:h})}),macSalt:new de({valueHex:a}),iterations:e.iterations})}break;case 1:{if(!("signingCertificate"in e))throw new et("signingCertificate");et.assertEmpty(e.privateKey,"privateKey"),et.assertEmpty(e.hashAlgorithm,"hashAlgorithm");const a=i.parsedValue.authenticatedSafe.toSchema().toBER(!1),o=new em({version:1,encapContentInfo:new Zn({eContentType:"1.2.840.113549.1.7.1",eContent:new de({valueHex:a})}),certificates:[e.signingCertificate]}),u=yield t.digest({name:e.hashAlgorithm},new Uint8Array(a)),h=[];h.push(new tt({type:"1.2.840.113549.1.9.3",values:[new Ve({value:"1.2.840.113549.1.7.1"})]})),h.push(new tt({type:"1.2.840.113549.1.9.5",values:[new Mr({valueDate:new Date})]})),h.push(new tt({type:"1.2.840.113549.1.9.4",values:[new de({valueHex:u})]})),o.signerInfos.push(new Lh({version:1,sid:new xt({issuer:e.signingCertificate.issuer,serialNumber:e.signingCertificate.serialNumber}),signedAttrs:new Ht({type:0,attributes:h})})),yield o.sign(e.privateKey,0,e.hashAlgorithm,void 0,t),i.authSafe=new Ut({contentType:"1.2.840.113549.1.7.2",content:o.toSchema(!0)})}break;default:throw new Error(`Parameter "integrityMode" has unknown value: ${i.parsedValue.integrityMode}`)}})()}parseInternalValues(e,t=Ge(!0)){var i=this;return(0,k.A)(function*(){switch(ot.assert(e,"parameters","object"),void 0===e.checkIntegrity&&(e.checkIntegrity=!0),i.parsedValue={},i.authSafe.contentType){case Ut.DATA:{et.assertEmpty(e.password,"password"),i.parsedValue.integrityMode=0,ot.assert(i.authSafe.content,"authSafe.content",de);const a=i.authSafe.content.getValue();if(i.parsedValue.authenticatedSafe=gh.fromBER(a),e.checkIntegrity){if(!i.macData)throw new Error('Absent "macData" value, can not check PKCS#12 data integrity');const o=t.getAlgorithmByOID(i.macData.mac.digestAlgorithm.algorithmId,!0,"digestAlgorithm");if(!(yield t.verifyDataStampedWithPassword({password:e.password,hashAlgorithm:o.name,salt:A._H.toArrayBuffer(i.macData.macSalt.valueBlock.valueHexView),iterationCount:i.macData.iterations||1,contentToVerify:a,signatureToVerify:A._H.toArrayBuffer(i.macData.mac.digest.valueBlock.valueHexView)})))throw new Error("Integrity for the PKCS#12 data is broken!")}}break;case Ut.SIGNED_DATA:{i.parsedValue.integrityMode=1;const a=new em({schema:i.authSafe.content}),o=a.encapContentInfo.eContent;et.assert(o,"eContent","cmsSigned.encapContentInfo"),ot.assert(o,"eContent",de);const u=o.getValue();if(i.parsedValue.authenticatedSafe=gh.fromBER(u),!(yield a.verify({signer:0,checkChain:!1},t)))throw new Error("Integrity for the PKCS#12 data is broken!")}break;default:throw new Error(`Incorrect value for "this.authSafe.contentType": ${i.authSafe.contentType}`)}})()}}return s.CLASS_NAME="PFX",s})();!function ow(){if(typeof self<"u"){if("crypto"in self){let s="webcrypto";"webkitSubtle"in self.crypto&&(s="safari"),Td(s,new zl({name:s,crypto}))}}else if(typeof crypto<"u"&&"webcrypto"in crypto){const s="NodeJS ^15",r=crypto.webcrypto;Td(s,new zl({name:s,crypto:r}))}}();const lw=function(){var s=(0,k.A)(function*(r,e,t,i,a,o){try{const u={name:"ECDSA",namedCurve:"P-384",typedCurve:""},h=yield crypto.subtle.generateKey(u,!0,["sign","verify"]),m=new _v;m.subject.typesAndValues.push(new gu({type:"2.5.4.3",value:new qt({value:"Test"})})),yield m.subjectPublicKeyInfo.importKey(h.publicKey),yield m.sign(h.privateKey,"SHA-384");const N=m.toSchema().toBER(!1),T=Tl(N,"CERTIFICATE REQUEST"),K=yield new Promise((we,se)=>{r.issueNewCertificate(T,e,t,i).subscribe(ye=>{},ye=>{201===ye.status?we(ye.error.text):(console.error("Error when trying to issue new certificate:",ye.error.message),se(ye))})}),L=yield crypto.subtle.exportKey("pkcs8",h.privateKey),re=yield crypto.subtle.exportKey("spki",h.publicKey),Ae=new Yr({schema:ct(L).result});if(a){const se=cw(K).map(le=>new zt({schema:ct(le).result})),ye=uw(),ae=yield hw(Ae,se,ye);return{certificate:K,publicKey:Tl(re,"PUBLIC KEY"),privateKey:Tl(L,"PRIVATE KEY"),pkcs12Keystore:ae,keystorePassword:ye}}return{certificate:K,publicKey:Tl(re,"PUBLIC KEY"),privateKey:Tl(L,"PRIVATE KEY")}}catch(u){return void console.error("Error while issuing new certificate:",u)}});return function(e,t,i,a,o,u){return s.apply(this,arguments)}}(),Tl=(s,r)=>{let e=A.U$.ToBase64(s),t="";for(;e.length>0;)t+=e.substring(0,64)+"\n",e=e.substring(64);return`-----BEGIN ${r}-----\n${t}-----END ${r}-----\n`},cw=s=>{let r=s.split(/-----END CERTIFICATE-----/);return r=r.slice(0,r.length-1),r.map(t=>t.split(/-----BEGIN CERTIFICATE-----/)[1].replace(/\n/gm,"")).map(t=>A.U$.FromBase64(t))},uw=()=>{const r=new Uint32Array(26);crypto.getRandomValues(r);let e="";for(const t of r)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_^$#&!%"[t%70];return e},hw=function(){var s=(0,k.A)(function*(r,e,t){const i=new ArrayBuffer(4);Nu(new Uint8Array(i));const o=new ArrayBuffer(4);Nu(new Uint8Array(o));const h=new ArrayBuffer(4);Nu(new Uint8Array(h));const N=new ArrayBuffer(1);new Uint8Array(N)[0]|=128;const K=new Ze({valueHex:N,unusedBits:7});r.attributes=[new tt({type:"2.5.29.15",values:[K]})];let L="";e[0].subject.typesAndValues.forEach(se=>{"2.5.4.3"===se.type&&(L=se.value.valueBlock.value)});let re="";e[1].subject.typesAndValues.forEach(se=>{"2.5.4.3"===se.type&&(re=se.value.valueBlock.value)});const Ae=new $v({parsedValue:{integrityMode:0,authenticatedSafe:new gh({parsedValue:{safeContents:[{privacyMode:0,value:new ar({safeBags:[new qo({bagId:"1.2.840.113549.1.12.10.1.2",bagValue:new Jd({parsedValue:r}),bagAttributes:[new tt({type:"1.2.840.113549.1.9.20",values:[new Xt({value:"PKCS8ShroudedKeyBag from PKIjs"})]}),new tt({type:"1.2.840.113549.1.9.21",values:[new de({valueHex:i})]}),new tt({type:"1.3.6.1.4.1.311.17.1",values:[new Xt({value:"MCP using https://pkijs.org/"})]})]})]})},{privacyMode:1,value:new ar({safeBags:[new qo({bagId:"1.2.840.113549.1.12.10.1.3",bagValue:new Qu({parsedValue:e[0]}),bagAttributes:[new tt({type:"1.2.840.113549.1.9.20",values:[new Xt({value:L})]}),new tt({type:"1.2.840.113549.1.9.21",values:[new de({valueHex:o})]}),new tt({type:"1.3.6.1.4.1.311.17.1",values:[new Xt({value:"MCP using https://pkijs.org/"})]})]}),new qo({bagId:"1.2.840.113549.1.12.10.1.3",bagValue:new Qu({parsedValue:e[1]}),bagAttributes:[new tt({type:"1.2.840.113549.1.9.20",values:[new Xt({value:re})]}),new tt({type:"1.2.840.113549.1.9.21",values:[new de({valueHex:h})]}),new tt({type:"1.3.6.1.4.1.311.17.1",values:[new Xt({value:"MCP using https://pkijs.org/"})]})]})]})}]}})}}),we=_e(t);return yield Ae.parsedValue.authenticatedSafe.parsedValue.safeContents[0].value.safeBags[0].bagValue.makeInternalValues({password:we,contentEncryptionAlgorithm:{name:"AES-CBC",length:128},hmacHashAlgorithm:"SHA-1",iterationCount:1e5}),yield Ae.parsedValue.authenticatedSafe.makeInternalValues({safeContents:[{},{password:we,contentEncryptionAlgorithm:{name:"AES-CBC",length:128},hmacHashAlgorithm:"SHA-1",iterationCount:1e5}]}),yield Ae.makeInternalValues({password:we,iterations:1e5,pbkdf2HashAlgorithm:"SHA-256",hmacHashAlgorithm:"SHA-256"}),Ae.toSchema().toBER(!1)});return function(e,t,i){return s.apply(this,arguments)}}();var Or=j(5004),os=j(7277);const sm=s=>{switch(s){case os.q.RevocationReasonEnum.Aacompromise:return{value:s,title:"AA compromised",description:"This reason indicates that it is known or suspected that the certificate subject's private key has been compromised. It applies to authority attribute (AA) certificates only.",reference:"https://docs.oracle.com/javase/8/docs/api/java/security/cert/CRLReason.html"};case os.q.RevocationReasonEnum.Affiliationchanged:return{value:s,title:"Affiliation changed",description:"The user has terminated his or her relationship with the organization indicated in the Distinguished Name attribute of the certificate. This revocation code is typically used when an individual is terminated or has resigned from an organization. You do not have to revoke a certificate when a user changes departments, unless your security policy requires different certificate be issued by a departmental CA.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Cacompromise:return{value:s,title:"CA compromised",description:"The token or disk location where the CA's private key is stored has been compromised and is in the possession of an unauthorized individual. When a CA's private key is revoked, this results in all certificates issued by the CA that are signed using the private key associated with the revoked certificate being considered revoked.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Certificatehold:return{value:s,title:"Certificate Hold",description:"A temporary revocation that indicates that a CA will not vouch for a certificate at a specific point in time. Once a certificate is revoked with a CertificateHold reason code, the certificate can then be revoked with another Reason Code, or unrevoked and returned to use.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Cessationofoperation:return{value:s,title:"Cessation of Operation",description:"If a CA is decommissioned, no longer to be used, the CA's certificate should be revoked with this reason code. Do not revoke the CA's certificate if the CA no longer issues new certificates, yet still publishes CRLs for the currently issued certificates.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Keycompromise:return{value:s,title:"Key compromised",description:"The token or disk location where the private key associated with the certificate has been compromised and is in the possession of an unauthorized individual. This can include the case where a laptop is stolen, or a smart card is lost.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Privilegewithdrawn:return{value:s,title:"Privilege withdrawn",description:"A certificate (public-key or attribute certificate) was revoked because a privilege contained within that certificate has been withdrawn",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Removefromcrl:return{value:s,title:"Remove from CRL",description:'If a certificate is revoked with the CertificateHold reason code, it is possible to "unrevoke" a certificate. The unrevoking process still lists the certificate in the CRL, but with the reason code set to RemoveFromCRL.',reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Superseded:return{value:s,title:"Superseded",description:"A replacement certificate has been issued to a user, and the reason does not fall under the previous reasons. This revocation reason is typically used when a smart card fails, the password for a token is forgotten by a user, or the user has changed their legal name.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};default:return{value:s,title:"Unspecified",description:"It is possible to revoke a certificate without providing a specific reason code. While it is possible to revoke a certificate with the Unspecified reason code, this is not recommended, as it does not provide an audit trail as to why a certificate is revoked.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"}}};var fw=j(1224),im=j(698),dw=j(3830),mw=j(8168);let gw=(()=>{class s{constructor(e,t,i,a,o,u){this.organizationsService=e,this.devicesService=t,this.servicesService=i,this.usersService=a,this.vesselsService=o,this.mmsService=u}ngOnInit(){}formatCerts(e){let t=[];for(const i in e){const a=e[i];for(const o in a)e[i][o]=a[o];a.revoked&&(a.revokeInfo=a.revokedAt,a.revokeReasonText=sm(a.revokeReason).title),t.push(a)}return t}splitByRevokeStatus(e){let t=[],i=[];for(const a in e){const o=e[a];o.revoked?i.push(o):t.push(o)}return t.sort((a,o)=>a.end-o.end),i.sort((a,o)=>a.end-o.end),{activeCertificates:this.formatCerts(t),revokedCertificates:this.formatCerts(i)}}issueNewCertificate(e,t,i,a){if(null==t||!i)throw new Error("Internal state lost");switch(t){case c.SP.Organization:return this.organizationsService.newOrgCertFromCsr(e,i);case c.SP.Device:return this.devicesService.newDeviceCertFromCsr(e,a,i);case c.SP.Service:return this.servicesService.newServiceCertFromCsr1(e,a,i);case c.SP.User:return this.usersService.newUserCertFromCsr(e,a,i);case c.SP.Vessel:return this.vesselsService.newVesselCertFromCsr(e,a,i);case c.SP.MMS:return this.mmsService.newMMSCertFromCsr(e,a,i);default:throw new Error("Unknown item type")}}revokeCertificate(e,t,i,a,o,u){if(null==e||!t)throw new Error("Internal state lost");switch(e){case c.SP.Organization:return this.organizationsService.revokeOrgCert(o,t,a);case c.SP.Device:return this.devicesService.revokeDeviceCert(o,i,t,a);case c.SP.Service:return u?this.servicesService.revokeServiceCert(o,i,t,u,a):this.servicesService.revokeServiceCert1(o,i,t,a);case c.SP.User:return this.usersService.revokeUserCert(o,i,t,a);case c.SP.Vessel:return this.vesselsService.revokeVesselCert(o,i,t,a);case c.SP.MMS:return this.mmsService.revokeMMSCert(o,i,t,a);default:throw new Error("Unknown item type")}}static#e=this.\u0275fac=function(t){return new(t||s)(n.KVO(Or.PZ),n.KVO(Or.SV),n.KVO(Or.dd),n.KVO(Or.Tz),n.KVO(Or.YY),n.KVO(Or.tZ))};static#t=this.\u0275prov=n.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var rm=j(9380),pw=j(5189),qh=j(5540),vw=j(8721);let ww=(()=>{class s{constructor(e){this.translate=e}downloadPemCertificate(e,t,i){try{const a=t.split(" ").join("_"),o=new vw;o.file("Certificate_"+a+".pem",e.certificate),e.privateKey&&o.file("PrivateKey_"+a+".pem",e.privateKey),e.publicKey&&o.file("PublicKey_"+a+".pem",e.publicKey),e.pkcs12Keystore&&o.file("Keystore_"+a+".p12",e.pkcs12Keystore),e.keystorePassword&&o.file("KeystorePassword_"+a+".txt",e.keystorePassword),o.generateAsync({type:"blob"}).then(function(u){qh.saveAs(u,"Certificate_"+a+".zip")})}catch(a){i.notify("error",this.translate.instant("error.file.downloadcert")+a)}}downloadXml(e,t){e?this.downloadFile(e.content,e.contentContentType,e.name,t):t.notify("error",this.translate.instant("error.file.empty"))}downloadDoc(e,t){if(!e)return void t.notify("error",this.translate.instant("error.file.empty"));if(e.filecontent.length>1&&e.filecontent.length<10)return void t.notify("error",this.translate.instant("error.file.wrongformat")+e.name);let i=e.filecontent.toString();this.downloadBase64File(i,e.filecontentContentType,e.name,t)}downloadBase64File(e,t,i,a){try{let o=this.convertBase64ToByteArray(e),u=new Blob([o],{type:t});qh.saveAs(u,i)}catch(o){a.notify("error",this.translate.instant("error.file.downloaderror")+o)}}downloadFile(e,t,i,a){try{let o=new Blob([e],{type:t});qh.saveAs(o,i)}catch(o){a.notify("error",this.translate.instant("error.file.downloaderror")+o)}}convertBase64ToByteArray(e){let t=window.atob(e),i=new Array(t.length);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return new Uint8Array(i)}static#e=this.\u0275fac=function(t){return new(t||s)(n.KVO(rm.c$))};static#t=this.\u0275prov=n.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var yw=j(6482);const Sw=["certModal"],bw=["revokeModal"],Aw=["migrateModal"];function Ew(s,r){1&s&&n.EFF(0," Organization details ")}function kw(s,r){if(1&s&&n.EFF(0),2&s){const e=n.XpG();n.SpI(" ",e.capitalize(e.itemType)," details ")}}function _w(s,r){if(1&s&&n.nrm(0,"input",40),2&s){const e=n.XpG(2).$implicit,t=n.XpG();n.xc7("width",400,"px"),n.Y8G("value",t.convertTimeString(t.item[e.key]))}}function Cw(s,r){if(1&s&&n.nrm(0,"input",40),2&s){const e=n.XpG(2).$implicit,t=n.XpG();n.xc7("width",400,"px"),n.Y8G("value",t.item[e.key])}}function Nw(s,r){if(1&s&&n.DNE(0,_w,1,3,"input",39)(1,Cw,1,3,"input",39),2&s){const e=n.XpG().$implicit,t=n.XpG();n.vxM(t.isTimestampFormat(e.key)?0:1)}}function Iw(s,r){1&s&&n.nrm(0,"input",40),2&s&&n.xc7("width",400,"px")}function Bw(s,r){if(1&s&&(n.j41(0,"div",36)(1,"label",37),n.EFF(2),n.k0s(),n.j41(3,"div",38)(4,"div",32),n.DNE(5,Nw,2,1)(6,Iw,1,2,"input",39),n.k0s()()()),2&s){const e=r.$implicit,t=n.XpG();n.R7$(2),n.JRh(e.value.title),n.R7$(3),n.vxM(t.item[e.key]?5:6)}}function Rw(s,r){if(1&s){const e=n.RV6();n.j41(0,"div",36)(1,"label",37),n.EFF(2,"Active certificates"),n.k0s(),n.j41(3,"div",5)(4,"app-cert-table",41),n.bIt("onAdd",function(){n.eBV(e);const i=n.XpG();return n.Njj(i.openCertModal())})("onDownload",function(i){n.eBV(e);const a=n.XpG();return n.Njj(a.clickDownloadBtn(i))})("onRevoke",function(i){n.eBV(e);const a=n.XpG();return n.Njj(a.clickRevokeBtn(i))}),n.k0s()()(),n.j41(5,"div",36)(6,"label",37),n.EFF(7,"Revoked certificates"),n.k0s(),n.j41(8,"div",5),n.nrm(9,"app-cert-table",42),n.k0s()()}if(2&s){const e=n.XpG();n.R7$(4),n.Y8G("data",e.activeCertificates),n.R7$(5),n.Y8G("data",e.revokedCertificates)}}function Tw(s,r){if(1&s&&n.nrm(0,"app-item-form",12,3),2&s){const e=n.XpG();n.Y8G("isForNew",!0)("itemType",e.userItemType)("item",e.adminUser)("mrnPrefix",e.adminUserMrnPrefix)}}function xw(s,r){if(1&s){const e=n.RV6();n.j41(0,"button",43),n.bIt("click",function(){n.eBV(e);const i=n.XpG();return n.Njj(i.clickMigrateBtn())}),n.EFF(1,"Migrate"),n.k0s()}}function Vw(s,r){if(1&s){const e=n.RV6();n.j41(0,"button",44),n.bIt("click",function(){n.eBV(e);const i=n.XpG();return n.Njj(i.approve())}),n.EFF(1,"Approve"),n.k0s()}}function Ow(s,r){if(1&s){const e=n.RV6();n.j41(0,"button",43),n.bIt("click",function(){n.eBV(e);const i=n.XpG();return n.Njj(i.edit())}),n.EFF(1,"Edit"),n.k0s()}}function Pw(s,r){1&s&&(n.j41(0,"div",21)(1,"p"),n.EFF(2,"Here is your certificate bundle. You can download it by clicking the button below."),n.k0s()())}function Dw(s,r){if(1&s&&(n.j41(0,"h3",18),n.EFF(1),n.k0s()),2&s){const e=n.XpG();n.R7$(),n.SpI("Revoke ",e.selectedActiveCerts.length," certificates")}}function Uw(s,r){if(1&s&&(n.j41(0,"h3",18),n.EFF(1),n.k0s()),2&s){const e=n.XpG();n.R7$(),n.SpI("Revoke ",e.selectedActiveCerts.length," certificate")}}function Mw(s,r){if(1&s){const e=n.RV6();n.j41(0,"clr-radio-wrapper")(1,"input",45),n.bIt("click",function(){const i=n.eBV(e).$implicit,a=n.XpG();return n.Njj(a.revokeReason=i)}),n.k0s(),n.j41(2,"label"),n.EFF(3),n.k0s()()}if(2&s){const e=r.$implicit;n.R7$(3),n.JRh(e.title)}}function Lw(s,r){if(1&s&&(n.j41(0,"div")(1,"span"),n.EFF(2),n.k0s()(),n.j41(3,"div")(4,"a",46),n.EFF(5,"More info"),n.k0s()()),2&s){const e=n.XpG();n.R7$(2),n.JRh(e.revokeReason.description),n.R7$(2),n.Y8G("href",e.revokeReason.reference,n.B4B)}}function Fw(s,r){1&s&&(n.j41(0,"div")(1,"span"),n.EFF(2,"Select reason name"),n.k0s()())}let Hw=(()=>{class s{constructor(e,t,i,a,o,u){this.certificateService=e,this.translate=t,this.notifier=i,this.fileHelper=a,this.locale=u,this.itemType=c.SP.None,this.item={},this.orgMrn="",this.mrnPrefix="urn:mrn:",this.instanceVersion=void 0,this.onEdit=new n.bkB,this.onMigrate=new n.bkB,this.onDelete=new n.bkB,this.onRefresh=new n.bkB,this.onApprove=new n.bkB,this.onDownloadCert=new n.bkB,this.viewContext="detail",this.columnForMenu={},this.itemId="",this.activeCertificates=[],this.revokedCertificates=[],this.revokeModalOpened=!1,this.certModalOpened=!1,this.fromBrowser=!0,this.revokeReason=void 0,this.revokeReasons=[],this.selectedActiveCerts=[],this.revokeAt=void 0,this.reasonTitle="",this.certificateBundle=void 0,this.migrateModalOpened=!1,this.newServiceMrn="",this.userItemType=c.SP.User,this.adminUser={permissions:mw.s},this.adminUserMrnPrefix="urn:mrn:mcp:",this.setForm=()=>{Object.entries(B.Y[this.itemType.toString()]).map(([h,m])=>{m.visibleFrom&&(m.visibleFrom&&!m.visibleFrom.includes(this.viewContext)||(this.columnForMenu[h]=m))})},this.assignCertificatesByStatus=h=>{this.activeCertificates=[],this.revokedCertificates=[],h.sort((m,N)=>m.start<N.start?1:-1),h.map(m=>{m.revoked?this.revokedCertificates.push(m):this.activeCertificates.push(m)}),this.revokedCertificates=this.updateRevokeReason(this.revokedCertificates)},this.updateRevokeReason=h=>h.map(m=>({...m,revokeReason:this.revokeReasons.filter(N=>N.value===m.revokeReason)[0].title})),this.sortColumnForMenu=(h,m)=>((s,r)=>s.order>r.order?-1:1)(h,m),this.edit=()=>{this.onEdit.emit(this.item)},this.migrate=()=>{this.onMigrate.emit(this.newServiceMrn)},this.approve=()=>{this.newAdminUserForm?.isValid()&&(this.adminUser=this.newAdminUserForm?.getFormValue(),this.onApprove.emit({...this.item,adminUser:this.adminUser}))},this.deleteItem=()=>{this.onDelete.emit(this.item)},this.convertTimeString=h=>(0,p.t)(h),this.openCertModal=()=>{this.itemType===c.SP.Service&&this.instanceVersion?this.notifier.notify("error",this.translate.instant("error.form.requiremigrate")):(this.certModal?.open(),this.certModalOpened=!0,this.issue())},this.issue=()=>{lw(this.certificateService,this.itemType,this.itemId,this.orgMrn,this.fromBrowser,this.instanceVersion).then(h=>{this.certificateBundle=h,this.notifier.notify("success",this.translate.instant("success.resource.create"))})},this.revokeCerts=h=>{this.revokeAt=new Date(Date.parse(this.revokeAt.toLocaleString()));const m={revokedAt:this.revokeAt,revocationReason:this.revokeReason?.value};h.forEach(N=>{this.certificateService.revokeCertificate(this.itemType,this.item.mrn,this.orgMrn,N.serialNumber,m,this.instanceVersion).subscribe(T=>{this.notifier.notify("success",this.translate.instant("success.certificate.revoke")),this.cancel()},T=>{this.notifier.notify("error",this.translate.instant("error.certificate.revoke"))})})},this.clickDownloadBtn=h=>{0!==h.length?h.forEach(m=>{const N=(0,g.Yq)(m.end,"yyyy-MM-ddTHH-mm-ss",this.locale);this.fileHelper.downloadPemCertificate({certificate:m.certificate},this.item.mrn+"_exp_"+N,this.notifier)}):this.notifier.notify("warning",this.translate.instant("error.selection.noSelection"))},this.clickRevokeBtn=h=>{this.itemType===c.SP.Service&&this.instanceVersion?this.notifier.notify("error",this.translate.instant("error.form.requiremigrate")):0!==h.length?(this.revokeModalOpened=!0,this.selectedActiveCerts=h):this.notifier.notify("warning",this.translate.instant("error.selection.noSelection"))},this.clickMigrateBtn=()=>{this.migrateModal?.open(),this.migrateModalOpened=!0,this.newServiceMrn=this.item.mrn+":"+this.instanceVersion},this.cancel=()=>{this.certModal?.close(),this.certModalOpened=!1,this.revokeModal?.close(),this.revokeModalOpened=!1,this.migrateModal?.close(),this.migrateModalOpened=!1,this.onRefresh.emit(),this.newServiceMrn="",this.certificateBundle=void 0},this.refreshData=()=>{this.onRefresh.emit()},this.issueFromBrowser=()=>{this.fromBrowser=!0},this.issueManualKeystore=()=>{this.fromBrowser=!1},this.capitalize=h=>h[0].toUpperCase()+h.slice(1);for(const h in Or.qQ.RevocationReasonEnum)this.revokeReasons.push(sm(h.toLocaleLowerCase()));this.revokeReasons.sort((h,m)=>h.value.localeCompare(m.value)),o.getOrgMrn().then(h=>{this.orgMrn=h})}ngOnChanges(e){!e.item||!e.item.currentValue||(this.item=e.item.currentValue&&e.item.currentValue,this.item&&this.itemType===c.SP.Role?(this.itemId=this.item.id,this.setForm()):this.item&&this.item.mrn&&(this.itemId=this.item.mrn,this.item.instanceVersion&&(this.instanceVersion=this.item.instanceVersion),this.itemType===c.SP.Vessel&&(this.item=(0,fw.BY)(this.item)),this.setForm(),this.item.certificates&&this.assignCertificatesByStatus(this.item.certificates)),this.itemType===c.SP.OrgCandidate&&(this.adminUserMrnPrefix=(0,dw.B)(this.item.mrn)))}isTimestampFormat(e){return c.N3.includes(e)}download(){this.certificateBundle&&(this.fileHelper.downloadPemCertificate(this.certificateBundle,this.itemId,this.notifier),this.notifier.notify("success",this.translate.instant("success.certificate.chosen")))}static#e=this.\u0275fac=function(t){return new(t||s)(n.rXU(gw),n.rXU(rm.c$),n.rXU(pw.iJ),n.rXU(ww),n.rXU(yw.u),n.rXU(n.xe9))};static#t=this.\u0275cmp=n.VBU({type:s,selectors:[["app-item-view"]],viewQuery:function(t,i){if(1&t&&(n.GBs(Sw,7),n.GBs(bw,7),n.GBs(Aw,7),n.GBs(im.j,5)),2&t){let a;n.mGM(a=n.lsd())&&(i.certModal=a.first),n.mGM(a=n.lsd())&&(i.revokeModal=a.first),n.mGM(a=n.lsd())&&(i.migrateModal=a.first),n.mGM(a=n.lsd())&&(i.newAdminUserForm=a.first)}},inputs:{itemType:"itemType",item:"item",orgMrn:"orgMrn",mrnPrefix:"mrnPrefix",instanceVersion:"instanceVersion"},outputs:{onEdit:"onEdit",onMigrate:"onMigrate",onDelete:"onDelete",onRefresh:"onRefresh",onApprove:"onApprove",onDownloadCert:"onDownloadCert"},standalone:!0,features:[n.OA$,n.aNF],decls:102,vars:18,consts:[["certModal",""],["revokeModal",""],["migrateModal",""],["newAdminUserForm",""],[1,"clr-row"],[1,"clr-col-lg-12","clr-col-md-8","clr-col-12"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"card-text"],["clrForm",""],["class","clr-form-horizontal clr-form-control clr-row",4,"ngFor","ngForOf"],["title","New administrator user",3,"isForNew","itemType","item","mrnPrefix"],[1,"card-footer"],[1,"btn","btn-primary"],[1,"btn","btn-success"],[1,"btn","btn-danger",3,"click"],["clrModalSize","lg",1,"modal",3,"clrModalOpenChange","clrModalOpen"],[1,"modal-title"],["aria-label","Close","type","button",1,"close",3,"click"],[1,"modal-body"],[1,"clr-col-sm-12","clr-col-md-12"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-outline",3,"click"],[1,"clr-col-4"],[1,"clr-col-8"],["type","date","autocomplete","off","clrDate","","name","demo",3,"ngModelChange","ngModel"],[1,"clr-form"],[1,"clr-form-control"],["for","basic",1,"clr-control-label"],[1,"clr-control-container"],[1,"clr-input-wrapper"],["type","text","id","basic","placeholder","Enter value here",1,"clr-input",3,"value"],["shape","exclamation-circle",1,"clr-validate-icon"],[1,"clr-subtext"],[1,"clr-form-horizontal","clr-form-control","clr-row"],[1,"clr-control-label"],["ng-reflect-ng-class","clr-col-md-10 clr-col-12",1,"clr-control-container","clr-col-md-10","clr-col-12"],["clrinput","","type","string","ng-reflect-name","mrn","ng-reflect-required","true","id","clr-form-control-1","required","","aria-describedby","clr-form-control-1-helper",1,"clr-input","ng-untouched","ng-pristine","ng-invalid","ng-star-inserted",3,"value","width"],["clrinput","","type","string","ng-reflect-name","mrn","ng-reflect-required","true","id","clr-form-control-1","required","","aria-describedby","clr-form-control-1-helper",1,"clr-input","ng-untouched","ng-pristine","ng-invalid","ng-star-inserted",3,"value"],["context","active",3,"onAdd","onDownload","onRevoke","data"],["context","revoked",3,"data"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-success",3,"click"],["type","radio","clrRadio","","name","options","required","",3,"click"],["target","_blank",3,"href"]],template:function(t,i){if(1&t){const a=n.RV6();n.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7),n.DNE(4,Ew,1,0)(5,kw,1,1),n.k0s(),n.j41(6,"div",8)(7,"div",9)(8,"form",10),n.DNE(9,Bw,7,2,"div",11),n.nI1(10,"keyvalue"),n.DNE(11,Rw,10,2),n.k0s(),n.DNE(12,Tw,2,4,"app-item-form",12),n.k0s()(),n.j41(13,"div",13),n.DNE(14,xw,2,0,"button",14)(15,Vw,2,0,"button",15)(16,Ow,2,0,"button",14),n.j41(17,"button",16),n.bIt("click",function(){return n.eBV(a),n.Njj(i.deleteItem())}),n.EFF(18,"Delete"),n.k0s()()()()(),n.j41(19,"clr-modal",17,0),n.mxI("clrModalOpenChange",function(u){return n.eBV(a),n.DH7(i.certModalOpened,u)||(i.certModalOpened=u),n.Njj(u)}),n.j41(21,"div",18)(22,"button",19),n.bIt("click",function(){return n.eBV(a),n.Njj(i.cancel())}),n.k0s(),n.j41(23,"h3",18),n.EFF(24,"Issue a new certificate"),n.k0s()(),n.j41(25,"div",20),n.DNE(26,Pw,3,0,"div",21),n.k0s(),n.j41(27,"div",22)(28,"button",23),n.bIt("click",function(){return n.eBV(a),n.Njj(i.download())}),n.EFF(29,"Download certificate"),n.k0s(),n.j41(30,"button",24),n.bIt("click",function(){return n.eBV(a),n.Njj(i.cancel())}),n.EFF(31,"Close"),n.k0s()()(),n.j41(32,"clr-modal",17,1),n.mxI("clrModalOpenChange",function(u){return n.eBV(a),n.DH7(i.revokeModalOpened,u)||(i.revokeModalOpened=u),n.Njj(u)}),n.j41(34,"div",18)(35,"button",19),n.bIt("click",function(){return n.eBV(a),n.Njj(i.cancel())}),n.k0s(),n.DNE(36,Dw,2,1,"h3",18)(37,Uw,2,1,"h3",18),n.k0s(),n.j41(38,"div",20)(39,"div",21)(40,"div",4)(41,"span")(42,"b"),n.EFF(43,"Warning: chosen certificates will no longer be valid when they are revoked!"),n.k0s()()(),n.j41(44,"div",4)(45,"div",25)(46,"div")(47,"h5"),n.EFF(48,"Reason name"),n.k0s()(),n.j41(49,"div"),n.Z7z(50,Mw,4,1,"clr-radio-wrapper",null,n.fX1),n.k0s()(),n.j41(52,"div",26)(53,"div")(54,"h5"),n.EFF(55,"Explanation"),n.k0s()(),n.j41(56,"div"),n.DNE(57,Lw,6,2)(58,Fw,3,0,"div"),n.k0s()()(),n.j41(59,"div",4)(60,"div",25)(61,"div")(62,"h5"),n.EFF(63,"Revoke at"),n.k0s()()(),n.j41(64,"div",26)(65,"clr-date-container")(66,"input",27),n.mxI("ngModelChange",function(u){return n.eBV(a),n.DH7(i.revokeAt,u)||(i.revokeAt=u),n.Njj(u)}),n.k0s()()()(),n.j41(67,"div",4)(68,"div")(69,"p"),n.EFF(70,"Choose revocation reason and date to proceed."),n.k0s()()()()(),n.j41(71,"div",22)(72,"button",23),n.bIt("click",function(){return n.eBV(a),n.Njj(i.revokeCerts(i.selectedActiveCerts))}),n.EFF(73,"Revoke"),n.k0s(),n.j41(74,"button",24),n.bIt("click",function(){return n.eBV(a),n.Njj(i.cancel())}),n.EFF(75,"Cancel"),n.k0s()()(),n.j41(76,"clr-modal",17,2),n.mxI("clrModalOpenChange",function(u){return n.eBV(a),n.DH7(i.migrateModalOpened,u)||(i.migrateModalOpened=u),n.Njj(u)}),n.j41(78,"div",18)(79,"button",19),n.bIt("click",function(){return n.eBV(a),n.Njj(i.cancel())}),n.k0s(),n.EFF(80," Migrate service "),n.k0s(),n.j41(81,"div",20)(82,"div",21)(83,"div",4)(84,"span"),n.EFF(85,"This migration allows you to remove the version from an existing service's MRN by assigning a new MRN that includes the version. It simplifies version management and future updates, making it easier for users to maintain and update services. The MRN below is given as an example, but you can edit it as you want."),n.k0s()(),n.j41(86,"div",4)(87,"form",28)(88,"div",29)(89,"label",30),n.EFF(90,"Recommended new MRN for your service"),n.k0s(),n.j41(91,"div",31)(92,"div",32),n.nrm(93,"input",33)(94,"cds-icon",34),n.k0s(),n.j41(95,"span",35),n.EFF(96,"New MRN can have the version of service inside."),n.k0s()()()()()()(),n.j41(97,"div",22)(98,"button",23),n.bIt("click",function(){return n.eBV(a),n.Njj(i.migrate())}),n.EFF(99,"Migrate"),n.k0s(),n.j41(100,"button",24),n.bIt("click",function(){return n.eBV(a),n.Njj(i.cancel())}),n.EFF(101,"Cancel"),n.k0s()()()}2&t&&(n.R7$(4),n.vxM("orgcandidate"===i.itemType?4:5),n.R7$(5),n.Y8G("ngForOf",n.i5U(10,15,i.columnForMenu,i.sortColumnForMenu)),n.R7$(2),n.vxM("role"!==i.itemType&&"orgcandidate"!==i.itemType?11:-1),n.R7$(),n.vxM("orgcandidate"===i.itemType?12:-1),n.R7$(2),n.vxM("service"===i.itemType&&i.instanceVersion?14:"orgcandidate"===i.itemType?15:16),n.R7$(5),n.R50("clrModalOpen",i.certModalOpened),n.R7$(7),n.vxM(i.certificateBundle?26:-1),n.R7$(6),n.R50("clrModalOpen",i.revokeModalOpened),n.R7$(4),n.vxM(i.selectedActiveCerts.length>1?36:37),n.R7$(14),n.Dyx(i.revokeReasons),n.R7$(7),n.vxM(i.revokeReason?57:58),n.R7$(9),n.R50("ngModel",i.revokeAt),n.R7$(10),n.R50("clrModalOpen",i.migrateModalOpened),n.R7$(17),n.xc7("width",400,"px"),n.Y8G("value",i.newServiceMrn))},dependencies:[S.G,g.Sq,g.lG,_.z7t,_.bZN,_.zN1,_.BlU,_.jsN,_.aZZ,_.mDd,_.fkp,_.cIb,_.CxT,_.lnv,_._Qf,_.WF1,im.j,w,y.YN,y.qT,y.me,y.BC,y.cb,y.vS,y.cV]})}return s})()},3426:(Nt,M,j)=>{"use strict";j.d(M,{d:()=>R});var n=j(6994),c=j(5950),b=j(3585),p=j(5166),C=j(3685),V=j(1066),U=j(8745),P=j(6482),F=j(5004);function w($,d){if(1&$){const D=c.RV6();c.j41(0,"div")(1,"button",1),c.bIt("click",function(){c.eBV(D);const W=c.XpG();return c.Njj(W.back())}),c.EFF(2,"Back"),c.k0s()(),c.j41(3,"div",2)(4,"div",3)(5,"app-item-view",4),c.bIt("onEdit",function(){c.eBV(D);const W=c.XpG();return c.Njj(W.edit(W.selectedItem))})("onDelete",function(){c.eBV(D);const W=c.XpG();return c.Njj(W.deleteItem(W.selectedItem))})("onRefresh",function(){c.eBV(D);const W=c.XpG();return c.Njj(W.refreshData())})("onMigrate",function(W){c.eBV(D);const Ie=c.XpG();return c.Njj(Ie.migrate(W))})("onApprove",function(W){c.eBV(D);const Ie=c.XpG();return c.Njj(Ie.approve(W))}),c.k0s()()()}if(2&$){const D=c.XpG();c.R7$(5),c.Y8G("itemType",D.itemType)("item",D.selectedItem)}}function B($,d){if(1&$){const D=c.RV6();c.j41(0,"div",9)(1,"button",10),c.bIt("click",function(){c.eBV(D);const W=c.XpG(3);return c.Njj(W.onAdd())}),c.nrm(2,"cds-icon",11),c.EFF(3),c.k0s()()}if(2&$){const D=c.XpG(3);c.R7$(3),c.SpI(" ",D.addText," ")}}function y($,d){if(1&$){const D=c.RV6();c.j41(0,"div",9)(1,"button",10),c.bIt("click",function(){c.eBV(D);const W=c.XpG(3);return c.Njj(W.onDelete(W.selected))}),c.nrm(2,"cds-icon",12),c.EFF(3),c.k0s(),c.j41(4,"button",10),c.bIt("click",function(){c.eBV(D);const W=c.XpG(3);return c.Njj(W.onDownload(W.selected))}),c.nrm(5,"cds-icon",13),c.EFF(6),c.k0s()()}if(2&$){const D=c.XpG(3);c.R7$(3),c.SpI(" ",D.deleteText,""),c.R7$(3),c.SpI(" ",D.downloadText,"")}}function E($,d){if(1&$){const D=c.RV6();c.j41(0,"div",9)(1,"button",10),c.bIt("click",function(){c.eBV(D);const W=c.XpG(3);return c.Njj(W.onDelete(W.selected))}),c.nrm(2,"cds-icon",12),c.EFF(3),c.k0s()()}if(2&$){const D=c.XpG(3);c.R7$(3),c.SpI(" ",D.deleteText,"")}}function g($,d){if(1&$&&(c.j41(0,"clr-dg-action-bar"),c.DNE(1,B,4,1,"div",9)(2,y,7,2,"div",9)(3,E,4,1,"div",9),c.k0s()),2&$){const D=c.XpG(2);c.R7$(),c.vxM(void 0!==D.onAdd?1:-1),c.R7$(),c.vxM(void 0!==D.onDelete&&void 0!==D.onDownload?2:void 0!==D.onDelete?3:-1)}}function S($,d){if(1&$&&(c.j41(0,"clr-dg-column"),c.EFF(1),c.k0s()),2&$){const D=d.$implicit;c.R7$(),c.JRh(D)}}function _($,d){if(1&$){const D=c.RV6();c.j41(0,"clr-dg-cell",15),c.bIt("click",function(){c.eBV(D);const W=c.XpG(2).$implicit,Ie=c.XpG(2);return c.Njj(Ie.userRowSelect(W))}),c.EFF(1),c.k0s()}if(2&$){const D=c.XpG().$implicit,ne=c.XpG().$implicit,W=c.XpG(2);c.R7$(),c.JRh(W.convertTimeString(ne[D]))}}function k($,d){if(1&$){const D=c.RV6();c.j41(0,"clr-dg-cell",15),c.bIt("click",function(){c.eBV(D);const W=c.XpG(2).$implicit,Ie=c.XpG(2);return c.Njj(Ie.userRowSelect(W))}),c.EFF(1),c.k0s()}if(2&$){const D=c.XpG().$implicit,ne=c.XpG().$implicit;c.R7$(),c.JRh(ne[D])}}function A($,d){if(1&$&&c.DNE(0,_,2,1,"clr-dg-cell")(1,k,2,1,"clr-dg-cell"),2&$){const D=d.$implicit,ne=c.XpG(3);c.vxM(ne.isTimestampFormat(D)?0:1)}}function te($,d){if(1&$&&(c.j41(0,"clr-dg-row",14),c.Z7z(1,A,2,1,null,null,c.fX1),c.k0s()),2&$){const D=d.$implicit,ne=c.XpG(2);c.Y8G("clrDgItem",D),c.R7$(),c.Dyx(ne.labelKeys)}}function l($,d){if(1&$&&(c.j41(0,"clr-dg-detail")(1,"clr-dg-detail-header"),c.EFF(2),c.k0s(),c.j41(3,"clr-dg-detail-body"),c.nrm(4,"app-item-view",17),c.k0s()()),2&$){const D=d.$implicit,ne=c.XpG(3);c.R7$(2),c.JRh(D.mrn),c.R7$(2),c.Y8G("itemType",ne.itemType)("item",D)}}function ve($,d){1&$&&c.DNE(0,l,5,3,"clr-dg-detail",16)}function ie($,d){if(1&$){const D=c.RV6();c.j41(0,"button",20),c.bIt("click",function(){const W=c.eBV(D).$implicit,Ie=c.XpG(3);return c.Njj(Ie.loadData(W))}),c.EFF(1),c.k0s()}if(2&$){const D=d.$implicit,ne=c.XpG(3);c.Y8G("disabled",D==ne.currentPageNumber),c.R7$(),c.JRh(D+1)}}function Se($,d){if(1&$&&(c.j41(0,"div",8)(1,"div",18),c.Z7z(2,ie,2,2,"button",19,c.fX1),c.k0s()()),2&$){const D=c.XpG(2);c.R7$(2),c.Dyx(D.pageNumbers)}}function Oe($,d){if(1&$){const D=c.RV6();c.j41(0,"clr-datagrid",5),c.mxI("clrDgSelectedChange",function(W){c.eBV(D);const Ie=c.XpG();return c.DH7(Ie.selected,W)||(Ie.selected=W),c.Njj(W)}),c.bIt("clrDgRefresh",function(W){c.eBV(D);const Ie=c.XpG();return c.Njj(Ie.refresh(W))}),c.DNE(1,g,4,2,"clr-dg-action-bar"),c.Z7z(2,S,2,1,"clr-dg-column",null,c.fX1),c.j41(4,"clr-dg-placeholder",6),c.EFF(5),c.k0s(),c.DNE(6,te,3,1,"clr-dg-row",7)(7,ve,1,0,"clr-dg-detail"),c.j41(8,"clr-dg-footer"),c.DNE(9,Se,4,0,"div",8),c.k0s()()}if(2&$){const D=c.XpG();c.R50("clrDgSelected",D.selected),c.Y8G("clrDgLoading",D.isLoading),c.R7$(),c.vxM(D.onAdd||D.onDelete||D.onDownload?1:-1),c.R7$(),c.Dyx(D.labelTitles),c.R7$(3),c.JRh(D.placeholder),c.R7$(),c.Y8G("clrDgItemsOf",D.data),c.R7$(),c.vxM(D.detailView?7:-1),c.R7$(2),c.vxM(D.totalPages>1?9:-1)}}let R=(()=>{class ${constructor(D,ne,W){this.router=D,this.authService=ne,this.roleService=W,this.itemType=p.SP.Device,this.labels=void 0,this.placeholder="We couldn't find any data!",this.deleteText="Delete",this.downloadText="Download",this.addText="Add",this.totalPages=0,this.totalElements=0,this.getData=Ie=>new Promise((Y,Te)=>Y([])),this.onRowSelect=new c.bkB,this.onRevokeCerts=new c.bkB,this.onDownloadCerts=new c.bkB,this.onEdit=new c.bkB,this.onMigrate=new c.bkB,this.onRefresh=new c.bkB,this.onApprove=new c.bkB,this.data=void 0,this.selected=[],this.detail={},this.selectedItem={},this.expanded=!1,this.detailView=!1,this.labelKeys=[],this.labelTitles=[],this.isLoading=!1,this.pageNumbers=[],this.currentPageNumber=0,this.elementsPerPage=10,this.roles=[],this.userRowSelect=Ie=>{this.expanded=!0,this.selectedItem=Ie,this.onRowSelect.emit(Ie)},this.back=()=>{this.expanded=!1,this.selectedItem={}},this.edit=Ie=>{this.expanded=!0,this.selectedItem=Ie,this.onEdit.emit(Ie)},this.approve=Ie=>{this.onApprove.emit(Ie)},this.migrate=Ie=>{this.onMigrate.emit({...this.selectedItem,newServiceMrn:Ie})},this.deleteItem=Ie=>{this.onDelete?.call(this,[Ie])},this.convertTimeString=Ie=>(0,V.t)(Ie),this.refreshData=()=>{this.loadData().then(()=>{if(this.selectedItem&&this.selectedItem.mrn){const Ie=this.data?.find(Y=>this.itemType===p.SP.Service?Y.mrn===this.selectedItem.mrn&&Y.instanceVersion===this.selectedItem.instanceVersion:this.itemType===p.SP.Role?Y.id===this.selectedItem.id:Y.mrn===this.selectedItem.mrn);Ie&&(this.selectedItem=Ie)}})},this.isLoading=!0}ngOnInit(){this.labels&&(this.labelKeys=Object.keys(this.labels),this.labelTitles=Object.values(this.labels).map(D=>D.title)),this.authService.getOrgMrn().then(D=>{this.roleService.getRoles(D).subscribe(ne=>{this.roles=ne})})}ngOnChanges(D){D.totalPages&&(this.pageNumbers=Array(this.totalPages).fill(0).map((ne,W)=>W))}loadData(D=this.currentPageNumber){var ne=this;return(0,n.A)(function*(){ne.data=(yield ne.getData(ne.itemType,D,ne.elementsPerPage))||[],D!==ne.currentPageNumber&&(ne.currentPageNumber=D),ne.isLoading=!1})()}refresh(D){var ne=this;return(0,n.A)(function*(){ne.data||ne.loadData()})()}isTimestampFormat(D){return p.N3.includes(D)}static#e=this.\u0275fac=function(ne){return new(ne||$)(c.rXU(U.Ix),c.rXU(P.u),c.rXU(F.Ky))};static#t=this.\u0275cmp=c.VBU({type:$,selectors:[["app-smart-expandable-table"]],inputs:{itemType:"itemType",labels:"labels",placeholder:"placeholder",onDownload:"onDownload",onDelete:"onDelete",onAdd:"onAdd",deleteText:"deleteText",downloadText:"downloadText",addText:"addText",totalPages:"totalPages",totalElements:"totalElements",getData:"getData"},outputs:{onRowSelect:"onRowSelect",onRevokeCerts:"onRevokeCerts",onDownloadCerts:"onDownloadCerts",onEdit:"onEdit",onMigrate:"onMigrate",onRefresh:"onRefresh",onApprove:"onApprove"},standalone:!0,features:[c.OA$,c.aNF],decls:2,vars:1,consts:[[3,"clrDgSelected","clrDgLoading"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"clr-row"],[1,"clr-col-lg-12","clr-col-md-8","clr-col-12"],[3,"onEdit","onDelete","onRefresh","onMigrate","onApprove","itemType","item"],[3,"clrDgSelectedChange","clrDgRefresh","clrDgSelected","clrDgLoading"],[1,"datagrid-empty"],[3,"clrDgItem",4,"clrDgItems","clrDgItemsOf"],[1,"clr-row","clr-justify-content-center"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],["shape","times"],["shape","download"],[3,"clrDgItem"],[3,"click"],[4,"clrIfDetail"],[3,"itemType","item"],[1,"btn-group","btn-outline-primary","btn-sm"],[1,"btn",3,"disabled"],[1,"btn",3,"click","disabled"]],template:function(ne,W){1&ne&&c.DNE(0,w,6,2)(1,Oe,10,7,"clr-datagrid",0),2&ne&&c.vxM(W.expanded?0:1)},dependencies:[b.PuD,b.ghA,b.fQA,b.slD,b.scM,b.f1O,b.PNO,b.ig6,b.Lwm,b.AtP,b.XTg,b.E1i,b.aFj,b.NTI,b.cIg,b.qDI,b.v0q,b.Aup,b.rpC,b.mCo,b.BlU,b.oFi,C.Y]})}return $})()},2537:(Nt,M,j)=>{"use strict";j.d(M,{B:()=>Oe});var n=j(5950),c=j(3585),b=j(1232),p=j(5930);const V=["download",(0,p.s)({outline:'<path d="M31,31H5a1,1,0,0,0,0,2H31a1,1,0,0,0,0-2Z"/><path d="M18,29.48,28.61,18.87a1,1,0,0,0-1.41-1.41L19,25.65V5a1,1,0,0,0-2,0V25.65L8.81,17.46a1,1,0,1,0-1.41,1.41Z"/>',outlineAlerted:'<path d="M31,31H5a1,1,0,0,0,0,2H31a1,1,0,0,0,0-2Z"/><path d="M18,29.48,28.61,18.87a1,1,0,0,0-1.41-1.41L19,25.65V5a1,1,0,0,0-2,0V25.65L8.81,17.46a1,1,0,1,0-1.41,1.41Z"/>',outlineBadged:'<path d="M31,31H5a1,1,0,0,0,0,2H31a1,1,0,0,0,0-2Z"/><path d="M18,29.48,28.61,18.87a1,1,0,0,0-1.41-1.41L19,25.65V5a1,1,0,0,0-2,0V25.65L8.81,17.46a1,1,0,1,0-1.41,1.41Z"/>'})];var U=j(673);const F=["plus",(0,p.s)({outline:'<path d="M30,17H19V6a1,1,0,1,0-2,0V17H6a1,1,0,0,0-1,1,.91.91,0,0,0,1,.94H17V30a1,1,0,1,0,2,0V19H30a1,1,0,0,0,1-1A1,1,0,0,0,30,17Z"/>'})];var w=j(5166),B=j(1066);const y=()=>[10,20,50,100];function E(R,$){1&R&&(n.j41(0,"clr-spinner"),n.EFF(1,"Loading"),n.k0s())}function g(R,$){if(1&R){const d=n.RV6();n.j41(0,"div",7)(1,"button",8),n.bIt("click",function(){n.eBV(d);const ne=n.XpG(3);return n.Njj(ne.onAdd())}),n.nrm(2,"cds-icon",9),n.EFF(3),n.k0s()()}if(2&R){const d=n.XpG(3);n.R7$(3),n.SpI(" ",d.addText," ")}}function S(R,$){if(1&R){const d=n.RV6();n.j41(0,"div",7)(1,"button",8),n.bIt("click",function(){n.eBV(d);const ne=n.XpG(3);return n.Njj(ne.onDelete(ne.selected))}),n.nrm(2,"cds-icon",10),n.EFF(3),n.k0s(),n.j41(4,"button",8),n.bIt("click",function(){n.eBV(d);const ne=n.XpG(3);return n.Njj(ne.onDownload(ne.selected))}),n.nrm(5,"cds-icon",11),n.EFF(6),n.k0s()()}if(2&R){const d=n.XpG(3);n.R7$(3),n.SpI(" ",d.deleteText,""),n.R7$(3),n.SpI(" ",d.downloadText,"")}}function _(R,$){if(1&R){const d=n.RV6();n.j41(0,"div",7)(1,"button",8),n.bIt("click",function(){n.eBV(d);const ne=n.XpG(3);return n.Njj(ne.onDelete(ne.selected))}),n.nrm(2,"cds-icon",10),n.EFF(3),n.k0s()()}if(2&R){const d=n.XpG(3);n.R7$(3),n.SpI(" ",d.deleteText,"")}}function k(R,$){if(1&R&&(n.j41(0,"clr-dg-action-bar"),n.DNE(1,g,4,1,"div",7)(2,S,7,2,"div",7)(3,_,4,1,"div",7),n.k0s()),2&R){const d=n.XpG(2);n.R7$(),n.vxM(void 0!==d.onAdd?1:-1),n.R7$(),n.vxM(void 0!==d.onDelete&&void 0!==d.onDownload?2:void 0!==d.onDelete?3:-1)}}function A(R,$){if(1&R&&(n.j41(0,"clr-dg-column"),n.EFF(1),n.k0s()),2&R){const d=$.$implicit;n.R7$(),n.JRh(d)}}function te(R,$){if(1&R){const d=n.RV6();n.j41(0,"clr-dg-cell",13),n.bIt("click",function(){n.eBV(d);const ne=n.XpG(2).$implicit,W=n.XpG(2);return n.Njj(W.userRowSelect(ne))}),n.EFF(1),n.k0s()}if(2&R){const d=n.XpG().$implicit,D=n.XpG().$implicit,ne=n.XpG(2);n.R7$(),n.JRh(ne.convertTimeString(D[d]))}}function l(R,$){if(1&R){const d=n.RV6();n.j41(0,"clr-dg-cell",13),n.bIt("click",function(){n.eBV(d);const ne=n.XpG(2).$implicit,W=n.XpG(2);return n.Njj(W.userRowSelect(ne))}),n.EFF(1),n.k0s()}if(2&R){const d=n.XpG().$implicit,D=n.XpG().$implicit;n.R7$(),n.JRh(D[d])}}function ve(R,$){if(1&R&&n.DNE(0,te,2,1,"clr-dg-cell")(1,l,2,1,"clr-dg-cell"),2&R){const d=$.$implicit,D=n.XpG(3);n.vxM(D.isTimestampFormat(d)?0:1)}}function ie(R,$){if(1&R&&(n.j41(0,"clr-dg-row",12),n.Z7z(1,ve,2,1,null,null,n.fX1),n.k0s()),2&R){const d=$.$implicit,D=n.XpG(2);n.Y8G("clrDgItem",d),n.R7$(),n.Dyx(D.labelKeys)}}function Se(R,$){if(1&R){const d=n.RV6();n.j41(0,"clr-datagrid",2),n.mxI("clrDgSelectedChange",function(ne){n.eBV(d);const W=n.XpG();return n.DH7(W.selected,ne)||(W.selected=ne),n.Njj(ne)}),n.DNE(1,k,4,2,"clr-dg-action-bar"),n.Z7z(2,A,2,1,"clr-dg-column",null,n.fX1),n.j41(4,"clr-dg-placeholder",3),n.EFF(5),n.k0s(),n.DNE(6,ie,3,1,"clr-dg-row",4),n.j41(7,"clr-dg-footer")(8,"clr-dg-pagination",5,0)(10,"clr-dg-page-size",6),n.EFF(11," items per page"),n.k0s(),n.EFF(12),n.k0s()()()}if(2&R){const d=n.sdS(9),D=n.XpG();n.R50("clrDgSelected",D.selected),n.R7$(),n.vxM(D.onAdd||D.onDelete||D.onDownload?1:-1),n.R7$(),n.Dyx(D.labelTitles),n.R7$(3),n.JRh(D.placeholder),n.R7$(),n.Y8G("clrDgItemsOf",D.data),n.R7$(2),n.Y8G("clrDgPageSize",10),n.R7$(2),n.Y8G("clrPageSizeOptions",n.lJ4(9,y)),n.R7$(2),n.E5c(" ",d.firstItem+1," - ",d.lastItem+1," of ",d.totalItems," certificates ")}}b.h.addIcons(V,U.a,F);let Oe=(()=>{class R{constructor(){this.data=[],this.itemType=w.SP.Device,this.labels={},this.placeholder="We couldn't find any data!",this.deleteText="Delete",this.downloadText="Download",this.addText="Add",this.onRowSelect=new n.bkB,this.selected=[],this.detail={},this.isLoading=!1,this.labelKeys=[],this.labelTitles=[],this.userRowSelect=d=>{this.onRowSelect&&this.onRowSelect.emit(d)},this.convertTimeString=d=>(0,B.t)(d),this.isLoading=!0}ngOnChanges(d){d.data.currentValue.length>0&&(this.labelKeys=Object.keys(this.labels),this.labelTitles=Object.values(this.labels).map(D=>D.title)),this.isLoading=!1}isTimestampFormat(d){return w.N3.includes(d)}static#e=this.\u0275fac=function(D){return new(D||R)};static#t=this.\u0275cmp=n.VBU({type:R,selectors:[["app-smart-table"]],inputs:{data:"data",itemType:"itemType",labels:"labels",placeholder:"placeholder",onDownload:"onDownload",onDelete:"onDelete",onAdd:"onAdd",deleteText:"deleteText",downloadText:"downloadText",addText:"addText"},outputs:{onRowSelect:"onRowSelect"},standalone:!0,features:[n.OA$,n.aNF],decls:2,vars:1,consts:[["pagination",""],[3,"clrDgSelected"],[3,"clrDgSelectedChange","clrDgSelected"],[1,"datagrid-empty"],[3,"clrDgItem",4,"clrDgItems","clrDgItemsOf"],[3,"clrDgPageSize"],[3,"clrPageSizeOptions"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],["shape","times"],["shape","download"],[3,"clrDgItem"],[3,"click"]],template:function(D,ne){1&D&&n.DNE(0,E,2,0,"clr-spinner")(1,Se,13,10,"clr-datagrid",1),2&D&&n.vxM(ne.isLoading?0:1)},dependencies:[c.PuD,c.ghA,c.fQA,c.slD,c.scM,c.Lwm,c.AtP,c.oip,c.o3y,c.XTg,c.E1i,c.NTI,c.cIg,c.qDI,c.v0q,c.Aup,c.rpC,c.mCo,c.BlU,c.BkK,c.oFi]})}return R})()},5540:function(Nt,M){var j,c;void 0!==(c="function"==typeof(j=function(){"use strict";function p(w,B,y){var E=new XMLHttpRequest;E.open("GET",w),E.responseType="blob",E.onload=function(){F(E.response,B,y)},E.onerror=function(){console.error("could not download file")},E.send()}function C(w){var B=new XMLHttpRequest;B.open("HEAD",w,!1);try{B.send()}catch{}return 200<=B.status&&299>=B.status}function V(w){try{w.dispatchEvent(new MouseEvent("click"))}catch{var B=document.createEvent("MouseEvents");B.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),w.dispatchEvent(B)}}var U="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,P=U.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),F=U.saveAs||("object"!=typeof window||window!==U?function(){}:"download"in HTMLAnchorElement.prototype&&!P?function(w,B,y){var E=U.URL||U.webkitURL,g=document.createElement("a");g.download=B=B||w.name||"download",g.rel="noopener","string"==typeof w?(g.href=w,g.origin===location.origin?V(g):C(g.href)?p(w,B,y):V(g,g.target="_blank")):(g.href=E.createObjectURL(w),setTimeout(function(){E.revokeObjectURL(g.href)},4e4),setTimeout(function(){V(g)},0))}:"msSaveOrOpenBlob"in navigator?function(w,B,y){if(B=B||w.name||"download","string"!=typeof w)navigator.msSaveOrOpenBlob(function b(w,B){return typeof B>"u"?B={autoBom:!1}:"object"!=typeof B&&(console.warn("Deprecated: Expected third argument to be a object"),B={autoBom:!B}),B.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(w.type)?new Blob(["\ufeff",w],{type:w.type}):w}(w,y),B);else if(C(w))p(w,B,y);else{var E=document.createElement("a");E.href=w,E.target="_blank",setTimeout(function(){V(E)})}}:function(w,B,y,E){if((E=E||open("","_blank"))&&(E.document.title=E.document.body.innerText="downloading..."),"string"==typeof w)return p(w,B,y);var g="application/octet-stream"===w.type,S=/constructor/i.test(U.HTMLElement)||U.safari,_=/CriOS\/[\d]+/.test(navigator.userAgent);if((_||g&&S||P)&&typeof FileReader<"u"){var k=new FileReader;k.onloadend=function(){var l=k.result;l=_?l:l.replace(/^data:[^;]*;/,"data:attachment/file;"),E?E.location.href=l:location=l,E=null},k.readAsDataURL(w)}else{var A=U.URL||U.webkitURL,te=A.createObjectURL(w);E?E.location=te:location.href=te,E=null,setTimeout(function(){A.revokeObjectURL(te)},4e4)}});U.saveAs=F.saveAs=F,Nt.exports=F})?j.apply(M,[]):j)&&(Nt.exports=c)},8721:Nt=>{Nt.exports=function M(j,n,c){function b(V,U){if(!n[V]){if(!j[V]){if(p)return p(V,!0);var F=new Error("Cannot find module '"+V+"'");throw F.code="MODULE_NOT_FOUND",F}var w=n[V]={exports:{}};j[V][0].call(w.exports,function(B){return b(j[V][1][B]||B)},w,w.exports,M,j,n,c)}return n[V].exports}for(var p=void 0,C=0;C<c.length;C++)b(c[C]);return b}({1:[function(M,j,n){"use strict";var c=M("./utils"),b=M("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(C){for(var V,U,P,w,B,y,E=[],g=0,S=C.length,_=S,k="string"!==c.getTypeOf(C);g<C.length;)_=S-g,P=k?(V=C[g++],U=g<S?C[g++]:0,g<S?C[g++]:0):(V=C.charCodeAt(g++),U=g<S?C.charCodeAt(g++):0,g<S?C.charCodeAt(g++):0),w=(3&V)<<4|U>>4,B=1<_?(15&U)<<2|P>>6:64,y=2<_?63&P:64,E.push(p.charAt(V>>2)+p.charAt(w)+p.charAt(B)+p.charAt(y));return E.join("")},n.decode=function(C){var V,U,P,F,w,B,y=0,E=0,g="data:";if(C.substr(0,5)===g)throw new Error("Invalid base64 input, it looks like a data url.");var S,_=3*(C=C.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(C.charAt(C.length-1)===p.charAt(64)&&_--,C.charAt(C.length-2)===p.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(S=b.uint8array?new Uint8Array(0|_):new Array(0|_);y<C.length;)V=p.indexOf(C.charAt(y++))<<2|(F=p.indexOf(C.charAt(y++)))>>4,U=(15&F)<<4|(w=p.indexOf(C.charAt(y++)))>>2,P=(3&w)<<6|(B=p.indexOf(C.charAt(y++))),S[E++]=V,64!==w&&(S[E++]=U),64!==B&&(S[E++]=P);return S}},{"./support":30,"./utils":32}],2:[function(M,j,n){"use strict";var c=M("./external"),b=M("./stream/DataWorker"),p=M("./stream/Crc32Probe"),C=M("./stream/DataLengthProbe");function V(U,P,F,w,B){this.compressedSize=U,this.uncompressedSize=P,this.crc32=F,this.compression=w,this.compressedContent=B}V.prototype={getContentWorker:function(){var U=new b(c.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new C("data_length")),P=this;return U.on("end",function(){if(this.streamInfo.data_length!==P.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),U},getCompressedWorker:function(){return new b(c.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},V.createWorkerFrom=function(U,P,F){return U.pipe(new p).pipe(new C("uncompressedSize")).pipe(P.compressWorker(F)).pipe(new C("compressedSize")).withStreamInfo("compression",P)},j.exports=V},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(M,j,n){"use strict";var c=M("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new c("STORE compression")},uncompressWorker:function(){return new c("STORE decompression")}},n.DEFLATE=M("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(M,j,n){"use strict";var c=M("./utils"),b=function(){for(var p,C=[],V=0;V<256;V++){p=V;for(var U=0;U<8;U++)p=1&p?3988292384^p>>>1:p>>>1;C[V]=p}return C}();j.exports=function(p,C){return void 0!==p&&p.length?"string"!==c.getTypeOf(p)?function(V,U,P){var w=b,B=0+P;V^=-1;for(var y=0;y<B;y++)V=V>>>8^w[255&(V^U[y])];return~V}(0|C,p,p.length):function(V,U,P){var w=b,B=0+P;V^=-1;for(var y=0;y<B;y++)V=V>>>8^w[255&(V^U.charCodeAt(y))];return~V}(0|C,p,p.length):0}},{"./utils":32}],5:[function(M,j,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(M,j,n){"use strict";var c;c=typeof Promise<"u"?Promise:M("lie"),j.exports={Promise:c}},{lie:37}],7:[function(M,j,n){"use strict";var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",b=M("pako"),p=M("./utils"),C=M("./stream/GenericWorker"),V=c?"uint8array":"array";function U(P,F){C.call(this,"FlateWorker/"+P),this._pako=null,this._pakoAction=P,this._pakoOptions=F,this.meta={}}n.magic="\b\0",p.inherits(U,C),U.prototype.processChunk=function(P){this.meta=P.meta,null===this._pako&&this._createPako(),this._pako.push(p.transformTo(V,P.data),!1)},U.prototype.flush=function(){C.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},U.prototype.cleanUp=function(){C.prototype.cleanUp.call(this),this._pako=null},U.prototype._createPako=function(){this._pako=new b[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var P=this;this._pako.onData=function(F){P.push({data:F,meta:P.meta})}},n.compressWorker=function(P){return new U("Deflate",P)},n.uncompressWorker=function(){return new U("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(M,j,n){"use strict";function c(w,B){var y,E="";for(y=0;y<B;y++)E+=String.fromCharCode(255&w),w>>>=8;return E}function b(w,B,y,E,g,S){var _,k,A=w.file,te=w.compression,l=S!==V.utf8encode,ve=p.transformTo("string",S(A.name)),ie=p.transformTo("string",V.utf8encode(A.name)),Se=A.comment,Oe=p.transformTo("string",S(Se)),R=p.transformTo("string",V.utf8encode(Se)),$=ie.length!==A.name.length,d=R.length!==Se.length,D="",ne="",W="",Ie=A.dir,Y=A.date,Te={crc32:0,compressedSize:0,uncompressedSize:0};B&&!y||(Te.crc32=w.crc32,Te.compressedSize=w.compressedSize,Te.uncompressedSize=w.uncompressedSize);var H=0;B&&(H|=8),l||!$&&!d||(H|=2048);var ke,it,J=0,_e=0;Ie&&(J|=16),"UNIX"===g?(_e=798,J|=(it=ke=A.unixPermissions,ke||(it=Ie?16893:33204),(65535&it)<<16)):(_e=20,J|=function(ke){return 63&(ke||0)}(A.dosPermissions)),_=Y.getUTCHours(),_<<=6,_|=Y.getUTCMinutes(),_<<=5,_|=Y.getUTCSeconds()/2,k=Y.getUTCFullYear()-1980,k<<=4,k|=Y.getUTCMonth()+1,k<<=5,k|=Y.getUTCDate(),$&&(ne=c(1,1)+c(U(ve),4)+ie,D+="up"+c(ne.length,2)+ne),d&&(W=c(1,1)+c(U(Oe),4)+R,D+="uc"+c(W.length,2)+W);var Ne="";return Ne+="\n\0",Ne+=c(H,2),Ne+=te.magic,Ne+=c(_,2),Ne+=c(k,2),Ne+=c(Te.crc32,4),Ne+=c(Te.compressedSize,4),Ne+=c(Te.uncompressedSize,4),Ne+=c(ve.length,2),Ne+=c(D.length,2),{fileRecord:P.LOCAL_FILE_HEADER+Ne+ve+D,dirRecord:P.CENTRAL_FILE_HEADER+c(_e,2)+Ne+c(Oe.length,2)+"\0\0\0\0"+c(J,4)+c(E,4)+ve+D+Oe}}var p=M("../utils"),C=M("../stream/GenericWorker"),V=M("../utf8"),U=M("../crc32"),P=M("../signature");function F(w,B,y,E){C.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=B,this.zipPlatform=y,this.encodeFileName=E,this.streamFiles=w,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}p.inherits(F,C),F.prototype.push=function(w){var B=w.meta.percent||0,y=this.entriesCount,E=this._sources.length;this.accumulate?this.contentBuffer.push(w):(this.bytesWritten+=w.data.length,C.prototype.push.call(this,{data:w.data,meta:{currentFile:this.currentFile,percent:y?(B+100*(y-E-1))/y:100}}))},F.prototype.openedSource=function(w){this.currentSourceOffset=this.bytesWritten,this.currentFile=w.file.name;var B=this.streamFiles&&!w.file.dir;if(B){var y=b(w,B,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:y.fileRecord,meta:{percent:0}})}else this.accumulate=!0},F.prototype.closedSource=function(w){this.accumulate=!1;var E,B=this.streamFiles&&!w.file.dir,y=b(w,B,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(y.dirRecord),B)this.push({data:(E=w,P.DATA_DESCRIPTOR+c(E.crc32,4)+c(E.compressedSize,4)+c(E.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:y.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},F.prototype.flush=function(){for(var w=this.bytesWritten,B=0;B<this.dirRecords.length;B++)this.push({data:this.dirRecords[B],meta:{percent:100}});var g,S,_,te,E=(g=this.dirRecords.length,S=this.bytesWritten-w,_=w,te=p.transformTo("string",(0,this.encodeFileName)(this.zipComment)),P.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(g,2)+c(g,2)+c(S,4)+c(_,4)+c(te.length,2)+te);this.push({data:E,meta:{percent:100}})},F.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},F.prototype.registerPrevious=function(w){this._sources.push(w);var B=this;return w.on("data",function(y){B.processChunk(y)}),w.on("end",function(){B.closedSource(B.previous.streamInfo),B._sources.length?B.prepareNextSource():B.end()}),w.on("error",function(y){B.error(y)}),this},F.prototype.resume=function(){return!!C.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},F.prototype.error=function(w){var B=this._sources;if(!C.prototype.error.call(this,w))return!1;for(var y=0;y<B.length;y++)try{B[y].error(w)}catch{}return!0},F.prototype.lock=function(){C.prototype.lock.call(this);for(var w=this._sources,B=0;B<w.length;B++)w[B].lock()},j.exports=F},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(M,j,n){"use strict";var c=M("../compressions"),b=M("./ZipFileWorker");n.generateWorker=function(p,C,V){var U=new b(C.streamFiles,V,C.platform,C.encodeFileName),P=0;try{p.forEach(function(F,w){P++;var B=function(S,_){var k=S||_,A=c[k];if(!A)throw new Error(k+" is not a valid compression method !");return A}(w.options.compression,C.compression),E=w.dir,g=w.date;w._compressWorker(B,w.options.compressionOptions||C.compressionOptions||{}).withStreamInfo("file",{name:F,dir:E,date:g,comment:w.comment||"",unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions}).pipe(U)}),U.entriesCount=P}catch(F){U.error(F)}return U}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(M,j,n){"use strict";function c(){if(!(this instanceof c))return new c;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var b=new c;for(var p in this)"function"!=typeof this[p]&&(b[p]=this[p]);return b}}(c.prototype=M("./object")).loadAsync=M("./load"),c.support=M("./support"),c.defaults=M("./defaults"),c.version="3.10.1",c.loadAsync=function(b,p){return(new c).loadAsync(b,p)},c.external=M("./external"),j.exports=c},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(M,j,n){"use strict";var c=M("./utils"),b=M("./external"),p=M("./utf8"),C=M("./zipEntries"),V=M("./stream/Crc32Probe"),U=M("./nodejsUtils");function P(F){return new b.Promise(function(w,B){var y=F.decompressed.getContentWorker().pipe(new V);y.on("error",function(E){B(E)}).on("end",function(){y.streamInfo.crc32!==F.decompressed.crc32?B(new Error("Corrupted zip : CRC32 mismatch")):w()}).resume()})}j.exports=function(F,w){var B=this;return w=c.extend(w||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:p.utf8decode}),U.isNode&&U.isStream(F)?b.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):c.prepareContent("the loaded zip file",F,!0,w.optimizedBinaryString,w.base64).then(function(y){var E=new C(w);return E.load(y),E}).then(function(y){var E=[b.Promise.resolve(y)],g=y.files;if(w.checkCRC32)for(var S=0;S<g.length;S++)E.push(P(g[S]));return b.Promise.all(E)}).then(function(y){for(var E=y.shift(),g=E.files,S=0;S<g.length;S++){var _=g[S],k=_.fileNameStr,A=c.resolve(_.fileNameStr);B.file(A,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:w.createFolders}),_.dir||(B.file(A).unsafeOriginalName=k)}return E.zipComment.length&&(B.comment=E.zipComment),B})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(M,j,n){"use strict";var c=M("../utils"),b=M("../stream/GenericWorker");function p(C,V){b.call(this,"Nodejs stream input adapter for "+C),this._upstreamEnded=!1,this._bindStream(V)}c.inherits(p,b),p.prototype._bindStream=function(C){var V=this;(this._stream=C).pause(),C.on("data",function(U){V.push({data:U,meta:{percent:0}})}).on("error",function(U){V.isPaused?this.generatedError=U:V.error(U)}).on("end",function(){V.isPaused?V._upstreamEnded=!0:V.end()})},p.prototype.pause=function(){return!!b.prototype.pause.call(this)&&(this._stream.pause(),!0)},p.prototype.resume=function(){return!!b.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},j.exports=p},{"../stream/GenericWorker":28,"../utils":32}],13:[function(M,j,n){"use strict";var c=M("readable-stream").Readable;function b(p,C,V){c.call(this,C),this._helper=p;var U=this;p.on("data",function(P,F){U.push(P)||U._helper.pause(),V&&V(F)}).on("error",function(P){U.emit("error",P)}).on("end",function(){U.push(null)})}M("../utils").inherits(b,c),b.prototype._read=function(){this._helper.resume()},j.exports=b},{"../utils":32,"readable-stream":16}],14:[function(M,j,n){"use strict";j.exports={isNode:typeof Buffer<"u",newBufferFrom:function(c,b){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(c,b);if("number"==typeof c)throw new Error('The "data" argument must not be a number');return new Buffer(c,b)},allocBuffer:function(c){if(Buffer.alloc)return Buffer.alloc(c);var b=new Buffer(c);return b.fill(0),b},isBuffer:function(c){return Buffer.isBuffer(c)},isStream:function(c){return c&&"function"==typeof c.on&&"function"==typeof c.pause&&"function"==typeof c.resume}}},{}],15:[function(M,j,n){"use strict";function c(A,te,l){var ve,ie=p.getTypeOf(te),Se=p.extend(l||{},U);Se.date=Se.date||new Date,null!==Se.compression&&(Se.compression=Se.compression.toUpperCase()),"string"==typeof Se.unixPermissions&&(Se.unixPermissions=parseInt(Se.unixPermissions,8)),Se.unixPermissions&&16384&Se.unixPermissions&&(Se.dir=!0),Se.dosPermissions&&16&Se.dosPermissions&&(Se.dir=!0),Se.dir&&(A=g(A)),Se.createFolders&&(ve=E(A))&&S.call(this,ve,!0),l&&void 0!==l.binary||(Se.binary=!("string"===ie&&!1===Se.binary&&!1===Se.base64)),(te instanceof P&&0===te.uncompressedSize||Se.dir||!te||0===te.length)&&(Se.base64=!1,Se.binary=!0,te="",Se.compression="STORE",ie="string");var R;R=te instanceof P||te instanceof C?te:B.isNode&&B.isStream(te)?new y(A,te):p.prepareContent(A,te,Se.binary,Se.optimizedBinaryString,Se.base64);var $=new F(A,R,Se);this.files[A]=$}var b=M("./utf8"),p=M("./utils"),C=M("./stream/GenericWorker"),V=M("./stream/StreamHelper"),U=M("./defaults"),P=M("./compressedObject"),F=M("./zipObject"),w=M("./generate"),B=M("./nodejsUtils"),y=M("./nodejs/NodejsStreamInputAdapter"),E=function(A){"/"===A.slice(-1)&&(A=A.substring(0,A.length-1));var te=A.lastIndexOf("/");return 0<te?A.substring(0,te):""},g=function(A){return"/"!==A.slice(-1)&&(A+="/"),A},S=function(A,te){return te=void 0!==te?te:U.createFolders,A=g(A),this.files[A]||c.call(this,A,null,{dir:!0,createFolders:te}),this.files[A]};function _(A){return"[object RegExp]"===Object.prototype.toString.call(A)}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var te,l,ve;for(te in this.files)ve=this.files[te],(l=te.slice(this.root.length,te.length))&&te.slice(0,this.root.length)===this.root&&A(l,ve)},filter:function(A){var te=[];return this.forEach(function(l,ve){A(l,ve)&&te.push(ve)}),te},file:function(A,te,l){if(1!==arguments.length)return c.call(this,A=this.root+A,te,l),this;if(_(A)){var ve=A;return this.filter(function(Se,Oe){return!Oe.dir&&ve.test(Se)})}var ie=this.files[this.root+A];return ie&&!ie.dir?ie:null},folder:function(A){if(!A)return this;if(_(A))return this.filter(function(ie,Se){return Se.dir&&A.test(ie)});var l=S.call(this,this.root+A),ve=this.clone();return ve.root=l.name,ve},remove:function(A){var te=this.files[A=this.root+A];if(te||("/"!==A.slice(-1)&&(A+="/"),te=this.files[A]),te&&!te.dir)delete this.files[A];else for(var l=this.filter(function(ie,Se){return Se.name.slice(0,A.length)===A}),ve=0;ve<l.length;ve++)delete this.files[l[ve].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var te,l={};try{if((l=p.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:b.utf8encode})).type=l.type.toLowerCase(),l.compression=l.compression.toUpperCase(),"binarystring"===l.type&&(l.type="string"),!l.type)throw new Error("No output type specified.");p.checkSupport(l.type),"darwin"!==l.platform&&"freebsd"!==l.platform&&"linux"!==l.platform&&"sunos"!==l.platform||(l.platform="UNIX"),"win32"===l.platform&&(l.platform="DOS"),te=w.generateWorker(this,l,l.comment||this.comment||"")}catch(ie){(te=new C("error")).error(ie)}return new V(te,l.type||"string",l.mimeType)},generateAsync:function(A,te){return this.generateInternalStream(A).accumulate(te)},generateNodeStream:function(A,te){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(te)}};j.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(M,j,n){"use strict";j.exports=M("stream")},{stream:void 0}],17:[function(M,j,n){"use strict";var c=M("./DataReader");function b(p){c.call(this,p);for(var C=0;C<this.data.length;C++)p[C]=255&p[C]}M("../utils").inherits(b,c),b.prototype.byteAt=function(p){return this.data[this.zero+p]},b.prototype.lastIndexOfSignature=function(p){for(var C=p.charCodeAt(0),V=p.charCodeAt(1),U=p.charCodeAt(2),P=p.charCodeAt(3),F=this.length-4;0<=F;--F)if(this.data[F]===C&&this.data[F+1]===V&&this.data[F+2]===U&&this.data[F+3]===P)return F-this.zero;return-1},b.prototype.readAndCheckSignature=function(p){var C=p.charCodeAt(0),V=p.charCodeAt(1),U=p.charCodeAt(2),P=p.charCodeAt(3),F=this.readData(4);return C===F[0]&&V===F[1]&&U===F[2]&&P===F[3]},b.prototype.readData=function(p){if(this.checkOffset(p),0===p)return[];var C=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,C},j.exports=b},{"../utils":32,"./DataReader":18}],18:[function(M,j,n){"use strict";var c=M("../utils");function b(p){this.data=p,this.length=p.length,this.index=0,this.zero=0}b.prototype={checkOffset:function(p){this.checkIndex(this.index+p)},checkIndex:function(p){if(this.length<this.zero+p||p<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+p+"). Corrupted zip ?")},setIndex:function(p){this.checkIndex(p),this.index=p},skip:function(p){this.setIndex(this.index+p)},byteAt:function(){},readInt:function(p){var C,V=0;for(this.checkOffset(p),C=this.index+p-1;C>=this.index;C--)V=(V<<8)+this.byteAt(C);return this.index+=p,V},readString:function(p){return c.transformTo("string",this.readData(p))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var p=this.readInt(4);return new Date(Date.UTC(1980+(p>>25&127),(p>>21&15)-1,p>>16&31,p>>11&31,p>>5&63,(31&p)<<1))}},j.exports=b},{"../utils":32}],19:[function(M,j,n){"use strict";var c=M("./Uint8ArrayReader");function b(p){c.call(this,p)}M("../utils").inherits(b,c),b.prototype.readData=function(p){this.checkOffset(p);var C=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,C},j.exports=b},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(M,j,n){"use strict";var c=M("./DataReader");function b(p){c.call(this,p)}M("../utils").inherits(b,c),b.prototype.byteAt=function(p){return this.data.charCodeAt(this.zero+p)},b.prototype.lastIndexOfSignature=function(p){return this.data.lastIndexOf(p)-this.zero},b.prototype.readAndCheckSignature=function(p){return p===this.readData(4)},b.prototype.readData=function(p){this.checkOffset(p);var C=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,C},j.exports=b},{"../utils":32,"./DataReader":18}],21:[function(M,j,n){"use strict";var c=M("./ArrayReader");function b(p){c.call(this,p)}M("../utils").inherits(b,c),b.prototype.readData=function(p){if(this.checkOffset(p),0===p)return new Uint8Array(0);var C=this.data.subarray(this.zero+this.index,this.zero+this.index+p);return this.index+=p,C},j.exports=b},{"../utils":32,"./ArrayReader":17}],22:[function(M,j,n){"use strict";var c=M("../utils"),b=M("../support"),p=M("./ArrayReader"),C=M("./StringReader"),V=M("./NodeBufferReader"),U=M("./Uint8ArrayReader");j.exports=function(P){var F=c.getTypeOf(P);return c.checkSupport(F),"string"!==F||b.uint8array?"nodebuffer"===F?new V(P):b.uint8array?new U(c.transformTo("uint8array",P)):new p(c.transformTo("array",P)):new C(P)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(M,j,n){"use strict";n.LOCAL_FILE_HEADER="PK\x03\x04",n.CENTRAL_FILE_HEADER="PK\x01\x02",n.CENTRAL_DIRECTORY_END="PK\x05\x06",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(M,j,n){"use strict";var c=M("./GenericWorker"),b=M("../utils");function p(C){c.call(this,"ConvertWorker to "+C),this.destType=C}b.inherits(p,c),p.prototype.processChunk=function(C){this.push({data:b.transformTo(this.destType,C.data),meta:C.meta})},j.exports=p},{"../utils":32,"./GenericWorker":28}],25:[function(M,j,n){"use strict";var c=M("./GenericWorker"),b=M("../crc32");function p(){c.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}M("../utils").inherits(p,c),p.prototype.processChunk=function(C){this.streamInfo.crc32=b(C.data,this.streamInfo.crc32||0),this.push(C)},j.exports=p},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(M,j,n){"use strict";var c=M("../utils"),b=M("./GenericWorker");function p(C){b.call(this,"DataLengthProbe for "+C),this.propName=C,this.withStreamInfo(C,0)}c.inherits(p,b),p.prototype.processChunk=function(C){C&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+C.data.length),b.prototype.processChunk.call(this,C)},j.exports=p},{"../utils":32,"./GenericWorker":28}],27:[function(M,j,n){"use strict";var c=M("../utils"),b=M("./GenericWorker");function p(C){b.call(this,"DataWorker");var V=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,C.then(function(U){V.dataIsReady=!0,V.data=U,V.max=U&&U.length||0,V.type=c.getTypeOf(U),V.isPaused||V._tickAndRepeat()},function(U){V.error(U)})}c.inherits(p,b),p.prototype.cleanUp=function(){b.prototype.cleanUp.call(this),this.data=null},p.prototype.resume=function(){return!!b.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,c.delay(this._tickAndRepeat,[],this)),!0)},p.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(c.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},p.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var C=null,V=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":C=this.data.substring(this.index,V);break;case"uint8array":C=this.data.subarray(this.index,V);break;case"array":case"nodebuffer":C=this.data.slice(this.index,V)}return this.index=V,this.push({data:C,meta:{percent:this.max?this.index/this.max*100:0}})},j.exports=p},{"../utils":32,"./GenericWorker":28}],28:[function(M,j,n){"use strict";function c(b){this.name=b||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}c.prototype={push:function(b){this.emit("data",b)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(b){this.emit("error",b)}return!0},error:function(b){return!this.isFinished&&(this.isPaused?this.generatedError=b:(this.isFinished=!0,this.emit("error",b),this.previous&&this.previous.error(b),this.cleanUp()),!0)},on:function(b,p){return this._listeners[b].push(p),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(b,p){if(this._listeners[b])for(var C=0;C<this._listeners[b].length;C++)this._listeners[b][C].call(this,p)},pipe:function(b){return b.registerPrevious(this)},registerPrevious:function(b){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=b.streamInfo,this.mergeStreamInfo(),this.previous=b;var p=this;return b.on("data",function(C){p.processChunk(C)}),b.on("end",function(){p.end()}),b.on("error",function(C){p.error(C)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var b=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),b=!0),this.previous&&this.previous.resume(),!b},flush:function(){},processChunk:function(b){this.push(b)},withStreamInfo:function(b,p){return this.extraStreamInfo[b]=p,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var b in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,b)&&(this.streamInfo[b]=this.extraStreamInfo[b])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var b="Worker "+this.name;return this.previous?this.previous+" -> "+b:b}},j.exports=c},{}],29:[function(M,j,n){"use strict";var c=M("../utils"),b=M("./ConvertWorker"),p=M("./GenericWorker"),C=M("../base64"),V=M("../support"),U=M("../external"),P=null;if(V.nodestream)try{P=M("../nodejs/NodejsStreamOutputAdapter")}catch{}function w(B,y,E){var g=y;switch(y){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=y,this._mimeType=E,c.checkSupport(g),this._worker=B.pipe(new b(g)),B.lock()}catch(S){this._worker=new p("error"),this._worker.error(S)}}w.prototype={accumulate:function(B){return function F(B,y){return new U.Promise(function(E,g){var S=[],_=B._internalType,k=B._outputType,A=B._mimeType;B.on("data",function(te,l){S.push(te),y&&y(l)}).on("error",function(te){S=[],g(te)}).on("end",function(){try{var te=function(l,ve,ie){switch(l){case"blob":return c.newBlob(c.transformTo("arraybuffer",ve),ie);case"base64":return C.encode(ve);default:return c.transformTo(l,ve)}}(k,function(l,ve){var ie,Se=0,Oe=null,R=0;for(ie=0;ie<ve.length;ie++)R+=ve[ie].length;switch(l){case"string":return ve.join("");case"array":return Array.prototype.concat.apply([],ve);case"uint8array":for(Oe=new Uint8Array(R),ie=0;ie<ve.length;ie++)Oe.set(ve[ie],Se),Se+=ve[ie].length;return Oe;case"nodebuffer":return Buffer.concat(ve);default:throw new Error("concat : unsupported type '"+l+"'")}}(_,S),A);E(te)}catch(l){g(l)}S=[]}).resume()})}(this,B)},on:function(B,y){var E=this;return this._worker.on(B,"data"===B?function(g){y.call(E,g.data,g.meta)}:function(){c.delay(y,arguments,E)}),this},resume:function(){return c.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(B){if(c.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new P(this,{objectMode:"nodebuffer"!==this._outputType},B)}},j.exports=w},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(M,j,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var c=new ArrayBuffer(0);try{n.blob=0===new Blob([c],{type:"application/zip"}).size}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);b.append(c),n.blob=0===b.getBlob("application/zip").size}catch{n.blob=!1}}}try{n.nodestream=!!M("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(M,j,n){"use strict";for(var c=M("./utils"),b=M("./support"),p=M("./nodejsUtils"),C=M("./stream/GenericWorker"),V=new Array(256),U=0;U<256;U++)V[U]=252<=U?6:248<=U?5:240<=U?4:224<=U?3:192<=U?2:1;function P(){C.call(this,"utf-8 decode"),this.leftOver=null}function F(){C.call(this,"utf-8 encode")}V[254]=V[254]=1,n.utf8encode=function(w){return b.nodebuffer?p.newBufferFrom(w,"utf-8"):function(B){var y,E,g,S,_,k=B.length,A=0;for(S=0;S<k;S++)55296==(64512&(E=B.charCodeAt(S)))&&S+1<k&&56320==(64512&(g=B.charCodeAt(S+1)))&&(E=65536+(E-55296<<10)+(g-56320),S++),A+=E<128?1:E<2048?2:E<65536?3:4;for(y=b.uint8array?new Uint8Array(A):new Array(A),S=_=0;_<A;S++)55296==(64512&(E=B.charCodeAt(S)))&&S+1<k&&56320==(64512&(g=B.charCodeAt(S+1)))&&(E=65536+(E-55296<<10)+(g-56320),S++),E<128?y[_++]=E:(E<2048?y[_++]=192|E>>>6:(E<65536?y[_++]=224|E>>>12:(y[_++]=240|E>>>18,y[_++]=128|E>>>12&63),y[_++]=128|E>>>6&63),y[_++]=128|63&E);return y}(w)},n.utf8decode=function(w){return b.nodebuffer?c.transformTo("nodebuffer",w).toString("utf-8"):function(B){var y,E,g,S,_=B.length,k=new Array(2*_);for(y=E=0;y<_;)if((g=B[y++])<128)k[E++]=g;else if(4<(S=V[g]))k[E++]=65533,y+=S-1;else{for(g&=2===S?31:3===S?15:7;1<S&&y<_;)g=g<<6|63&B[y++],S--;1<S?k[E++]=65533:g<65536?k[E++]=g:(k[E++]=55296|(g-=65536)>>10&1023,k[E++]=56320|1023&g)}return k.length!==E&&(k.subarray?k=k.subarray(0,E):k.length=E),c.applyFromCharCode(k)}(w=c.transformTo(b.uint8array?"uint8array":"array",w))},c.inherits(P,C),P.prototype.processChunk=function(w){var B=c.transformTo(b.uint8array?"uint8array":"array",w.data);if(this.leftOver&&this.leftOver.length){if(b.uint8array){var y=B;(B=new Uint8Array(y.length+this.leftOver.length)).set(this.leftOver,0),B.set(y,this.leftOver.length)}else B=this.leftOver.concat(B);this.leftOver=null}var E=function(S,_){var k;for((_=_||S.length)>S.length&&(_=S.length),k=_-1;0<=k&&128==(192&S[k]);)k--;return k<0||0===k?_:k+V[S[k]]>_?k:_}(B),g=B;E!==B.length&&(b.uint8array?(g=B.subarray(0,E),this.leftOver=B.subarray(E,B.length)):(g=B.slice(0,E),this.leftOver=B.slice(E,B.length))),this.push({data:n.utf8decode(g),meta:w.meta})},P.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=P,c.inherits(F,C),F.prototype.processChunk=function(w){this.push({data:n.utf8encode(w.data),meta:w.meta})},n.Utf8EncodeWorker=F},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(M,j,n){"use strict";var c=M("./support"),b=M("./base64"),p=M("./nodejsUtils"),C=M("./external");function V(y){return y}function U(y,E){for(var g=0;g<y.length;++g)E[g]=255&y.charCodeAt(g);return E}M("setimmediate"),n.newBlob=function(y,E){n.checkSupport("blob");try{return new Blob([y],{type:E})}catch{try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(y),g.getBlob(E)}catch{throw new Error("Bug : can't construct the Blob.")}}};var P={stringifyByChunk:function(y,E,g){var S=[],_=0,k=y.length;if(k<=g)return String.fromCharCode.apply(null,y);for(;_<k;)S.push(String.fromCharCode.apply(null,"array"===E||"nodebuffer"===E?y.slice(_,Math.min(_+g,k)):y.subarray(_,Math.min(_+g,k)))),_+=g;return S.join("")},stringifyByChar:function(y){for(var E="",g=0;g<y.length;g++)E+=String.fromCharCode(y[g]);return E},applyCanBeUsed:{uint8array:function(){try{return c.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return c.nodebuffer&&1===String.fromCharCode.apply(null,p.allocBuffer(1)).length}catch{return!1}}()}};function F(y){var E=65536,g=n.getTypeOf(y),S=!0;if("uint8array"===g?S=P.applyCanBeUsed.uint8array:"nodebuffer"===g&&(S=P.applyCanBeUsed.nodebuffer),S)for(;1<E;)try{return P.stringifyByChunk(y,g,E)}catch{E=Math.floor(E/2)}return P.stringifyByChar(y)}function w(y,E){for(var g=0;g<y.length;g++)E[g]=y[g];return E}n.applyFromCharCode=F;var B={};B.string={string:V,array:function(y){return U(y,new Array(y.length))},arraybuffer:function(y){return B.string.uint8array(y).buffer},uint8array:function(y){return U(y,new Uint8Array(y.length))},nodebuffer:function(y){return U(y,p.allocBuffer(y.length))}},B.array={string:F,array:V,arraybuffer:function(y){return new Uint8Array(y).buffer},uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return p.newBufferFrom(y)}},B.arraybuffer={string:function(y){return F(new Uint8Array(y))},array:function(y){return w(new Uint8Array(y),new Array(y.byteLength))},arraybuffer:V,uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return p.newBufferFrom(new Uint8Array(y))}},B.uint8array={string:F,array:function(y){return w(y,new Array(y.length))},arraybuffer:function(y){return y.buffer},uint8array:V,nodebuffer:function(y){return p.newBufferFrom(y)}},B.nodebuffer={string:F,array:function(y){return w(y,new Array(y.length))},arraybuffer:function(y){return B.nodebuffer.uint8array(y).buffer},uint8array:function(y){return w(y,new Uint8Array(y.length))},nodebuffer:V},n.transformTo=function(y,E){if(E=E||"",!y)return E;n.checkSupport(y);var g=n.getTypeOf(E);return B[g][y](E)},n.resolve=function(y){for(var E=y.split("/"),g=[],S=0;S<E.length;S++){var _=E[S];"."===_||""===_&&0!==S&&S!==E.length-1||(".."===_?g.pop():g.push(_))}return g.join("/")},n.getTypeOf=function(y){return"string"==typeof y?"string":"[object Array]"===Object.prototype.toString.call(y)?"array":c.nodebuffer&&p.isBuffer(y)?"nodebuffer":c.uint8array&&y instanceof Uint8Array?"uint8array":c.arraybuffer&&y instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(y){if(!c[y.toLowerCase()])throw new Error(y+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(y){var E,g,S="";for(g=0;g<(y||"").length;g++)S+="\\x"+((E=y.charCodeAt(g))<16?"0":"")+E.toString(16).toUpperCase();return S},n.delay=function(y,E,g){setImmediate(function(){y.apply(g||null,E||[])})},n.inherits=function(y,E){function g(){}g.prototype=E.prototype,y.prototype=new g},n.extend=function(){var y,E,g={};for(y=0;y<arguments.length;y++)for(E in arguments[y])Object.prototype.hasOwnProperty.call(arguments[y],E)&&void 0===g[E]&&(g[E]=arguments[y][E]);return g},n.prepareContent=function(y,E,g,S,_){return C.Promise.resolve(E).then(function(k){return c.blob&&(k instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k)))&&typeof FileReader<"u"?new C.Promise(function(A,te){var l=new FileReader;l.onload=function(ve){A(ve.target.result)},l.onerror=function(ve){te(ve.target.error)},l.readAsArrayBuffer(k)}):k}).then(function(k){var te,A=n.getTypeOf(k);return A?("arraybuffer"===A?k=n.transformTo("uint8array",k):"string"===A&&(_?k=b.decode(k):g&&!0!==S&&(k=U(te=k,c.uint8array?new Uint8Array(te.length):new Array(te.length)))),k):C.Promise.reject(new Error("Can't read the data of '"+y+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(M,j,n){"use strict";var c=M("./reader/readerFor"),b=M("./utils"),p=M("./signature"),C=M("./zipEntry"),V=M("./support");function U(P){this.files=[],this.loadOptions=P}U.prototype={checkSignature:function(P){if(!this.reader.readAndCheckSignature(P)){this.reader.index-=4;var F=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+b.pretty(F)+", expected "+b.pretty(P)+")")}},isSignature:function(P,F){var w=this.reader.index;this.reader.setIndex(P);var B=this.reader.readString(4)===F;return this.reader.setIndex(w),B},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var P=this.reader.readData(this.zipCommentLength),w=b.transformTo(V.uint8array?"uint8array":"array",P);this.zipComment=this.loadOptions.decodeFileName(w)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var P,F,w,B=this.zip64EndOfCentralSize-44;0<B;)P=this.reader.readInt(2),F=this.reader.readInt(4),w=this.reader.readData(F),this.zip64ExtensibleData[P]={id:P,length:F,value:w}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var P,F;for(P=0;P<this.files.length;P++)this.reader.setIndex((F=this.files[P]).localHeaderOffset),this.checkSignature(p.LOCAL_FILE_HEADER),F.readLocalPart(this.reader),F.handleUTF8(),F.processAttributes()},readCentralDir:function(){var P;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(p.CENTRAL_FILE_HEADER);)(P=new C({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(P);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var P=this.reader.lastIndexOfSignature(p.CENTRAL_DIRECTORY_END);if(P<0)throw this.isSignature(0,p.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(P);var F=P;if(this.checkSignature(p.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===b.MAX_VALUE_16BITS||this.diskWithCentralDirStart===b.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===b.MAX_VALUE_16BITS||this.centralDirRecords===b.MAX_VALUE_16BITS||this.centralDirSize===b.MAX_VALUE_32BITS||this.centralDirOffset===b.MAX_VALUE_32BITS){if(this.zip64=!0,(P=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(P),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,p.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var w=this.centralDirOffset+this.centralDirSize;this.zip64&&(w+=20,w+=12+this.zip64EndOfCentralSize);var B=F-w;if(0<B)this.isSignature(F,p.CENTRAL_FILE_HEADER)||(this.reader.zero=B);else if(B<0)throw new Error("Corrupted zip: missing "+Math.abs(B)+" bytes.")},prepareReader:function(P){this.reader=c(P)},load:function(P){this.prepareReader(P),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},j.exports=U},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(M,j,n){"use strict";var c=M("./reader/readerFor"),b=M("./utils"),p=M("./compressedObject"),C=M("./crc32"),V=M("./utf8"),U=M("./compressions"),P=M("./support");function F(w,B){this.options=w,this.loadOptions=B}F.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(w){var B,y;if(w.skip(22),this.fileNameLength=w.readInt(2),y=w.readInt(2),this.fileName=w.readData(this.fileNameLength),w.skip(y),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(B=function(E){for(var g in U)if(Object.prototype.hasOwnProperty.call(U,g)&&U[g].magic===E)return U[g];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+b.pretty(this.compressionMethod)+" unknown (inner file : "+b.transformTo("string",this.fileName)+")");this.decompressed=new p(this.compressedSize,this.uncompressedSize,this.crc32,B,w.readData(this.compressedSize))},readCentralPart:function(w){this.versionMadeBy=w.readInt(2),w.skip(2),this.bitFlag=w.readInt(2),this.compressionMethod=w.readString(2),this.date=w.readDate(),this.crc32=w.readInt(4),this.compressedSize=w.readInt(4),this.uncompressedSize=w.readInt(4);var B=w.readInt(2);if(this.extraFieldsLength=w.readInt(2),this.fileCommentLength=w.readInt(2),this.diskNumberStart=w.readInt(2),this.internalFileAttributes=w.readInt(2),this.externalFileAttributes=w.readInt(4),this.localHeaderOffset=w.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");w.skip(B),this.readExtraFields(w),this.parseZIP64ExtraField(w),this.fileComment=w.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var w=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==w&&(this.dosPermissions=63&this.externalFileAttributes),3==w&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var w=c(this.extraFields[1].value);this.uncompressedSize===b.MAX_VALUE_32BITS&&(this.uncompressedSize=w.readInt(8)),this.compressedSize===b.MAX_VALUE_32BITS&&(this.compressedSize=w.readInt(8)),this.localHeaderOffset===b.MAX_VALUE_32BITS&&(this.localHeaderOffset=w.readInt(8)),this.diskNumberStart===b.MAX_VALUE_32BITS&&(this.diskNumberStart=w.readInt(4))}},readExtraFields:function(w){var B,y,E,g=w.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});w.index+4<g;)B=w.readInt(2),y=w.readInt(2),E=w.readData(y),this.extraFields[B]={id:B,length:y,value:E};w.setIndex(g)},handleUTF8:function(){var w=P.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=V.utf8decode(this.fileName),this.fileCommentStr=V.utf8decode(this.fileComment);else{var B=this.findExtraFieldUnicodePath();if(null!==B)this.fileNameStr=B;else{var y=b.transformTo(w,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var E=this.findExtraFieldUnicodeComment();if(null!==E)this.fileCommentStr=E;else{var g=b.transformTo(w,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var w=this.extraFields[28789];if(w){var B=c(w.value);return 1!==B.readInt(1)||C(this.fileName)!==B.readInt(4)?null:V.utf8decode(B.readData(w.length-5))}return null},findExtraFieldUnicodeComment:function(){var w=this.extraFields[25461];if(w){var B=c(w.value);return 1!==B.readInt(1)||C(this.fileComment)!==B.readInt(4)?null:V.utf8decode(B.readData(w.length-5))}return null}},j.exports=F},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(M,j,n){"use strict";function c(B,y,E){this.name=B,this.dir=E.dir,this.date=E.date,this.comment=E.comment,this.unixPermissions=E.unixPermissions,this.dosPermissions=E.dosPermissions,this._data=y,this._dataBinary=E.binary,this.options={compression:E.compression,compressionOptions:E.compressionOptions}}var b=M("./stream/StreamHelper"),p=M("./stream/DataWorker"),C=M("./utf8"),V=M("./compressedObject"),U=M("./stream/GenericWorker");c.prototype={internalStream:function(B){var y=null,E="string";try{if(!B)throw new Error("No output type specified.");var g="string"===(E=B.toLowerCase())||"text"===E;"binarystring"!==E&&"text"!==E||(E="string"),y=this._decompressWorker();var S=!this._dataBinary;S&&!g&&(y=y.pipe(new C.Utf8EncodeWorker)),!S&&g&&(y=y.pipe(new C.Utf8DecodeWorker))}catch(_){(y=new U("error")).error(_)}return new b(y,E,"")},async:function(B,y){return this.internalStream(B).accumulate(y)},nodeStream:function(B,y){return this.internalStream(B||"nodebuffer").toNodejsStream(y)},_compressWorker:function(B,y){if(this._data instanceof V&&this._data.compression.magic===B.magic)return this._data.getCompressedWorker();var E=this._decompressWorker();return this._dataBinary||(E=E.pipe(new C.Utf8EncodeWorker)),V.createWorkerFrom(E,B,y)},_decompressWorker:function(){return this._data instanceof V?this._data.getContentWorker():this._data instanceof U?this._data:new p(this._data)}};for(var P=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],F=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},w=0;w<P.length;w++)c.prototype[P[w]]=F;j.exports=c},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(M,j,n){(function(c){"use strict";var b,p,C=c.MutationObserver||c.WebKitMutationObserver;if(C){var V=0,U=new C(B),P=c.document.createTextNode("");U.observe(P,{characterData:!0}),b=function(){P.data=V=++V%2}}else if(c.setImmediate||void 0===c.MessageChannel)b="document"in c&&"onreadystatechange"in c.document.createElement("script")?function(){var y=c.document.createElement("script");y.onreadystatechange=function(){B(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},c.document.documentElement.appendChild(y)}:function(){setTimeout(B,0)};else{var F=new c.MessageChannel;F.port1.onmessage=B,b=function(){F.port2.postMessage(0)}}var w=[];function B(){var y,E;p=!0;for(var g=w.length;g;){for(E=w,w=[],y=-1;++y<g;)E[y]();g=w.length}p=!1}j.exports=function(y){1!==w.push(y)||p||b()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(M,j,n){"use strict";var c=M("immediate");function b(){}var p={},C=["REJECTED"],V=["FULFILLED"],U=["PENDING"];function P(g){if("function"!=typeof g)throw new TypeError("resolver must be a function");this.state=U,this.queue=[],this.outcome=void 0,g!==b&&y(this,g)}function F(g,S,_){this.promise=g,"function"==typeof S&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),"function"==typeof _&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function w(g,S,_){c(function(){var k;try{k=S(_)}catch(A){return p.reject(g,A)}k===g?p.reject(g,new TypeError("Cannot resolve promise with itself")):p.resolve(g,k)})}function B(g){var S=g&&g.then;if(g&&("object"==typeof g||"function"==typeof g)&&"function"==typeof S)return function(){S.apply(g,arguments)}}function y(g,S){var _=!1;function k(l){_||(_=!0,p.reject(g,l))}function A(l){_||(_=!0,p.resolve(g,l))}var te=E(function(){S(A,k)});"error"===te.status&&k(te.value)}function E(g,S){var _={};try{_.value=g(S),_.status="success"}catch(k){_.status="error",_.value=k}return _}(j.exports=P).prototype.finally=function(g){if("function"!=typeof g)return this;var S=this.constructor;return this.then(function(_){return S.resolve(g()).then(function(){return _})},function(_){return S.resolve(g()).then(function(){throw _})})},P.prototype.catch=function(g){return this.then(null,g)},P.prototype.then=function(g,S){if("function"!=typeof g&&this.state===V||"function"!=typeof S&&this.state===C)return this;var _=new this.constructor(b);return this.state!==U?w(_,this.state===V?g:S,this.outcome):this.queue.push(new F(_,g,S)),_},F.prototype.callFulfilled=function(g){p.resolve(this.promise,g)},F.prototype.otherCallFulfilled=function(g){w(this.promise,this.onFulfilled,g)},F.prototype.callRejected=function(g){p.reject(this.promise,g)},F.prototype.otherCallRejected=function(g){w(this.promise,this.onRejected,g)},p.resolve=function(g,S){var _=E(B,S);if("error"===_.status)return p.reject(g,_.value);var k=_.value;if(k)y(g,k);else{g.state=V,g.outcome=S;for(var A=-1,te=g.queue.length;++A<te;)g.queue[A].callFulfilled(S)}return g},p.reject=function(g,S){g.state=C,g.outcome=S;for(var _=-1,k=g.queue.length;++_<k;)g.queue[_].callRejected(S);return g},P.resolve=function(g){return g instanceof this?g:p.resolve(new this(b),g)},P.reject=function(g){var S=new this(b);return p.reject(S,g)},P.all=function(g){var S=this;if("[object Array]"!==Object.prototype.toString.call(g))return this.reject(new TypeError("must be an array"));var _=g.length,k=!1;if(!_)return this.resolve([]);for(var A=new Array(_),te=0,l=-1,ve=new this(b);++l<_;)ie(g[l],l);return ve;function ie(Se,Oe){S.resolve(Se).then(function(R){A[Oe]=R,++te!==_||k||(k=!0,p.resolve(ve,A))},function(R){k||(k=!0,p.reject(ve,R))})}},P.race=function(g){if("[object Array]"!==Object.prototype.toString.call(g))return this.reject(new TypeError("must be an array"));var _=g.length,k=!1;if(!_)return this.resolve([]);for(var A=-1,te=new this(b);++A<_;)this.resolve(g[A]).then(function(ve){k||(k=!0,p.resolve(te,ve))},function(ve){k||(k=!0,p.reject(te,ve))});return te}},{immediate:36}],38:[function(M,j,n){"use strict";var c={};(0,M("./lib/utils/common").assign)(c,M("./lib/deflate"),M("./lib/inflate"),M("./lib/zlib/constants")),j.exports=c},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(M,j,n){"use strict";var c=M("./zlib/deflate"),b=M("./utils/common"),p=M("./utils/strings"),C=M("./zlib/messages"),V=M("./zlib/zstream"),U=Object.prototype.toString,P=0,F=-1,w=0,B=8;function y(g){if(!(this instanceof y))return new y(g);this.options=b.assign({level:F,method:B,chunkSize:16384,windowBits:15,memLevel:8,strategy:w,to:""},g||{});var S=this.options;S.raw&&0<S.windowBits?S.windowBits=-S.windowBits:S.gzip&&0<S.windowBits&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new V,this.strm.avail_out=0;var _=c.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(_!==P)throw new Error(C[_]);if(S.header&&c.deflateSetHeader(this.strm,S.header),S.dictionary){var k;if(k="string"==typeof S.dictionary?p.string2buf(S.dictionary):"[object ArrayBuffer]"===U.call(S.dictionary)?new Uint8Array(S.dictionary):S.dictionary,(_=c.deflateSetDictionary(this.strm,k))!==P)throw new Error(C[_]);this._dict_set=!0}}function E(g,S){var _=new y(S);if(_.push(g,!0),_.err)throw _.msg||C[_.err];return _.result}y.prototype.push=function(g,S){var _,k,A=this.strm,te=this.options.chunkSize;if(this.ended)return!1;k=S===~~S?S:!0===S?4:0,A.input="string"==typeof g?p.string2buf(g):"[object ArrayBuffer]"===U.call(g)?new Uint8Array(g):g,A.next_in=0,A.avail_in=A.input.length;do{if(0===A.avail_out&&(A.output=new b.Buf8(te),A.next_out=0,A.avail_out=te),1!==(_=c.deflate(A,k))&&_!==P)return this.onEnd(_),!(this.ended=!0);0!==A.avail_out&&(0!==A.avail_in||4!==k&&2!==k)||this.onData("string"===this.options.to?p.buf2binstring(b.shrinkBuf(A.output,A.next_out)):b.shrinkBuf(A.output,A.next_out))}while((0<A.avail_in||0===A.avail_out)&&1!==_);return 4===k?(_=c.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===P):2!==k||(this.onEnd(P),!(A.avail_out=0))},y.prototype.onData=function(g){this.chunks.push(g)},y.prototype.onEnd=function(g){g===P&&(this.result="string"===this.options.to?this.chunks.join(""):b.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},n.Deflate=y,n.deflate=E,n.deflateRaw=function(g,S){return(S=S||{}).raw=!0,E(g,S)},n.gzip=function(g,S){return(S=S||{}).gzip=!0,E(g,S)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(M,j,n){"use strict";var c=M("./zlib/inflate"),b=M("./utils/common"),p=M("./utils/strings"),C=M("./zlib/constants"),V=M("./zlib/messages"),U=M("./zlib/zstream"),P=M("./zlib/gzheader"),F=Object.prototype.toString;function w(y){if(!(this instanceof w))return new w(y);this.options=b.assign({chunkSize:16384,windowBits:0,to:""},y||{});var E=this.options;E.raw&&0<=E.windowBits&&E.windowBits<16&&(E.windowBits=-E.windowBits,0===E.windowBits&&(E.windowBits=-15)),!(0<=E.windowBits&&E.windowBits<16)||y&&y.windowBits||(E.windowBits+=32),15<E.windowBits&&E.windowBits<48&&!(15&E.windowBits)&&(E.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new U,this.strm.avail_out=0;var g=c.inflateInit2(this.strm,E.windowBits);if(g!==C.Z_OK)throw new Error(V[g]);this.header=new P,c.inflateGetHeader(this.strm,this.header)}function B(y,E){var g=new w(E);if(g.push(y,!0),g.err)throw g.msg||V[g.err];return g.result}w.prototype.push=function(y,E){var g,S,_,k,A,te,l=this.strm,ve=this.options.chunkSize,ie=this.options.dictionary,Se=!1;if(this.ended)return!1;S=E===~~E?E:!0===E?C.Z_FINISH:C.Z_NO_FLUSH,l.input="string"==typeof y?p.binstring2buf(y):"[object ArrayBuffer]"===F.call(y)?new Uint8Array(y):y,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new b.Buf8(ve),l.next_out=0,l.avail_out=ve),(g=c.inflate(l,C.Z_NO_FLUSH))===C.Z_NEED_DICT&&ie&&(te="string"==typeof ie?p.string2buf(ie):"[object ArrayBuffer]"===F.call(ie)?new Uint8Array(ie):ie,g=c.inflateSetDictionary(this.strm,te)),g===C.Z_BUF_ERROR&&!0===Se&&(g=C.Z_OK,Se=!1),g!==C.Z_STREAM_END&&g!==C.Z_OK)return this.onEnd(g),!(this.ended=!0);l.next_out&&(0!==l.avail_out&&g!==C.Z_STREAM_END&&(0!==l.avail_in||S!==C.Z_FINISH&&S!==C.Z_SYNC_FLUSH)||("string"===this.options.to?(_=p.utf8border(l.output,l.next_out),k=l.next_out-_,A=p.buf2string(l.output,_),l.next_out=k,l.avail_out=ve-k,k&&b.arraySet(l.output,l.output,_,k,0),this.onData(A)):this.onData(b.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(Se=!0)}while((0<l.avail_in||0===l.avail_out)&&g!==C.Z_STREAM_END);return g===C.Z_STREAM_END&&(S=C.Z_FINISH),S===C.Z_FINISH?(g=c.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===C.Z_OK):S!==C.Z_SYNC_FLUSH||(this.onEnd(C.Z_OK),!(l.avail_out=0))},w.prototype.onData=function(y){this.chunks.push(y)},w.prototype.onEnd=function(y){y===C.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):b.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},n.Inflate=w,n.inflate=B,n.inflateRaw=function(y,E){return(E=E||{}).raw=!0,B(y,E)},n.ungzip=B},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(M,j,n){"use strict";var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(C){for(var V=Array.prototype.slice.call(arguments,1);V.length;){var U=V.shift();if(U){if("object"!=typeof U)throw new TypeError(U+"must be non-object");for(var P in U)U.hasOwnProperty(P)&&(C[P]=U[P])}}return C},n.shrinkBuf=function(C,V){return C.length===V?C:C.subarray?C.subarray(0,V):(C.length=V,C)};var b={arraySet:function(C,V,U,P,F){if(V.subarray&&C.subarray)C.set(V.subarray(U,U+P),F);else for(var w=0;w<P;w++)C[F+w]=V[U+w]},flattenChunks:function(C){var V,U,P,F,w,B;for(V=P=0,U=C.length;V<U;V++)P+=C[V].length;for(B=new Uint8Array(P),V=F=0,U=C.length;V<U;V++)B.set(w=C[V],F),F+=w.length;return B}},p={arraySet:function(C,V,U,P,F){for(var w=0;w<P;w++)C[F+w]=V[U+w]},flattenChunks:function(C){return[].concat.apply([],C)}};n.setTyped=function(C){C?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,b)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,p))},n.setTyped(c)},{}],42:[function(M,j,n){"use strict";var c=M("./common"),b=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch{b=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{p=!1}for(var C=new c.Buf8(256),V=0;V<256;V++)C[V]=252<=V?6:248<=V?5:240<=V?4:224<=V?3:192<=V?2:1;function U(P,F){if(F<65537&&(P.subarray&&p||!P.subarray&&b))return String.fromCharCode.apply(null,c.shrinkBuf(P,F));for(var w="",B=0;B<F;B++)w+=String.fromCharCode(P[B]);return w}C[254]=C[254]=1,n.string2buf=function(P){var F,w,B,y,E,g=P.length,S=0;for(y=0;y<g;y++)55296==(64512&(w=P.charCodeAt(y)))&&y+1<g&&56320==(64512&(B=P.charCodeAt(y+1)))&&(w=65536+(w-55296<<10)+(B-56320),y++),S+=w<128?1:w<2048?2:w<65536?3:4;for(F=new c.Buf8(S),y=E=0;E<S;y++)55296==(64512&(w=P.charCodeAt(y)))&&y+1<g&&56320==(64512&(B=P.charCodeAt(y+1)))&&(w=65536+(w-55296<<10)+(B-56320),y++),w<128?F[E++]=w:(w<2048?F[E++]=192|w>>>6:(w<65536?F[E++]=224|w>>>12:(F[E++]=240|w>>>18,F[E++]=128|w>>>12&63),F[E++]=128|w>>>6&63),F[E++]=128|63&w);return F},n.buf2binstring=function(P){return U(P,P.length)},n.binstring2buf=function(P){for(var F=new c.Buf8(P.length),w=0,B=F.length;w<B;w++)F[w]=P.charCodeAt(w);return F},n.buf2string=function(P,F){var w,B,y,E,g=F||P.length,S=new Array(2*g);for(w=B=0;w<g;)if((y=P[w++])<128)S[B++]=y;else if(4<(E=C[y]))S[B++]=65533,w+=E-1;else{for(y&=2===E?31:3===E?15:7;1<E&&w<g;)y=y<<6|63&P[w++],E--;1<E?S[B++]=65533:y<65536?S[B++]=y:(S[B++]=55296|(y-=65536)>>10&1023,S[B++]=56320|1023&y)}return U(S,B)},n.utf8border=function(P,F){var w;for((F=F||P.length)>P.length&&(F=P.length),w=F-1;0<=w&&128==(192&P[w]);)w--;return w<0||0===w?F:w+C[P[w]]>F?w:F}},{"./common":41}],43:[function(M,j,n){"use strict";j.exports=function(c,b,p,C){for(var V=65535&c,U=c>>>16&65535,P=0;0!==p;){for(p-=P=2e3<p?2e3:p;U=U+(V=V+b[C++]|0)|0,--P;);V%=65521,U%=65521}return V|U<<16}},{}],44:[function(M,j,n){"use strict";j.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(M,j,n){"use strict";var c=function(){for(var b,p=[],C=0;C<256;C++){b=C;for(var V=0;V<8;V++)b=1&b?3988292384^b>>>1:b>>>1;p[C]=b}return p}();j.exports=function(b,p,C,V){var U=c,P=V+C;b^=-1;for(var F=V;F<P;F++)b=b>>>8^U[255&(b^p[F])];return~b}},{}],46:[function(M,j,n){"use strict";var c,b=M("../utils/common"),p=M("./trees"),C=M("./adler32"),V=M("./crc32"),U=M("./messages"),P=0,w=0,B=-2,g=2,S=8,k=286,A=30,te=19,l=2*k+1,ve=15,ie=3,Se=258,Oe=Se+ie+1,R=42,$=113;function Ie(f,ce){return f.msg=U[ce],ce}function Y(f){return(f<<1)-(4<f?9:0)}function Te(f){for(var ce=f.length;0<=--ce;)f[ce]=0}function H(f){var ce=f.state,ee=ce.pending;ee>f.avail_out&&(ee=f.avail_out),0!==ee&&(b.arraySet(f.output,ce.pending_buf,ce.pending_out,ee,f.next_out),f.next_out+=ee,ce.pending_out+=ee,f.total_out+=ee,f.avail_out-=ee,ce.pending-=ee,0===ce.pending&&(ce.pending_out=0))}function J(f,ce){p._tr_flush_block(f,0<=f.block_start?f.block_start:-1,f.strstart-f.block_start,ce),f.block_start=f.strstart,H(f.strm)}function _e(f,ce){f.pending_buf[f.pending++]=ce}function Ne(f,ce){f.pending_buf[f.pending++]=ce>>>8&255,f.pending_buf[f.pending++]=255&ce}function ke(f,ce){var ee,x,I=f.max_chain_length,G=f.strstart,ue=f.prev_length,me=f.nice_match,z=f.strstart>f.w_size-Oe?f.strstart-(f.w_size-Oe):0,ge=f.window,Ce=f.w_mask,Ee=f.prev,Ue=f.strstart+Se,rt=ge[G+ue-1],Xe=ge[G+ue];f.prev_length>=f.good_match&&(I>>=2),me>f.lookahead&&(me=f.lookahead);do{if(ge[(ee=ce)+ue]===Xe&&ge[ee+ue-1]===rt&&ge[ee]===ge[G]&&ge[++ee]===ge[G+1]){G+=2,ee++;do{}while(ge[++G]===ge[++ee]&&ge[++G]===ge[++ee]&&ge[++G]===ge[++ee]&&ge[++G]===ge[++ee]&&ge[++G]===ge[++ee]&&ge[++G]===ge[++ee]&&ge[++G]===ge[++ee]&&ge[++G]===ge[++ee]&&G<Ue);if(x=Se-(Ue-G),G=Ue-Se,ue<x){if(f.match_start=ce,me<=(ue=x))break;rt=ge[G+ue-1],Xe=ge[G+ue]}}}while((ce=Ee[ce&Ce])>z&&0!=--I);return ue<=f.lookahead?ue:f.lookahead}function Z(f){var ce,ee,x,I,G,ue,me,z,ge,Ce,Ee=f.w_size;do{if(I=f.window_size-f.lookahead-f.strstart,f.strstart>=Ee+(Ee-Oe)){for(b.arraySet(f.window,f.window,Ee,Ee,0),f.match_start-=Ee,f.strstart-=Ee,f.block_start-=Ee,ce=ee=f.hash_size;x=f.head[--ce],f.head[ce]=Ee<=x?x-Ee:0,--ee;);for(ce=ee=Ee;x=f.prev[--ce],f.prev[ce]=Ee<=x?x-Ee:0,--ee;);I+=Ee}if(0===f.strm.avail_in)break;if(me=f.window,z=f.strstart+f.lookahead,Ce=void 0,(ge=I)<(Ce=(ue=f.strm).avail_in)&&(Ce=ge),ee=0===Ce?0:(ue.avail_in-=Ce,b.arraySet(me,ue.input,ue.next_in,Ce,z),1===ue.state.wrap?ue.adler=C(ue.adler,me,Ce,z):2===ue.state.wrap&&(ue.adler=V(ue.adler,me,Ce,z)),ue.next_in+=Ce,ue.total_in+=Ce,Ce),f.lookahead+=ee,f.lookahead+f.insert>=ie)for(f.ins_h=f.window[G=f.strstart-f.insert],f.ins_h=(f.ins_h<<f.hash_shift^f.window[G+1])&f.hash_mask;f.insert&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[G+ie-1])&f.hash_mask,f.prev[G&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=G,G++,f.insert--,!(f.lookahead+f.insert<ie)););}while(f.lookahead<Oe&&0!==f.strm.avail_in)}function it(f,ce){for(var ee,x;;){if(f.lookahead<Oe){if(Z(f),f.lookahead<Oe&&ce===P)return 1;if(0===f.lookahead)break}if(ee=0,f.lookahead>=ie&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+ie-1])&f.hash_mask,ee=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),0!==ee&&f.strstart-ee<=f.w_size-Oe&&(f.match_length=ke(f,ee)),f.match_length>=ie)if(x=p._tr_tally(f,f.strstart-f.match_start,f.match_length-ie),f.lookahead-=f.match_length,f.match_length<=f.max_lazy_match&&f.lookahead>=ie){for(f.match_length--;f.strstart++,f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+ie-1])&f.hash_mask,ee=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart,0!=--f.match_length;);f.strstart++}else f.strstart+=f.match_length,f.match_length=0,f.ins_h=f.window[f.strstart],f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+1])&f.hash_mask;else x=p._tr_tally(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++;if(x&&(J(f,!1),0===f.strm.avail_out))return 1}return f.insert=f.strstart<ie-1?f.strstart:ie-1,4===ce?(J(f,!0),0===f.strm.avail_out?3:4):f.last_lit&&(J(f,!1),0===f.strm.avail_out)?1:2}function Ke(f,ce){for(var ee,x,I;;){if(f.lookahead<Oe){if(Z(f),f.lookahead<Oe&&ce===P)return 1;if(0===f.lookahead)break}if(ee=0,f.lookahead>=ie&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+ie-1])&f.hash_mask,ee=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),f.prev_length=f.match_length,f.prev_match=f.match_start,f.match_length=ie-1,0!==ee&&f.prev_length<f.max_lazy_match&&f.strstart-ee<=f.w_size-Oe&&(f.match_length=ke(f,ee),f.match_length<=5&&(1===f.strategy||f.match_length===ie&&4096<f.strstart-f.match_start)&&(f.match_length=ie-1)),f.prev_length>=ie&&f.match_length<=f.prev_length){for(I=f.strstart+f.lookahead-ie,x=p._tr_tally(f,f.strstart-1-f.prev_match,f.prev_length-ie),f.lookahead-=f.prev_length-1,f.prev_length-=2;++f.strstart<=I&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+ie-1])&f.hash_mask,ee=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),0!=--f.prev_length;);if(f.match_available=0,f.match_length=ie-1,f.strstart++,x&&(J(f,!1),0===f.strm.avail_out))return 1}else if(f.match_available){if((x=p._tr_tally(f,0,f.window[f.strstart-1]))&&J(f,!1),f.strstart++,f.lookahead--,0===f.strm.avail_out)return 1}else f.match_available=1,f.strstart++,f.lookahead--}return f.match_available&&(x=p._tr_tally(f,0,f.window[f.strstart-1]),f.match_available=0),f.insert=f.strstart<ie-1?f.strstart:ie-1,4===ce?(J(f,!0),0===f.strm.avail_out?3:4):f.last_lit&&(J(f,!1),0===f.strm.avail_out)?1:2}function Je(f,ce,ee,x,I){this.good_length=f,this.max_lazy=ce,this.nice_length=ee,this.max_chain=x,this.func=I}function At(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new b.Buf16(2*l),this.dyn_dtree=new b.Buf16(2*(2*A+1)),this.bl_tree=new b.Buf16(2*(2*te+1)),Te(this.dyn_ltree),Te(this.dyn_dtree),Te(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new b.Buf16(ve+1),this.heap=new b.Buf16(2*k+1),Te(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new b.Buf16(2*k+1),Te(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function at(f){var ce;return f&&f.state?(f.total_in=f.total_out=0,f.data_type=g,(ce=f.state).pending=0,ce.pending_out=0,ce.wrap<0&&(ce.wrap=-ce.wrap),ce.status=ce.wrap?R:$,f.adler=2===ce.wrap?0:1,ce.last_flush=P,p._tr_init(ce),w):Ie(f,B)}function Lt(f){var ee,ce=at(f);return ce===w&&((ee=f.state).window_size=2*ee.w_size,Te(ee.head),ee.max_lazy_match=c[ee.level].max_lazy,ee.good_match=c[ee.level].good_length,ee.nice_match=c[ee.level].nice_length,ee.max_chain_length=c[ee.level].max_chain,ee.strstart=0,ee.block_start=0,ee.lookahead=0,ee.insert=0,ee.match_length=ee.prev_length=ie-1,ee.match_available=0,ee.ins_h=0),ce}function Pt(f,ce,ee,x,I,G){if(!f)return B;var ue=1;if(-1===ce&&(ce=6),x<0?(ue=0,x=-x):15<x&&(ue=2,x-=16),I<1||9<I||ee!==S||x<8||15<x||ce<0||9<ce||G<0||4<G)return Ie(f,B);8===x&&(x=9);var me=new At;return(f.state=me).strm=f,me.wrap=ue,me.gzhead=null,me.w_bits=x,me.w_size=1<<me.w_bits,me.w_mask=me.w_size-1,me.hash_bits=I+7,me.hash_size=1<<me.hash_bits,me.hash_mask=me.hash_size-1,me.hash_shift=~~((me.hash_bits+ie-1)/ie),me.window=new b.Buf8(2*me.w_size),me.head=new b.Buf16(me.hash_size),me.prev=new b.Buf16(me.w_size),me.lit_bufsize=1<<I+6,me.pending_buf_size=4*me.lit_bufsize,me.pending_buf=new b.Buf8(me.pending_buf_size),me.d_buf=1*me.lit_bufsize,me.l_buf=3*me.lit_bufsize,me.level=ce,me.strategy=G,me.method=ee,Lt(f)}c=[new Je(0,0,0,0,function(f,ce){var ee=65535;for(ee>f.pending_buf_size-5&&(ee=f.pending_buf_size-5);;){if(f.lookahead<=1){if(Z(f),0===f.lookahead&&ce===P)return 1;if(0===f.lookahead)break}f.strstart+=f.lookahead,f.lookahead=0;var x=f.block_start+ee;if((0===f.strstart||f.strstart>=x)&&(f.lookahead=f.strstart-x,f.strstart=x,J(f,!1),0===f.strm.avail_out)||f.strstart-f.block_start>=f.w_size-Oe&&(J(f,!1),0===f.strm.avail_out))return 1}return f.insert=0,4===ce?(J(f,!0),0===f.strm.avail_out?3:4):(f.strstart>f.block_start&&J(f,!1),1)}),new Je(4,4,8,4,it),new Je(4,5,16,8,it),new Je(4,6,32,32,it),new Je(4,4,16,16,Ke),new Je(8,16,32,32,Ke),new Je(8,16,128,128,Ke),new Je(8,32,128,256,Ke),new Je(32,128,258,1024,Ke),new Je(32,258,258,4096,Ke)],n.deflateInit=function(f,ce){return Pt(f,ce,S,15,8,0)},n.deflateInit2=Pt,n.deflateReset=Lt,n.deflateResetKeep=at,n.deflateSetHeader=function(f,ce){return f&&f.state?2!==f.state.wrap?B:(f.state.gzhead=ce,w):B},n.deflate=function(f,ce){var ee,x,I,G;if(!f||!f.state||5<ce||ce<0)return f?Ie(f,B):B;if(x=f.state,!f.output||!f.input&&0!==f.avail_in||666===x.status&&4!==ce)return Ie(f,0===f.avail_out?-5:B);if(x.strm=f,ee=x.last_flush,x.last_flush=ce,x.status===R)if(2===x.wrap)f.adler=0,_e(x,31),_e(x,139),_e(x,8),x.gzhead?(_e(x,(x.gzhead.text?1:0)+(x.gzhead.hcrc?2:0)+(x.gzhead.extra?4:0)+(x.gzhead.name?8:0)+(x.gzhead.comment?16:0)),_e(x,255&x.gzhead.time),_e(x,x.gzhead.time>>8&255),_e(x,x.gzhead.time>>16&255),_e(x,x.gzhead.time>>24&255),_e(x,9===x.level?2:2<=x.strategy||x.level<2?4:0),_e(x,255&x.gzhead.os),x.gzhead.extra&&x.gzhead.extra.length&&(_e(x,255&x.gzhead.extra.length),_e(x,x.gzhead.extra.length>>8&255)),x.gzhead.hcrc&&(f.adler=V(f.adler,x.pending_buf,x.pending,0)),x.gzindex=0,x.status=69):(_e(x,0),_e(x,0),_e(x,0),_e(x,0),_e(x,0),_e(x,9===x.level?2:2<=x.strategy||x.level<2?4:0),_e(x,3),x.status=$);else{var ue=S+(x.w_bits-8<<4)<<8;ue|=(2<=x.strategy||x.level<2?0:x.level<6?1:6===x.level?2:3)<<6,0!==x.strstart&&(ue|=32),ue+=31-ue%31,x.status=$,Ne(x,ue),0!==x.strstart&&(Ne(x,f.adler>>>16),Ne(x,65535&f.adler)),f.adler=1}if(69===x.status)if(x.gzhead.extra){for(I=x.pending;x.gzindex<(65535&x.gzhead.extra.length)&&(x.pending!==x.pending_buf_size||(x.gzhead.hcrc&&x.pending>I&&(f.adler=V(f.adler,x.pending_buf,x.pending-I,I)),H(f),I=x.pending,x.pending!==x.pending_buf_size));)_e(x,255&x.gzhead.extra[x.gzindex]),x.gzindex++;x.gzhead.hcrc&&x.pending>I&&(f.adler=V(f.adler,x.pending_buf,x.pending-I,I)),x.gzindex===x.gzhead.extra.length&&(x.gzindex=0,x.status=73)}else x.status=73;if(73===x.status)if(x.gzhead.name){I=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>I&&(f.adler=V(f.adler,x.pending_buf,x.pending-I,I)),H(f),I=x.pending,x.pending===x.pending_buf_size)){G=1;break}G=x.gzindex<x.gzhead.name.length?255&x.gzhead.name.charCodeAt(x.gzindex++):0,_e(x,G)}while(0!==G);x.gzhead.hcrc&&x.pending>I&&(f.adler=V(f.adler,x.pending_buf,x.pending-I,I)),0===G&&(x.gzindex=0,x.status=91)}else x.status=91;if(91===x.status)if(x.gzhead.comment){I=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>I&&(f.adler=V(f.adler,x.pending_buf,x.pending-I,I)),H(f),I=x.pending,x.pending===x.pending_buf_size)){G=1;break}G=x.gzindex<x.gzhead.comment.length?255&x.gzhead.comment.charCodeAt(x.gzindex++):0,_e(x,G)}while(0!==G);x.gzhead.hcrc&&x.pending>I&&(f.adler=V(f.adler,x.pending_buf,x.pending-I,I)),0===G&&(x.status=103)}else x.status=103;if(103===x.status&&(x.gzhead.hcrc?(x.pending+2>x.pending_buf_size&&H(f),x.pending+2<=x.pending_buf_size&&(_e(x,255&f.adler),_e(x,f.adler>>8&255),f.adler=0,x.status=$)):x.status=$),0!==x.pending){if(H(f),0===f.avail_out)return x.last_flush=-1,w}else if(0===f.avail_in&&Y(ce)<=Y(ee)&&4!==ce)return Ie(f,-5);if(666===x.status&&0!==f.avail_in)return Ie(f,-5);if(0!==f.avail_in||0!==x.lookahead||ce!==P&&666!==x.status){var me=2===x.strategy?function(z,ge){for(var Ce;;){if(0===z.lookahead&&(Z(z),0===z.lookahead)){if(ge===P)return 1;break}if(z.match_length=0,Ce=p._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,Ce&&(J(z,!1),0===z.strm.avail_out))return 1}return z.insert=0,4===ge?(J(z,!0),0===z.strm.avail_out?3:4):z.last_lit&&(J(z,!1),0===z.strm.avail_out)?1:2}(x,ce):3===x.strategy?function(z,ge){for(var Ce,Ee,Ue,rt,Xe=z.window;;){if(z.lookahead<=Se){if(Z(z),z.lookahead<=Se&&ge===P)return 1;if(0===z.lookahead)break}if(z.match_length=0,z.lookahead>=ie&&0<z.strstart&&(Ee=Xe[Ue=z.strstart-1])===Xe[++Ue]&&Ee===Xe[++Ue]&&Ee===Xe[++Ue]){rt=z.strstart+Se;do{}while(Ee===Xe[++Ue]&&Ee===Xe[++Ue]&&Ee===Xe[++Ue]&&Ee===Xe[++Ue]&&Ee===Xe[++Ue]&&Ee===Xe[++Ue]&&Ee===Xe[++Ue]&&Ee===Xe[++Ue]&&Ue<rt);z.match_length=Se-(rt-Ue),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=ie?(Ce=p._tr_tally(z,1,z.match_length-ie),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(Ce=p._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),Ce&&(J(z,!1),0===z.strm.avail_out))return 1}return z.insert=0,4===ge?(J(z,!0),0===z.strm.avail_out?3:4):z.last_lit&&(J(z,!1),0===z.strm.avail_out)?1:2}(x,ce):c[x.level].func(x,ce);if(3!==me&&4!==me||(x.status=666),1===me||3===me)return 0===f.avail_out&&(x.last_flush=-1),w;if(2===me&&(1===ce?p._tr_align(x):5!==ce&&(p._tr_stored_block(x,0,0,!1),3===ce&&(Te(x.head),0===x.lookahead&&(x.strstart=0,x.block_start=0,x.insert=0))),H(f),0===f.avail_out))return x.last_flush=-1,w}return 4!==ce?w:x.wrap<=0?1:(2===x.wrap?(_e(x,255&f.adler),_e(x,f.adler>>8&255),_e(x,f.adler>>16&255),_e(x,f.adler>>24&255),_e(x,255&f.total_in),_e(x,f.total_in>>8&255),_e(x,f.total_in>>16&255),_e(x,f.total_in>>24&255)):(Ne(x,f.adler>>>16),Ne(x,65535&f.adler)),H(f),0<x.wrap&&(x.wrap=-x.wrap),0!==x.pending?w:1)},n.deflateEnd=function(f){var ce;return f&&f.state?(ce=f.state.status)!==R&&69!==ce&&73!==ce&&91!==ce&&103!==ce&&ce!==$&&666!==ce?Ie(f,B):(f.state=null,ce===$?Ie(f,-3):w):B},n.deflateSetDictionary=function(f,ce){var ee,x,I,G,ue,me,z,ge,Ce=ce.length;if(!f||!f.state||2===(G=(ee=f.state).wrap)||1===G&&ee.status!==R||ee.lookahead)return B;for(1===G&&(f.adler=C(f.adler,ce,Ce,0)),ee.wrap=0,Ce>=ee.w_size&&(0===G&&(Te(ee.head),ee.strstart=0,ee.block_start=0,ee.insert=0),ge=new b.Buf8(ee.w_size),b.arraySet(ge,ce,Ce-ee.w_size,ee.w_size,0),ce=ge,Ce=ee.w_size),ue=f.avail_in,me=f.next_in,z=f.input,f.avail_in=Ce,f.next_in=0,f.input=ce,Z(ee);ee.lookahead>=ie;){for(x=ee.strstart,I=ee.lookahead-(ie-1);ee.ins_h=(ee.ins_h<<ee.hash_shift^ee.window[x+ie-1])&ee.hash_mask,ee.prev[x&ee.w_mask]=ee.head[ee.ins_h],ee.head[ee.ins_h]=x,x++,--I;);ee.strstart=x,ee.lookahead=ie-1,Z(ee)}return ee.strstart+=ee.lookahead,ee.block_start=ee.strstart,ee.insert=ee.lookahead,ee.lookahead=0,ee.match_length=ee.prev_length=ie-1,ee.match_available=0,f.next_in=me,f.input=z,f.avail_in=ue,ee.wrap=G,w},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(M,j,n){"use strict";j.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(M,j,n){"use strict";j.exports=function(c,b){var p,C,V,U,P,F,w,B,y,E,g,S,_,k,A,te,l,ve,ie,Se,Oe,R,$,d,D;d=c.input,V=(C=c.next_in)+(c.avail_in-5),D=c.output,P=(U=c.next_out)-(b-c.avail_out),F=U+(c.avail_out-257),w=(p=c.state).dmax,B=p.wsize,y=p.whave,E=p.wnext,g=p.window,S=p.hold,_=p.bits,k=p.lencode,A=p.distcode,te=(1<<p.lenbits)-1,l=(1<<p.distbits)-1;e:do{_<15&&(S+=d[C++]<<_,S+=d[C++]<<(_+=8),_+=8),ve=k[S&te];t:for(;;){if(S>>>=ie=ve>>>24,_-=ie,0==(ie=ve>>>16&255))D[U++]=65535&ve;else{if(!(16&ie)){if(!(64&ie)){ve=k[(65535&ve)+(S&(1<<ie)-1)];continue t}if(32&ie){p.mode=12;break e}c.msg="invalid literal/length code",p.mode=30;break e}Se=65535&ve,(ie&=15)&&(_<ie&&(S+=d[C++]<<_,_+=8),Se+=S&(1<<ie)-1,S>>>=ie,_-=ie),_<15&&(S+=d[C++]<<_,S+=d[C++]<<(_+=8),_+=8),ve=A[S&l];s:for(;;){if(S>>>=ie=ve>>>24,_-=ie,!(16&(ie=ve>>>16&255))){if(!(64&ie)){ve=A[(65535&ve)+(S&(1<<ie)-1)];continue s}c.msg="invalid distance code",p.mode=30;break e}if(Oe=65535&ve,_<(ie&=15)&&(S+=d[C++]<<_,(_+=8)<ie&&(S+=d[C++]<<_,_+=8)),w<(Oe+=S&(1<<ie)-1)){c.msg="invalid distance too far back",p.mode=30;break e}if(S>>>=ie,_-=ie,(ie=U-P)<Oe){if(y<(ie=Oe-ie)&&p.sane){c.msg="invalid distance too far back",p.mode=30;break e}if($=g,(R=0)===E){if(R+=B-ie,ie<Se){for(Se-=ie;D[U++]=g[R++],--ie;);R=U-Oe,$=D}}else if(E<ie){if(R+=B+E-ie,(ie-=E)<Se){for(Se-=ie;D[U++]=g[R++],--ie;);if(R=0,E<Se){for(Se-=ie=E;D[U++]=g[R++],--ie;);R=U-Oe,$=D}}}else if(R+=E-ie,ie<Se){for(Se-=ie;D[U++]=g[R++],--ie;);R=U-Oe,$=D}for(;2<Se;)D[U++]=$[R++],D[U++]=$[R++],D[U++]=$[R++],Se-=3;Se&&(D[U++]=$[R++],1<Se&&(D[U++]=$[R++]))}else{for(R=U-Oe;D[U++]=D[R++],D[U++]=D[R++],D[U++]=D[R++],2<(Se-=3););Se&&(D[U++]=D[R++],1<Se&&(D[U++]=D[R++]))}break}}break}}while(C<V&&U<F);C-=Se=_>>3,S&=(1<<(_-=Se<<3))-1,c.next_in=C,c.next_out=U,c.avail_in=C<V?V-C+5:5-(C-V),c.avail_out=U<F?F-U+257:257-(U-F),p.hold=S,p.bits=_}},{}],49:[function(M,j,n){"use strict";var c=M("../utils/common"),b=M("./adler32"),p=M("./crc32"),C=M("./inffast"),V=M("./inftrees"),F=0,w=-2,B=1,y=852,E=592;function g(R){return(R>>>24&255)+(R>>>8&65280)+((65280&R)<<8)+((255&R)<<24)}function S(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new c.Buf16(320),this.work=new c.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(R){var $;return R&&R.state?(R.total_in=R.total_out=($=R.state).total=0,R.msg="",$.wrap&&(R.adler=1&$.wrap),$.mode=B,$.last=0,$.havedict=0,$.dmax=32768,$.head=null,$.hold=0,$.bits=0,$.lencode=$.lendyn=new c.Buf32(y),$.distcode=$.distdyn=new c.Buf32(E),$.sane=1,$.back=-1,F):w}function k(R){var $;return R&&R.state?(($=R.state).wsize=0,$.whave=0,$.wnext=0,_(R)):w}function A(R,$){var d,D;return R&&R.state?(D=R.state,$<0?(d=0,$=-$):(d=1+($>>4),$<48&&($&=15)),$&&($<8||15<$)?w:(null!==D.window&&D.wbits!==$&&(D.window=null),D.wrap=d,D.wbits=$,k(R))):w}function te(R,$){var d,D;return R?(D=new S,(R.state=D).window=null,(d=A(R,$))!==F&&(R.state=null),d):w}var l,ve,ie=!0;function Se(R){if(ie){var $;for(l=new c.Buf32(512),ve=new c.Buf32(32),$=0;$<144;)R.lens[$++]=8;for(;$<256;)R.lens[$++]=9;for(;$<280;)R.lens[$++]=7;for(;$<288;)R.lens[$++]=8;for(V(1,R.lens,0,288,l,0,R.work,{bits:9}),$=0;$<32;)R.lens[$++]=5;V(2,R.lens,0,32,ve,0,R.work,{bits:5}),ie=!1}R.lencode=l,R.lenbits=9,R.distcode=ve,R.distbits=5}function Oe(R,$,d,D){var ne,W=R.state;return null===W.window&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new c.Buf8(W.wsize)),D>=W.wsize?(c.arraySet(W.window,$,d-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(D<(ne=W.wsize-W.wnext)&&(ne=D),c.arraySet(W.window,$,d-D,ne,W.wnext),(D-=ne)?(c.arraySet(W.window,$,d-D,D,0),W.wnext=D,W.whave=W.wsize):(W.wnext+=ne,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=ne))),0}n.inflateReset=k,n.inflateReset2=A,n.inflateResetKeep=_,n.inflateInit=function(R){return te(R,15)},n.inflateInit2=te,n.inflate=function(R,$){var d,D,ne,W,Ie,Y,Te,H,J,_e,Ne,ke,Z,it,Ke,Je,At,at,Lt,Pt,f,ce,ee,x,I=0,G=new c.Buf8(4),ue=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!R||!R.state||!R.output||!R.input&&0!==R.avail_in)return w;12===(d=R.state).mode&&(d.mode=13),Ie=R.next_out,ne=R.output,W=R.next_in,D=R.input,H=d.hold,J=d.bits,_e=Y=R.avail_in,Ne=Te=R.avail_out,ce=F;e:for(;;)switch(d.mode){case B:if(0===d.wrap){d.mode=13;break}for(;J<16;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}if(2&d.wrap&&35615===H){G[d.check=0]=255&H,G[1]=H>>>8&255,d.check=p(d.check,G,2,0),J=H=0,d.mode=2;break}if(d.flags=0,d.head&&(d.head.done=!1),!(1&d.wrap)||(((255&H)<<8)+(H>>8))%31){R.msg="incorrect header check",d.mode=30;break}if(8!=(15&H)){R.msg="unknown compression method",d.mode=30;break}if(J-=4,f=8+(15&(H>>>=4)),0===d.wbits)d.wbits=f;else if(f>d.wbits){R.msg="invalid window size",d.mode=30;break}d.dmax=1<<f,R.adler=d.check=1,d.mode=512&H?10:12,J=H=0;break;case 2:for(;J<16;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}if(d.flags=H,8!=(255&d.flags)){R.msg="unknown compression method",d.mode=30;break}if(57344&d.flags){R.msg="unknown header flags set",d.mode=30;break}d.head&&(d.head.text=H>>8&1),512&d.flags&&(G[0]=255&H,G[1]=H>>>8&255,d.check=p(d.check,G,2,0)),J=H=0,d.mode=3;case 3:for(;J<32;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}d.head&&(d.head.time=H),512&d.flags&&(G[0]=255&H,G[1]=H>>>8&255,G[2]=H>>>16&255,G[3]=H>>>24&255,d.check=p(d.check,G,4,0)),J=H=0,d.mode=4;case 4:for(;J<16;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}d.head&&(d.head.xflags=255&H,d.head.os=H>>8),512&d.flags&&(G[0]=255&H,G[1]=H>>>8&255,d.check=p(d.check,G,2,0)),J=H=0,d.mode=5;case 5:if(1024&d.flags){for(;J<16;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}d.length=H,d.head&&(d.head.extra_len=H),512&d.flags&&(G[0]=255&H,G[1]=H>>>8&255,d.check=p(d.check,G,2,0)),J=H=0}else d.head&&(d.head.extra=null);d.mode=6;case 6:if(1024&d.flags&&(Y<(ke=d.length)&&(ke=Y),ke&&(d.head&&(f=d.head.extra_len-d.length,d.head.extra||(d.head.extra=new Array(d.head.extra_len)),c.arraySet(d.head.extra,D,W,ke,f)),512&d.flags&&(d.check=p(d.check,D,ke,W)),Y-=ke,W+=ke,d.length-=ke),d.length))break e;d.length=0,d.mode=7;case 7:if(2048&d.flags){if(0===Y)break e;for(ke=0;f=D[W+ke++],d.head&&f&&d.length<65536&&(d.head.name+=String.fromCharCode(f)),f&&ke<Y;);if(512&d.flags&&(d.check=p(d.check,D,ke,W)),Y-=ke,W+=ke,f)break e}else d.head&&(d.head.name=null);d.length=0,d.mode=8;case 8:if(4096&d.flags){if(0===Y)break e;for(ke=0;f=D[W+ke++],d.head&&f&&d.length<65536&&(d.head.comment+=String.fromCharCode(f)),f&&ke<Y;);if(512&d.flags&&(d.check=p(d.check,D,ke,W)),Y-=ke,W+=ke,f)break e}else d.head&&(d.head.comment=null);d.mode=9;case 9:if(512&d.flags){for(;J<16;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}if(H!==(65535&d.check)){R.msg="header crc mismatch",d.mode=30;break}J=H=0}d.head&&(d.head.hcrc=d.flags>>9&1,d.head.done=!0),R.adler=d.check=0,d.mode=12;break;case 10:for(;J<32;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}R.adler=d.check=g(H),J=H=0,d.mode=11;case 11:if(0===d.havedict)return R.next_out=Ie,R.avail_out=Te,R.next_in=W,R.avail_in=Y,d.hold=H,d.bits=J,2;R.adler=d.check=1,d.mode=12;case 12:if(5===$||6===$)break e;case 13:if(d.last){H>>>=7&J,J-=7&J,d.mode=27;break}for(;J<3;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}switch(d.last=1&H,J-=1,3&(H>>>=1)){case 0:d.mode=14;break;case 1:if(Se(d),d.mode=20,6!==$)break;H>>>=2,J-=2;break e;case 2:d.mode=17;break;case 3:R.msg="invalid block type",d.mode=30}H>>>=2,J-=2;break;case 14:for(H>>>=7&J,J-=7&J;J<32;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}if((65535&H)!=(H>>>16^65535)){R.msg="invalid stored block lengths",d.mode=30;break}if(d.length=65535&H,J=H=0,d.mode=15,6===$)break e;case 15:d.mode=16;case 16:if(ke=d.length){if(Y<ke&&(ke=Y),Te<ke&&(ke=Te),0===ke)break e;c.arraySet(ne,D,W,ke,Ie),Y-=ke,W+=ke,Te-=ke,Ie+=ke,d.length-=ke;break}d.mode=12;break;case 17:for(;J<14;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}if(d.nlen=257+(31&H),J-=5,d.ndist=1+(31&(H>>>=5)),J-=5,d.ncode=4+(15&(H>>>=5)),H>>>=4,J-=4,286<d.nlen||30<d.ndist){R.msg="too many length or distance symbols",d.mode=30;break}d.have=0,d.mode=18;case 18:for(;d.have<d.ncode;){for(;J<3;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}d.lens[ue[d.have++]]=7&H,H>>>=3,J-=3}for(;d.have<19;)d.lens[ue[d.have++]]=0;if(d.lencode=d.lendyn,d.lenbits=7,ce=V(0,d.lens,0,19,d.lencode,0,d.work,ee={bits:d.lenbits}),d.lenbits=ee.bits,ce){R.msg="invalid code lengths set",d.mode=30;break}d.have=0,d.mode=19;case 19:for(;d.have<d.nlen+d.ndist;){for(;Je=(I=d.lencode[H&(1<<d.lenbits)-1])>>>16&255,At=65535&I,!((Ke=I>>>24)<=J);){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}if(At<16)H>>>=Ke,J-=Ke,d.lens[d.have++]=At;else{if(16===At){for(x=Ke+2;J<x;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}if(H>>>=Ke,J-=Ke,0===d.have){R.msg="invalid bit length repeat",d.mode=30;break}f=d.lens[d.have-1],ke=3+(3&H),H>>>=2,J-=2}else if(17===At){for(x=Ke+3;J<x;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}J-=Ke,f=0,ke=3+(7&(H>>>=Ke)),H>>>=3,J-=3}else{for(x=Ke+7;J<x;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}J-=Ke,f=0,ke=11+(127&(H>>>=Ke)),H>>>=7,J-=7}if(d.have+ke>d.nlen+d.ndist){R.msg="invalid bit length repeat",d.mode=30;break}for(;ke--;)d.lens[d.have++]=f}}if(30===d.mode)break;if(0===d.lens[256]){R.msg="invalid code -- missing end-of-block",d.mode=30;break}if(d.lenbits=9,ce=V(1,d.lens,0,d.nlen,d.lencode,0,d.work,ee={bits:d.lenbits}),d.lenbits=ee.bits,ce){R.msg="invalid literal/lengths set",d.mode=30;break}if(d.distbits=6,d.distcode=d.distdyn,ce=V(2,d.lens,d.nlen,d.ndist,d.distcode,0,d.work,ee={bits:d.distbits}),d.distbits=ee.bits,ce){R.msg="invalid distances set",d.mode=30;break}if(d.mode=20,6===$)break e;case 20:d.mode=21;case 21:if(6<=Y&&258<=Te){R.next_out=Ie,R.avail_out=Te,R.next_in=W,R.avail_in=Y,d.hold=H,d.bits=J,C(R,Ne),Ie=R.next_out,ne=R.output,Te=R.avail_out,W=R.next_in,D=R.input,Y=R.avail_in,H=d.hold,J=d.bits,12===d.mode&&(d.back=-1);break}for(d.back=0;Je=(I=d.lencode[H&(1<<d.lenbits)-1])>>>16&255,At=65535&I,!((Ke=I>>>24)<=J);){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}if(Je&&!(240&Je)){for(at=Ke,Lt=Je,Pt=At;Je=(I=d.lencode[Pt+((H&(1<<at+Lt)-1)>>at)])>>>16&255,At=65535&I,!(at+(Ke=I>>>24)<=J);){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}H>>>=at,J-=at,d.back+=at}if(H>>>=Ke,J-=Ke,d.back+=Ke,d.length=At,0===Je){d.mode=26;break}if(32&Je){d.back=-1,d.mode=12;break}if(64&Je){R.msg="invalid literal/length code",d.mode=30;break}d.extra=15&Je,d.mode=22;case 22:if(d.extra){for(x=d.extra;J<x;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}d.length+=H&(1<<d.extra)-1,H>>>=d.extra,J-=d.extra,d.back+=d.extra}d.was=d.length,d.mode=23;case 23:for(;Je=(I=d.distcode[H&(1<<d.distbits)-1])>>>16&255,At=65535&I,!((Ke=I>>>24)<=J);){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}if(!(240&Je)){for(at=Ke,Lt=Je,Pt=At;Je=(I=d.distcode[Pt+((H&(1<<at+Lt)-1)>>at)])>>>16&255,At=65535&I,!(at+(Ke=I>>>24)<=J);){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}H>>>=at,J-=at,d.back+=at}if(H>>>=Ke,J-=Ke,d.back+=Ke,64&Je){R.msg="invalid distance code",d.mode=30;break}d.offset=At,d.extra=15&Je,d.mode=24;case 24:if(d.extra){for(x=d.extra;J<x;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}d.offset+=H&(1<<d.extra)-1,H>>>=d.extra,J-=d.extra,d.back+=d.extra}if(d.offset>d.dmax){R.msg="invalid distance too far back",d.mode=30;break}d.mode=25;case 25:if(0===Te)break e;if(d.offset>(ke=Ne-Te)){if((ke=d.offset-ke)>d.whave&&d.sane){R.msg="invalid distance too far back",d.mode=30;break}Z=ke>d.wnext?d.wsize-(ke-=d.wnext):d.wnext-ke,ke>d.length&&(ke=d.length),it=d.window}else it=ne,Z=Ie-d.offset,ke=d.length;for(Te<ke&&(ke=Te),Te-=ke,d.length-=ke;ne[Ie++]=it[Z++],--ke;);0===d.length&&(d.mode=21);break;case 26:if(0===Te)break e;ne[Ie++]=d.length,Te--,d.mode=21;break;case 27:if(d.wrap){for(;J<32;){if(0===Y)break e;Y--,H|=D[W++]<<J,J+=8}if(R.total_out+=Ne-=Te,d.total+=Ne,Ne&&(R.adler=d.check=d.flags?p(d.check,ne,Ne,Ie-Ne):b(d.check,ne,Ne,Ie-Ne)),Ne=Te,(d.flags?H:g(H))!==d.check){R.msg="incorrect data check",d.mode=30;break}J=H=0}d.mode=28;case 28:if(d.wrap&&d.flags){for(;J<32;){if(0===Y)break e;Y--,H+=D[W++]<<J,J+=8}if(H!==(4294967295&d.total)){R.msg="incorrect length check",d.mode=30;break}J=H=0}d.mode=29;case 29:ce=1;break e;case 30:ce=-3;break e;case 31:return-4;default:return w}return R.next_out=Ie,R.avail_out=Te,R.next_in=W,R.avail_in=Y,d.hold=H,d.bits=J,(d.wsize||Ne!==R.avail_out&&d.mode<30&&(d.mode<27||4!==$))&&Oe(R,R.output,R.next_out,Ne-R.avail_out)?(d.mode=31,-4):(Ne-=R.avail_out,R.total_in+=_e-=R.avail_in,R.total_out+=Ne,d.total+=Ne,d.wrap&&Ne&&(R.adler=d.check=d.flags?p(d.check,ne,Ne,R.next_out-Ne):b(d.check,ne,Ne,R.next_out-Ne)),R.data_type=d.bits+(d.last?64:0)+(12===d.mode?128:0)+(20===d.mode||15===d.mode?256:0),(0==_e&&0===Ne||4===$)&&ce===F&&(ce=-5),ce)},n.inflateEnd=function(R){if(!R||!R.state)return w;var $=R.state;return $.window&&($.window=null),R.state=null,F},n.inflateGetHeader=function(R,$){var d;return R&&R.state&&2&(d=R.state).wrap?((d.head=$).done=!1,F):w},n.inflateSetDictionary=function(R,$){var d,D=$.length;return R&&R.state?0!==(d=R.state).wrap&&11!==d.mode?w:11===d.mode&&b(1,$,D,0)!==d.check?-3:Oe(R,$,D,D)?(d.mode=31,-4):(d.havedict=1,F):w},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(M,j,n){"use strict";var c=M("../utils/common"),b=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],V=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];j.exports=function(U,P,F,w,B,y,E,g){var S,_,k,A,te,l,ve,ie,Se,Oe=g.bits,R=0,$=0,d=0,D=0,ne=0,W=0,Ie=0,Y=0,Te=0,H=0,J=null,_e=0,Ne=new c.Buf16(16),ke=new c.Buf16(16),Z=null,it=0;for(R=0;R<=15;R++)Ne[R]=0;for($=0;$<w;$++)Ne[P[F+$]]++;for(ne=Oe,D=15;1<=D&&0===Ne[D];D--);if(D<ne&&(ne=D),0===D)return B[y++]=20971520,B[y++]=20971520,g.bits=1,0;for(d=1;d<D&&0===Ne[d];d++);for(ne<d&&(ne=d),R=Y=1;R<=15;R++)if(Y<<=1,(Y-=Ne[R])<0)return-1;if(0<Y&&(0===U||1!==D))return-1;for(ke[1]=0,R=1;R<15;R++)ke[R+1]=ke[R]+Ne[R];for($=0;$<w;$++)0!==P[F+$]&&(E[ke[P[F+$]]++]=$);if(l=0===U?(J=Z=E,19):1===U?(J=b,_e-=257,Z=p,it-=257,256):(J=C,Z=V,-1),R=d,te=y,Ie=$=H=0,k=-1,A=(Te=1<<(W=ne))-1,1===U&&852<Te||2===U&&592<Te)return 1;for(;;){for(ve=R-Ie,Se=E[$]<l?(ie=0,E[$]):E[$]>l?(ie=Z[it+E[$]],J[_e+E[$]]):(ie=96,0),S=1<<R-Ie,d=_=1<<W;B[te+(H>>Ie)+(_-=S)]=ve<<24|ie<<16|Se,0!==_;);for(S=1<<R-1;H&S;)S>>=1;if(0!==S?(H&=S-1,H+=S):H=0,$++,0==--Ne[R]){if(R===D)break;R=P[F+E[$]]}if(ne<R&&(H&A)!==k){for(0===Ie&&(Ie=ne),te+=d,Y=1<<(W=R-Ie);W+Ie<D&&!((Y-=Ne[W+Ie])<=0);)W++,Y<<=1;if(Te+=1<<W,1===U&&852<Te||2===U&&592<Te)return 1;B[k=H&A]=ne<<24|W<<16|te-y}}return 0!==H&&(B[te+H]=R-Ie<<24|64<<16),g.bits=ne,0}},{"../utils/common":41}],51:[function(M,j,n){"use strict";j.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(M,j,n){"use strict";var c=M("../utils/common");function C(I){for(var G=I.length;0<=--G;)I[G]=0}var P=256,F=286,w=30,E=15,g=16,l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ve=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Oe=new Array(576);C(Oe);var R=new Array(60);C(R);var $=new Array(512);C($);var d=new Array(256);C(d);var D=new Array(29);C(D);var ne,W,Ie,Y=new Array(w);function Te(I,G,ue,me,z){this.static_tree=I,this.extra_bits=G,this.extra_base=ue,this.elems=me,this.max_length=z,this.has_stree=I&&I.length}function H(I,G){this.dyn_tree=I,this.max_code=0,this.stat_desc=G}function J(I){return I<256?$[I]:$[256+(I>>>7)]}function _e(I,G){I.pending_buf[I.pending++]=255&G,I.pending_buf[I.pending++]=G>>>8&255}function Ne(I,G,ue){I.bi_valid>g-ue?(I.bi_buf|=G<<I.bi_valid&65535,_e(I,I.bi_buf),I.bi_buf=G>>g-I.bi_valid,I.bi_valid+=ue-g):(I.bi_buf|=G<<I.bi_valid&65535,I.bi_valid+=ue)}function ke(I,G,ue){Ne(I,ue[2*G],ue[2*G+1])}function Z(I,G){for(var ue=0;ue|=1&I,I>>>=1,ue<<=1,0<--G;);return ue>>>1}function it(I,G,ue){var me,z,ge=new Array(E+1),Ce=0;for(me=1;me<=E;me++)ge[me]=Ce=Ce+ue[me-1]<<1;for(z=0;z<=G;z++){var Ee=I[2*z+1];0!==Ee&&(I[2*z]=Z(ge[Ee]++,Ee))}}function Ke(I){var G;for(G=0;G<F;G++)I.dyn_ltree[2*G]=0;for(G=0;G<w;G++)I.dyn_dtree[2*G]=0;for(G=0;G<19;G++)I.bl_tree[2*G]=0;I.dyn_ltree[512]=1,I.opt_len=I.static_len=0,I.last_lit=I.matches=0}function Je(I){8<I.bi_valid?_e(I,I.bi_buf):0<I.bi_valid&&(I.pending_buf[I.pending++]=I.bi_buf),I.bi_buf=0,I.bi_valid=0}function At(I,G,ue,me){var z=2*G,ge=2*ue;return I[z]<I[ge]||I[z]===I[ge]&&me[G]<=me[ue]}function at(I,G,ue){for(var me=I.heap[ue],z=ue<<1;z<=I.heap_len&&(z<I.heap_len&&At(G,I.heap[z+1],I.heap[z],I.depth)&&z++,!At(G,me,I.heap[z],I.depth));)I.heap[ue]=I.heap[z],ue=z,z<<=1;I.heap[ue]=me}function Lt(I,G,ue){var me,z,ge,Ce,Ee=0;if(0!==I.last_lit)for(;me=I.pending_buf[I.d_buf+2*Ee]<<8|I.pending_buf[I.d_buf+2*Ee+1],z=I.pending_buf[I.l_buf+Ee],Ee++,0===me?ke(I,z,G):(ke(I,(ge=d[z])+P+1,G),0!==(Ce=l[ge])&&Ne(I,z-=D[ge],Ce),ke(I,ge=J(--me),ue),0!==(Ce=ve[ge])&&Ne(I,me-=Y[ge],Ce)),Ee<I.last_lit;);ke(I,256,G)}function Pt(I,G){var ue,me,z,ge=G.dyn_tree,Ce=G.stat_desc.static_tree,Ee=G.stat_desc.has_stree,Ue=G.stat_desc.elems,rt=-1;for(I.heap_len=0,I.heap_max=573,ue=0;ue<Ue;ue++)0!==ge[2*ue]?(I.heap[++I.heap_len]=rt=ue,I.depth[ue]=0):ge[2*ue+1]=0;for(;I.heap_len<2;)ge[2*(z=I.heap[++I.heap_len]=rt<2?++rt:0)]=1,I.depth[z]=0,I.opt_len--,Ee&&(I.static_len-=Ce[2*z+1]);for(G.max_code=rt,ue=I.heap_len>>1;1<=ue;ue--)at(I,ge,ue);for(z=Ue;ue=I.heap[1],I.heap[1]=I.heap[I.heap_len--],at(I,ge,1),me=I.heap[1],I.heap[--I.heap_max]=ue,I.heap[--I.heap_max]=me,ge[2*z]=ge[2*ue]+ge[2*me],I.depth[z]=(I.depth[ue]>=I.depth[me]?I.depth[ue]:I.depth[me])+1,ge[2*ue+1]=ge[2*me+1]=z,I.heap[1]=z++,at(I,ge,1),2<=I.heap_len;);I.heap[--I.heap_max]=I.heap[1],function(Xe,Et){var $t,pt,Si,yt,Be,It,Kt=Et.dyn_tree,xl=Et.max_code,eu=Et.stat_desc.static_tree,Vl=Et.stat_desc.has_stree,Le=Et.stat_desc.extra_bits,Ol=Et.stat_desc.extra_base,Gt=Et.stat_desc.max_length,ct=0;for(yt=0;yt<=E;yt++)Xe.bl_count[yt]=0;for(Kt[2*Xe.heap[Xe.heap_max]+1]=0,$t=Xe.heap_max+1;$t<573;$t++)Gt<(yt=Kt[2*Kt[2*(pt=Xe.heap[$t])+1]+1]+1)&&(yt=Gt,ct++),Kt[2*pt+1]=yt,xl<pt||(Xe.bl_count[yt]++,Be=0,Ol<=pt&&(Be=Le[pt-Ol]),Xe.opt_len+=(It=Kt[2*pt])*(yt+Be),Vl&&(Xe.static_len+=It*(eu[2*pt+1]+Be)));if(0!==ct){do{for(yt=Gt-1;0===Xe.bl_count[yt];)yt--;Xe.bl_count[yt]--,Xe.bl_count[yt+1]+=2,Xe.bl_count[Gt]--,ct-=2}while(0<ct);for(yt=Gt;0!==yt;yt--)for(pt=Xe.bl_count[yt];0!==pt;)xl<(Si=Xe.heap[--$t])||(Kt[2*Si+1]!==yt&&(Xe.opt_len+=(yt-Kt[2*Si+1])*Kt[2*Si],Kt[2*Si+1]=yt),pt--)}}(I,G),it(ge,rt,I.bl_count)}function f(I,G,ue){var me,z,ge=-1,Ce=G[1],Ee=0,Ue=7,rt=4;for(0===Ce&&(Ue=138,rt=3),G[2*(ue+1)+1]=65535,me=0;me<=ue;me++)z=Ce,Ce=G[2*(me+1)+1],++Ee<Ue&&z===Ce||(Ee<rt?I.bl_tree[2*z]+=Ee:0!==z?(z!==ge&&I.bl_tree[2*z]++,I.bl_tree[32]++):Ee<=10?I.bl_tree[34]++:I.bl_tree[36]++,ge=z,rt=(Ee=0)===Ce?(Ue=138,3):z===Ce?(Ue=6,3):(Ue=7,4))}function ce(I,G,ue){var me,z,ge=-1,Ce=G[1],Ee=0,Ue=7,rt=4;for(0===Ce&&(Ue=138,rt=3),me=0;me<=ue;me++)if(z=Ce,Ce=G[2*(me+1)+1],!(++Ee<Ue&&z===Ce)){if(Ee<rt)for(;ke(I,z,I.bl_tree),0!=--Ee;);else 0!==z?(z!==ge&&(ke(I,z,I.bl_tree),Ee--),ke(I,16,I.bl_tree),Ne(I,Ee-3,2)):Ee<=10?(ke(I,17,I.bl_tree),Ne(I,Ee-3,3)):(ke(I,18,I.bl_tree),Ne(I,Ee-11,7));ge=z,rt=(Ee=0)===Ce?(Ue=138,3):z===Ce?(Ue=6,3):(Ue=7,4)}}C(Y);var ee=!1;function x(I,G,ue,me){var z,ge,Ce;Ne(I,0+(me?1:0),3),ge=G,Ce=ue,Je(z=I),_e(z,Ce),_e(z,~Ce),c.arraySet(z.pending_buf,z.window,ge,Ce,z.pending),z.pending+=Ce}n._tr_init=function(I){ee||(function(){var G,ue,me,z,ge,Ce=new Array(E+1);for(z=me=0;z<28;z++)for(D[z]=me,G=0;G<1<<l[z];G++)d[me++]=z;for(d[me-1]=z,z=ge=0;z<16;z++)for(Y[z]=ge,G=0;G<1<<ve[z];G++)$[ge++]=z;for(ge>>=7;z<w;z++)for(Y[z]=ge<<7,G=0;G<1<<ve[z]-7;G++)$[256+ge++]=z;for(ue=0;ue<=E;ue++)Ce[ue]=0;for(G=0;G<=143;)Oe[2*G+1]=8,G++,Ce[8]++;for(;G<=255;)Oe[2*G+1]=9,G++,Ce[9]++;for(;G<=279;)Oe[2*G+1]=7,G++,Ce[7]++;for(;G<=287;)Oe[2*G+1]=8,G++,Ce[8]++;for(it(Oe,287,Ce),G=0;G<w;G++)R[2*G+1]=5,R[2*G]=Z(G,5);ne=new Te(Oe,l,257,F,E),W=new Te(R,ve,0,w,E),Ie=new Te(new Array(0),ie,0,19,7)}(),ee=!0),I.l_desc=new H(I.dyn_ltree,ne),I.d_desc=new H(I.dyn_dtree,W),I.bl_desc=new H(I.bl_tree,Ie),I.bi_buf=0,I.bi_valid=0,Ke(I)},n._tr_stored_block=x,n._tr_flush_block=function(I,G,ue,me){var z,ge,Ce=0;0<I.level?(2===I.strm.data_type&&(I.strm.data_type=function(Ee){var Ue,rt=4093624447;for(Ue=0;Ue<=31;Ue++,rt>>>=1)if(1&rt&&0!==Ee.dyn_ltree[2*Ue])return 0;if(0!==Ee.dyn_ltree[18]||0!==Ee.dyn_ltree[20]||0!==Ee.dyn_ltree[26])return 1;for(Ue=32;Ue<P;Ue++)if(0!==Ee.dyn_ltree[2*Ue])return 1;return 0}(I)),Pt(I,I.l_desc),Pt(I,I.d_desc),Ce=function(Ee){var Ue;for(f(Ee,Ee.dyn_ltree,Ee.l_desc.max_code),f(Ee,Ee.dyn_dtree,Ee.d_desc.max_code),Pt(Ee,Ee.bl_desc),Ue=18;3<=Ue&&0===Ee.bl_tree[2*Se[Ue]+1];Ue--);return Ee.opt_len+=3*(Ue+1)+5+5+4,Ue}(I),(ge=I.static_len+3+7>>>3)<=(z=I.opt_len+3+7>>>3)&&(z=ge)):z=ge=ue+5,ue+4<=z&&-1!==G?x(I,G,ue,me):4===I.strategy||ge===z?(Ne(I,2+(me?1:0),3),Lt(I,Oe,R)):(Ne(I,4+(me?1:0),3),function(Ee,Ue,rt,Xe){var Et;for(Ne(Ee,Ue-257,5),Ne(Ee,rt-1,5),Ne(Ee,Xe-4,4),Et=0;Et<Xe;Et++)Ne(Ee,Ee.bl_tree[2*Se[Et]+1],3);ce(Ee,Ee.dyn_ltree,Ue-1),ce(Ee,Ee.dyn_dtree,rt-1)}(I,I.l_desc.max_code+1,I.d_desc.max_code+1,Ce+1),Lt(I,I.dyn_ltree,I.dyn_dtree)),Ke(I),me&&Je(I)},n._tr_tally=function(I,G,ue){return I.pending_buf[I.d_buf+2*I.last_lit]=G>>>8&255,I.pending_buf[I.d_buf+2*I.last_lit+1]=255&G,I.pending_buf[I.l_buf+I.last_lit]=255&ue,I.last_lit++,0===G?I.dyn_ltree[2*ue]++:(I.matches++,G--,I.dyn_ltree[2*(d[ue]+P+1)]++,I.dyn_dtree[2*J(G)]++),I.last_lit===I.lit_bufsize-1},n._tr_align=function(I){var G;Ne(I,2,3),ke(I,256,Oe),16===(G=I).bi_valid?(_e(G,G.bi_buf),G.bi_buf=0,G.bi_valid=0):8<=G.bi_valid&&(G.pending_buf[G.pending++]=255&G.bi_buf,G.bi_buf>>=8,G.bi_valid-=8)}},{"../utils/common":41}],53:[function(M,j,n){"use strict";j.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(M,j,n){(function(c){!function(b,p){"use strict";if(!b.setImmediate){var C,V,U,P,F=1,w={},B=!1,y=b.document,E=Object.getPrototypeOf&&Object.getPrototypeOf(b);E=E&&E.setTimeout?E:b,C="[object process]"==={}.toString.call(b.process)?function(k){process.nextTick(function(){S(k)})}:function(){if(b.postMessage&&!b.importScripts){var k=!0,A=b.onmessage;return b.onmessage=function(){k=!1},b.postMessage("","*"),b.onmessage=A,k}}()?(P="setImmediate$"+Math.random()+"$",b.addEventListener?b.addEventListener("message",_,!1):b.attachEvent("onmessage",_),function(k){b.postMessage(P+k,"*")}):b.MessageChannel?((U=new MessageChannel).port1.onmessage=function(k){S(k.data)},function(k){U.port2.postMessage(k)}):y&&"onreadystatechange"in y.createElement("script")?(V=y.documentElement,function(k){var A=y.createElement("script");A.onreadystatechange=function(){S(k),A.onreadystatechange=null,V.removeChild(A),A=null},V.appendChild(A)}):function(k){setTimeout(S,0,k)},E.setImmediate=function(k){"function"!=typeof k&&(k=new Function(""+k));for(var A=new Array(arguments.length-1),te=0;te<A.length;te++)A[te]=arguments[te+1];return w[F]={callback:k,args:A},C(F),F++},E.clearImmediate=g}function g(k){delete w[k]}function S(k){if(B)setTimeout(S,0,k);else{var A=w[k];if(A){B=!0;try{!function(te){var l=te.callback,ve=te.args;switch(ve.length){case 0:l();break;case 1:l(ve[0]);break;case 2:l(ve[0],ve[1]);break;case 3:l(ve[0],ve[1],ve[2]);break;default:l.apply(p,ve)}}(A)}finally{g(k),B=!1}}}}function _(k){k.source===b&&"string"==typeof k.data&&0===k.data.indexOf(P)&&S(+k.data.slice(P.length))}}(typeof self>"u"?void 0===c?this:c:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)},153:(Nt,M)=>{"use strict";class c{static isArrayBuffer(g){return"[object ArrayBuffer]"===Object.prototype.toString.call(g)}static toArrayBuffer(g){return this.isArrayBuffer(g)?g:g.byteLength===g.buffer.byteLength||0===g.byteOffset&&g.byteLength===g.buffer.byteLength?g.buffer:this.toUint8Array(g.buffer).slice(g.byteOffset,g.byteOffset+g.byteLength).buffer}static toUint8Array(g){return this.toView(g,Uint8Array)}static toView(g,S){if(g.constructor===S)return g;if(this.isArrayBuffer(g))return new S(g);if(this.isArrayBufferView(g))return new S(g.buffer,g.byteOffset,g.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(g){return this.isArrayBufferView(g)||this.isArrayBuffer(g)}static isArrayBufferView(g){return ArrayBuffer.isView(g)||g&&this.isArrayBuffer(g.buffer)}static isEqual(g,S){const _=c.toUint8Array(g),k=c.toUint8Array(S);if(_.length!==k.byteLength)return!1;for(let A=0;A<_.length;A++)if(_[A]!==k[A])return!1;return!0}static concat(...g){let S;S=Array.isArray(g[0])&&!(g[1]instanceof Function)||Array.isArray(g[0])&&g[1]instanceof Function?g[0]:g[g.length-1]instanceof Function?g.slice(0,g.length-1):g;let _=0;for(const te of S)_+=te.byteLength;const k=new Uint8Array(_);let A=0;for(const te of S){const l=this.toUint8Array(te);k.set(l,A),A+=l.length}return g[g.length-1]instanceof Function?this.toView(k,g[g.length-1]):k.buffer}}const b="string",p=/^[0-9a-f]+$/i,C=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,V=/^[a-zA-Z0-9-_]+$/;class U{static fromString(g){const S=unescape(encodeURIComponent(g)),_=new Uint8Array(S.length);for(let k=0;k<S.length;k++)_[k]=S.charCodeAt(k);return _.buffer}static toString(g){const S=c.toUint8Array(g);let _="";for(let A=0;A<S.length;A++)_+=String.fromCharCode(S[A]);return decodeURIComponent(escape(_))}}class P{static toString(g,S=!1){const _=c.toArrayBuffer(g),k=new DataView(_);let A="";for(let te=0;te<_.byteLength;te+=2){const l=k.getUint16(te,S);A+=String.fromCharCode(l)}return A}static fromString(g,S=!1){const _=new ArrayBuffer(2*g.length),k=new DataView(_);for(let A=0;A<g.length;A++)k.setUint16(2*A,g.charCodeAt(A),S);return _}}let F=(()=>{class E{static isHex(S){return typeof S===b&&p.test(S)}static isBase64(S){return typeof S===b&&C.test(S)}static isBase64Url(S){return typeof S===b&&V.test(S)}static ToString(S,_="utf8"){const k=c.toUint8Array(S);switch(_.toLowerCase()){case"utf8":return this.ToUtf8String(k);case"binary":return this.ToBinary(k);case"hex":return this.ToHex(k);case"base64":return this.ToBase64(k);case"base64url":return this.ToBase64Url(k);case"utf16le":return P.toString(k,!0);case"utf16":case"utf16be":return P.toString(k);default:throw new Error(`Unknown type of encoding '${_}'`)}}static FromString(S,_="utf8"){if(!S)return new ArrayBuffer(0);switch(_.toLowerCase()){case"utf8":return this.FromUtf8String(S);case"binary":return this.FromBinary(S);case"hex":return this.FromHex(S);case"base64":return this.FromBase64(S);case"base64url":return this.FromBase64Url(S);case"utf16le":return P.fromString(S,!0);case"utf16":case"utf16be":return P.fromString(S);default:throw new Error(`Unknown type of encoding '${_}'`)}}static ToBase64(S){const _=c.toUint8Array(S);if(typeof btoa<"u"){const k=this.ToString(_,"binary");return btoa(k)}return Buffer.from(_).toString("base64")}static FromBase64(S){const _=this.formatString(S);if(!_)return new ArrayBuffer(0);if(!E.isBase64(_))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(_)):new Uint8Array(Buffer.from(_,"base64")).buffer}static FromBase64Url(S){const _=this.formatString(S);if(!_)return new ArrayBuffer(0);if(!E.isBase64Url(_))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(_.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(S){return this.ToBase64(S).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(S,_=E.DEFAULT_UTF8_ENCODING){switch(_){case"ascii":return this.FromBinary(S);case"utf8":return U.fromString(S);case"utf16":case"utf16be":return P.fromString(S);case"utf16le":case"usc2":return P.fromString(S,!0);default:throw new Error(`Unknown type of encoding '${_}'`)}}static ToUtf8String(S,_=E.DEFAULT_UTF8_ENCODING){switch(_){case"ascii":return this.ToBinary(S);case"utf8":return U.toString(S);case"utf16":case"utf16be":return P.toString(S);case"utf16le":case"usc2":return P.toString(S,!0);default:throw new Error(`Unknown type of encoding '${_}'`)}}static FromBinary(S){const _=S.length,k=new Uint8Array(_);for(let A=0;A<_;A++)k[A]=S.charCodeAt(A);return k.buffer}static ToBinary(S){const _=c.toUint8Array(S);let k="";for(let A=0;A<_.length;A++)k+=String.fromCharCode(_[A]);return k}static ToHex(S){const _=c.toUint8Array(S);let k="";const A=_.length;for(let te=0;te<A;te++){const l=_[te];l<16&&(k+="0"),k+=l.toString(16)}return k}static FromHex(S){let _=this.formatString(S);if(!_)return new ArrayBuffer(0);if(!E.isHex(_))throw new TypeError("Argument 'hexString' is not HEX encoded");_.length%2&&(_=`0${_}`);const k=new Uint8Array(_.length/2);for(let A=0;A<_.length;A+=2){const te=_.slice(A,A+2);k[A/2]=parseInt(te,16)}return k.buffer}static ToUtf16String(S,_=!1){return P.toString(S,_)}static FromUtf16String(S,_=!1){return P.fromString(S,_)}static Base64Padding(S){const _=4-S.length%4;if(_<4)for(let k=0;k<_;k++)S+="=";return S}static formatString(S){return S?.replace(/[\n\r\t ]/g,"")||""}}return E.DEFAULT_UTF8_ENCODING="utf8",E})();M._H=c,M.U$=F}}]);