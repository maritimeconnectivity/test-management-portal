(self.webpackChunkmanagement_portal_clr=self.webpackChunkmanagement_portal_clr||[]).push([[660],{6482:(_t,F,$)=>{"use strict";$.d(F,{u:()=>v});var n=$(6994),A=$(6488).X.RoleNameEnum,m=function(p){return p[p.User=1]="User",p[p.OrgAdmin=2]="OrgAdmin",p[p.SiteAdmin=4]="SiteAdmin",p[p.UserAdmin=8]="UserAdmin",p[p.VesselAdmin=16]="VesselAdmin",p[p.ServiceAdmin=32]="ServiceAdmin",p[p.DeviceAdmin=64]="DeviceAdmin",p[p.MMSAdmin=128]="MMSAdmin",p[p.ApproveOrg=256]="ApproveOrg",p[p.EntityAdmin=512]="EntityAdmin",p}(m||{});class M{static isSiteAdmin(S){return(S&m.SiteAdmin)>0}static isOrgAdmin(S){return(S&m.OrgAdmin)>0||this.isSiteAdmin(S)}static isEntityAdmin(S){return(S&m.EntityAdmin)>0||this.isOrgAdmin(S)}static isUserAdmin(S){return(S&m.UserAdmin)>0||this.isEntityAdmin(S)}static isVesselAdmin(S){return(S&m.VesselAdmin)>0||this.isEntityAdmin(S)}static isDeviceAdmin(S){return(S&m.DeviceAdmin)>0||this.isEntityAdmin(S)}static isServiceAdmin(S){return(S&m.ServiceAdmin)>0||this.isEntityAdmin(S)}static canApproveOrg(S){return(S&m.ApproveOrg)>0||this.isSiteAdmin(S)}static isMSRAdmin(S){return S&&S.length>0&&S.includes("admin")}static isLedgerAdmin(S){return S&&S.length>0&&S.includes("ledger_admin")}static isOrgServiceAdmin(S){return S&&S.length>0&&S.includes("service_admin")}}const O=(p,S)=>{switch(S){case m.User:return!0;case m.SiteAdmin:return M.isSiteAdmin(p);case m.OrgAdmin:return M.isOrgAdmin(p);case m.ApproveOrg:return M.canApproveOrg(p);case m.EntityAdmin:return M.isEntityAdmin(p);case m.ServiceAdmin:return M.isServiceAdmin(p);case m.DeviceAdmin:return M.isDeviceAdmin(p);case m.VesselAdmin:return M.isVesselAdmin(p);case m.UserAdmin:return M.isUserAdmin(p);default:return!1}};var T=$(5166),y=$(8974),I=$(5950),b=$(2514),k=$(8745);let v=(()=>{class p{constructor(C,E){this.keycloakService=C,this.router=E,this.isAuthenticatedSubject=new y.t(!1),this.isAuthenticated$=this.isAuthenticatedSubject.asObservable(),this.protectFromEmptyToken=()=>{if(!this.keycloakService.getKeycloakInstance().tokenParsed)throw this.router.navigate(["/login"]),new Error("User is not authenticated")}}login(){var C=this;return(0,n.A)(function*(){const E=window.location;yield C.keycloakService.login({redirectUri:E.protocol+"//"+E.host+"/pages"})})()}setAuthenticated(C){this.isAuthenticatedSubject.next(C)}logout(){var C=this;return(0,n.A)(function*(){const E=window.location;yield C.keycloakService.logout(E.protocol+"//"+E.host+"/login")})()}isAuthenticated(){var C=this;return(0,n.A)(function*(){const E=yield C.keycloakService.isLoggedIn();return C.setAuthenticated(E),Promise.resolve(E)})()}getToken(){var C=this;return(0,n.A)(function*(){return C.protectFromEmptyToken(),C.keycloakService.getToken()})()}getOrgMrn(){var C=this;return(0,n.A)(function*(){return C.protectFromEmptyToken(),C.keycloakService.getKeycloakInstance().tokenParsed.org})()}getUserName(){var C=this;return(0,n.A)(function*(){return C.protectFromEmptyToken(),C.keycloakService.getKeycloakInstance().tokenParsed.name})()}getUserMrn(){var C=this;return(0,n.A)(function*(){return C.protectFromEmptyToken(),C.keycloakService.getKeycloakInstance().tokenParsed.mrn})()}getUserRoles(){var C=this;return(0,n.A)(function*(){return C.protectFromEmptyToken(),C.keycloakService.getKeycloakInstance().tokenParsed.roles})()}getUserPermission(){var C=this;return(0,n.A)(function*(){return C.protectFromEmptyToken(),new Promise(function(){var E=(0,n.A)(function*(L,ee){L((p=>{let S=m.User;for(const C of p)switch(C){case A.ORGADMIN:S|=m.OrgAdmin;break;case A.SITEADMIN:S|=m.SiteAdmin;break;case A.USERADMIN:S|=m.UserAdmin;break;case A.DEVICEADMIN:S|=m.DeviceAdmin;break;case A.VESSELADMIN:S|=m.VesselAdmin;break;case A.SERVICEADMIN:S|=m.ServiceAdmin;break;case A.ENTITYADMIN:S|=m.EntityAdmin;break;case A.MMSADMIN:S|=m.MMSAdmin;break;case A.APPROVEORG:S|=m.ApproveOrg;break;default:S|=m.User}return S})(yield C.keycloakService.getKeycloakInstance().tokenParsed.roles))});return function(L,ee){return E.apply(this,arguments)}}())})()}hasPermission(C,E=!1){var L=this;return(0,n.A)(function*(){return L.protectFromEmptyToken(),new Promise(function(){var ee=(0,n.A)(function*(c,se){L.keycloakService.isLoggedIn()||c(!1),L.getUserPermission().then(ve=>{O(ve,m.SiteAdmin)?c(!0):c(C===T.SP.User?O(ve,m.UserAdmin):C===T.SP.Device?O(ve,m.DeviceAdmin):C===T.SP.Vessel?O(ve,m.VesselAdmin):C===T.SP.MMS?O(ve,m.MMSAdmin):C===T.SP.Service?O(ve,m.ServiceAdmin):E&&C===T.SP.Organization||C===T.SP.Role?O(ve,m.OrgAdmin):C===T.SP.Organization&&O(ve,m.SiteAdmin))})});return function(c,se){return ee.apply(this,arguments)}}())})()}static#e=this.\u0275fac=function(E){return new(E||p)(I.KVO(b.F1),I.KVO(k.Ix))};static#t=this.\u0275prov=I.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()},1748:(_t,F,$)=>{"use strict";$.d(F,{Y:()=>A});const n=[{code:"AF",code3:"AFG",title:"Afghanistan",value:"Afghanistan"},{code:"AL",code3:"ALB",title:"Albania",value:"Albania"},{code:"DZ",code3:"DZA",title:"Algeria",value:"Algeria"},{code:"AS",code3:"ASM",title:"American Samoa",value:"American Samoa"},{code:"AD",code3:"AND",title:"Andorra",value:"Andorra"},{code:"AO",code3:"AGO",title:"Angola",value:"Angola"},{code:"AI",code3:"AIA",title:"Anguilla",value:"Anguilla"},{code:"AQ",code3:"ATA",title:"Antarctica",value:"Antarctica"},{code:"AG",code3:"ATG",title:"Antigua and Barbuda",value:"Antigua and Barbuda"},{code:"AR",code3:"ARG",title:"Argentina",value:"Argentina"},{code:"AM",code3:"ARM",title:"Armenia",value:"Armenia"},{code:"AW",code3:"ABW",title:"Aruba",value:"Aruba"},{code:"AU",code3:"AUS",title:"Australia",value:"Australia"},{code:"AT",code3:"AUT",title:"Austria",value:"Austria"},{code:"AZ",code3:"AZE",title:"Azerbaijan",value:"Azerbaijan"},{code:"BS",code3:"BHS",title:"Bahamas (the)",value:"Bahamas (the)"},{code:"BH",code3:"BHR",title:"Bahrain",value:"Bahrain"},{code:"BD",code3:"BGD",title:"Bangladesh",value:"Bangladesh"},{code:"BB",code3:"BRB",title:"Barbados",value:"Barbados"},{code:"BY",code3:"BLR",title:"Belarus",value:"Belarus"},{code:"BE",code3:"BEL",title:"Belgium",value:"Belgium"},{code:"BZ",code3:"BLZ",title:"Belize",value:"Belize"},{code:"BJ",code3:"BEN",title:"Benin",value:"Benin"},{code:"BM",code3:"BMU",title:"Bermuda",value:"Bermuda"},{code:"BT",code3:"BTN",title:"Bhutan",value:"Bhutan"},{code:"BO",code3:"BOL",title:"Bolivia (Plurinational State of)",value:"Bolivia (Plurinational State of)"},{code:"BQ",code3:"BES",title:"Bonaire, Sint Eustatius and Saba",value:"Bonaire, Sint Eustatius and Saba"},{code:"BA",code3:"BIH",title:"Bosnia and Herzegovina",value:"Bosnia and Herzegovina"},{code:"BW",code3:"BWA",title:"Botswana",value:"Botswana"},{code:"BV",code3:"BVT",title:"Bouvet Island",value:"Bouvet Island"},{code:"BR",code3:"BRA",title:"Brazil",value:"Brazil"},{code:"IO",code3:"IOT",title:"British Indian Ocean Territory (the)",value:"British Indian Ocean Territory (the)"},{code:"BN",code3:"BRN",title:"Brunei Darussalam",value:"Brunei Darussalam"},{code:"BG",code3:"BGR",title:"Bulgaria",value:"Bulgaria"},{code:"BF",code3:"BFA",title:"Burkina Faso",value:"Burkina Faso"},{code:"BI",code3:"BDI",title:"Burundi",value:"Burundi"},{code:"CV",code3:"CPV",title:"Cabo Verde",value:"Cabo Verde"},{code:"KH",code3:"KHM",title:"Cambodia",value:"Cambodia"},{code:"CM",code3:"CMR",title:"Cameroon",value:"Cameroon"},{code:"CA",code3:"CAN",title:"Canada",value:"Canada"},{code:"KY",code3:"CYM",title:"Cayman Islands (the)",value:"Cayman Islands (the)"},{code:"CF",code3:"CAF",title:"Central African Republic (the)",value:"Central African Republic (the)"},{code:"TD",code3:"TCD",title:"Chad",value:"Chad"},{code:"CL",code3:"CHL",title:"Chile",value:"Chile"},{code:"CN",code3:"CHN",title:"China",value:"China"},{code:"CX",code3:"CXR",title:"Christmas Island",value:"Christmas Island"},{code:"CC",code3:"CCK",title:"Cocos (Keeling) Islands (the)",value:"Cocos (Keeling) Islands (the)"},{code:"CO",code3:"COL",title:"Colombia",value:"Colombia"},{code:"KM",code3:"COM",title:"Comoros (the)",value:"Comoros (the)"},{code:"CD",code3:"COD",title:"Congo (the Democratic Republic of the)",value:"Congo (the Democratic Republic of the)"},{code:"CG",code3:"COG",title:"Congo (the)",value:"Congo (the)"},{code:"CK",code3:"COK",title:"Cook Islands (the)",value:"Cook Islands (the)"},{code:"CR",code3:"CRI",title:"Costa Rica",value:"Costa Rica"},{code:"HR",code3:"HRV",title:"Croatia",value:"Croatia"},{code:"CU",code3:"CUB",title:"Cuba",value:"Cuba"},{code:"CW",code3:"CUW",title:"Cura\xe7ao",value:"Cura\xe7ao"},{code:"CY",code3:"CYP",title:"Cyprus",value:"Cyprus"},{code:"CZ",code3:"CZE",title:"Czechia",value:"Czechia"},{code:"CI",code3:"CIV",title:"C\xf4te d'Ivoire",value:"C\xf4te d'Ivoire"},{code:"DK",code3:"DNK",title:"Denmark",value:"Denmark"},{code:"DJ",code3:"DJI",title:"Djibouti",value:"Djibouti"},{code:"DM",code3:"DMA",title:"Dominica",value:"Dominica"},{code:"DO",code3:"DOM",title:"Dominican Republic (the)",value:"Dominican Republic (the)"},{code:"EC",code3:"ECU",title:"Ecuador",value:"Ecuador"},{code:"EG",code3:"EGY",title:"Egypt",value:"Egypt"},{code:"SV",code3:"SLV",title:"El Salvador",value:"El Salvador"},{code:"GQ",code3:"GNQ",title:"Equatorial Guinea",value:"Equatorial Guinea"},{code:"ER",code3:"ERI",title:"Eritrea",value:"Eritrea"},{code:"EE",code3:"EST",title:"Estonia",value:"Estonia"},{code:"SZ",code3:"SWZ",title:"Eswatini",value:"Eswatini"},{code:"ET",code3:"ETH",title:"Ethiopia",value:"Ethiopia"},{code:"FK",code3:"FLK",title:"Falkland Islands (the) [Malvinas]",value:"Falkland Islands (the) [Malvinas]"},{code:"FO",code3:"FRO",title:"Faroe Islands (the)",value:"Faroe Islands (the)"},{code:"FJ",code3:"FJI",title:"Fiji",value:"Fiji"},{code:"FI",code3:"FIN",title:"Finland",value:"Finland"},{code:"FR",code3:"FRA",title:"France",value:"France"},{code:"GF",code3:"GUF",title:"French Guiana",value:"French Guiana"},{code:"PF",code3:"PYF",title:"French Polynesia",value:"French Polynesia"},{code:"TF",code3:"ATF",title:"French Southern Territories (the)",value:"French Southern Territories (the)"},{code:"GA",code3:"GAB",title:"Gabon",value:"Gabon"},{code:"GM",code3:"GMB",title:"Gambia (the)",value:"Gambia (the)"},{code:"GE",code3:"GEO",title:"Georgia",value:"Georgia"},{code:"DE",code3:"DEU",title:"Germany",value:"Germany"},{code:"GH",code3:"GHA",title:"Ghana",value:"Ghana"},{code:"GI",code3:"GIB",title:"Gibraltar",value:"Gibraltar"},{code:"GR",code3:"GRC",title:"Greece",value:"Greece"},{code:"GL",code3:"GRL",title:"Greenland",value:"Greenland"},{code:"GD",code3:"GRD",title:"Grenada",value:"Grenada"},{code:"GP",code3:"GLP",title:"Guadeloupe",value:"Guadeloupe"},{code:"GU",code3:"GUM",title:"Guam",value:"Guam"},{code:"GT",code3:"GTM",title:"Guatemala",value:"Guatemala"},{code:"GG",code3:"GGY",title:"Guernsey",value:"Guernsey"},{code:"GN",code3:"GIN",title:"Guinea",value:"Guinea"},{code:"GW",code3:"GNB",title:"Guinea-Bissau",value:"Guinea-Bissau"},{code:"GY",code3:"GUY",title:"Guyana",value:"Guyana"},{code:"HT",code3:"HTI",title:"Haiti",value:"Haiti"},{code:"HM",code3:"HMD",title:"Heard Island and McDonald Islands",value:"Heard Island and McDonald Islands"},{code:"VA",code3:"VAT",title:"Holy See (the)",value:"Holy See (the)"},{code:"HN",code3:"HND",title:"Honduras",value:"Honduras"},{code:"HK",code3:"HKG",title:"Hong Kong",value:"Hong Kong"},{code:"HU",code3:"HUN",title:"Hungary",value:"Hungary"},{code:"IS",code3:"ISL",title:"Iceland",value:"Iceland"},{code:"IN",code3:"IND",title:"India",value:"India"},{code:"ID",code3:"IDN",title:"Indonesia",value:"Indonesia"},{code:"IR",code3:"IRN",title:"Iran (Islamic Republic of)",value:"Iran (Islamic Republic of)"},{code:"IQ",code3:"IRQ",title:"Iraq",value:"Iraq"},{code:"IE",code3:"IRL",title:"Ireland",value:"Ireland"},{code:"IM",code3:"IMN",title:"Isle of Man",value:"Isle of Man"},{code:"IL",code3:"ISR",title:"Israel",value:"Israel"},{code:"IT",code3:"ITA",title:"Italy",value:"Italy"},{code:"JM",code3:"JAM",title:"Jamaica",value:"Jamaica"},{code:"JP",code3:"JPN",title:"Japan",value:"Japan"},{code:"JE",code3:"JEY",title:"Jersey",value:"Jersey"},{code:"JO",code3:"JOR",title:"Jordan",value:"Jordan"},{code:"KZ",code3:"KAZ",title:"Kazakhstan",value:"Kazakhstan"},{code:"KE",code3:"KEN",title:"Kenya",value:"Kenya"},{code:"KI",code3:"KIR",title:"Kiribati",value:"Kiribati"},{code:"KP",code3:"PRK",title:"Korea (the Democratic People's Republic of)",value:"Korea (the Democratic People's Republic of)"},{code:"KR",code3:"KOR",title:"Korea (the Republic of)",value:"Korea (the Republic of)"},{code:"KW",code3:"KWT",title:"Kuwait",value:"Kuwait"},{code:"KG",code3:"KGZ",title:"Kyrgyzstan",value:"Kyrgyzstan"},{code:"LA",code3:"LAO",title:"Lao People's Democratic Republic (the)",value:"Lao People's Democratic Republic (the)"},{code:"LV",code3:"LVA",title:"Latvia",value:"Latvia"},{code:"LB",code3:"LBN",title:"Lebanon",value:"Lebanon"},{code:"LS",code3:"LSO",title:"Lesotho",value:"Lesotho"},{code:"LR",code3:"LBR",title:"Liberia",value:"Liberia"},{code:"LY",code3:"LBY",title:"Libya",value:"Libya"},{code:"LI",code3:"LIE",title:"Liechtenstein",value:"Liechtenstein"},{code:"LT",code3:"LTU",title:"Lithuania",value:"Lithuania"},{code:"LU",code3:"LUX",title:"Luxembourg",value:"Luxembourg"},{code:"MO",code3:"MAC",title:"Macao",value:"Macao"},{code:"MG",code3:"MDG",title:"Madagascar",value:"Madagascar"},{code:"MW",code3:"MWI",title:"Malawi",value:"Malawi"},{code:"MY",code3:"MYS",title:"Malaysia",value:"Malaysia"},{code:"MV",code3:"MDV",title:"Maldives",value:"Maldives"},{code:"ML",code3:"MLI",title:"Mali",value:"Mali"},{code:"MT",code3:"MLT",title:"Malta",value:"Malta"},{code:"MH",code3:"MHL",title:"Marshall Islands (the)",value:"Marshall Islands (the)"},{code:"MQ",code3:"MTQ",title:"Martinique",value:"Martinique"},{code:"MR",code3:"MRT",title:"Mauritania",value:"Mauritania"},{code:"MU",code3:"MUS",title:"Mauritius",value:"Mauritius"},{code:"YT",code3:"MYT",title:"Mayotte",value:"Mayotte"},{code:"MX",code3:"MEX",title:"Mexico",value:"Mexico"},{code:"FM",code3:"FSM",title:"Micronesia (Federated States of)",value:"Micronesia (Federated States of)"},{code:"MD",code3:"MDA",title:"Moldova (the Republic of)",value:"Moldova (the Republic of)"},{code:"MC",code3:"MCO",title:"Monaco",value:"Monaco"},{code:"MN",code3:"MNG",title:"Mongolia",value:"Mongolia"},{code:"ME",code3:"MNE",title:"Montenegro",value:"Montenegro"},{code:"MS",code3:"MSR",title:"Montserrat",value:"Montserrat"},{code:"MA",code3:"MAR",title:"Morocco",value:"Morocco"},{code:"MZ",code3:"MOZ",title:"Mozambique",value:"Mozambique"},{code:"MM",code3:"MMR",title:"Myanmar",value:"Myanmar"},{code:"NA",code3:"NAM",title:"Namibia",value:"Namibia"},{code:"NR",code3:"NRU",title:"Nauru",value:"Nauru"},{code:"NP",code3:"NPL",title:"Nepal",value:"Nepal"},{code:"NL",code3:"NLD",title:"Netherlands (the)",value:"Netherlands (the)"},{code:"NC",code3:"NCL",title:"New Caledonia",value:"New Caledonia"},{code:"NZ",code3:"NZL",title:"New Zealand",value:"New Zealand"},{code:"NI",code3:"NIC",title:"Nicaragua",value:"Nicaragua"},{code:"NE",code3:"NER",title:"Niger (the)",value:"Niger (the)"},{code:"NG",code3:"NGA",title:"Nigeria",value:"Nigeria"},{code:"NU",code3:"NIU",title:"Niue",value:"Niue"},{code:"NF",code3:"NFK",title:"Norfolk Island",value:"Norfolk Island"},{code:"MP",code3:"MNP",title:"Northern Mariana Islands (the)",value:"Northern Mariana Islands (the)"},{code:"NO",code3:"NOR",title:"Norway",value:"Norway"},{code:"OM",code3:"OMN",title:"Oman",value:"Oman"},{code:"PK",code3:"PAK",title:"Pakistan",value:"Pakistan"},{code:"PW",code3:"PLW",title:"Palau",value:"Palau"},{code:"PS",code3:"PSE",title:"Palestine, State of",value:"Palestine, State of"},{code:"PA",code3:"PAN",title:"Panama",value:"Panama"},{code:"PG",code3:"PNG",title:"Papua New Guinea",value:"Papua New Guinea"},{code:"PY",code3:"PRY",title:"Paraguay",value:"Paraguay"},{code:"PE",code3:"PER",title:"Peru",value:"Peru"},{code:"PH",code3:"PHL",title:"Philippines (the)",value:"Philippines (the)"},{code:"PN",code3:"PCN",title:"Pitcairn",value:"Pitcairn"},{code:"PL",code3:"POL",title:"Poland",value:"Poland"},{code:"PT",code3:"PRT",title:"Portugal",value:"Portugal"},{code:"PR",code3:"PRI",title:"Puerto Rico",value:"Puerto Rico"},{code:"QA",code3:"QAT",title:"Qatar",value:"Qatar"},{code:"MK",code3:"MKD",title:"Republic of North Macedonia",value:"Republic of North Macedonia"},{code:"RO",code3:"ROU",title:"Romania",value:"Romania"},{code:"RU",code3:"RUS",title:"Russian Federation (the)",value:"Russian Federation (the)"},{code:"RW",code3:"RWA",title:"Rwanda",value:"Rwanda"},{code:"RE",code3:"REU",title:"R\xe9union",value:"R\xe9union"},{code:"BL",code3:"BLM",title:"Saint Barth\xe9lemy",value:"Saint Barth\xe9lemy"},{code:"SH",code3:"SHN",title:"Saint Helena, Ascension and Tristan da Cunha",value:"Saint Helena, Ascension and Tristan da Cunha"},{code:"KN",code3:"KNA",title:"Saint Kitts and Nevis",value:"Saint Kitts and Nevis"},{code:"LC",code3:"LCA",title:"Saint Lucia",value:"Saint Lucia"},{code:"MF",code3:"MAF",title:"Saint Martin (French part)",value:"Saint Martin (French part)"},{code:"PM",code3:"SPM",title:"Saint Pierre and Miquelon",value:"Saint Pierre and Miquelon"},{code:"VC",code3:"VCT",title:"Saint Vincent and the Grenadines",value:"Saint Vincent and the Grenadines"},{code:"WS",code3:"WSM",title:"Samoa",value:"Samoa"},{code:"SM",code3:"SMR",title:"San Marino",value:"San Marino"},{code:"ST",code3:"STP",title:"Sao Tome and Principe",value:"Sao Tome and Principe"},{code:"SA",code3:"SAU",title:"Saudi Arabia",value:"Saudi Arabia"},{code:"SN",code3:"SEN",title:"Senegal",value:"Senegal"},{code:"RS",code3:"SRB",title:"Serbia",value:"Serbia"},{code:"SC",code3:"SYC",title:"Seychelles",value:"Seychelles"},{code:"SL",code3:"SLE",title:"Sierra Leone",value:"Sierra Leone"},{code:"SG",code3:"SGP",title:"Singapore",value:"Singapore"},{code:"SX",code3:"SXM",title:"Sint Maarten (Dutch part)",value:"Sint Maarten (Dutch part)"},{code:"SK",code3:"SVK",title:"Slovakia",value:"Slovakia"},{code:"SI",code3:"SVN",title:"Slovenia",value:"Slovenia"},{code:"SB",code3:"SLB",title:"Solomon Islands",value:"Solomon Islands"},{code:"SO",code3:"SOM",title:"Somalia",value:"Somalia"},{code:"ZA",code3:"ZAF",title:"South Africa",value:"South Africa"},{code:"GS",code3:"SGS",title:"South Georgia and the South Sandwich Islands",value:"South Georgia and the South Sandwich Islands"},{code:"SS",code3:"SSD",title:"South Sudan",value:"South Sudan"},{code:"ES",code3:"ESP",title:"Spain",value:"Spain"},{code:"LK",code3:"LKA",title:"Sri Lanka",value:"Sri Lanka"},{code:"SD",code3:"SDN",title:"Sudan (the)",value:"Sudan (the)"},{code:"SR",code3:"SUR",title:"Surititle",value:"Surititle"},{code:"SJ",code3:"SJM",title:"Svalbard and Jan Mayen",value:"Svalbard and Jan Mayen"},{code:"SE",code3:"SWE",title:"Sweden",value:"Sweden"},{code:"CH",code3:"CHE",title:"Switzerland",value:"Switzerland"},{code:"SY",code3:"SYR",title:"Syrian Arab Republic",value:"Syrian Arab Republic"},{code:"TW",code3:"TWN",title:"Taiwan",value:"Taiwan"},{code:"TJ",code3:"TJK",title:"Tajikistan",value:"Tajikistan"},{code:"TZ",code3:"TZA",title:"Tanzania, United Republic of",value:"Tanzania, United Republic of"},{code:"TH",code3:"THA",title:"Thailand",value:"Thailand"},{code:"TL",code3:"TLS",title:"Timor-Leste",value:"Timor-Leste"},{code:"TG",code3:"TGO",title:"Togo",value:"Togo"},{code:"TK",code3:"TKL",title:"Tokelau",value:"Tokelau"},{code:"TO",code3:"TON",title:"Tonga",value:"Tonga"},{code:"TT",code3:"TTO",title:"Trinidad and Tobago",value:"Trinidad and Tobago"},{code:"TN",code3:"TUN",title:"Tunisia",value:"Tunisia"},{code:"TR",code3:"TUR",title:"Turkey",value:"Turkey"},{code:"TM",code3:"TKM",title:"Turkmenistan",value:"Turkmenistan"},{code:"TC",code3:"TCA",title:"Turks and Caicos Islands (the)",value:"Turks and Caicos Islands (the)"},{code:"TV",code3:"TUV",title:"Tuvalu",value:"Tuvalu"},{code:"UG",code3:"UGA",title:"Uganda",value:"Uganda"},{code:"UA",code3:"UKR",title:"Ukraine",value:"Ukraine"},{code:"AE",code3:"ARE",title:"United Arab Emirates (the)",value:"United Arab Emirates (the)"},{code:"GB",code3:"GBR",title:"United Kingdom of Great Britain and Northern Ireland (the)",value:"United Kingdom of Great Britain and Northern Ireland (the)"},{code:"UM",code3:"UMI",title:"United States Minor Outlying Islands (the)",value:"United States Minor Outlying Islands (the)"},{code:"US",code3:"USA",title:"United States of America (the)",value:"United States of America (the)"},{code:"UY",code3:"URY",title:"Uruguay",value:"Uruguay"},{code:"UZ",code3:"UZB",title:"Uzbekistan",value:"Uzbekistan"},{code:"VU",code3:"VUT",title:"Vanuatu",value:"Vanuatu"},{code:"VE",code3:"VEN",title:"Venezuela (Bolivarian Republic of)",value:"Venezuela (Bolivarian Republic of)"},{code:"VN",code3:"VNM",title:"Viet Nam",value:"Viet Nam"},{code:"VG",code3:"VGB",title:"Virgin Islands (British)",value:"Virgin Islands (British)"},{code:"VI",code3:"VIR",title:"Virgin Islands (U.S.)",value:"Virgin Islands (U.S.)"},{code:"WF",code3:"WLF",title:"Wallis and Futuna",value:"Wallis and Futuna"},{code:"EH",code3:"ESH",title:"Western Sahara",value:"Western Sahara"},{code:"YE",code3:"YEM",title:"Yemen",value:"Yemen"},{code:"ZM",code3:"ZMB",title:"Zambia",value:"Zambia"},{code:"ZW",code3:"ZWE",title:"Zimbabwe",value:"Zimbabwe"},{code:"AX",code3:"ALA",title:"\xc5land Islands",value:"\xc5land Islands"}];var l=$(1066);const A={device:{id:{title:"ID",type:"number",description:"identifier"},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"device",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>:<unique_id>'"},name:{title:"Name",type:"string",description:"Name of device",visibleFrom:["detail","list","edit","edit-new"],required:!0},permissions:{title:"Permissions",type:"string",description:"List of permissions assigned by the organization",visibleFrom:["edit","detail","edit","edit-new"]},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},organization:{id:{title:"ID",type:"number"},logo:{title:"Logo",type:"image",allowedExtensions:[".jpg",".png"],visibleFrom:["detail","edit"]},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"organization",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>'"},name:{title:"Name",type:"string",description:"Name of organization",visibleFrom:["detail","list","edit","edit-new"],required:!0},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},email:{title:"e-mail",type:"string",description:"Contact e-mail",visibleFrom:["detail","edit","edit-new"],required:!0},url:{title:"URL",type:"string",description:"URL of organization",visibleFrom:["detail","edit","edit-new"],required:!0},address:{title:"Address",type:"string",description:"Address of organization",visibleFrom:["detail","edit","edit-new"],required:!0},country:{title:"Country",type:"string",description:"Country that organization belongs to",visibleFrom:["detail","list","edit","edit-new"],options:n,required:!0},federationType:{title:"Federation type",type:"string",description:"OpenID Connect federation type",visibleFrom:["detail","edit","edit-new"],immutable:!0},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},service:{id:{title:"ID",type:"number"},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"service",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>:<unique_id>'"},name:{title:"Name",type:"string",description:"Name of service",visibleFrom:["detail","list","edit","edit-new"],required:!0},permissions:{title:"Permissions",type:"string",description:"List of permissions assigned by the organization",visibleFrom:["edit","detail","edit","edit-new"]},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},instanceVersion:{title:"Instance version",type:"string",description:"Version of service instance",immutable:!0},certDomainName:{title:"Certificate domain name",type:"string",description:"The domain name the service will be available on. Used in the issued certificates for the service.",visibleFrom:["detail","edit","edit-new"]},oidcClientId:{title:"OIDC client ID",type:"string",description:"OpenID Connect client ID",visibleFrom:["detail","edit"]},oidcClientSecret:{title:"OIDC client secret",type:"string",description:"OpenID Connect client secret",visibleFrom:["detail","edit"]},oidcAccessType:{title:"Access type",type:"string",description:"OpenID Connect access type",options:[{title:"public",value:"public",showField:{key:"oidcRedirectUri",value:!0}},{title:"bearer-only",value:"bearer-only",showField:{key:"oidcRedirectUri",value:!1}},{title:"confidential",value:"confidential",showField:{key:"oidcRedirectUri",value:!0}}],visibleFrom:["detail","edit"]},oidcRedirectUri:{title:"OIDC redirect URI",type:"string",description:"OpenID Connect client redirect URI",visibleFrom:["detail","edit"]},vessel:{title:"Vessel",type:"vessel",description:"Correlated vessel",visibleFrom:["detail","edit"]},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},user:{id:{title:"ID",type:"number"},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"user",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>:<unique_id>'"},firstName:{title:"First name",type:"string",visibleFrom:["detail","list","edit","edit-new"],required:!0},lastName:{title:"Last name",type:"string",visibleFrom:["detail","list","edit","edit-new"],required:!0},email:{title:"e-mail",type:"string",description:"Contact e-mail",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0},permissions:{title:"Permissions",type:"string",description:"List of permissions assigned by the organization",visibleFrom:["detail","list","edit","edit-new"]},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},vessel:{id:{title:"ID",type:"number"},logo:{title:"Logo",type:"image",allowedExtensions:[".jpg",".png"],visibleFrom:["detail","edit"]},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],immutable:!0,required:!0,shortIdType:"vessel",error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>:<unique_id>'"},name:{title:"Name",type:"string",description:"Name of device",visibleFrom:["detail","list","edit","edit-new"],required:!0},permissions:{title:"Permissions",type:"string",description:"List of permissions assigned by the organization",visibleFrom:["detail","edit","edit-new"]},imoNumber:{title:"IMO number",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},mmsiNumber:{title:"MMSI number",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},callsign:{title:"Call sign",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},flagstate:{title:"Flag state",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},aisClass:{title:"AIS class",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},portOfRegister:{title:"Port of register",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit","edit-new"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},role:{id:{title:"ID",type:"number"},permission:{title:"Permission",type:"string",visibleFrom:["detail","list","edit","edit-new"],required:!0},roleName:{title:"Role name",type:"string",visibleFrom:["detail","list","edit","edit-new"],options:[{title:"ROLE_SITE_ADMIN",value:"ROLE_SITE_ADMIN"},{title:"ROLE_ORG_ADMIN",value:"ROLE_ORG_ADMIN"},{title:"ROLE_USER",value:"ROLE_USER"},{title:"ROLE_ENTITY_ADMIN",value:"ROLE_ENTITY_ADMIN"},{title:"ROLE_USER_ADMIN",value:"ROLE_USER_ADMIN"},{title:"ROLE_VESSEL_ADMIN",value:"ROLE_VESSEL_ADMIN"},{title:"ROLE_SERVICE_ADMIN",value:"ROLE_SERVICE_ADMIN"},{title:"ROLE_APPROVE_ORG",value:"ROLE_APPROVE_ORG"},{title:"ROLE_DEVICE_ADMIN",value:"ROLE_DEVICE_ADMIN"},{title:"ROLE_MMS_ADMIN",value:"ROLE_MMS_ADMIN"}],required:!0},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},orgcandidate:{id:{title:"ID",type:"number"},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","list","edit","edit-new"],shortIdType:"organization",immutable:!0,required:!0,error:"Please enter a valid MCP MRN, respecting the format 'urn:mrn:mcp:<entity_type>:<id_provider_id>:<org_id>'"},name:{title:"Name",type:"string",description:"Name of organization",visibleFrom:["detail","list","edit","edit-new"],required:!0},mrnSubsidiary:{title:"Subsidiary MRN",type:"string",description:"Additional MRN assigned to entity",visibleFrom:["detail","edit"]},homeMMSUrl:{title:"Home MMS URL",type:"string",description:"URL of home MMS"},email:{title:"e-mail",type:"string",description:"Contact e-mail",visibleFrom:["detail","list","edit","edit-new"],required:!0},url:{title:"URL",type:"string",description:"URL of organization",visibleFrom:["detail","list","edit","edit-new"],required:!0},address:{title:"Address",type:"string",description:"Address of organization",visibleFrom:["detail","edit","edit-new"],required:!0},country:{title:"Country",type:"string",description:"Country that organization belongs to",visibleFrom:["detail","list","edit","edit-new"],options:n,required:!0},federationType:{title:"Federation type",type:"string",description:"OpenID Connect federation type",visibleFrom:["detail","edit"],immutable:!0},createdAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]},updatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,valuePrepareFunction:m=>(0,l.t)(m),immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","list"]}},instance:{id:{title:"ID",type:"number"},instanceId:{title:"Instance ID",type:"string",description:"MCP MRN as unique identifer",placeholder:"urn:mrn:",visibleFrom:["detail","edit","edit-new"],required:!0},name:{title:"Name",type:"string",description:"Name of service instance",visibleFrom:["detail","list","edit","edit-new"],required:!0},version:{title:"Version",type:"string",description:"Version of service instance",visibleFrom:["detail","list","edit","edit-new"],required:!0},comment:{title:"Comment",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},serviceType:{title:"Service type",type:"stringArray",options:[{title:"MS 1 - VTS Information service (INS)",value:"VTSInformationService"},{title:"MS 2 - VTS Navigational assistance service (NAS)",value:"VTSNavigationalAssistanceService"},{title:"MS 3 - Traffic organization service (TOS)",value:"TrafficOrganizationService"},{title:"MS 4 - Port support service (PSS)",value:"PortSupportService"},{title:"MS 5 - Maritime safety information (MSI) service",value:"MaritimeSafetyInformationService"},{title:"MS 6 - Pilotage service",value:"PilotageService"},{title:"MS 7 - Tug service",value:"TugService"},{title:"MS 8 - Vessel shore reporting",value:"VesselShoreReporting"},{title:"MS 9 - Telemedical assistance service (TMAS)",value:"TelemedicalAssistanceService"},{title:"MS 10 - Maritime assistance service (MAS)",value:"MaritimeAssistanceService"},{title:"MS 11 - Nautical chart service",value:"NauticalChartService"},{title:"MS 12 - Nautical publications service",value:"NauticalPublicationsService"},{title:"MS 13 - Ice navigation service",value:"IceNavigationService"},{title:"MS 14 - Meteorological information service",value:"MeteorologicalInformationService"},{title:"MS 15 - Real-time hydrographic and environmental information services",value:"RealTimeHydrographicAndEnvironmentalInformationServices"},{title:"MS 16 - Search and rescue (SAR) service",value:"SearchAndRescueService"},{title:"Other",value:"other:etc"}],description:"The service type shall reflect the associated operational service type provided according to defined types",visibleFrom:["detail","list","edit","edit-new"]},dataProductType:{title:"Data product type",type:"stringArray",options:[{title:"S-57 Electronic Navigational Chart (ENC)",value:"S57"},{title:"S-101 Electronic Navigational Chart (ENC)",value:"S101"},{title:"S-102 Bathymetric Surface",value:"S102"},{title:"S-104 Water Level Information for Surface Navigation",value:"S104"},{title:"S-111 Surface Currents",value:"S111"},{title:"S-122 Marine Protected Areas (MPAs)",value:"S122"},{title:"S-123 Marine Radio Services",value:"S123"},{title:"S-124 Navigational Warnings",value:"S124"},{title:"S-125 Marine Navigational Services",value:"S125"},{title:"S-126 Marine Physical Environment",value:"S126"},{title:"S-127 Marine Traffic Management",value:"S127"},{title:"S-128 Catalogue of Nautical Products",value:"S128"},{title:"S-129 Under Keel Clearance Management (UKCM)",value:"S129"},{title:"S-131 Marine Harbour Infrastructure",value:"S131"},{title:"S-210 Inter-VTS Exchange Format",value:"S210"},{title:"S-211 Port Call Message Format",value:"S211"},{title:"S-212 VTS Digital Information Service",value:"S212"},{title:"S-401 Inland ENC",value:"S401"},{title:"S-402 Bathymetric Contour Overlay for Inland ENC",value:"S402"},{title:"S-411 Sea Ice Information",value:"S411"},{title:"S-412 Weather Overlay",value:"S412"},{title:"S-413 Marine Weather Conditions",value:"S413"},{title:"S-414 Marine Weather Observations",value:"S414"},{title:"S-421 Route Plan",value:"S421"},{title:"Route Plan",value:"RTZ"},{title:"Electronic Port Clearance",value:"EPC"},{title:"Other data types not covered in this table",value:"OTHER"}],description:"Data product type defined in IEC 63173-2 SECOM standard",visibleFrom:["detail","list","edit","edit-new"]},status:{title:"Status",type:"string",options:[{title:"Provisional",value:"PROVISIONAL"},{title:"Released",value:"RELEASED"},{title:"Deprecated",value:"DEPRECATED"},{title:"Deleted",value:"DELETED"}],visibleFrom:["detail","list","edit","edit-new"],required:!0},endpointUri:{title:"Endpoint URI",type:"string",visibleFrom:["detail","edit","edit-new"],required:!0},endpointType:{title:"Endpoint type",type:"string",visibleFrom:["detail","edit","edit-new"]},organizationId:{title:"Organization ID",type:"string",visibleFrom:["detail","edit","edit-new"],immutable:!0},keywords:{title:"Keywords",type:"stringArray",placeholder:"Please enter keyword",visibleFrom:["detail","list","edit","edit-new"]},implementsServiceDesign:{title:"Technical design ID",type:"string",description:"MCP MRN as unique identifer",placeholder:"urn:mrn:",visibleFrom:["detail","edit","edit-new"]},implementsServiceDesignVersion:{title:"Technical design version",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","edit","edit-new"]},geometryContentType:{title:"Geometry content type",type:"string",visibleFrom:["detail","edit","edit-new"]},geometry:{title:"Geometry",type:"object",visibleFrom:[]},unlocode:{title:"Unlocode",type:"string",placeholder:"Please enter UN/LOCODE",visibleFrom:["detail","edit","edit-new"]},mmsi:{title:"MMSI",type:"string",visibleFrom:["detail","edit","edit-new"]},imo:{title:"IMO number",type:"string",visibleFrom:["detail","edit","edit-new"]},instanceAsXml:{title:"Instance as XML",type:"xml",notShowOnEdit:!0,visibleFrom:["detail","edit","edit-new"]},instanceAsDocId:{title:"Instance as DocId",type:"number"},instanceAsDoc:{title:"Instance as document",type:"file",visibleFrom:["detail","edit","edit-new"]},ledgerRequestId:{title:"Ledger Request ID",type:"number"},ledgerRequestStatus:{title:"Ledger Request status",type:"string",options:[{title:"Inactive",value:"INACTIVE"},{title:"Created",value:"CREATED"},{title:"Vetting",value:"VETTING"},{title:"Vetted",value:"VETTED"},{title:"Requesting",value:"REQUESTING"},{title:"Succeeded",value:"SUCCEEDED"},{title:"Failed",value:"FAILED"},{title:"Rejected",value:"REJECTED"}],visibleFrom:["detail","edit","edit-new"]},docIds:{title:"Related documents",type:"fileArray",filter:!1,visibleFrom:["detail","edit","edit-new"]},publishedAt:{title:"Created at",type:"string",description:"Time of creation",filter:!1,immutable:!0,notShowOnEdit:!0,visibleFrom:["detail","edit","edit-new"]},lastUpdatedAt:{title:"Updated at",type:"string",description:"Time of last update",filter:!1,immutable:!0,notShowOnEdit:!0,visibleFrom:["detail"]}},newOrganization:{orgMrn:{title:"Maritime Resource Name (MRN) for organization",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["detail","edit","edit-new"],required:!0,shortIdType:"organization"},orgName:{title:"Organization name",type:"string",description:"Name of organization",visibleFrom:["detail","edit","edit-new"],required:!0},orgEmail:{title:"Organization contact e-mail",type:"string",description:"Contact e-mail",placeholder:"non-personal email, e.g., info@example.org",visibleFrom:["detail","edit","edit-new"],required:!0},orgUrl:{title:"URL of organization",type:"string",description:"URL of organization",visibleFrom:["detail","edit","edit-new"],required:!0},orgAddress:{title:"Address of organization",type:"string",description:"Address of organization",visibleFrom:["detail","edit","edit-new"],required:!0},orgCountry:{title:"Country of organization",type:"stringArray",description:"Country that organization belongs to",visibleFrom:["detail","edit","edit-new"],options:n,required:!0}},ledgerInstance:{name:{title:"Name",type:"string",description:"Name of service instance",visibleFrom:["list"]},mrn:{title:"MRN",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["list"]},version:{title:"Version",type:"string",description:"Version of service instance",visibleFrom:["list"]},keywords:{title:"Keywords",type:"string",visibleFrom:["list"]},coverageArea:{title:"Coverage ",type:"string"},status:{title:"Status",type:"string",options:[{title:"Provisional",value:"PROVISIONAL"},{title:"Released",value:"RELEASED"},{title:"Deprecated",value:"DEPRECATED"},{title:"Deleted",value:"DELETED"}],visibleFrom:["list"]},implementsDesignMRN:{title:"Technical design ID",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["list"],shortIdType:"design",immutable:!0},implementsDesignVersion:{title:"Technical design version",type:"string",description:"MCP MRN as unique identifer",visibleFrom:["list"]},msrName:{title:"MSR Name of register",type:"string",visibleFrom:["list"]},msrUrl:{title:"MSR URL of register",type:"string",visibleFrom:["list"]}}}},1224:(_t,F,$)=>{"use strict";$.d(F,{$l:()=>l,BY:()=>A,kB:()=>n});const n=m=>Object.fromEntries(Object.entries(m).filter(([_,D])=>void 0!==D&&D.toString().length>0)),l=(m,_)=>{const D={...m};for(const M in _)D.hasOwnProperty(M)&&_[M]!==D[M]&&(D[M]=_[M]);return D},A=m=>({...m,...m.attributes.reduce((_,D)=>({..._,[D.attributeName.replace(/-([a-z])/g,function(M){return M[1].toUpperCase()})]:D.attributeValue}),{})})},2170:(_t,F,$)=>{"use strict";$.d(F,{c:()=>n,e:()=>l});const n=["en-GB","ko-KR"],l=[{code:"en-GB",name:"English"},{code:"ko-KR",name:"\ud55c\uad6d\uc5b4"}]},5166:(_t,F,$)=>{"use strict";$.d(F,{N3:()=>A,SP:()=>n});var n=function(T){return T.None="none",T.Device="device",T.Organization="organization",T.Service="service",T.User="user",T.Vessel="vessel",T.MMS="mms",T.Role="role",T.Agent="agent",T.Instance="instance",T.Design="design",T.InstanceOfOrg="instanceorg",T.OrgCandidate="orgcandidate",T.LedgerInstance="ledgerInstance",T.Certificate="certificate",T}(n||{});const A=["start","end","revokedAt","createdAt","updatedAt"]},3830:(_t,F,$)=>{"use strict";$.d(F,{B:()=>n});const n=l=>{const A=l.split(":");return A.slice(0,3).join(":")+":entity:"+A.slice(4,6).join(":")+":"}},58:(_t,F,$)=>{"use strict";$.d(F,{G:()=>m});var n=$(2047),l=$(9380),A=$(5950);let m=(()=>{class _{static#e=this.\u0275fac=function(O){return new(O||_)};static#t=this.\u0275mod=A.$C({type:_});static#s=this.\u0275inj=A.G2t({imports:[n.MD,n.MD,l.h]})}return _})()},1066:(_t,F,$)=>{"use strict";$.d(F,{t:()=>n});const n=l=>new Date(l).toLocaleString()},3987:(_t,F,$)=>{"use strict";$.d(F,{Xo:()=>_,lk:()=>m,rR:()=>A,xs:()=>l});var n=$(2170);const l=D=>{D.addLangs(n.c)},A=D=>{const M=localStorage.getItem("locale"),O=M&&n.c.includes(M)?localStorage.getItem("locale"):"en-GB";if(null!==O)return D.setDefaultLang(O),D.use(O),O;throw new Error("Locale not found")},m=(D,M)=>{D.use(M),D.setDefaultLang(M),localStorage.setItem("locale",M)},_=D=>n.e.find(M=>M.code===D)?.name||"English"},8168:(_t,F,$)=>{"use strict";$.d(F,{s:()=>n});const n="ORGADMIN"},9850:(_t,F,$)=>{"use strict";$.d(F,{h:()=>T});var n=$(2047),l=$(58),A=$(3585),m=$(698),_=$(3685),D=$(2537),M=$(3426),O=$(5950);let T=(()=>{class y{static#e=this.\u0275fac=function(k){return new(k||y)};static#t=this.\u0275mod=O.$C({type:y});static#s=this.\u0275inj=O.G2t({imports:[n.MD,l.G,A.PuD,m.j,_.Y,D.B,M.d]})}return y})()},698:(_t,F,$)=>{"use strict";$.d(F,{j:()=>ke});var n=$(5950),l=$(7882),A=$(3585),m=$(1748),_=$(1224),D=$(5166),O=$(58),T=$(5004),y=$(6482),I=$(5189),b=$(9380),k=$(2047);function v(X,Te){if(1&X&&(n.j41(0,"clr-control-error"),n.EFF(1),n.k0s()),2&X){const j=n.XpG(2).$implicit;n.R7$(),n.JRh(j.value.error)}}function p(X,Te){1&X&&(n.j41(0,"clr-control-error"),n.EFF(1,"Please enter a value"),n.k0s())}function S(X,Te){if(1&X){const j=n.RV6();n.j41(0,"clr-input-container")(1,"label"),n.EFF(2),n.k0s(),n.j41(3,"input",9),n.bIt("ngModelChange",function(Ie){n.eBV(j);const _e=n.XpG(2);return n.Njj(_e.onMrnChange(Ie))})("keydown",function(Ie){n.eBV(j);const _e=n.XpG(2);return n.Njj(_e.onMrnKeyDown(Ie))}),n.k0s(),n.j41(4,"clr-control-helper"),n.EFF(5),n.k0s(),n.DNE(6,v,2,1,"clr-control-error")(7,p,2,0,"clr-control-error"),n.k0s()}if(2&X){const j=n.XpG().$implicit,q=n.XpG();n.R7$(2),n.JRh(j.value.title),n.R7$(),n.xc7("width",400,"px"),n.Y8G("type",j.value.type)("formControlName",j.key)("required",!0===j.value.required)("placeholder",q.mrnPrefix),n.R7$(2),n.JRh(j.value.description),n.R7$(),n.vxM(j.value.error?6:7)}}function C(X,Te){if(1&X&&(n.j41(0,"option",12),n.EFF(1),n.k0s()),2&X){const j=Te.$implicit;n.Y8G("value",j.value),n.R7$(),n.JRh(j.title)}}function E(X,Te){if(1&X&&(n.j41(0,"clr-control-error"),n.EFF(1),n.k0s()),2&X){const j=n.XpG(2).$implicit;n.R7$(),n.JRh(j.value.error)}}function L(X,Te){1&X&&(n.j41(0,"clr-control-error"),n.EFF(1,"Please enter a value"),n.k0s())}function ee(X,Te){if(1&X&&(n.j41(0,"clr-select-container")(1,"label"),n.EFF(2),n.k0s(),n.j41(3,"select",10),n.DNE(4,C,2,2,"option",11),n.k0s(),n.j41(5,"clr-control-helper"),n.EFF(6),n.k0s(),n.DNE(7,E,2,1,"clr-control-error")(8,L,2,0,"clr-control-error"),n.k0s()),2&X){const j=n.XpG().$implicit;n.R7$(2),n.Lme("",j.value.title," ",j.key,""),n.R7$(),n.xc7("width",400,"px"),n.Y8G("formControlName",j.key)("required",!0===j.value.required),n.R7$(),n.Y8G("ngForOf",j.value.options),n.R7$(2),n.JRh(j.value.description),n.R7$(),n.vxM(j.value.error?7:8)}}function c(X,Te){if(1&X&&(n.j41(0,"option",12),n.EFF(1),n.k0s()),2&X){const j=Te.$implicit;n.Y8G("value",j.permission),n.R7$(),n.JRh(j.permission)}}function se(X,Te){if(1&X&&(n.j41(0,"clr-control-error"),n.EFF(1),n.k0s()),2&X){const j=n.XpG(2).$implicit;n.R7$(),n.JRh(j.value.error)}}function ve(X,Te){1&X&&(n.j41(0,"clr-control-error"),n.EFF(1,"Please enter a value"),n.k0s())}function Pe(X,Te){if(1&X&&(n.j41(0,"clr-select-container")(1,"label"),n.EFF(2),n.k0s(),n.j41(3,"select",10),n.DNE(4,c,2,2,"option",11),n.k0s(),n.j41(5,"clr-control-helper"),n.EFF(6),n.k0s(),n.DNE(7,se,2,1,"clr-control-error")(8,ve,2,0,"clr-control-error"),n.k0s()),2&X){const j=n.XpG().$implicit,q=n.XpG();n.R7$(2),n.JRh(j.value.title),n.R7$(),n.xc7("width",400,"px"),n.Y8G("formControlName",j.key)("required",!0===j.value.required),n.R7$(),n.Y8G("ngForOf",q.roles),n.R7$(2),n.JRh(j.value.description),n.R7$(),n.vxM(j.value.error?7:8)}}function R(X,Te){if(1&X&&(n.j41(0,"clr-control-error"),n.EFF(1),n.k0s()),2&X){const j=n.XpG(2).$implicit;n.R7$(),n.JRh(j.value.error)}}function K(X,Te){1&X&&(n.j41(0,"clr-control-error"),n.EFF(1,"Please enter a value"),n.k0s())}function f(X,Te){if(1&X&&(n.j41(0,"clr-input-container")(1,"label"),n.EFF(2),n.k0s(),n.nrm(3,"input",13),n.j41(4,"clr-control-helper"),n.EFF(5),n.k0s(),n.DNE(6,R,2,1,"clr-control-error")(7,K,2,0,"clr-control-error"),n.k0s()),2&X){const j=n.XpG().$implicit;n.R7$(2),n.JRh(j.value.title),n.R7$(),n.xc7("width",400,"px"),n.Y8G("type",j.value.type)("formControlName",j.key)("required",!0===j.value.required),n.R7$(2),n.JRh(j.value.description),n.R7$(),n.vxM(j.value.error?6:7)}}function P(X,Te){if(1&X&&(n.j41(0,"div"),n.DNE(1,S,8,9,"clr-input-container")(2,ee,9,9,"clr-select-container")(3,Pe,9,8,"clr-select-container")(4,f,8,8,"clr-input-container"),n.k0s()),2&X){const j=Te.$implicit;n.R7$(),n.vxM("mrn"===j.key?1:"roleName"===j.key?2:"permissions"===j.key?3:4)}}function ae(X,Te){if(1&X){const j=n.RV6();n.j41(0,"button",17),n.bIt("click",function(){n.eBV(j);const Ie=n.XpG(2);return n.Njj(Ie.cancel())}),n.EFF(1,"Cancel"),n.k0s()}}function W(X,Te){if(1&X){const j=n.RV6();n.j41(0,"div",8)(1,"button",14),n.bIt("click",function(){n.eBV(j);const Ie=n.XpG();return n.Njj(Ie.submit())}),n.EFF(2,"Submit"),n.k0s(),n.j41(3,"button",15),n.bIt("click",function(){n.eBV(j);const Ie=n.XpG();return n.Njj(Ie.resetForm())}),n.EFF(4,"Reset"),n.k0s(),n.DNE(5,ae,2,0,"button",16),n.k0s()}if(2&X){const j=n.XpG();n.R7$(5),n.vxM(j.isForNew?-1:5)}}let ke=(()=>{class X{constructor(j,q,Ie,_e,Ce){this.formBuilder=j,this.roleService=q,this.authService=Ie,this.notifierService=_e,this.translate=Ce,this.itemType=D.SP.None,this.isForNew=!1,this.item={},this.mrnPrefix="urn:mrn:",this.title="",this.onCancel=new n.bkB,this.onSubmit=new n.bkB,this.viewContext="edit",this.itemForm=new l.gE({}),this.columnForMenu={},this.isEditing=!1,this.roles=[],this.id="",this.onSubmitIsGiven=!0,this.submit=()=>{if(this.isValid()){const Je=(0,_.kB)(this.itemForm.value);if(this.isForNew)this.onSubmit.emit(Je);else{const ne=(0,_.$l)(this.item,Je);this.onSubmit.emit(ne)}}},this.isValid=()=>this.itemForm.valid?this.itemForm.value.mrn!==this.mrnPrefix||(this.notifierService.notify("error",this.translate.instant("error.form.invalidmrn")),!1):(this.itemForm.markAllAsTouched(),this.clrForm?.markAsTouched(),this.notifierService.notify("error",this.translate.instant("error.form.invalid")),!1),this.getFormValue=()=>{if(this.isValid())return(0,_.kB)(this.itemForm.value)},this.resetForm=()=>{this.setForm(),this.isForNew?this.itemType!==D.SP.Role&&(this.item={mrn:this.mrnPrefix},this.itemForm.patchValue(this.item)):this.itemForm.patchValue(this.item)},this.cancel=()=>{this.onCancel.emit()},this.setForm=()=>{let Je={};Object.entries(m.Y[this.itemType.toString()]).map(([ne,$e])=>{if($e.visibleFrom&&(!$e.visibleFrom||$e.visibleFrom.includes(this.viewContext))){if("mrn"===ne){const Ze=new RegExp("urn:mrn:mcp:(entity|mir|mms|msr|device|org|user|vessel|service|mms):([a-z0-9]([a-z0-9]|-){0,20}[a-z0-9]):((([-._a-z0-9]|~)|%[0-9a-f][0-9a-f]|([!$&'()*+,;=])|:|@)((([-._a-z0-9]|~)|%[0-9a-f][0-9a-f]|([!$&'()*+,;=])|:|@)|)*)$");Je[ne]=["",[l.k0.required,l.k0.pattern(Ze)]]}else Je[ne]=["",$e.required?l.k0.required:void 0];this.columnForMenu[ne]=$e}}),this.itemForm=this.formBuilder.group(Je)},this.needShortId=Je=>void 0!==this.getShortIdType(Je),this.getShortIdType=Je=>this.columnForMenu[Je]?this.columnForMenu[Je].shortIdType:void 0,this.sortColumnForMenu=(Je,ne)=>Je.order>ne.order?-1:1,this.capitalize=Je=>Je[0].toUpperCase()+Je.slice(1)}ngOnInit(){this.itemType!==D.SP.OrgCandidate&&this.authService.getOrgMrn().then(j=>{this.roleService.getRoles(j).subscribe(q=>{this.roles=q})})}ngOnChanges(j){this.isForNew&&(this.viewContext="edit-new"),this.itemType!==D.SP.None&&(this.setForm(),this.item&&this.itemForm.patchValue(this.item)),0===this.title.length&&this.itemType!==D.SP.None&&(this.title=this.isForNew?"New "+this.capitalize(this.itemType):"Edit "+this.capitalize(this.itemType)),this.onSubmitIsGiven=0!==this.onSubmit.observers.length}onMrnKeyDown(j){const q=j.target.value;q.includes(this.mrnPrefix)?this.item.mrn=q:j.target.value=this.mrnPrefix}onMrnChange(j){this.item.mrn=j.startsWith(this.mrnPrefix)?j:this.mrnPrefix}static#e=this.\u0275fac=function(q){return new(q||X)(n.rXU(l.ok),n.rXU(T.Ky),n.rXU(y.u),n.rXU(I.iJ),n.rXU(b.c$))};static#t=this.\u0275cmp=n.VBU({type:X,selectors:[["app-item-form"]],viewQuery:function(q,Ie){if(1&q&&n.GBs(A.mDd,7),2&q){let _e;n.mGM(_e=n.lsd())&&(Ie.clrForm=_e.first)}},inputs:{itemType:"itemType",isForNew:"isForNew",item:"item",mrnPrefix:"mrnPrefix",title:"title"},outputs:{onCancel:"onCancel",onSubmit:"onSubmit"},standalone:!0,features:[n.OA$,n.aNF],decls:11,vars:7,consts:[[1,"clr-row"],[1,"clr-col-lg-12","clr-col-md-8","clr-col-12"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"card-text"],["clrForm","",1,"ng-untouched",3,"formGroup"],[4,"ngFor","ngForOf"],[1,"card-footer"],["clrInput","",3,"ngModelChange","keydown","type","formControlName","required","placeholder"],["clrSelect","",3,"formControlName","required"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["clrInput","",3,"type","formControlName","required"],["type","submit",1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"btn","btn-danger"],[1,"btn","btn-danger",3,"click"]],template:function(q,Ie){1&q&&(n.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),n.EFF(4),n.k0s(),n.j41(5,"div",4)(6,"div",5)(7,"form",6),n.DNE(8,P,5,1,"div",7),n.nI1(9,"keyvalue"),n.k0s()()(),n.DNE(10,W,6,1,"div",8),n.k0s()()()),2&q&&(n.R7$(4),n.SpI(" ",Ie.title," "),n.R7$(3),n.Y8G("formGroup",Ie.itemForm),n.R7$(),n.Y8G("ngForOf",n.i5U(9,4,Ie.columnForMenu,Ie.sortColumnForMenu)),n.R7$(2),n.vxM(Ie.onSubmitIsGiven?10:-1))},dependencies:[O.G,k.Sq,k.lG,A.t5G,A.aZZ,A.Hpg,A.bnk,A.mDd,A.icl,A.Xu5,A.Yf6,A.hTQ,l.YN,l.qT,l.xH,l.y7,l.me,l.wz,l.BC,l.cb,l.YS,l.X1,l.j4,l.JD]})}return X})()},3685:(_t,F,$)=>{"use strict";$.d(F,{Y:()=>jw});var n=$(5950),l=$(5166),A=$(2537),m=$(1066);const _={serialNumber:{title:"Serial number",type:"string"},start:{title:"Valid from",type:"string",valuePrepareFunction:s=>(0,m.t)(s)},end:{title:"Valid until",type:"string",valuePrepareFunction:s=>(0,m.t)(s)}},D={serialNumber:{title:"Serial number",type:"string"},revokedAt:{title:"Revoked from",type:"string",valuePrepareFunction:s=>(0,m.t)(s)},revokeReason:{title:"Reason",type:"string"}},M=s=>[s];function O(s,r){if(1&s&&n.nrm(0,"app-smart-table",0),2&s){const e=n.XpG();n.Y8G("labels",e.columnsForActive)("data",e.data)("selectedIds",n.eq3(7,M,e.serial))("onDelete",e.revoke)("onDownload",e.download)("onAdd",e.add)("itemType",e.itemType)}}function T(s,r){if(1&s&&n.nrm(0,"app-smart-table",1),2&s){const e=n.XpG();n.Y8G("labels",e.columnsForRevoked)("data",e.data)("itemType",e.itemType)}}function y(s,r){if(1&s&&(n.j41(0,"h1"),n.EFF(1),n.k0s()),2&s){const e=n.XpG();n.R7$(),n.SpI("The given context is wrong! : ",e.context,"")}}let I=(()=>{class s{constructor(){this.context="active",this.data=[],this.onAdd=new n.bkB,this.onDownload=new n.bkB,this.onRevoke=new n.bkB,this.itemType=l.SP.Certificate,this.download=e=>{this.onDownload.emit(e)},this.add=()=>{this.onAdd.emit()},this.revoke=e=>{this.onRevoke.emit(e)},this.empty=[],this.columnsForActive=_,this.columnsForRevoked=D}static#e=this.\u0275fac=function(t){return new(t||s)};static#t=this.\u0275cmp=n.VBU({type:s,selectors:[["app-cert-table"]],inputs:{context:"context",data:"data",serial:"serial"},outputs:{onAdd:"onAdd",onDownload:"onDownload",onRevoke:"onRevoke"},standalone:!0,features:[n.aNF],decls:3,vars:1,consts:[["deleteText","Revoke","placeholder","There is no issued certificate.",3,"labels","data","selectedIds","onDelete","onDownload","onAdd","itemType"],["placeholder","There is no revoked certificate.",3,"labels","data","itemType"]],template:function(t,i){1&t&&n.DNE(0,O,1,9,"app-smart-table",0)(1,T,1,3,"app-smart-table",1)(2,y,2,1,"h1"),2&t&&n.vxM("active"===i.context?0:"revoked"===i.context?1:2)},dependencies:[A.B]})}return s})();var b=$(1748),k=$(7882),p=$(2047),S=$(58),C=$(3585),E=$(6994),L=$(153);function c(s,r,e){var t;return s instanceof Object&&null!==(t=s[r])&&void 0!==t?t:e}function se(s,r=0,e=s.byteLength-r,t=!1){let i="";for(const a of new Uint8Array(s,r,e)){const o=a.toString(16).toUpperCase();1===o.length&&(i+="0"),i+=o,t&&(i+=" ")}return i.trim()}function Pe(s,r){let e=0;if(1===s.length)return s[0];for(let t=s.length-1;t>=0;t--)e+=s[s.length-1-t]*Math.pow(2,r*t);return e}function R(s,r,e=-1){const t=e;let i=s,a=0,o=Math.pow(2,r);for(let u=1;u<8;u++){if(s<o){let h;if(t<0)h=new ArrayBuffer(u),a=u;else{if(t<u)return new ArrayBuffer(0);h=new ArrayBuffer(t),a=t}const g=new Uint8Array(h);for(let N=u-1;N>=0;N--){const x=Math.pow(2,N*r);g[a-N-1]=Math.floor(i/x),i-=g[a-N-1]*x}return h}o*=Math.pow(2,r)}return new ArrayBuffer(0)}function K(...s){let r=0,e=0;for(const a of s)r+=a.byteLength;const t=new ArrayBuffer(r),i=new Uint8Array(t);for(const a of s)i.set(new Uint8Array(a),e),e+=a.byteLength;return t}function f(...s){let r=0,e=0;for(const a of s)r+=a.length;const t=new ArrayBuffer(r),i=new Uint8Array(t);for(const a of s)i.set(a,e),e+=a.length;return i}function P(){const s=new Uint8Array(this.valueHex);this.valueHex.byteLength>=2&&(255===s[0]&&128&s[1]||0===s[0]&&!(128&s[1]))&&this.warnings.push("Needlessly long format");const r=new ArrayBuffer(this.valueHex.byteLength),e=new Uint8Array(r);for(let u=0;u<this.valueHex.byteLength;u++)e[u]=0;e[0]=128&s[0];const t=Pe(e,8),i=new ArrayBuffer(this.valueHex.byteLength),a=new Uint8Array(i);for(let u=0;u<this.valueHex.byteLength;u++)a[u]=s[u];return a[0]&=127,Pe(a,8)-t}function W(s,r){if(s.byteLength!==r.byteLength)return!1;const e=new Uint8Array(s),t=new Uint8Array(r);for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function ke(s,r){const e=s.toString(10);if(r<e.length)return"";const t=r-e.length,i=new Array(t);for(let o=0;o<t;o++)i[o]="0";return i.join("").concat(e)}const X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function j(s,r=!1,e=!1,t=!1){let i=0,a=0,o=0,u="";const h=r?Te:X;if(t){let g=0;for(let N=0;N<s.length;N++)if(0!==s.charCodeAt(N)){g=N;break}s=s.slice(g)}for(;i<s.length;){const g=s.charCodeAt(i++);i>=s.length&&(a=1);const N=s.charCodeAt(i++);i>=s.length&&(o=1);const x=s.charCodeAt(i++),G=g>>2,H=(3&g)<<4|N>>4;let re=(15&N)<<2|x>>6,Ae=63&x;1===a?re=Ae=64:1===o&&(Ae=64),u+=e?64===re?`${h.charAt(G)}${h.charAt(H)}`:64===Ae?`${h.charAt(G)}${h.charAt(H)}${h.charAt(re)}`:`${h.charAt(G)}${h.charAt(H)}${h.charAt(re)}${h.charAt(Ae)}`:`${h.charAt(G)}${h.charAt(H)}${h.charAt(re)}${h.charAt(Ae)}`}return u}function q(s,r=!1,e=!1){const t=r?Te:X;function i(h){for(let g=0;g<64;g++)if(t.charAt(g)===h)return g;return 64}function a(h){return 64===h?0:h}let o=0,u="";for(;o<s.length;){const h=i(s.charAt(o++)),g=o>=s.length?0:i(s.charAt(o++)),N=o>=s.length?0:i(s.charAt(o++)),x=o>=s.length?0:i(s.charAt(o++)),G=a(h)<<2|a(g)>>4,H=(15&a(g))<<4|a(N)>>2,re=(3&a(N))<<6|a(x);u+=String.fromCharCode(G),64!==N&&(u+=String.fromCharCode(H)),64!==x&&(u+=String.fromCharCode(re))}if(e){let g=-1;for(let N=u.length-1;N>=0;N--)if(0!==u.charCodeAt(N)){g=N;break}u=-1!==g?u.slice(0,g+1):""}return u}function Ie(s){let r="";const e=new Uint8Array(s);for(const t of e)r+=String.fromCharCode(t);return r}function _e(s){const r=s.length,e=new ArrayBuffer(r),t=new Uint8Array(e);for(let i=0;i<r;i++)t[i]=s.charCodeAt(i);return e}const Ce=Math.log(2);function Je(s){const r=Math.log(s)/Ce,e=Math.floor(r),t=Math.round(r);return e===t?e:t}function ne(s,r){for(const e of r)delete s[e]}function $e(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function Ze(s){let r=0,e=0;for(let i=0;i<s.length;i++)r+=s[i].byteLength;const t=new Uint8Array(r);for(let i=0;i<s.length;i++){const a=s[i];t.set(new Uint8Array(a),e),e+=a.byteLength}return t.buffer}function at(s,r,e,t){return r instanceof Uint8Array?r.byteLength?e<0?(s.error="Wrong parameter: inputOffset less than zero",!1):t<0?(s.error="Wrong parameter: inputLength less than zero",!1):!(r.byteLength-e-t<0&&(s.error="End of input reached before message was fully decoded (inconsistent offset and length values)",1)):(s.error="Wrong parameter: inputBuffer has zero length",!1):(s.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class ut{constructor(){this.items=[]}write(r){this.items.push(r)}final(){return Ze(this.items)}}const Bt=[new Uint8Array([1])],Ht="0123456789",d="name",ue="valueHexView",Se=new ArrayBuffer(0),Me=new Uint8Array(0),tt="EndOfContent",Xe="OCTET STRING",Dt="BIT STRING";function Ut(s){var r;return(r=class extends s{constructor(...t){var i;super(...t);const a=t[0]||{};this.isHexOnly=null!==(i=a.isHexOnly)&&void 0!==i&&i,this.valueHexView=a.valueHex?L._H.toUint8Array(a.valueHex):Me}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(t){this.valueHexView=new Uint8Array(t)}fromBER(t,i,a){const o=t instanceof ArrayBuffer?new Uint8Array(t):t;if(!at(this,o,i,a))return-1;const u=i+a;return this.valueHexView=o.subarray(i,u),this.valueHexView.length?(this.blockLength=a,u):(this.warnings.push("Zero buffer length"),i)}toBER(t=!1){return this.isHexOnly?t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Se)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:L.U$.ToHex(this.valueHexView)}}}).NAME="hexBlock",r}let It=(()=>{class s{constructor({blockLength:e=0,error:t="",warnings:i=[],valueBeforeDecode:a=Me}={}){this.blockLength=e,this.error=t,this.warnings=i,this.valueBeforeDecodeView=L._H.toUint8Array(a)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:L.U$.ToHex(this.valueBeforeDecodeView)}}}return s.NAME="baseBlock",s})(),Ct=(()=>{class s extends It{fromBER(e,t,i){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}return s.NAME="valueBlock",s})(),yt=(()=>{class s extends(Ut(It)){constructor({idBlock:e={}}={}){var t,i,a,o;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?L._H.toUint8Array(e.valueHex):Me,this.tagClass=null!==(i=e.tagClass)&&void 0!==i?i:-1,this.tagNumber=null!==(a=e.tagNumber)&&void 0!==a?a:-1,this.isConstructed=null!==(o=e.isConstructed)&&void 0!==o&&o):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",Se}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const a=new Uint8Array(1);if(!e){let o=this.tagNumber;o&=31,t|=o,a[0]=t}return a.buffer}if(!this.isHexOnly){const a=R(this.tagNumber,7),o=new Uint8Array(a),u=a.byteLength,h=new Uint8Array(u+1);if(h[0]=31|t,!e){for(let g=0;g<u-1;g++)h[g+1]=128|o[g];h[u]=o[u-1]}return h.buffer}const i=new Uint8Array(this.valueHexView.byteLength+1);if(i[0]=31|t,!e){const a=this.valueHexView;for(let o=0;o<a.length-1;o++)i[o+1]=128|a[o];i[this.valueHexView.byteLength]=a[a.length-1]}return i.buffer}fromBER(e,t,i){const a=L._H.toUint8Array(e);if(!at(this,a,t,i))return-1;const o=a.subarray(t,t+i);if(0===o.length)return this.error="Zero buffer length",-1;switch(192&o[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=!(32&~o[0]),this.isHexOnly=!1;const h=31&o[0];if(31!==h)this.tagNumber=h,this.blockLength=1;else{let g=1,N=this.valueHexView=new Uint8Array(255),x=255;for(;128&o[g];){if(N[g-1]=127&o[g],g++,g>=o.length)return this.error="End of input reached before message was fully decoded",-1;if(g===x){x+=255;const H=new Uint8Array(x);for(let re=0;re<N.length;re++)H[re]=N[re];N=this.valueHexView=new Uint8Array(x)}}this.blockLength=g+1,N[g-1]=127&o[g];const G=new Uint8Array(g);for(let H=0;H<g;H++)G[H]=N[H];N=this.valueHexView=new Uint8Array(g),N.set(G),this.blockLength<=9?this.tagNumber=Pe(N,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}return s.NAME="identificationBlock",s})(),Ur=(()=>{class s extends It{constructor({lenBlock:e={}}={}){var t,i,a;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(i=e.longFormUsed)&&void 0!==i&&i,this.length=null!==(a=e.length)&&void 0!==a?a:0}fromBER(e,t,i){const a=L._H.toUint8Array(e);if(!at(this,a,t,i))return-1;const o=a.subarray(t,t+i);if(0===o.length)return this.error="Zero buffer length",-1;if(255===o[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===o[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&o[0]),!1===this.longFormUsed)return this.length=o[0],this.blockLength=1,t+this.blockLength;const u=127&o[0];if(u>8)return this.error="Too big integer",-1;if(u+1>o.length)return this.error="End of input reached before message was fully decoded",-1;const h=t+1,g=a.subarray(h,h+u);return 0===g[u-1]&&this.warnings.push("Needlessly long encoded length"),this.length=Pe(g,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=u+1,t+this.blockLength}toBER(e=!1){let t,i;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(i=new Uint8Array(t),i[0]=128),t;if(this.longFormUsed){const a=R(this.length,8);if(a.byteLength>127)return this.error="Too big length",Se;if(t=new ArrayBuffer(a.byteLength+1),e)return t;const o=new Uint8Array(a);i=new Uint8Array(t),i[0]=128|a.byteLength;for(let u=0;u<a.byteLength;u++)i[u+1]=o[u];return t}return t=new ArrayBuffer(1),!1===e&&(i=new Uint8Array(t),i[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}return s.NAME="lengthBlock",s})();const Re={};let pt=(()=>{class s extends It{constructor({name:e="",optional:t=!1,primitiveSchema:i,...a}={},o){super(a),this.name=e,this.optional=t,i&&(this.primitiveSchema=i),this.idBlock=new yt(a),this.lenBlock=new Ur(a),this.valueBlock=o?new o(a):new Ct(a)}fromBER(e,t,i){const a=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return-1===a?(this.error=this.valueBlock.error,a):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),a)}toBER(e,t){const i=t||new ut;t||ha(this);const a=this.idBlock.toBER(e);if(i.write(a),this.lenBlock.isIndefiniteForm)i.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,i),i.write(new ArrayBuffer(2));else{const o=this.valueBlock.toBER(e);this.lenBlock.length=o.byteLength;const u=this.lenBlock.toBER(e);i.write(u),i.write(o)}return t?Se:i.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():L.U$.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${L.U$.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){return this===e||e instanceof this.constructor&&W(this.toBER(),e.toBER())}}return s.NAME="BaseBlock",s})();function ha(s){if(s instanceof Re.Constructed)for(const r of s.valueBlock.value)ha(r)&&(s.lenBlock.isIndefiniteForm=!0);return!!s.lenBlock.isIndefiniteForm}let eu=(()=>{class s extends pt{constructor({value:e="",...t}={},i){super(t,i),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,i){const a=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return-1===a?(this.error=this.valueBlock.error,a):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),a)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}return s.NAME="BaseStringBlock",s})(),tu=(()=>{class s extends(Ut(Ct)){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}return s.NAME="PrimitiveValueBlock",s})();class Le extends pt{constructor(r={}){super(r,tu),this.idBlock.isConstructed=!1}}function Yt(s,r=0,e=s.length){const t=r;let i=new pt({},Ct);const a=new It;if(!at(a,s,r,e))return i.error=a.error,{offset:-1,result:i};if(!s.subarray(r,r+e).length)return i.error="Zero buffer length",{offset:-1,result:i};let u=i.idBlock.fromBER(s,r,e);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),-1===u)return i.error=i.idBlock.error,{offset:-1,result:i};if(u=i.lenBlock.fromBER(s,r=u,e-=i.idBlock.blockLength),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),-1===u)return i.error=i.lenBlock.error,{offset:-1,result:i};if(r=u,e-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let h=pt;if(1===i.idBlock.tagClass){if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};h=Re.EndOfContent;break;case 1:h=Re.Boolean;break;case 2:h=Re.Integer;break;case 3:h=Re.BitString;break;case 4:h=Re.OctetString;break;case 5:h=Re.Null;break;case 6:h=Re.ObjectIdentifier;break;case 10:h=Re.Enumerated;break;case 12:h=Re.Utf8String;break;case 13:h=Re.RelativeObjectIdentifier;break;case 14:h=Re.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:h=Re.Sequence;break;case 17:h=Re.Set;break;case 18:h=Re.NumericString;break;case 19:h=Re.PrintableString;break;case 20:h=Re.TeletexString;break;case 21:h=Re.VideotexString;break;case 22:h=Re.IA5String;break;case 23:h=Re.UTCTime;break;case 24:h=Re.GeneralizedTime;break;case 25:h=Re.GraphicString;break;case 26:h=Re.VisibleString;break;case 27:h=Re.GeneralString;break;case 28:h=Re.UniversalString;break;case 29:h=Re.CharacterString;break;case 30:h=Re.BmpString;break;case 31:h=Re.DATE;break;case 32:h=Re.TimeOfDay;break;case 33:h=Re.DateTime;break;case 34:h=Re.Duration;break;default:{const g=i.idBlock.isConstructed?new Re.Constructed:new Re.Primitive;g.idBlock=i.idBlock,g.lenBlock=i.lenBlock,g.warnings=i.warnings,i=g}}}else h=i.idBlock.isConstructed?Re.Constructed:Re.Primitive;return i=function Si(s,r){if(s instanceof r)return s;const e=new r;return e.idBlock=s.idBlock,e.lenBlock=s.lenBlock,e.warnings=s.warnings,e.valueBeforeDecodeView=s.valueBeforeDecodeView,e}(i,h),u=i.fromBER(s,r,i.lenBlock.isIndefiniteForm?e:i.lenBlock.length),i.valueBeforeDecodeView=s.subarray(t,t+i.blockLength),{offset:u,result:i}}function Et(s){if(!s.byteLength){const r=new pt({},Ct);return r.error="Input buffer has zero length",{offset:-1,result:r}}return Yt(L._H.toUint8Array(s).slice(),0,s.byteLength)}function am(s,r){return s?1:r}Re.Primitive=Le,Le.NAME="PRIMITIVE";let bi=(()=>{class s extends Ct{constructor({value:e=[],isIndefiniteForm:t=!1,...i}={}){super(i),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,i){const a=L._H.toUint8Array(e);if(!at(this,a,t,i))return-1;if(this.valueBeforeDecodeView=a.subarray(t,t+i),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let o=t;for(;am(this.isIndefiniteForm,i)>0;){const u=Yt(a,o,i);if(-1===u.offset)return this.error=u.result.error,this.warnings.concat(u.result.warnings),-1;if(o=u.offset,this.blockLength+=u.result.blockLength,i-=u.result.blockLength,this.value.push(u.result),this.isIndefiniteForm&&u.result.constructor.NAME===tt)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===tt?this.value.pop():this.warnings.push("No EndOfContent block encoded")),o}toBER(e,t){const i=t||new ut;for(let a=0;a<this.value.length;a++)this.value[a].toBER(e,i);return t?Se:i.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}return s.NAME="ConstructedValueBlock",s})();class z extends pt{constructor(r={}){super(r,bi),this.idBlock.isConstructed=!0}fromBER(r,e,t){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const i=this.valueBlock.fromBER(r,e,this.lenBlock.isIndefiniteForm?t:this.lenBlock.length);return-1===i?(this.error=this.valueBlock.error,i):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}onAsciiEncoding(){const r=[];for(const t of this.valueBlock.value)r.push(t.toString("ascii").split("\n").map(i=>`  ${i}`).join("\n"));const e=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return r.length?`${e} :\n${r.join("\n")}`:`${e} :`}}Re.Constructed=z,z.NAME="CONSTRUCTED";let om=(()=>{class s extends Ct{fromBER(e,t,i){return t}toBER(e){return Se}}return s.override="EndOfContentValueBlock",s})();class Xh extends pt{constructor(r={}){super(r,om),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}Re.EndOfContent=Xh,Xh.NAME=tt;class At extends pt{constructor(r={}){super(r,Ct),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(r,e,t){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=t,e+t>r.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):e+t}toBER(r,e){const t=new ArrayBuffer(2);if(!r){const i=new Uint8Array(t);i[0]=5,i[1]=0}return e&&e.write(t),t}onAsciiEncoding(){return`${this.constructor.NAME}`}}Re.Null=At,At.NAME="NULL";let lm=(()=>{class s extends(Ut(Ct)){constructor({value:e,...t}={}){super(t),this.valueHexView=t.valueHex?L._H.toUint8Array(t.valueHex):new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,i){const a=L._H.toUint8Array(e);return at(this,a,t,i)?(this.valueHexView=a.subarray(t,t+i),i>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,P.call(this),this.blockLength=i,t+i):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}return s.NAME="BooleanValueBlock",s})();class Es extends pt{constructor(r={}){super(r,lm),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(r){this.valueBlock.value=r}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}Re.Boolean=Es,Es.NAME="BOOLEAN";let cm=(()=>{class s extends(Ut(bi)){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,i){let a=0;if(this.isConstructed){if(this.isHexOnly=!1,a=bi.prototype.fromBER.call(this,e,t,i),-1===a)return a;for(let o=0;o<this.value.length;o++){const u=this.value[o].constructor.NAME;if(u===tt){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(u!==Xe)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,a=super.fromBER(e,t,i),this.blockLength=i;return a}toBER(e,t){return this.isConstructed?bi.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}return s.NAME="OctetStringValueBlock",s})();class me extends pt{constructor({idBlock:r={},lenBlock:e={},...t}={}){var i,a;null!==(i=t.isConstructed)&&void 0!==i||(t.isConstructed=!(null===(a=t.value)||void 0===a||!a.length)),super({idBlock:{isConstructed:t.isConstructed,...r},lenBlock:{...e,isIndefiniteForm:!!t.isIndefiniteForm},...t},cm),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(r,e,t){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===t)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),e;if(!this.valueBlock.isConstructed){const a=(r instanceof ArrayBuffer?new Uint8Array(r):r).subarray(e,e+t);try{if(a.byteLength){const o=Yt(a,0,a.byteLength);-1!==o.offset&&o.offset===t&&(this.valueBlock.value=[o.result])}}catch{}}return super.fromBER(r,e,t)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?z.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${L.U$.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const r=[];for(const e of this.valueBlock.value)e instanceof me&&r.push(e.valueBlock.valueHexView);return L._H.concat(r)}}Re.OctetString=me,me.NAME=Xe;let um=(()=>{class s extends(Ut(bi)){constructor({unusedBits:e=0,isConstructed:t=!1,...i}={}){super(i),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,i){if(!i)return t;let a=-1;if(this.isConstructed){if(a=bi.prototype.fromBER.call(this,e,t,i),-1===a)return a;for(const h of this.value){const g=h.constructor.NAME;if(g===tt){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(g!==Dt)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const N=h.valueBlock;if(this.unusedBits>0&&N.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=N.unusedBits}return a}const o=L._H.toUint8Array(e);if(!at(this,o,t,i))return-1;const u=o.subarray(t,t+i);if(this.unusedBits=u[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const h=u.subarray(1);try{if(h.byteLength){const g=Yt(h,0,h.byteLength);-1!==g.offset&&g.offset===i-1&&(this.value=[g.result])}}catch{}}return this.valueHexView=u.subarray(1),this.blockLength=u.length,t+i}toBER(e,t){if(this.isConstructed)return bi.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Se;const i=new Uint8Array(this.valueHexView.length+1);return i[0]=this.unusedBits,i.set(this.valueHexView,1),i.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}return s.NAME="BitStringValueBlock",s})();var sd;class et extends pt{constructor({idBlock:r={},lenBlock:e={},...t}={}){var i,a;null!==(i=t.isConstructed)&&void 0!==i||(t.isConstructed=!(null===(a=t.value)||void 0===a||!a.length)),super({idBlock:{isConstructed:t.isConstructed,...r},lenBlock:{...e,isIndefiniteForm:!!t.isIndefiniteForm},...t},um),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(r,e,t){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(r,e,t)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return z.prototype.onAsciiEncoding.call(this);{const r=[],e=this.valueBlock.valueHexView;for(const i of e)r.push(i.toString(2).padStart(8,"0"));const t=r.join("");return`${this.constructor.NAME} : ${t.substring(0,t.length-this.valueBlock.unusedBits)}`}}}function hm(s,r){const e=new Uint8Array([0]),t=new Uint8Array(s),i=new Uint8Array(r);let a=t.slice(0);const o=a.length-1,u=i.slice(0),h=u.length-1;let g=0,x=0;for(let G=h<o?o:h;G>=0;G--,x++)g=1==x<u.length?a[o-x]+u[h-x]+e[0]:a[o-x]+e[0],e[0]=g/10,1==x>=a.length?a=f(new Uint8Array([g%10]),a):a[o-x]=g%10;return e[0]>0&&(a=f(e,a)),a}function id(s){if(s>=Bt.length)for(let r=Bt.length;r<=s;r++){const e=new Uint8Array([0]);let t=Bt[r-1].slice(0);for(let i=t.length-1;i>=0;i--){const a=new Uint8Array([(t[i]<<1)+e[0]]);e[0]=a[0]/10,t[i]=a[0]%10}e[0]>0&&(t=f(e,t)),Bt.push(t)}return Bt[s]}function dm(s,r){let e=0;const t=new Uint8Array(s),i=new Uint8Array(r),a=t.slice(0),o=a.length-1,u=i.slice(0),h=u.length-1;let g,N=0;for(let x=h;x>=0;x--,N++)g=a[o-N]-u[h-N]-e,1==g<0?(e=1,a[o-N]=g+10):(e=0,a[o-N]=g);if(e>0)for(let x=o-h+1;x>=0;x--,N++){if(g=a[o-N]-e,!(g<0)){e=0,a[o-N]=g;break}e=1,a[o-N]=g+10}return a.slice()}Re.BitString=et,et.NAME=Dt;class su extends(Ut(Ct)){constructor({value:r,...e}={}){super(e),this._valueDec=0,e.valueHex&&this.setValueHex(),void 0!==r&&(this.valueDec=r)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=P.call(this)))}set valueDec(r){this._valueDec=r,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function ae(s){const r=s<0?-1*s:s;let e=128;for(let t=1;t<8;t++){if(r<=e){if(s<0){const u=R(e-r,8,t);return new Uint8Array(u)[0]|=128,u}let i=R(r,8,t),a=new Uint8Array(i);if(128&a[0]){const o=i.slice(0),u=new Uint8Array(o);i=new ArrayBuffer(i.byteLength+1),a=new Uint8Array(i);for(let h=0;h<o.byteLength;h++)a[h+1]=u[h];a[0]=0}return i}e*=Math.pow(2,8)}return new ArrayBuffer(0)}(r))}get valueDec(){return this._valueDec}fromDER(r,e,t,i=0){const a=this.fromBER(r,e,t);if(-1===a)return a;const o=this.valueHexView;return 0===o[0]&&128&o[1]?this.valueHexView=o.subarray(1):0!==i&&o.length<i&&(i-o.length>1&&(i=o.length+1),this.valueHexView=o.subarray(i-o.length)),a}toDER(r=!1){const e=this.valueHexView;switch(!0){case!!(128&e[0]):{const t=new Uint8Array(this.valueHexView.length+1);t[0]=0,t.set(e,1),this.valueHexView=t}break;case 0===e[0]&&!(128&e[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(r)}fromBER(r,e,t){const i=super.fromBER(r,e,t);return-1===i||this.setValueHex(),i}toBER(r){return r?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const r=8*this.valueHexView.length-1;let i,e=new Uint8Array(8*this.valueHexView.length/3),t=0;const a=this.valueHexView;let o="",u=!1;for(let h=a.byteLength-1;h>=0;h--){i=a[h];for(let g=0;g<8;g++)1&~i||(t===r?(e=dm(id(t),e),o="-"):e=hm(e,id(t))),t++,i>>=1}for(let h=0;h<e.length;h++)e[h]&&(u=!0),u&&(o+=Ht.charAt(e[h]));return!1===u&&(o+=Ht.charAt(0)),o}}sd=su,su.NAME="IntegerValueBlock",Object.defineProperty(sd.prototype,"valueHex",{set:function(s){this.valueHexView=new Uint8Array(s),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class Q extends pt{constructor(r={}){super(r,su),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return $e(),BigInt(this.valueBlock.toString())}static fromBigInt(r){$e();const e=BigInt(r),t=new ut,i=e.toString(16).replace(/^-/,""),a=new Uint8Array(L.U$.FromHex(i));if(e<0){const u=new Uint8Array(a.length+(128&a[0]?1:0));u[0]|=128;const g=BigInt(`0x${L.U$.ToHex(u)}`)+e,N=L._H.toUint8Array(L.U$.FromHex(g.toString(16)));N[0]|=128,t.write(N)}else 128&a[0]&&t.write(new Uint8Array([0])),t.write(a);return new Q({valueHex:t.final()})}convertToDER(){const r=new Q({valueHex:this.valueBlock.valueHexView});return r.valueBlock.toDER(),r}convertFromDER(){return new Q({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}Re.Integer=Q,Q.NAME="INTEGER";class da extends Q{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}Re.Enumerated=da,da.NAME="ENUMERATED";let ad=(()=>{class s extends(Ut(Ct)){constructor({valueDec:e=-1,isFirstSid:t=!1,...i}={}){super(i),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,i){if(!i)return t;const a=L._H.toUint8Array(e);if(!at(this,a,t,i))return-1;const o=a.subarray(t,t+i);this.valueHexView=new Uint8Array(i);for(let h=0;h<i&&(this.valueHexView[h]=127&o[h],this.blockLength++,128&o[h]);h++);const u=new Uint8Array(this.blockLength);for(let h=0;h<this.blockLength;h++)u[h]=this.valueHexView[h];return this.valueHexView=u,128&o[this.blockLength-1]?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Pe(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){$e();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const i=new Uint8Array(t.length/7);for(let a=0;a<i.length;a++)i[a]=parseInt(t.slice(7*a,7*a+7),2)+(a+1<i.length?128:0);this.fromBER(i.buffer,0,i.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const a=this.valueHexView,o=new Uint8Array(this.blockLength);for(let u=0;u<this.blockLength-1;u++)o[u]=128|a[u];return o[this.blockLength-1]=a[this.blockLength-1],o.buffer}const t=R(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Se;const i=new Uint8Array(t.byteLength);if(!e){const a=new Uint8Array(t),o=t.byteLength-1;for(let u=0;u<o;u++)i[u]=128|a[u];i[o]=a[o]}return i}toString(){let e="";if(this.isHexOnly)e=L.U$.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}return s.NAME="sidBlock",s})(),fm=(()=>{class s extends Ct{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,i){let a=t;for(;i>0;){const o=new ad;if(a=o.fromBER(e,a,i),-1===a)return this.blockLength=0,this.error=o.error,a;0===this.value.length&&(o.isFirstSid=!0),this.blockLength+=o.blockLength,i-=o.blockLength,this.value.push(o)}return a}toBER(e){const t=[];for(let i=0;i<this.value.length;i++){const a=this.value[i].toBER(e);if(0===a.byteLength)return this.error=this.value[i].error,Se;t.push(a)}return Ze(t)}fromString(e){this.value=[];let t=0,i=0,a="",o=!1;do{if(i=e.indexOf(".",t),a=-1===i?e.substring(t):e.substring(t,i),t=i+1,o){const u=this.value[0];let h=0;switch(u.valueDec){case 0:break;case 1:h=40;break;case 2:h=80;break;default:return void(this.value=[])}const g=parseInt(a,10);if(isNaN(g))return;u.valueDec=g+h,o=!1}else{const u=new ad;if(a>Number.MAX_SAFE_INTEGER){$e();const h=BigInt(a);u.valueBigInt=h}else if(u.valueDec=parseInt(a,10),isNaN(u.valueDec))return;this.value.length||(u.isFirstSid=!0,o=!0),this.value.push(u)}}while(-1!==i)}toString(){let e="",t=!1;for(let i=0;i<this.value.length;i++){t=this.value[i].isHexOnly;let a=this.value[i].toString();0!==i&&(e=`${e}.`),t?(a=`{${a}}`,this.value[i].isFirstSid?e=`2.{${a} - 80}`:e+=a):e+=a}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}return s.NAME="ObjectIdentifierValueBlock",s})();class Ve extends pt{constructor(r={}){super(r,fm),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(r){this.valueBlock.fromString(r)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Re.ObjectIdentifier=Ve,Ve.NAME="OBJECT IDENTIFIER";let ld=(()=>{class s extends(Ut(It)){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,i){if(0===i)return t;const a=L._H.toUint8Array(e);if(!at(this,a,t,i))return-1;const o=a.subarray(t,t+i);this.valueHexView=new Uint8Array(i);for(let h=0;h<i&&(this.valueHexView[h]=127&o[h],this.blockLength++,128&o[h]);h++);const u=new Uint8Array(this.blockLength);for(let h=0;h<this.blockLength;h++)u[h]=this.valueHexView[h];return this.valueHexView=u,128&o[this.blockLength-1]?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Pe(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const a=this.valueHexView,o=new Uint8Array(this.blockLength);for(let u=0;u<this.blockLength-1;u++)o[u]=128|a[u];return o[this.blockLength-1]=a[this.blockLength-1],o.buffer}const t=R(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Se;const i=new Uint8Array(t.byteLength);if(!e){const a=new Uint8Array(t),o=t.byteLength-1;for(let u=0;u<o;u++)i[u]=128|a[u];i[o]=a[o]}return i.buffer}toString(){let e="";return e=this.isHexOnly?L.U$.ToHex(this.valueHexView):this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}return s.NAME="relativeSidBlock",s})(),mm=(()=>{class s extends Ct{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,i){let a=t;for(;i>0;){const o=new ld;if(a=o.fromBER(e,a,i),-1===a)return this.blockLength=0,this.error=o.error,a;this.blockLength+=o.blockLength,i-=o.blockLength,this.value.push(o)}return a}toBER(e,t){const i=[];for(let a=0;a<this.value.length;a++){const o=this.value[a].toBER(e);if(0===o.byteLength)return this.error=this.value[a].error,Se;i.push(o)}return Ze(i)}fromString(e){this.value=[];let t=0,i=0,a="";do{i=e.indexOf(".",t),a=-1===i?e.substring(t):e.substring(t,i),t=i+1;const o=new ld;if(o.valueDec=parseInt(a,10),isNaN(o.valueDec))return!0;this.value.push(o)}while(-1!==i);return!0}toString(){let e="",t=!1;for(let i=0;i<this.value.length;i++){t=this.value[i].isHexOnly;let a=this.value[i].toString();0!==i&&(e=`${e}.`),t&&(a=`{${a}}`),e+=a}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}return s.NAME="RelativeObjectIdentifierValueBlock",s})();class ud extends pt{constructor(r={}){super(r,mm),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(r){this.valueBlock.fromString(r)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Re.RelativeObjectIdentifier=ud,ud.NAME="RelativeObjectIdentifier";class U extends z{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}Re.Sequence=U,U.NAME="SEQUENCE";class kt extends z{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}Re.Set=kt,kt.NAME="SET";let gm=(()=>{class s extends(Ut(Ct)){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=""}toJSON(){return{...super.toJSON(),value:this.value}}}return s.NAME="StringValueBlock",s})(),pm=(()=>{class s extends gm{}return s.NAME="SimpleStringValueBlock",s})(),Gt=(()=>{class s extends eu{constructor({...e}={}){super(e,pm)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,L._H.toUint8Array(e))}fromString(e){const t=e.length,i=this.valueBlock.valueHexView=new Uint8Array(t);for(let a=0;a<t;a++)i[a]=e.charCodeAt(a);this.valueBlock.value=e}}return s.NAME="SIMPLE STRING",s})(),vm=(()=>{class s extends Gt{fromBuffer(e){this.valueBlock.valueHexView=L._H.toUint8Array(e);try{this.valueBlock.value=L.U$.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=L.U$.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(L.U$.FromUtf8String(e)),this.valueBlock.value=e}}return s.NAME="Utf8StringValueBlock",s})();class is extends vm{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Re.Utf8String=is,is.NAME="UTF8String";let wm=(()=>{class s extends Gt{fromBuffer(e){this.valueBlock.value=L.U$.ToUtf16String(e),this.valueBlock.valueHexView=L._H.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(L.U$.FromUtf16String(e))}}return s.NAME="BmpStringValueBlock",s})();class Xt extends wm{constructor({...r}={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}Re.BmpString=Xt,Xt.NAME="BMPString";let ym=(()=>{class s extends Gt{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),i=new Uint8Array(t);for(let a=0;a<i.length;a+=4)i[a]=i[a+3],i[a+1]=i[a+2],i[a+2]=0,i[a+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,i=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let a=0;a<t;a++){const o=R(e.charCodeAt(a),8),u=new Uint8Array(o);if(u.length>4)continue;const h=4-u.length;for(let g=u.length-1;g>=0;g--)i[4*a+g+h]=u[g]}this.valueBlock.value=e}}return s.NAME="UniversalStringValueBlock",s})();class fa extends ym{constructor({...r}={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}Re.UniversalString=fa,fa.NAME="UniversalString";class Mr extends Gt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}Re.NumericString=Mr,Mr.NAME="NumericString";class Jt extends Gt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}Re.PrintableString=Jt,Jt.NAME="PrintableString";class ma extends Gt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}Re.TeletexString=ma,ma.NAME="TeletexString";class iu extends Gt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}Re.VideotexString=iu,iu.NAME="VideotexString";class Pl extends Gt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}Re.IA5String=Pl,Pl.NAME="IA5String";class ru extends Gt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}Re.GraphicString=ru,ru.NAME="GraphicString";class Dl extends Gt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}Re.VisibleString=Dl,Dl.NAME="VisibleString";class nu extends Gt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}Re.GeneralString=nu,nu.NAME="GeneralString";class au extends Gt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}Re.CharacterString=au,au.NAME="CharacterString";class Lr extends Dl{constructor({value:r,valueDate:e,...t}={}){if(super(t),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,r){this.fromString(r),this.valueBlock.valueHexView=new Uint8Array(r.length);for(let i=0;i<r.length;i++)this.valueBlock.valueHexView[i]=r.charCodeAt(i)}e&&(this.fromDate(e),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(r){this.fromString(String.fromCharCode.apply(null,L._H.toUint8Array(r)))}toBuffer(){const r=this.toString(),e=new ArrayBuffer(r.length),t=new Uint8Array(e);for(let i=0;i<r.length;i++)t[i]=r.charCodeAt(i);return e}fromDate(r){this.year=r.getUTCFullYear(),this.month=r.getUTCMonth()+1,this.day=r.getUTCDate(),this.hour=r.getUTCHours(),this.minute=r.getUTCMinutes(),this.second=r.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(r){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(r);if(null===t)return void(this.error="Wrong input string for conversion");const i=parseInt(t[1],10);this.year=i>=50?1900+i:2e3+i,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(r="iso"){if("iso"===r){const e=new Array(7);return e[0]=ke(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=ke(this.month,2),e[2]=ke(this.day,2),e[3]=ke(this.hour,2),e[4]=ke(this.minute,2),e[5]=ke(this.second,2),e[6]="Z",e.join("")}return super.toString(r)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}Re.UTCTime=Lr,Lr.NAME="UTCTime";class ht extends Lr{constructor(r={}){var e;super(r),null!==(e=this.millisecond)&&void 0!==e||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(r){super.fromDate(r),this.millisecond=r.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(r){let o,e=!1,t="",i="",a=0,u=0,h=0;if("Z"===r[r.length-1])t=r.substring(0,r.length-1),e=!0;else{const x=new Number(r[r.length-1]);if(isNaN(x.valueOf()))throw new Error("Wrong input string for conversion");t=r}if(e){if(-1!==t.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==t.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let x=1,G=t.indexOf("+"),H="";if(-1===G&&(G=t.indexOf("-"),x=-1),-1!==G){if(H=t.substring(G+1),t=t.substring(0,G),2!==H.length&&4!==H.length)throw new Error("Wrong input string for conversion");let re=parseInt(H.substring(0,2),10);if(isNaN(re.valueOf()))throw new Error("Wrong input string for conversion");if(u=x*re,4===H.length){if(re=parseInt(H.substring(2,4),10),isNaN(re.valueOf()))throw new Error("Wrong input string for conversion");h=x*re}}}let g=t.indexOf(".");if(-1===g&&(g=t.indexOf(",")),-1!==g){const x=new Number(`0${t.substring(g)}`);if(isNaN(x.valueOf()))throw new Error("Wrong input string for conversion");a=x.valueOf(),i=t.substring(0,g)}else i=t;switch(!0){case 8===i.length:if(o=/(\d{4})(\d{2})(\d{2})/gi,-1!==g)throw new Error("Wrong input string for conversion");break;case 10===i.length:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==g){let x=60*a;this.minute=Math.floor(x),x=60*(x-this.minute),this.second=Math.floor(x),x=1e3*(x-this.second),this.millisecond=Math.floor(x)}break;case 12===i.length:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==g){let x=60*a;this.second=Math.floor(x),x=1e3*(x-this.second),this.millisecond=Math.floor(x)}break;case 14===i.length:o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==g&&(this.millisecond=Math.floor(1e3*a));break;default:throw new Error("Wrong input string for conversion")}const N=o.exec(i);if(null===N)throw new Error("Wrong input string for conversion");for(let x=1;x<N.length;x++)switch(x){case 1:this.year=parseInt(N[x],10);break;case 2:this.month=parseInt(N[x],10);break;case 3:this.day=parseInt(N[x],10);break;case 4:this.hour=parseInt(N[x],10)+u;break;case 5:this.minute=parseInt(N[x],10)+h;break;case 6:this.second=parseInt(N[x],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===e){const x=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=x.getUTCFullYear(),this.month=x.getUTCMonth(),this.day=x.getUTCDay(),this.hour=x.getUTCHours(),this.minute=x.getUTCMinutes(),this.second=x.getUTCSeconds(),this.millisecond=x.getUTCMilliseconds()}}toString(r="iso"){if("iso"===r){const e=[];return e.push(ke(this.year,4)),e.push(ke(this.month,2)),e.push(ke(this.day,2)),e.push(ke(this.hour,2)),e.push(ke(this.minute,2)),e.push(ke(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(ke(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(r)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}Re.GeneralizedTime=ht,ht.NAME="GeneralizedTime";class Id extends is{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}Re.DATE=Id,Id.NAME="DATE";class Rd extends is{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}Re.TimeOfDay=Rd,Rd.NAME="TimeOfDay";class xd extends is{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}Re.DateTime=xd,xd.NAME="DateTime";class Od extends is{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}Re.Duration=Od,Od.NAME="Duration";class Dd extends is{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}Re.TIME=Dd,Dd.NAME="TIME";class Fe{constructor({name:r="",optional:e=!1}={}){this.name=r,this.optional=e}}class dt extends Fe{constructor({value:r=[],...e}={}){super(e),this.value=r}}class Ke extends Fe{constructor({value:r=new Fe,local:e=!1,...t}={}){super(t),this.value=r,this.local=e}}class Ul{constructor({data:r=Me}={}){this.dataView=L._H.toUint8Array(r)}get data(){return this.dataView.slice().buffer}set data(r){this.dataView=L._H.toUint8Array(r)}fromBER(r,e,t){const i=e+t;return this.dataView=L._H.toUint8Array(r).subarray(e,i),i}toBER(r){return this.dataView.slice().buffer}}function de(s,r,e){if(e instanceof dt){for(let a=0;a<e.value.length;a++)if(de(s,r,e.value[a]).verified)return{verified:!0,result:s};{const a={verified:!1,result:{error:"Wrong values for Choice type"}};return e.hasOwnProperty(d)&&(a.name=e.name),a}}if(e instanceof Fe)return e.hasOwnProperty(d)&&(s[e.name]=r),{verified:!0,result:s};if(!(s instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(r instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!("idBlock"in e))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!("fromBER"in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!("toBER"in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const t=e.idBlock.toBER(!1);if(0===t.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===e.idBlock.fromBER(t,0,t.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===e.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagClass!==r.idBlock.tagClass)return{verified:!1,result:s};if(!1===e.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagNumber!==r.idBlock.tagNumber)return{verified:!1,result:s};if(!1===e.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isConstructed!==r.idBlock.isConstructed)return{verified:!1,result:s};if(!("isHexOnly"in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isHexOnly!==r.idBlock.isHexOnly)return{verified:!1,result:s};if(e.idBlock.isHexOnly){if(!(ue in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const a=e.idBlock.valueHexView,o=r.idBlock.valueHexView;if(a.length!==o.length)return{verified:!1,result:s};for(let u=0;u<a.length;u++)if(a[u]!==o[1])return{verified:!1,result:s}}if(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&(s[e.name]=r)),e instanceof Re.Constructed){let a=0,o={verified:!1,result:{error:"Unknown error"}},u=e.valueBlock.value.length;if(u>0&&e.valueBlock.value[0]instanceof Ke&&(u=r.valueBlock.value.length),0===u)return{verified:!0,result:s};if(0===r.valueBlock.value.length&&0!==e.valueBlock.value.length){let h=!0;for(let g=0;g<e.valueBlock.value.length;g++)h=h&&(e.valueBlock.value[g].optional||!1);return h?{verified:!0,result:s}:(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&delete s[e.name]),s.error="Inconsistent object length",{verified:!1,result:s})}for(let h=0;h<u;h++)if(h-a>=r.valueBlock.value.length){if(!1===e.valueBlock.value[h].optional){const g={verified:!1,result:s};return s.error="Inconsistent length between ASN.1 data and schema",e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&(delete s[e.name],g.name=e.name)),g}}else if(e.valueBlock.value[0]instanceof Ke){if(o=de(s,r.valueBlock.value[h],e.valueBlock.value[0].value),!1===o.verified){if(!e.valueBlock.value[0].optional)return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&delete s[e.name]),o;a++}if(d in e.valueBlock.value[0]&&e.valueBlock.value[0].name.length>0){let g={};g="local"in e.valueBlock.value[0]&&e.valueBlock.value[0].local?r:s,typeof g[e.valueBlock.value[0].name]>"u"&&(g[e.valueBlock.value[0].name]=[]),g[e.valueBlock.value[0].name].push(r.valueBlock.value[h])}}else if(o=de(s,r.valueBlock.value[h-a],e.valueBlock.value[h]),!1===o.verified){if(!e.valueBlock.value[h].optional)return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&delete s[e.name]),o;a++}if(!1===o.verified){const h={verified:!1,result:s};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&(delete s[e.name],h.name=e.name)),h}return{verified:!0,result:s}}if(e.primitiveSchema&&ue in r.valueBlock){const a=Yt(r.valueBlock.valueHexView);if(-1===a.offset){const o={verified:!1,result:a.result};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,""),e.name&&(delete s[e.name],o.name=e.name)),o}return de(s,a.result,e.primitiveSchema)}return{verified:!0,result:s}}class vt{constructor(r={}){if("view"in r)this.fromUint8Array(r.view);else if("buffer"in r)this.fromArrayBuffer(r.buffer);else if("string"in r)this.fromString(r.string);else if("hexstring"in r)this.fromHexString(r.hexstring);else if("length"in r&&r.length>0){if(this.length=r.length,r.stub)for(let e=0;e<this._view.length;e++)this._view[e]=r.stub}else this.length=0}set buffer(r){this._buffer=r,this._view=new Uint8Array(this._buffer)}get buffer(){return this._buffer}set view(r){this._buffer=new ArrayBuffer(r.length),this._view=new Uint8Array(this._buffer),this._view.set(r)}get view(){return this._view}get length(){return this.view.byteLength}set length(r){this._buffer=new ArrayBuffer(r),this._view=new Uint8Array(this._buffer)}clear(){this._buffer=new ArrayBuffer(0),this._view=new Uint8Array(this._buffer)}fromArrayBuffer(r){this._buffer=r,this._view=new Uint8Array(this._buffer)}fromUint8Array(r){this.fromArrayBuffer(new Uint8Array(r).buffer)}fromString(r){const e=r.length;this.length=e;for(let t=0;t<e;t++)this.view[t]=r.charCodeAt(t)}toString(r=0,e=this.view.length-r){let t="";(r>=this.view.length||r<0)&&(r=0),(e>=this.view.length||e<0)&&(e=this.view.length-r);for(let i=r;i<r+e;i++)t+=String.fromCharCode(this.view[i]);return t}fromHexString(r){const e=r.length;this.buffer=new ArrayBuffer(e>>1),this.view=new Uint8Array(this.buffer);const t=new Map;t.set("0",0),t.set("1",1),t.set("2",2),t.set("3",3),t.set("4",4),t.set("5",5),t.set("6",6),t.set("7",7),t.set("8",8),t.set("9",9),t.set("A",10),t.set("a",10),t.set("B",11),t.set("b",11),t.set("C",12),t.set("c",12),t.set("D",13),t.set("d",13),t.set("E",14),t.set("e",14),t.set("F",15),t.set("f",15);let i=0,a=0;for(let o=0;o<e;o++)o%2?(a|=t.get(r.charAt(o)),this.view[i]=a,i++):a=t.get(r.charAt(o))<<4}toHexString(r=0,e=this.view.length-r){let t="";(r>=this.view.length||r<0)&&(r=0),(e>=this.view.length||e<0)&&(e=this.view.length-r);for(let i=r;i<r+e;i++){const a=this.view[i].toString(16).toUpperCase();t=t+(1==a.length?"0":"")+a}return t}copy(r=0,e=this.length-r){if(!r&&!this.length)return new vt;if(r<0||r>this.length-1)throw new Error(`Wrong start position: ${r}`);return new vt({buffer:this._buffer.slice(r,r+e)})}slice(r=0,e=this.length){if(!r&&!this.length)return new vt;if(r<0||r>this.length-1)throw new Error(`Wrong start position: ${r}`);return new vt({buffer:this._buffer.slice(r,e)})}realloc(r){const e=new ArrayBuffer(r);new Uint8Array(e).set(r>this._view.length?this._view:new Uint8Array(this._buffer,0,r)),this._buffer=e,this._view=new Uint8Array(this._buffer)}append(r){const e=this.length,t=r.length,i=r._view.subarray();this.realloc(e+t),this._view.set(i,e)}insert(r,e=0,t=this.length-e){return!(e>this.length-1||(t>this.length-e&&(t=this.length-e),t>r.length&&(t=r.length),this._view.set(t==r.length?r._view:r._view.subarray(0,t),e),0))}isEqual(r){if(this.length!=r.length)return!1;for(let e=0;e<r.length;e++)if(this.view[e]!=r.view[e])return!1;return!0}isEqualView(r){if(r.length!=this.view.length)return!1;for(let e=0;e<r.length;e++)if(this.view[e]!=r[e])return!1;return!0}findPattern(r,e,t,i){const{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,i),h=r.length;if(h>o)return-1;const g=[];for(let N=0;N<h;N++)g.push(r.view[N]);for(let N=0;N<=o-h;N++){let x=!0;const G=u?a-h-N:a+N;for(let H=0;H<h;H++)if(this.view[H+G]!=g[H]){x=!1;break}if(x)return u?a-h-N:a+h+N}return-1}findFirstIn(r,e,t,i){const{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,i),h={id:-1,position:u?0:a+o,length:0};for(let g=0;g<r.length;g++){const N=this.findPattern(r[g],a,o,u);if(-1!=N){let x=!1;const G=r[g].length;u?N-G>=h.position-h.length&&(x=!0):N-G<=h.position-h.length&&(x=!0),x&&(h.position=N,h.id=g,h.length=G)}}return h}findAllIn(r,e,t){let{start:i,length:a}=this.prepareFindParameters(e,t);const o=[];let u={id:-1,position:i};for(;;){const h=u.position;if(u=this.findFirstIn(r,u.position,a),-1==u.id)break;a-=u.position-h,o.push({id:u.id,position:u.position})}return o}findAllPatternIn(r,e,t){const{start:i,length:a}=this.prepareFindParameters(e,t),o=[],u=r.length;if(u>a)return-1;const h=Array.from(r.view);for(let g=0;g<=a-u;g++){let N=!0;const x=i+g;for(let G=0;G<u;G++)if(this.view[G+x]!=h[G]){N=!1;break}N&&(o.push(i+u+g),g+=u-1)}return o}findFirstNotIn(r,e,t,i){let{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,i);const h={left:{id:-1,position:a},right:{id:-1,position:0},value:new vt};let g=o;for(;g>0;){if(h.right=this.findFirstIn(r,u?a-o+g:a+o-g,g,u),-1==h.right.id){o=g,u?a-=o:a=h.left.position,h.value=new vt({buffer:this._buffer.slice(a,a+o)});break}if(h.right.position!=(u?h.left.position-r[h.right.id].length:h.left.position+r[h.right.id].length)){u?(a=h.right.position+r[h.right.id].length,o=h.left.position-h.right.position-r[h.right.id].length):(a=h.left.position,o=h.right.position-h.left.position-r[h.right.id].length),h.value=new vt({buffer:this._buffer.slice(a,a+o)});break}h.left=h.right,g-=r[h.right.id].length}if(u){const N=h.right;h.right=h.left,h.left=N}return h}findAllNotIn(r,e,t){let{start:i,length:a}=this.prepareFindParameters(e,t);const o=[];let u={left:{id:-1,position:i},right:{id:-1,position:i},value:new vt};do{const h=u.right.position;u=this.findFirstNotIn(r,u.right.position,a),a-=u.right.position-h,o.push({left:{id:u.left.id,position:u.left.position},right:{id:u.right.id,position:u.right.position},value:u.value})}while(-1!=u.right.id);return o}findFirstSequence(r,e,t,i){let{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,i);const h=this.skipNotPatterns(r,a,o,u);if(-1==h)return{position:-1,value:new vt};const g=this.skipPatterns(r,h,o-(u?a-h:h-a),u);return u?(a=g,o=h-g):(a=h,o=g-h),{position:g,value:new vt({buffer:this._buffer.slice(a,a+o)})}}findAllSequences(r,e,t){let{start:i,length:a}=this.prepareFindParameters(e,t);const o=[];let u={position:i,value:new vt};do{const h=u.position;u=this.findFirstSequence(r,u.position,a),-1!=u.position&&(a-=u.position-h,o.push({position:u.position,value:u.value}))}while(-1!=u.position);return o}findPairedPatterns(r,e,t,i){const a=[];if(r.isEqual(e))return a;const{start:o,length:u}=this.prepareFindParameters(t,i);let h=0;const g=this.findAllPatternIn(r,o,u);if(!Array.isArray(g)||0==g.length)return a;const N=this.findAllPatternIn(e,o,u);if(!Array.isArray(N)||0==N.length)return a;for(;h<g.length&&0!=N.length;)if(g[0]!=N[0]){if(g[h]>N[0])break;for(;g[h]<N[0]&&(h++,!(h>=g.length)););a.push({left:g[h-1],right:N[0]}),g.splice(h-1,1),N.splice(0,1),h=0}else a.push({left:g[0],right:N[0]}),g.splice(0,1),N.splice(0,1);return a.sort((x,G)=>x.left-G.left),a}findPairedArrays(r,e,t,i){const{start:a,length:o}=this.prepareFindParameters(t,i),u=[];let h=0;const g=this.findAllIn(r,a,o);if(0==g.length)return u;const N=this.findAllIn(e,a,o);if(0==N.length)return u;for(;h<g.length&&0!=N.length;)if(g[0].position!=N[0].position){if(g[h].position>N[0].position)break;for(;g[h].position<N[0].position&&(h++,!(h>=g.length)););u.push({left:g[h-1],right:N[0]}),g.splice(h-1,1),N.splice(0,1),h=0}else u.push({left:g[0],right:N[0]}),g.splice(0,1),N.splice(0,1);return u.sort((x,G)=>x.left.position-G.left.position),u}replacePattern(r,e,t,i,a=null){let u,o=[];const h={status:-1,searchPatternPositions:[],replacePatternPositions:[]},{start:g,length:N}=this.prepareFindParameters(t,i);if(null==a){if(o=this.findAllIn([r],g,N),0==o.length)return h}else o=a;h.searchPatternPositions.push(...Array.from(o,re=>re.position));const x=r.length-e.length,G=new ArrayBuffer(this.view.length-o.length*x),H=new Uint8Array(G);for(H.set(new Uint8Array(this.buffer,0,g)),u=0;u<o.length;u++){const re=0==u?g:o[u-1].position;H.set(new Uint8Array(this.buffer,re,o[u].position-r.length-re),re-u*x),H.set(e.view,o[u].position-r.length-u*x),h.replacePatternPositions.push(o[u].position-r.length-u*x)}return u--,H.set(new Uint8Array(this.buffer,o[u].position,this.length-o[u].position),o[u].position-r.length+e.length-u*x),this.buffer=G,this.view=new Uint8Array(this.buffer),h.status=1,h}skipPatterns(r,e,t,i){const{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,i);let h=a;for(let g=0;g<r.length;g++){const N=r[g].length,x=u?h-N:h;let G=!0;for(let H=0;H<N;H++)if(this.view[H+x]!=r[g].view[H]){G=!1;break}if(G)if(g=-1,u){if(h-=N,h<=0)return h}else if(h+=N,h>=a+o)return h}return h}skipNotPatterns(r,e,t,i){const{start:a,length:o,backward:u}=this.prepareFindParameters(e,t,i);let h=-1;for(let g=0;g<o;g++){for(let N=0;N<r.length;N++){const x=r[N].length,G=u?a-g-x:a+g;let H=!0;for(let re=0;re<x;re++)if(this.view[re+G]!=r[N].view[re]){H=!1;break}if(H){h=u?a-g:a+g;break}}if(-1!=h)break}return h}prepareFindParameters(r=null,e=null,t=!1){return null===r&&(r=t?this.length:0),r>this.length&&(r=this.length),t?(null===e&&(e=r),e>r&&(e=r)):(null===e&&(e=this.length-r),e>this.length-r&&(e=this.length-r)),{start:r,length:e,backward:t}}}let ga=(()=>{class s{constructor(e={}){this._stream=new vt,this._length=0,this._start=0,this.backward=!1,this.appendBlock=0,this.prevLength=0,this.prevStart=0,this.stream="view"in e?new vt({view:e.view}):"buffer"in e?new vt({buffer:e.buffer}):"string"in e?new vt({string:e.string}):"hexstring"in e?new vt({hexstring:e.hexstring}):"stream"in e?e.stream.slice():new vt,"backward"in e&&e.backward&&(this.backward=e.backward,this._start=this.stream.length),"length"in e&&e.length>0&&(this._length=e.length),"start"in e&&e.start&&e.start>0&&(this._start=e.start),"appendBlock"in e&&e.appendBlock&&e.appendBlock>0&&(this.appendBlock=e.appendBlock)}set stream(e){this._stream=e,this.prevLength=this._length,this._length=e.length,this.prevStart=this._start,this._start=0}get stream(){return this._stream}set length(e){this.prevLength=this._length,this._length=e}get length(){return this.appendBlock?this.start:this._length}set start(e){e>this.stream.length||(this.prevStart=this._start,this.prevLength=this._length,this._length-=this.backward?this._start-e:e-this._start,this._start=e)}get start(){return this._start}get buffer(){return this._stream.buffer.slice(0,this._length)}resetPosition(){this._start=this.prevStart,this._length=this.prevLength}findPattern(e,t=null){(null==t||t>this.length)&&(t=this.length);const i=this.stream.findPattern(e,this.start,this.length,this.backward);if(-1==i)return i;if(this.backward){if(i<this.start-e.length-t)return-1}else if(i>this.start+e.length+t)return-1;return this.start=i,i}findFirstIn(e,t=null){(null==t||t>this.length)&&(t=this.length);const i=this.stream.findFirstIn(e,this.start,this.length,this.backward);if(-1==i.id)return i;if(this.backward){if(i.position<this.start-e[i.id].length-t)return{id:-1,position:this.backward?0:this.start+this.length}}else if(i.position>this.start+e[i.id].length+t)return{id:-1,position:this.backward?0:this.start+this.length};return this.start=i.position,i}findAllIn(e){return this.stream.findAllIn(e,this.backward?this.start-this.length:this.start,this.length)}findFirstNotIn(e,t=null){(null==t||t>this._length)&&(t=this._length);const i=this._stream.findFirstNotIn(e,this._start,this._length,this.backward);if(-1==i.left.id&&-1==i.right.id)return i;if(this.backward){if(-1!=i.right.id&&i.right.position<this._start-e[i.right.id].length-t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new vt}}else if(-1!=i.left.id&&i.left.position>this._start+e[i.left.id].length+t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new vt};return this.start=this.backward?-1==i.left.id?0:i.left.position:-1==i.right.id?this._start+this._length:i.right.position,i}findAllNotIn(e){return this._stream.findAllNotIn(e,this.backward?this._start-this._length:this._start,this._length)}findFirstSequence(e,t=null,i=null){(null==t||t>this._length)&&(t=this._length),(null==i||i>t)&&(i=t);const a=this._stream.findFirstSequence(e,this._start,t,this.backward);if(0==a.value.length)return a;if(this.backward){if(a.position<this._start-a.value.length-i)return{position:-1,value:new vt}}else if(a.position>this._start+a.value.length+i)return{position:-1,value:new vt};return this.start=a.position,a}findAllSequences(e){return this.stream.findAllSequences(e,this.backward?this.start-this.length:this.start,this.length)}findPairedPatterns(e,t,i=null){(null==i||i>this.length)&&(i=this.length);const o=this.stream.findPairedPatterns(e,t,this.backward?this.start-this.length:this.start,this.length);if(o.length)if(this.backward){if(o[0].right<this.start-t.length-i)return[]}else if(o[0].left>this.start+e.length+i)return[];return o}findPairedArrays(e,t,i=null){(null==i||i>this.length)&&(i=this.length);const o=this.stream.findPairedArrays(e,t,this.backward?this.start-this.length:this.start,this.length);if(o.length)if(this.backward){if(o[0].right.position<this.start-t[o[0].right.id].length-i)return[]}else if(o[0].left.position>this.start+e[o[0].left.id].length+i)return[];return o}replacePattern(e,t){return this.stream.replacePattern(e,t,this.backward?this.start-this.length:this.start,this.length)}skipPatterns(e){const t=this.stream.skipPatterns(e,this.start,this.length,this.backward);return this.start=t,t}skipNotPatterns(e){const t=this.stream.skipNotPatterns(e,this.start,this.length,this.backward);return-1==t?-1:(this.start=t,t)}append(e){this.beforeAppend(e.length),this._stream.view.set(e.view,this._start),this._length+=2*e.length,this.start=this._start+e.length,this.prevLength-=2*e.length}appendView(e){this.beforeAppend(e.length),this._stream.view.set(e,this._start),this._length+=2*e.length,this.start=this._start+e.length,this.prevLength-=2*e.length}appendChar(e){this.beforeAppend(1),this._stream.view[this._start]=e,this._length+=2,this.start=this._start+1,this.prevLength-=2}appendUint16(e){this.beforeAppend(2);const t=new Uint16Array([e]),i=new Uint8Array(t.buffer);this.stream.view[this._start]=i[1],this._stream.view[this._start+1]=i[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendUint24(e){this.beforeAppend(3);const t=new Uint32Array([e]),i=new Uint8Array(t.buffer);this._stream.view[this._start]=i[2],this._stream.view[this._start+1]=i[1],this._stream.view[this._start+2]=i[0],this._length+=6,this.start=this._start+3,this.prevLength-=6}appendUint32(e){this.beforeAppend(4);const t=new Uint32Array([e]),i=new Uint8Array(t.buffer);this._stream.view[this._start]=i[3],this._stream.view[this._start+1]=i[2],this._stream.view[this._start+2]=i[1],this._stream.view[this._start+3]=i[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}appendInt16(e){this.beforeAppend(2);const t=new Int16Array([e]),i=new Uint8Array(t.buffer);this._stream.view[this._start]=i[1],this._stream.view[this._start+1]=i[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendInt32(e){this.beforeAppend(4);const t=new Int32Array([e]),i=new Uint8Array(t.buffer);this._stream.view[this._start]=i[3],this._stream.view[this._start+1]=i[2],this._stream.view[this._start+2]=i[1],this._stream.view[this._start+3]=i[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}getBlock(e,t=!0){if(this._length<=0)return new Uint8Array(0);let i;if(this._length<e&&(e=this._length),this.backward){const a=this._stream.view.subarray(this._length-e,this._length);i=new Uint8Array(e);for(let o=0;o<e;o++)i[e-1-o]=a[o]}else i=this._stream.view.subarray(this._start,this._start+e);return t&&(this.start+=this.backward?-1*e:e),i}getUint16(e=!0){const t=this.getBlock(2,e);return t.length<2?0:t[0]<<8|t[1]}getInt16(e=!0){const t=this.getUint16(e),i=32768;return t&i?-(i-(t^i)):t}getUint24(e=!0){const t=this.getBlock(4,e);return t.length<3?0:t[0]<<16|t[1]<<8|t[2]}getUint32(e=!0){const t=this.getBlock(4,e);return t.length<4?0:16777216*t[0]+(t[1]<<16)+(t[2]<<8)+t[3]}getInt32(e=!0){const t=this.getUint32(e),i=2147483648;return t&i?-(i-(t^i)):t}beforeAppend(e){this._start+e>this._stream.length&&(e>this.appendBlock&&(this.appendBlock=e+s.APPEND_BLOCK),this._stream.realloc(this._stream.length+this.appendBlock))}}return s.APPEND_BLOCK=1e3,s})();function lu(s,...r){if(!function Am(s){return s instanceof Uint8Array||null!=s&&"object"==typeof s&&"Uint8Array"===s.constructor.name}(s))throw new Error("Uint8Array expected");if(r.length>0&&!r.includes(s.length))throw new Error(`Uint8Array expected of length ${r}, not of length=${s.length}`)}function cu(s,r=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(r&&s.finished)throw new Error("Hash#digest() has already been called")}const uu=s=>new DataView(s.buffer,s.byteOffset,s.byteLength),rs=(s,r)=>s<<32-r|s>>>r,hu=(s,r)=>s<<r|s>>>32-r>>>0;function Ml(s){return"string"==typeof s&&(s=function Nm(s){if("string"!=typeof s)throw new Error("utf8ToBytes expected string, got "+typeof s);return new Uint8Array((new TextEncoder).encode(s))}(s)),lu(s),s}new Uint8Array(new Uint32Array([287454020]).buffer);class Im{clone(){return this._cloneInto()}}function Ll(s){const r=t=>s().update(Ml(t)).digest(),e=s();return r.outputLen=e.outputLen,r.blockLen=e.blockLen,r.create=()=>s(),r}const Ld=(s,r,e)=>s&r^~s&e,Fd=(s,r,e)=>s&r^s&e^r&e;class fu extends Im{constructor(r,e,t,i){super(),this.blockLen=r,this.outputLen=e,this.padOffset=t,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(r),this.view=uu(this.buffer)}update(r){cu(this);const{view:e,buffer:t,blockLen:i}=this,a=(r=Ml(r)).length;for(let o=0;o<a;){const u=Math.min(i-this.pos,a-o);if(u!==i)t.set(r.subarray(o,o+u),this.pos),this.pos+=u,o+=u,this.pos===i&&(this.process(e,0),this.pos=0);else{const h=uu(r);for(;i<=a-o;o+=i)this.process(h,o)}}return this.length+=r.length,this.roundClean(),this}digestInto(r){cu(this),function Ud(s,r){lu(s);const e=r.outputLen;if(s.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}(r,this),this.finished=!0;const{buffer:e,view:t,blockLen:i,isLE:a}=this;let{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(t,0),o=0);for(let x=o;x<i;x++)e[x]=0;(function Rm(s,r,e,t){if("function"==typeof s.setBigUint64)return s.setBigUint64(r,e,t);const i=BigInt(32),a=BigInt(4294967295),o=Number(e>>i&a),u=Number(e&a),g=t?0:4;s.setUint32(r+(t?4:0),o,t),s.setUint32(r+g,u,t)})(t,i-8,BigInt(8*this.length),a),this.process(t,0);const u=uu(r),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const g=h/4,N=this.get();if(g>N.length)throw new Error("_sha2: outputLen bigger than state");for(let x=0;x<g;x++)u.setUint32(4*x,N[x],a)}digest(){const{buffer:r,outputLen:e}=this;this.digestInto(r);const t=r.slice(0,e);return this.destroy(),t}_cloneInto(r){r||(r=new this.constructor),r.set(...this.get());const{blockLen:e,buffer:t,length:i,finished:a,destroyed:o,pos:u}=this;return r.length=i,r.pos=u,r.finished=a,r.destroyed=o,i%e&&r.buffer.set(t),r}}const pa=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),_s=new Uint32Array(80);class Tm extends fu{constructor(){super(64,20,8,!1),this.A=0|pa[0],this.B=0|pa[1],this.C=0|pa[2],this.D=0|pa[3],this.E=0|pa[4]}get(){const{A:r,B:e,C:t,D:i,E:a}=this;return[r,e,t,i,a]}set(r,e,t,i,a){this.A=0|r,this.B=0|e,this.C=0|t,this.D=0|i,this.E=0|a}process(r,e){for(let h=0;h<16;h++,e+=4)_s[h]=r.getUint32(e,!1);for(let h=16;h<80;h++)_s[h]=hu(_s[h-3]^_s[h-8]^_s[h-14]^_s[h-16],1);let{A:t,B:i,C:a,D:o,E:u}=this;for(let h=0;h<80;h++){let g,N;h<20?(g=Ld(i,a,o),N=1518500249):h<40?(g=i^a^o,N=1859775393):h<60?(g=Fd(i,a,o),N=2400959708):(g=i^a^o,N=3395469782);const x=hu(t,5)+g+u+N+_s[h]|0;u=o,o=a,a=hu(i,30),i=t,t=x}t=t+this.A|0,i=i+this.B|0,a=a+this.C|0,o=o+this.D|0,u=u+this.E|0,this.set(t,i,a,o,u)}roundClean(){_s.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}const xm=Ll(()=>new Tm),Vm=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Cs=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ns=new Uint32Array(64);class Hd extends fu{constructor(){super(64,32,8,!1),this.A=0|Cs[0],this.B=0|Cs[1],this.C=0|Cs[2],this.D=0|Cs[3],this.E=0|Cs[4],this.F=0|Cs[5],this.G=0|Cs[6],this.H=0|Cs[7]}get(){const{A:r,B:e,C:t,D:i,E:a,F:o,G:u,H:h}=this;return[r,e,t,i,a,o,u,h]}set(r,e,t,i,a,o,u,h){this.A=0|r,this.B=0|e,this.C=0|t,this.D=0|i,this.E=0|a,this.F=0|o,this.G=0|u,this.H=0|h}process(r,e){for(let x=0;x<16;x++,e+=4)Ns[x]=r.getUint32(e,!1);for(let x=16;x<64;x++){const G=Ns[x-15],H=Ns[x-2],re=rs(G,7)^rs(G,18)^G>>>3,Ae=rs(H,17)^rs(H,19)^H>>>10;Ns[x]=Ae+Ns[x-7]+re+Ns[x-16]|0}let{A:t,B:i,C:a,D:o,E:u,F:h,G:g,H:N}=this;for(let x=0;x<64;x++){const H=N+(rs(u,6)^rs(u,11)^rs(u,25))+Ld(u,h,g)+Vm[x]+Ns[x]|0,Ae=(rs(t,2)^rs(t,13)^rs(t,22))+Fd(t,i,a)|0;N=g,g=h,h=u,u=o+H|0,o=a,a=i,i=t,t=H+Ae|0}t=t+this.A|0,i=i+this.B|0,a=a+this.C|0,o=o+this.D|0,u=u+this.E|0,h=h+this.F|0,g=g+this.G|0,N=N+this.H|0,this.set(t,i,a,o,u,h,g,N)}roundClean(){Ns.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Om=Ll(()=>new Hd),Fl=BigInt(2**32-1),mu=BigInt(32);function jd(s,r=!1){return r?{h:Number(s&Fl),l:Number(s>>mu&Fl)}:{h:0|Number(s>>mu&Fl),l:0|Number(s&Fl)}}const qe_split=function Pm(s,r=!1){let e=new Uint32Array(s.length),t=new Uint32Array(s.length);for(let i=0;i<s.length;i++){const{h:a,l:o}=jd(s[i],r);[e[i],t[i]]=[a,o]}return[e,t]},qe_shrSH=(s,r,e)=>s>>>e,qe_shrSL=(s,r,e)=>s<<32-e|r>>>e,qe_rotrSH=(s,r,e)=>s>>>e|r<<32-e,qe_rotrSL=(s,r,e)=>s<<32-e|r>>>e,qe_rotrBH=(s,r,e)=>s<<64-e|r>>>e-32,qe_rotrBL=(s,r,e)=>s>>>e-32|r<<64-e,qe_add=function Wm(s,r,e,t){const i=(r>>>0)+(t>>>0);return{h:s+e+(i/2**32|0)|0,l:0|i}},qe_add3L=(s,r,e)=>(s>>>0)+(r>>>0)+(e>>>0),qe_add3H=(s,r,e,t)=>r+e+t+(s/2**32|0)|0,qe_add4L=(s,r,e,t)=>(s>>>0)+(r>>>0)+(e>>>0)+(t>>>0),qe_add4H=(s,r,e,t,i)=>r+e+t+i+(s/2**32|0)|0,qe_add5H=(s,r,e,t,i,a)=>r+e+t+i+a+(s/2**32|0)|0,qe_add5L=(s,r,e,t,i)=>(s>>>0)+(r>>>0)+(e>>>0)+(t>>>0)+(i>>>0),[Ym,Xm]=qe_split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(s=>BigInt(s))),Is=new Uint32Array(80),Bs=new Uint32Array(80);class Hl extends fu{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:r,Al:e,Bh:t,Bl:i,Ch:a,Cl:o,Dh:u,Dl:h,Eh:g,El:N,Fh:x,Fl:G,Gh:H,Gl:re,Hh:Ae,Hl:we}=this;return[r,e,t,i,a,o,u,h,g,N,x,G,H,re,Ae,we]}set(r,e,t,i,a,o,u,h,g,N,x,G,H,re,Ae,we){this.Ah=0|r,this.Al=0|e,this.Bh=0|t,this.Bl=0|i,this.Ch=0|a,this.Cl=0|o,this.Dh=0|u,this.Dl=0|h,this.Eh=0|g,this.El=0|N,this.Fh=0|x,this.Fl=0|G,this.Gh=0|H,this.Gl=0|re,this.Hh=0|Ae,this.Hl=0|we}process(r,e){for(let oe=0;oe<16;oe++,e+=4)Is[oe]=r.getUint32(e),Bs[oe]=r.getUint32(e+=4);for(let oe=16;oe<80;oe++){const ce=0|Is[oe-15],pe=0|Bs[oe-15],be=qe_rotrSH(ce,pe,1)^qe_rotrSH(ce,pe,8)^qe_shrSH(ce,pe,7),Be=qe_rotrSL(ce,pe,1)^qe_rotrSL(ce,pe,8)^qe_shrSL(ce,pe,7),xe=0|Is[oe-2],Ue=0|Bs[oe-2],We=qe_rotrSH(xe,Ue,19)^qe_rotrBH(xe,Ue,61)^qe_shrSH(xe,Ue,6),bt=qe_rotrSL(xe,Ue,19)^qe_rotrBL(xe,Ue,61)^qe_shrSL(xe,Ue,6),Ye=qe_add4L(Be,bt,Bs[oe-7],Bs[oe-16]),lt=qe_add4H(Ye,be,We,Is[oe-7],Is[oe-16]);Is[oe]=0|lt,Bs[oe]=0|Ye}let{Ah:t,Al:i,Bh:a,Bl:o,Ch:u,Cl:h,Dh:g,Dl:N,Eh:x,El:G,Fh:H,Fl:re,Gh:Ae,Gl:we,Hh:ie,Hl:ye}=this;for(let oe=0;oe<80;oe++){const ce=qe_rotrSH(x,G,14)^qe_rotrSH(x,G,18)^qe_rotrBH(x,G,41),pe=qe_rotrSL(x,G,14)^qe_rotrSL(x,G,18)^qe_rotrBL(x,G,41),be=x&H^~x&Ae,xe=qe_add5L(ye,pe,G&re^~G&we,Xm[oe],Bs[oe]),Ue=qe_add5H(xe,ie,ce,be,Ym[oe],Is[oe]),We=0|xe,bt=qe_rotrSH(t,i,28)^qe_rotrBH(t,i,34)^qe_rotrBH(t,i,39),Ye=qe_rotrSL(t,i,28)^qe_rotrBL(t,i,34)^qe_rotrBL(t,i,39),lt=t&a^t&u^a&u,Kt=i&o^i&h^o&h;ie=0|Ae,ye=0|we,Ae=0|H,we=0|re,H=0|x,re=0|G,({h:x,l:G}=qe_add(0|g,0|N,0|Ue,0|We)),g=0|u,N=0|h,u=0|a,h=0|o,a=0|t,o=0|i;const Pt=qe_add3L(We,Ye,Kt);t=qe_add3H(Pt,Ue,bt,lt),i=0|Pt}({h:t,l:i}=qe_add(0|this.Ah,0|this.Al,0|t,0|i)),({h:a,l:o}=qe_add(0|this.Bh,0|this.Bl,0|a,0|o)),({h:u,l:h}=qe_add(0|this.Ch,0|this.Cl,0|u,0|h)),({h:g,l:N}=qe_add(0|this.Dh,0|this.Dl,0|g,0|N)),({h:x,l:G}=qe_add(0|this.Eh,0|this.El,0|x,0|G)),({h:H,l:re}=qe_add(0|this.Fh,0|this.Fl,0|H,0|re)),({h:Ae,l:we}=qe_add(0|this.Gh,0|this.Gl,0|Ae,0|we)),({h:ie,l:ye}=qe_add(0|this.Hh,0|this.Hl,0|ie,0|ye)),this.set(t,i,a,o,u,h,g,N,x,G,H,re,Ae,we,ie,ye)}roundClean(){Is.fill(0),Bs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Qm extends Hl{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const Zm=Ll(()=>new Hl),eg=Ll(()=>new Qm),Nt=new ArrayBuffer(0),w="";let ot=(()=>{class s extends TypeError{constructor(){super(...arguments),this.name=s.NAME}static isType(e,t){if("string"==typeof t){if("Array"===t&&Array.isArray(e))return!0;if("ArrayBuffer"===t&&e instanceof ArrayBuffer)return!0;if("ArrayBufferView"===t&&ArrayBuffer.isView(e))return!0;if(typeof e===t)return!0}else if(e instanceof t)return!0;return!1}static assert(e,t,...i){for(const o of i)if(this.isType(e,o))return;const a=i.map(o=>o instanceof Function&&"name"in o?o.name:`${o}`);throw new s(`Parameter '${t}' is not of type ${a.length>1?`(${a.join(" or ")})`:a[0]}`)}}return s.NAME="ArgumentError",s})(),st=(()=>{class s extends TypeError{static assert(...e){let i,a,t=null;"string"==typeof e[0]?(t=e[0],i=e[1],a=e.slice(2)):(i=e[0],a=e.slice(1)),ot.assert(i,"parameters","object");for(const o of a)if(null==i[o])throw new s(o,t)}static assertEmpty(e,t,i){if(null==e)throw new s(t,i)}constructor(e,t=null,i){super(),this.name=s.NAME,this.field=e,t&&(this.target=t),this.message=i||`Absent mandatory parameter '${e}' ${t?` in '${t}'`:w}`}}return s.NAME="ParameterError",s})();class le extends Error{static assertSchema(r,e){if(!r.verified)throw new Error(`Object's schema was not verified against input data for ${e}`)}static assert(r,e){if(-1===r.offset)throw new le(`Error during parsing of ASN.1 data. Data is not correct for '${e}'.`)}constructor(r){super(r),this.name="AsnError"}}let fe=(()=>{class s{static blockName(){return this.CLASS_NAME}static fromBER(e){const t=Et(e);le.assert(t,this.name);try{return new this({schema:t.result})}catch{throw new le(`Cannot create '${this.CLASS_NAME}' from ASN.1 object`)}}static defaultValues(e){throw new Error(`Invalid member name for ${this.CLASS_NAME} class: ${e}`)}static schema(e={}){throw new Error(`Method '${this.CLASS_NAME}.schema' should be overridden`)}get className(){return this.constructor.CLASS_NAME}toString(e="hex"){let t;try{t=this.toSchema()}catch{t=this.toSchema(!0)}return L.U$.ToString(t.toBER(),e)}}return s.CLASS_NAME="PkiObject",s})();function Rs(s){let r=!1,e=w;const t=s.trim();for(let i=0;i<t.length;i++)32===t.charCodeAt(i)?!1===r&&(r=!0):(r&&(e+=" ",r=!1),e+=t[i]);return e.toLowerCase()}const va="type",gu="value";let pu=(()=>{class s extends fe{constructor(e={}){super(),this.type=c(e,va,s.defaultValues(va)),this.value=c(e,gu,s.defaultValues(gu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case va:return w;case gu:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.type||w}),new Fe({name:t.value||w})]})}fromSchema(e){ne(e,[va,"typeValue"]);const t=de(e,e,s.schema({names:{type:va,value:"typeValue"}}));le.assertSchema(t,this.className),this.type=t.result.type.valueBlock.toString(),this.value=t.result.typeValue}toSchema(){return new U({value:[new Ve({value:this.type}),this.value]})}toJSON(){const e={type:this.type};return e.value=0!==Object.keys(this.value).length?this.value.toJSON():this.value,e}isEqual(e){const t=[is.blockName(),Xt.blockName(),fa.blockName(),Mr.blockName(),Jt.blockName(),ma.blockName(),iu.blockName(),Pl.blockName(),ru.blockName(),Dl.blockName(),nu.blockName(),au.blockName()];if(e instanceof ArrayBuffer)return L._H.isEqual(this.value.valueBeforeDecodeView,e);if(e.constructor.blockName()===s.blockName()){if(this.type!==e.type)return!1;const i=[!1,!1],a=this.value.constructor.blockName();for(const u of t)a===u&&(i[0]=!0),e.value.constructor.blockName()===u&&(i[1]=!0);if(i[0]!==i[1])return!1;if(i[0]&&i[1]){const u=Rs(this.value.valueBlock.value),h=Rs(e.value.valueBlock.value);if(0!==u.localeCompare(h))return!1}else if(!L._H.isEqual(this.value.valueBeforeDecodeView,e.value.valueBeforeDecodeView))return!1;return!0}return!1}}return s.CLASS_NAME="AttributeTypeAndValue",s})();const Ai="typesAndValues",jl="valueBeforeDecode";let ft=(()=>{class s extends fe{constructor(e={}){super(),this.typesAndValues=c(e,Ai,s.defaultValues(Ai)),this.valueBeforeDecode=c(e,jl,s.defaultValues(jl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ai:return[];case jl:return Nt;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ai:return 0===t.length;case jl:return 0===t.byteLength;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ke({name:t.repeatedSequence||w,value:new kt({value:[new Ke({name:t.repeatedSet||w,value:pu.schema(t.typeAndValue||{})})]})})]})}fromSchema(e){ne(e,["RDN",Ai]);const t=de(e,e,s.schema({names:{blockName:"RDN",repeatedSet:Ai}}));le.assertSchema(t,this.className),Ai in t.result&&(this.typesAndValues=Array.from(t.result.typesAndValues,i=>new pu({schema:i}))),this.valueBeforeDecode=t.result.RDN.valueBeforeDecodeView.slice().buffer}toSchema(){if(0===this.valueBeforeDecode.byteLength)return new U({value:[new kt({value:Array.from(this.typesAndValues,t=>t.toSchema())})]});const e=Et(this.valueBeforeDecode);if(le.assert(e,"RelativeDistinguishedNames"),!(e.result instanceof U))throw new Error("ASN.1 result should be SEQUENCE");return e.result}toJSON(){return{typesAndValues:Array.from(this.typesAndValues,e=>e.toJSON())}}isEqual(e){if(e instanceof s){if(this.typesAndValues.length!==e.typesAndValues.length)return!1;for(const[t,i]of this.typesAndValues.entries())if(!1===i.isEqual(e.typesAndValues[t]))return!1;return!0}return e instanceof ArrayBuffer&&W(this.valueBeforeDecode,e)}}return s.CLASS_NAME="RelativeDistinguishedNames",s})();const wa="type",ya="value";function tg(s={},r=!1){const e=c(s,"names",{});return new U({optional:r,value:[new z({optional:!0,idBlock:{tagClass:2,tagNumber:1},name:e.country_name||w,value:[new dt({value:[new Mr,new Jt]})]}),new z({optional:!0,idBlock:{tagClass:2,tagNumber:2},name:e.administration_domain_name||w,value:[new dt({value:[new Mr,new Jt]})]}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:0},name:e.network_address||w,isHexOnly:!0}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:1},name:e.terminal_identifier||w,isHexOnly:!0}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:2},name:e.private_domain_name||w,value:[new dt({value:[new Mr,new Jt]})]}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:3},name:e.organization_name||w,isHexOnly:!0}),new Le({optional:!0,name:e.numeric_user_identifier||w,idBlock:{tagClass:3,tagNumber:4},isHexOnly:!0}),new z({optional:!0,name:e.personal_name||w,idBlock:{tagClass:3,tagNumber:5},value:[new Le({idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:1},isHexOnly:!0}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:2},isHexOnly:!0}),new Le({optional:!0,idBlock:{tagClass:3,tagNumber:3},isHexOnly:!0})]}),new z({optional:!0,name:e.organizational_unit_names||w,idBlock:{tagClass:3,tagNumber:6},value:[new Ke({value:new Jt})]})]})}function sg(s=!1){return new U({optional:s,value:[new Jt,new Jt]})}function ig(s=!1){return new kt({optional:s,value:[new Le({optional:!0,idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Fe]})]})}let St=(()=>{class s extends fe{constructor(e={}){super(),this.type=c(e,wa,s.defaultValues(wa)),this.value=c(e,ya,s.defaultValues(ya)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wa:return 9;case ya:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case wa:return t===s.defaultValues(e);case ya:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new dt({value:[new z({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||w,value:[new Ve,new z({idBlock:{tagClass:3,tagNumber:0},value:[new Fe]})]}),new Le({name:t.blockName||w,idBlock:{tagClass:3,tagNumber:1}}),new Le({name:t.blockName||w,idBlock:{tagClass:3,tagNumber:2}}),new z({idBlock:{tagClass:3,tagNumber:3},name:t.blockName||w,value:[tg(t.builtInStandardAttributes||{},!1),sg(!0),ig(!0)]}),new z({idBlock:{tagClass:3,tagNumber:4},name:t.blockName||w,value:[ft.schema(t.directoryName||{})]}),new z({idBlock:{tagClass:3,tagNumber:5},name:t.blockName||w,value:[new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new dt({value:[new ma,new Jt,new fa,new is,new Xt]})]}),new z({idBlock:{tagClass:3,tagNumber:1},value:[new dt({value:[new ma,new Jt,new fa,new is,new Xt]})]})]}),new Le({name:t.blockName||w,idBlock:{tagClass:3,tagNumber:6}}),new Le({name:t.blockName||w,idBlock:{tagClass:3,tagNumber:7}}),new Le({name:t.blockName||w,idBlock:{tagClass:3,tagNumber:8}})]})}fromSchema(e){ne(e,["blockName","otherName","rfc822Name","dNSName","x400Address","directoryName","ediPartyName","uniformResourceIdentifier","iPAddress","registeredID"]);const t=de(e,e,s.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));switch(le.assertSchema(t,this.className),this.type=t.result.blockName.idBlock.tagNumber,this.type){case 0:case 3:this.value=t.result.blockName;break;case 1:case 2:case 6:{const i=t.result.blockName;i.idBlock.tagClass=1,i.idBlock.tagNumber=22;const o=Et(i.toBER(!1));le.assert(o,"GeneralName value"),this.value=o.result.valueBlock.value}break;case 4:this.value=new ft({schema:t.result.directoryName});break;case 5:this.value=t.result.ediPartyName;break;case 7:this.value=new me({valueHex:t.result.blockName.valueBlock.valueHex});break;case 8:{const i=t.result.blockName;i.idBlock.tagClass=1,i.idBlock.tagNumber=6;const o=Et(i.toBER(!1));le.assert(o,"GeneralName registeredID"),this.value=o.result.valueBlock.toString()}}}toSchema(){switch(this.type){case 0:case 3:case 5:return new z({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:{const e=new Pl({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 4:return new z({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:{const e=this.value;return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 8:{const e=new Ve({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}default:return s.schema()}}toJSON(){const e={type:this.type,value:w};if("string"==typeof this.value)e.value=this.value;else try{e.value=this.value.toJSON()}catch{}return e}}return s.CLASS_NAME="GeneralName",s})();const Sa="accessMethod",ba="accessLocation",rg=[Sa,ba];let Kd=(()=>{class s extends fe{constructor(e={}){super(),this.accessMethod=c(e,Sa,s.defaultValues(Sa)),this.accessLocation=c(e,ba,s.defaultValues(ba)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Sa:return w;case ba:return new St;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.accessMethod||w}),St.schema(t.accessLocation||{})]})}fromSchema(e){ne(e,rg);const t=de(e,e,s.schema({names:{accessMethod:Sa,accessLocation:{names:{blockName:ba}}}}));le.assertSchema(t,this.className),this.accessMethod=t.result.accessMethod.valueBlock.toString(),this.accessLocation=new St({schema:t.result.accessLocation})}toSchema(){return new U({value:[new Ve({value:this.accessMethod}),this.accessLocation.toSchema()]})}toJSON(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}return s.CLASS_NAME="AccessDescription",s})();const Ts="seconds",xs="millis",Vs="micros";let Fr=(()=>{class s extends fe{constructor(e={}){super(),Ts in e&&(this.seconds=c(e,Ts,s.defaultValues(Ts))),xs in e&&(this.millis=c(e,xs,s.defaultValues(xs))),Vs in e&&(this.micros=c(e,Vs,s.defaultValues(Vs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ts:case xs:case Vs:return 0;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ts:case xs:case Vs:return t===s.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,optional:!0,value:[new Q({optional:!0,name:t.seconds||w}),new Le({name:t.millis||w,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Le({name:t.micros||w,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){ne(e,[Ts,xs,Vs]);const t=de(e,e,s.schema({names:{seconds:Ts,millis:xs,micros:Vs}}));if(le.assertSchema(t,this.className),"seconds"in t.result&&(this.seconds=t.result.seconds.valueBlock.valueDec),"millis"in t.result){const i=new Q({valueHex:t.result.millis.valueBlock.valueHex});this.millis=i.valueBlock.valueDec}if("micros"in t.result){const i=new Q({valueHex:t.result.micros.valueBlock.valueHex});this.micros=i.valueBlock.valueDec}}toSchema(){const e=[];if(void 0!==this.seconds&&e.push(new Q({value:this.seconds})),void 0!==this.millis){const t=new Q({value:this.millis});e.push(new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:t.valueBlock.valueHexView}))}if(void 0!==this.micros){const t=new Q({value:this.micros});e.push(new Le({idBlock:{tagClass:3,tagNumber:1},valueHex:t.valueBlock.valueHexView}))}return new U({value:e})}toJSON(){const e={};return void 0!==this.seconds&&(e.seconds=this.seconds),void 0!==this.millis&&(e.millis=this.millis),void 0!==this.micros&&(e.micros=this.micros),e}}return s.CLASS_NAME="Accuracy",s})();const $l="algorithmId",Aa="algorithmParams",Gd="algorithm",vu="params",ng=[Gd,vu];let Z=(()=>{class s extends fe{constructor(e={}){super(),this.algorithmId=c(e,$l,s.defaultValues($l)),Aa in e&&(this.algorithmParams=c(e,Aa,s.defaultValues(Aa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $l:return w;case Aa:return new Fe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case $l:return t===w;case Aa:return t instanceof Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,optional:t.optional||!1,value:[new Ve({name:t.algorithmIdentifier||w}),new Fe({name:t.algorithmParams||w,optional:!0})]})}fromSchema(e){ne(e,ng);const t=de(e,e,s.schema({names:{algorithmIdentifier:Gd,algorithmParams:vu}}));le.assertSchema(t,this.className),this.algorithmId=t.result.algorithm.valueBlock.toString(),vu in t.result&&(this.algorithmParams=t.result.params)}toSchema(){const e=[];return e.push(new Ve({value:this.algorithmId})),this.algorithmParams&&!(this.algorithmParams instanceof Fe)&&e.push(this.algorithmParams),new U({value:e})}toJSON(){const e={algorithmId:this.algorithmId};return this.algorithmParams&&!(this.algorithmParams instanceof Fe)&&(e.algorithmParams=this.algorithmParams.toJSON()),e}isEqual(e){return e instanceof s&&this.algorithmId===e.algorithmId&&(this.algorithmParams?!!e.algorithmParams&&JSON.stringify(this.algorithmParams)===JSON.stringify(e.algorithmParams):!e.algorithmParams)}}return s.CLASS_NAME="AlgorithmIdentifier",s})();const Hr="altNames",ag=[Hr];let Jd=(()=>{class s extends fe{constructor(e={}){super(),this.altNames=c(e,Hr,s.defaultValues(Hr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Hr?[]:super.defaultValues(e)}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ke({name:t.altNames||w,value:St.schema()})]})}fromSchema(e){ne(e,ag);const t=de(e,e,s.schema({names:{altNames:Hr}}));le.assertSchema(t,this.className),Hr in t.result&&(this.altNames=Array.from(t.result.altNames,i=>new St({schema:i})))}toSchema(){return new U({value:Array.from(this.altNames,e=>e.toSchema())})}toJSON(){return{altNames:Array.from(this.altNames,e=>e.toJSON())}}}return s.CLASS_NAME="AltName",s})();const jr="type",$r="values",og=[jr,$r];let it=(()=>{class s extends fe{constructor(e={}){super(),this.type=c(e,jr,s.defaultValues(jr)),this.values=c(e,$r,s.defaultValues($r)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case jr:return w;case $r:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case jr:return t===w;case $r:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.type||w}),new kt({name:t.setName||w,value:[new Ke({name:t.values||w,value:new Fe})]})]})}fromSchema(e){ne(e,og);const t=de(e,e,s.schema({names:{type:jr,values:$r}}));le.assertSchema(t,this.className),this.type=t.result.type.valueBlock.toString(),this.values=t.result.values}toSchema(){return new U({value:[new Ve({value:this.type}),new kt({value:this.values})]})}toJSON(){return{type:this.type,values:Array.from(this.values,e=>e.toJSON())}}}return s.CLASS_NAME="Attribute",s})();const ka="notBeforeTime",Ea="notAfterTime",lg=[ka,Ea];let Kr=(()=>{class s extends fe{constructor(e={}){super(),this.notBeforeTime=c(e,ka,s.defaultValues(ka)),this.notAfterTime=c(e,Ea,s.defaultValues(Ea)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ka:case Ea:return new Date(0,0,0);default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new ht({name:t.notBeforeTime||w}),new ht({name:t.notAfterTime||w})]})}fromSchema(e){ne(e,lg);const t=de(e,e,s.schema({names:{notBeforeTime:ka,notAfterTime:Ea}}));le.assertSchema(t,this.className),this.notBeforeTime=t.result.notBeforeTime.toDate(),this.notAfterTime=t.result.notAfterTime.toDate()}toSchema(){return new U({value:[new ht({valueDate:this.notBeforeTime}),new ht({valueDate:this.notAfterTime})]})}toJSON(){return{notBeforeTime:this.notBeforeTime,notAfterTime:this.notAfterTime}}}return s.CLASS_NAME="AttCertValidityPeriod",s})();const _a="names",qd="generalNames";let Rt=(()=>{class s extends fe{constructor(e={}){super(),this.names=c(e,_a,s.defaultValues(_a)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return"names"===e?[]:super.defaultValues(e)}static schema(e={},t=!1){const i=c(e,_a,{});return new U({optional:t,name:i.blockName||w,value:[new Ke({name:i.generalNames||w,value:St.schema()})]})}fromSchema(e){ne(e,[_a,qd]);const t=de(e,e,s.schema({names:{blockName:_a,generalNames:qd}}));le.assertSchema(t,this.className),this.names=Array.from(t.result.generalNames,i=>new St({schema:i}))}toSchema(){return new U({value:Array.from(this.names,e=>e.toSchema())})}toJSON(){return{names:Array.from(this.names,e=>e.toJSON())}}}return s.CLASS_NAME="GeneralNames",s})();const zd="2.5.29.17",Wd="2.5.29.18",wu="2.5.29.19",Yd="2.5.29.28",Xd="2.5.29.29",Qd="2.5.29.30",Zd="2.5.29.31",yu="2.5.29.46",ef="2.5.29.32",qt="2.5.29.32.0",tf="2.5.29.33",Su="2.5.29.35",sf="2.5.29.36",bu="1.3.6.1.5.5.7.1.1",Au="1.2.840.113549.1.7.1",nf="1.2.840.113549.1.7.3",af="1.2.840.113549.1.7.6",of="1.2.840.113549.1.9.22.1",lf="1.2.840.113549.1.9.22.3",cf="1.2.840.113549.1.9.23.1",ki="keyIdentifier",Ei="authorityCertIssuer",_i="authorityCertSerialNumber",Ig=[ki,Ei,_i];let uf=(()=>{class s extends fe{constructor(e={}){super(),ki in e&&(this.keyIdentifier=c(e,ki,s.defaultValues(ki))),Ei in e&&(this.authorityCertIssuer=c(e,Ei,s.defaultValues(Ei))),_i in e&&(this.authorityCertSerialNumber=c(e,_i,s.defaultValues(_i))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ki:return new me;case Ei:return[];case _i:return new Q;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Le({name:t.keyIdentifier||w,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Ke({name:t.authorityCertIssuer||w,value:St.schema()})]}),new Le({name:t.authorityCertSerialNumber||w,optional:!0,idBlock:{tagClass:3,tagNumber:2}})]})}fromSchema(e){ne(e,Ig);const t=de(e,e,s.schema({names:{keyIdentifier:ki,authorityCertIssuer:Ei,authorityCertSerialNumber:_i}}));le.assertSchema(t,this.className),ki in t.result&&(this.keyIdentifier=new me({valueHex:t.result.keyIdentifier.valueBlock.valueHex})),Ei in t.result&&(this.authorityCertIssuer=Array.from(t.result.authorityCertIssuer,i=>new St({schema:i}))),_i in t.result&&(this.authorityCertSerialNumber=new Q({valueHex:t.result.authorityCertSerialNumber.valueBlock.valueHex}))}toSchema(){const e=[];return this.keyIdentifier&&e.push(new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:this.keyIdentifier.valueBlock.valueHexView})),this.authorityCertIssuer&&e.push(new z({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.authorityCertIssuer,t=>t.toSchema())})),this.authorityCertSerialNumber&&e.push(new Le({idBlock:{tagClass:3,tagNumber:2},valueHex:this.authorityCertSerialNumber.valueBlock.valueHexView})),new U({value:e})}toJSON(){const e={};return this.keyIdentifier&&(e.keyIdentifier=this.keyIdentifier.toJSON()),this.authorityCertIssuer&&(e.authorityCertIssuer=Array.from(this.authorityCertIssuer,t=>t.toJSON())),this.authorityCertSerialNumber&&(e.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),e}}return s.CLASS_NAME="AuthorityKeyIdentifier",s})();const Ci="pathLenConstraint",Ni="cA";let hf=(()=>{class s extends fe{constructor(e={}){super(),this.cA=c(e,Ni,!1),Ci in e&&(this.pathLenConstraint=c(e,Ci,0)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e!==Ni&&super.defaultValues(e)}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Es({optional:!0,name:t.cA||w}),new Q({optional:!0,name:t.pathLenConstraint||w})]})}fromSchema(e){ne(e,[Ni,Ci]);const t=de(e,e,s.schema({names:{cA:Ni,pathLenConstraint:Ci}}));le.assertSchema(t,this.className),Ni in t.result&&(this.cA=t.result.cA.valueBlock.value),Ci in t.result&&(this.pathLenConstraint=t.result.pathLenConstraint.valueBlock.isHexOnly?t.result.pathLenConstraint:t.result.pathLenConstraint.valueBlock.valueDec)}toSchema(){const e=[];return this.cA!==s.defaultValues(Ni)&&e.push(new Es({value:this.cA})),Ci in this&&e.push(this.pathLenConstraint instanceof Q?this.pathLenConstraint:new Q({value:this.pathLenConstraint})),new U({value:e})}toJSON(){const e={};return this.cA!==s.defaultValues(Ni)&&(e.cA=this.cA),Ci in this&&(e.pathLenConstraint=this.pathLenConstraint instanceof Q?this.pathLenConstraint.toJSON():this.pathLenConstraint),e}}return s.CLASS_NAME="BasicConstraints",s})();const ku="certificateIndex",Eu="keyIndex";let Bg=(()=>{class s extends fe{constructor(e={}){super(),this.certificateIndex=c(e,ku,s.defaultValues(ku)),this.keyIndex=c(e,Eu,s.defaultValues(Eu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ku:case Eu:return 0;default:return super.defaultValues(e)}}static schema(){return new Q}fromSchema(e){if(e.constructor.blockName()!==Q.blockName())throw new Error("Object's schema was not verified against input data for CAVersion");let t=e.valueBlock.valueHex.slice(0);const i=new Uint8Array(t);switch(!0){case t.byteLength<4:{const G=new ArrayBuffer(4);new Uint8Array(G).set(i,4-t.byteLength),t=G.slice(0)}break;case t.byteLength>4:{const G=new ArrayBuffer(4);new Uint8Array(G).set(i.slice(0,4)),t=G.slice(0)}}const a=t.slice(0,2),o=new Uint8Array(a);let u=o[0];o[0]=o[1],o[1]=u;const h=new Uint16Array(a);this.keyIndex=h[0];const g=t.slice(2),N=new Uint8Array(g);u=N[0],N[0]=N[1],N[1]=u;const x=new Uint16Array(g);this.certificateIndex=x[0]}toSchema(){const e=new ArrayBuffer(2);new Uint16Array(e)[0]=this.certificateIndex;const i=new Uint8Array(e);let a=i[0];i[0]=i[1],i[1]=a;const o=new ArrayBuffer(2);new Uint16Array(o)[0]=this.keyIndex;const h=new Uint8Array(o);return a=h[0],h[0]=h[1],h[1]=a,new Q({valueHex:K(o,e)})}toJSON(){return{certificateIndex:this.certificateIndex,keyIndex:this.keyIndex}}}return s.CLASS_NAME="CAVersion",s})();const Ca="policyQualifierId",Na="qualifier",Rg=[Ca,Na];let df=(()=>{class s extends fe{constructor(e={}){super(),this.policyQualifierId=c(e,Ca,s.defaultValues(Ca)),this.qualifier=c(e,Na,s.defaultValues(Na)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ca:return w;case Na:return new Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.policyQualifierId||w}),new Fe({name:t.qualifier||w})]})}fromSchema(e){ne(e,Rg);const t=de(e,e,s.schema({names:{policyQualifierId:Ca,qualifier:Na}}));le.assertSchema(t,this.className),this.policyQualifierId=t.result.policyQualifierId.valueBlock.toString(),this.qualifier=t.result.qualifier}toSchema(){return new U({value:[new Ve({value:this.policyQualifierId}),this.qualifier]})}toJSON(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}return s.CLASS_NAME="PolicyQualifierInfo",s})();const Ia="policyIdentifier",Ii="policyQualifiers",Tg=[Ia,Ii];let ff=(()=>{class s extends fe{constructor(e={}){super(),this.policyIdentifier=c(e,Ia,s.defaultValues(Ia)),Ii in e&&(this.policyQualifiers=c(e,Ii,s.defaultValues(Ii))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ia:return w;case Ii:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.policyIdentifier||w}),new U({optional:!0,value:[new Ke({name:t.policyQualifiers||w,value:df.schema()})]})]})}fromSchema(e){ne(e,Tg);const t=de(e,e,s.schema({names:{policyIdentifier:Ia,policyQualifiers:Ii}}));le.assertSchema(t,this.className),this.policyIdentifier=t.result.policyIdentifier.valueBlock.toString(),Ii in t.result&&(this.policyQualifiers=Array.from(t.result.policyQualifiers,i=>new df({schema:i})))}toSchema(){const e=[];return e.push(new Ve({value:this.policyIdentifier})),this.policyQualifiers&&e.push(new U({value:Array.from(this.policyQualifiers,t=>t.toSchema())})),new U({value:e})}toJSON(){const e={policyIdentifier:this.policyIdentifier};return this.policyQualifiers&&(e.policyQualifiers=Array.from(this.policyQualifiers,t=>t.toJSON())),e}}return s.CLASS_NAME="PolicyInformation",s})();const Ba="certificatePolicies",xg=[Ba];let mf=(()=>{class s extends fe{constructor(e={}){super(),this.certificatePolicies=c(e,Ba,s.defaultValues(Ba)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Ba?[]:super.defaultValues(e)}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ke({name:t.certificatePolicies||w,value:ff.schema()})]})}fromSchema(e){ne(e,xg);const t=de(e,e,s.schema({names:{certificatePolicies:Ba}}));le.assertSchema(t,this.className),this.certificatePolicies=Array.from(t.result.certificatePolicies,i=>new ff({schema:i}))}toSchema(){return new U({value:Array.from(this.certificatePolicies,e=>e.toSchema())})}toJSON(){return{certificatePolicies:Array.from(this.certificatePolicies,e=>e.toJSON())}}}return s.CLASS_NAME="CertificatePolicies",s})();const Ra="templateID",cs="templateMajorVersion",us="templateMinorVersion",Vg=[Ra,cs,us];class Gr extends fe{constructor(r={}){super(),this.templateID=c(r,Ra,Gr.defaultValues(Ra)),cs in r&&(this.templateMajorVersion=c(r,cs,Gr.defaultValues(cs))),us in r&&(this.templateMinorVersion=c(r,us,Gr.defaultValues(us))),r.schema&&this.fromSchema(r.schema)}static defaultValues(r){switch(r){case Ra:return w;case cs:case us:return 0;default:return super.defaultValues(r)}}static schema(r={}){const e=c(r,"names",{});return new U({name:e.blockName||w,value:[new Ve({name:e.templateID||w}),new Q({name:e.templateMajorVersion||w,optional:!0}),new Q({name:e.templateMinorVersion||w,optional:!0})]})}fromSchema(r){ne(r,Vg);const e=de(r,r,Gr.schema({names:{templateID:Ra,templateMajorVersion:cs,templateMinorVersion:us}}));le.assertSchema(e,this.className),this.templateID=e.result.templateID.valueBlock.toString(),cs in e.result&&(this.templateMajorVersion=e.result.templateMajorVersion.valueBlock.valueDec),us in e.result&&(this.templateMinorVersion=e.result.templateMinorVersion.valueBlock.valueDec)}toSchema(){const r=[];return r.push(new Ve({value:this.templateID})),cs in this&&r.push(new Q({value:this.templateMajorVersion})),us in this&&r.push(new Q({value:this.templateMinorVersion})),new U({value:r})}toJSON(){const r={templateID:this.templateID};return cs in this&&(r.templateMajorVersion=this.templateMajorVersion),us in this&&(r.templateMinorVersion=this.templateMinorVersion),r}}const Bi="distributionPoint",gf="distributionPointNames",Ri="reasons",Ti="cRLIssuer",pf="cRLIssuerNames",Og=[Bi,gf,Ri,Ti,pf];let vf=(()=>{class s extends fe{constructor(e={}){super(),Bi in e&&(this.distributionPoint=c(e,Bi,s.defaultValues(Bi))),Ri in e&&(this.reasons=c(e,Ri,s.defaultValues(Ri))),Ti in e&&(this.cRLIssuer=c(e,Ti,s.defaultValues(Ti))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Bi:return[];case Ri:return new et;case Ti:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new dt({value:[new z({name:t.distributionPoint||w,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ke({name:t.distributionPointNames||w,value:St.schema()})]}),new z({name:t.distributionPoint||w,optional:!0,idBlock:{tagClass:3,tagNumber:1},value:ft.schema().valueBlock.value})]})]}),new Le({name:t.reasons||w,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new z({name:t.cRLIssuer||w,optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[new Ke({name:t.cRLIssuerNames||w,value:St.schema()})]})]})}fromSchema(e){ne(e,Og);const t=de(e,e,s.schema({names:{distributionPoint:Bi,distributionPointNames:gf,reasons:Ri,cRLIssuer:Ti,cRLIssuerNames:pf}}));le.assertSchema(t,this.className),Bi in t.result&&(0===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=Array.from(t.result.distributionPointNames,i=>new St({schema:i}))),1===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=new ft({schema:new U({value:t.result.distributionPoint.valueBlock.value})}))),Ri in t.result&&(this.reasons=new et({valueHex:t.result.reasons.valueBlock.valueHex})),Ti in t.result&&(this.cRLIssuer=Array.from(t.result.cRLIssuerNames,i=>new St({schema:i})))}toSchema(){const e=[];if(this.distributionPoint){let t;t=new z(this.distributionPoint instanceof Array?{idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,i=>i.toSchema())}:{idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]}),e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}return this.reasons&&e.push(new Le({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHexView})),this.cRLIssuer&&e.push(new z({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,t=>t.toSchema())})),new U({value:e})}toJSON(){const e={};return this.distributionPoint&&(e.distributionPoint=this.distributionPoint instanceof Array?Array.from(this.distributionPoint,t=>t.toJSON()):this.distributionPoint.toJSON()),this.reasons&&(e.reasons=this.reasons.toJSON()),this.cRLIssuer&&(e.cRLIssuer=Array.from(this.cRLIssuer,t=>t.toJSON())),e}}return s.CLASS_NAME="DistributionPoint",s})();const Ta="distributionPoints",Pg=[Ta];let wf=(()=>{class s extends fe{constructor(e={}){super(),this.distributionPoints=c(e,Ta,s.defaultValues(Ta)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Ta?[]:super.defaultValues(e)}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ke({name:t.distributionPoints||w,value:vf.schema()})]})}fromSchema(e){ne(e,Pg);const t=de(e,e,s.schema({names:{distributionPoints:Ta}}));le.assertSchema(t,this.className),this.distributionPoints=Array.from(t.result.distributionPoints,i=>new vf({schema:i}))}toSchema(){return new U({value:Array.from(this.distributionPoints,e=>e.toSchema())})}toJSON(){return{distributionPoints:Array.from(this.distributionPoints,e=>e.toJSON())}}}return s.CLASS_NAME="CRLDistributionPoints",s})();const xa="keyPurposes",Dg=[xa];let Ug=(()=>{class s extends fe{constructor(e={}){super(),this.keyPurposes=c(e,xa,s.defaultValues(xa)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===xa?[]:super.defaultValues(e)}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ke({name:t.keyPurposes||w,value:new Ve})]})}fromSchema(e){ne(e,Dg);const t=de(e,e,s.schema({names:{keyPurposes:xa}}));le.assertSchema(t,this.className),this.keyPurposes=Array.from(t.result.keyPurposes,i=>i.valueBlock.toString())}toSchema(){return new U({value:Array.from(this.keyPurposes,e=>new Ve({value:e}))})}toJSON(){return{keyPurposes:Array.from(this.keyPurposes)}}}return s.CLASS_NAME="ExtKeyUsage",s})();const Va="accessDescriptions";let yf=(()=>{class s extends fe{constructor(e={}){super(),this.accessDescriptions=c(e,Va,s.defaultValues(Va)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Va?[]:super.defaultValues(e)}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ke({name:t.accessDescriptions||w,value:Kd.schema()})]})}fromSchema(e){ne(e,[Va]);const t=de(e,e,s.schema({names:{accessDescriptions:Va}}));le.assertSchema(t,this.className),this.accessDescriptions=Array.from(t.result.accessDescriptions,i=>new Kd({schema:i}))}toSchema(){return new U({value:Array.from(this.accessDescriptions,e=>e.toSchema())})}toJSON(){return{accessDescriptions:Array.from(this.accessDescriptions,e=>e.toJSON())}}}return s.CLASS_NAME="InfoAccess",s})();const xi="distributionPoint",Sf="distributionPointNames",Os="onlyContainsUserCerts",Ps="onlyContainsCACerts",Ds="onlySomeReasons",Us="indirectCRL",Ms="onlyContainsAttributeCerts",Mg=[xi,Sf,Os,Ps,Ds,Us,Ms];let Lg=(()=>{class s extends fe{constructor(e={}){super(),xi in e&&(this.distributionPoint=c(e,xi,s.defaultValues(xi))),this.onlyContainsUserCerts=c(e,Os,s.defaultValues(Os)),this.onlyContainsCACerts=c(e,Ps,s.defaultValues(Ps)),Ds in e&&(this.onlySomeReasons=c(e,Ds,s.defaultValues(Ds))),this.indirectCRL=c(e,Us,s.defaultValues(Us)),this.onlyContainsAttributeCerts=c(e,Ms,s.defaultValues(Ms)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xi:return[];case Os:case Ps:return!1;case Ds:return 0;case Us:case Ms:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new dt({value:[new z({name:t.distributionPoint||w,idBlock:{tagClass:3,tagNumber:0},value:[new Ke({name:t.distributionPointNames||w,value:St.schema()})]}),new z({name:t.distributionPoint||w,idBlock:{tagClass:3,tagNumber:1},value:ft.schema().valueBlock.value})]})]}),new Le({name:t.onlyContainsUserCerts||w,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Le({name:t.onlyContainsCACerts||w,optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new Le({name:t.onlySomeReasons||w,optional:!0,idBlock:{tagClass:3,tagNumber:3}}),new Le({name:t.indirectCRL||w,optional:!0,idBlock:{tagClass:3,tagNumber:4}}),new Le({name:t.onlyContainsAttributeCerts||w,optional:!0,idBlock:{tagClass:3,tagNumber:5}})]})}fromSchema(e){ne(e,Mg);const t=de(e,e,s.schema({names:{distributionPoint:xi,distributionPointNames:Sf,onlyContainsUserCerts:Os,onlyContainsCACerts:Ps,onlySomeReasons:Ds,indirectCRL:Us,onlyContainsAttributeCerts:Ms}}));if(le.assertSchema(t,this.className),xi in t.result)switch(!0){case 0===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=Array.from(t.result.distributionPointNames,i=>new St({schema:i}));break;case 1===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=new ft({schema:new U({value:t.result.distributionPoint.valueBlock.value})});break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}if(Os in t.result){const i=new Uint8Array(t.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=0!==i[0]}if(Ps in t.result){const i=new Uint8Array(t.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=0!==i[0]}if(Ds in t.result){const i=new Uint8Array(t.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=i[0]}if(Us in t.result){const i=new Uint8Array(t.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=0!==i[0]}if(Ms in t.result){const i=new Uint8Array(t.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=0!==i[0]}}toSchema(){const e=[];if(this.distributionPoint){let t;this.distributionPoint instanceof Array?t=new z({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,i=>i.toSchema())}):(t=this.distributionPoint.toSchema(),t.idBlock.tagClass=3,t.idBlock.tagNumber=1),e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(this.onlyContainsUserCerts!==s.defaultValues(Os)&&e.push(new Le({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsCACerts!==s.defaultValues(Ps)&&e.push(new Le({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer})),void 0!==this.onlySomeReasons){const t=new ArrayBuffer(1);new Uint8Array(t)[0]=this.onlySomeReasons,e.push(new Le({idBlock:{tagClass:3,tagNumber:3},valueHex:t}))}return this.indirectCRL!==s.defaultValues(Us)&&e.push(new Le({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsAttributeCerts!==s.defaultValues(Ms)&&e.push(new Le({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer})),new U({value:e})}toJSON(){const e={};return this.distributionPoint&&(e.distributionPoint=this.distributionPoint instanceof Array?Array.from(this.distributionPoint,t=>t.toJSON()):this.distributionPoint.toJSON()),this.onlyContainsUserCerts!==s.defaultValues(Os)&&(e.onlyContainsUserCerts=this.onlyContainsUserCerts),this.onlyContainsCACerts!==s.defaultValues(Ps)&&(e.onlyContainsCACerts=this.onlyContainsCACerts),Ds in this&&(e.onlySomeReasons=this.onlySomeReasons),this.indirectCRL!==s.defaultValues(Us)&&(e.indirectCRL=this.indirectCRL),this.onlyContainsAttributeCerts!==s.defaultValues(Ms)&&(e.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),e}}return s.CLASS_NAME="IssuingDistributionPoint",s})();const Oa="base",Jr="minimum",Ls="maximum",Fg=[Oa,Jr,Ls];let Kl=(()=>{class s extends fe{constructor(e={}){super(),this.base=c(e,Oa,s.defaultValues(Oa)),this.minimum=c(e,Jr,s.defaultValues(Jr)),Ls in e&&(this.maximum=c(e,Ls,s.defaultValues(Ls))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Oa:return new St;case Jr:case Ls:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[St.schema(t.base||{}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Q({name:t.minimum||w})]}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Q({name:t.maximum||w})]})]})}fromSchema(e){ne(e,Fg);const t=de(e,e,s.schema({names:{base:{names:{blockName:Oa}},minimum:Jr,maximum:Ls}}));le.assertSchema(t,this.className),this.base=new St({schema:t.result.base}),Jr in t.result&&(this.minimum=t.result.minimum.valueBlock.isHexOnly?t.result.minimum:t.result.minimum.valueBlock.valueDec),Ls in t.result&&(this.maximum=t.result.maximum.valueBlock.isHexOnly?t.result.maximum:t.result.maximum.valueBlock.valueDec)}toSchema(){const e=[];if(e.push(this.base.toSchema()),0!==this.minimum){let t=0;t=this.minimum instanceof Q?this.minimum:new Q({value:this.minimum}),e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(Ls in this){let t=0;t=this.maximum instanceof Q?this.maximum:new Q({value:this.maximum}),e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[t]}))}return new U({value:e})}toJSON(){const e={base:this.base.toJSON()};return 0!==this.minimum&&(e.minimum="number"==typeof this.minimum?this.minimum:this.minimum.toJSON()),void 0!==this.maximum&&(e.maximum="number"==typeof this.maximum?this.maximum:this.maximum.toJSON()),e}}return s.CLASS_NAME="GeneralSubtree",s})();const Vi="permittedSubtrees",Oi="excludedSubtrees",Hg=[Vi,Oi];let jg=(()=>{class s extends fe{constructor(e={}){super(),Vi in e&&(this.permittedSubtrees=c(e,Vi,s.defaultValues(Vi))),Oi in e&&(this.excludedSubtrees=c(e,Oi,s.defaultValues(Oi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Vi:case Oi:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ke({name:t.permittedSubtrees||w,value:Kl.schema()})]}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Ke({name:t.excludedSubtrees||w,value:Kl.schema()})]})]})}fromSchema(e){ne(e,Hg);const t=de(e,e,s.schema({names:{permittedSubtrees:Vi,excludedSubtrees:Oi}}));le.assertSchema(t,this.className),Vi in t.result&&(this.permittedSubtrees=Array.from(t.result.permittedSubtrees,i=>new Kl({schema:i}))),Oi in t.result&&(this.excludedSubtrees=Array.from(t.result.excludedSubtrees,i=>new Kl({schema:i})))}toSchema(){const e=[];return this.permittedSubtrees&&e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.permittedSubtrees,t=>t.toSchema())})),this.excludedSubtrees&&e.push(new z({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.excludedSubtrees,t=>t.toSchema())})),new U({value:e})}toJSON(){const e={};return this.permittedSubtrees&&(e.permittedSubtrees=Array.from(this.permittedSubtrees,t=>t.toJSON())),this.excludedSubtrees&&(e.excludedSubtrees=Array.from(this.excludedSubtrees,t=>t.toJSON())),e}}return s.CLASS_NAME="NameConstraints",s})();const hs="requireExplicitPolicy",ds="inhibitPolicyMapping",$g=[hs,ds];let Kg=(()=>{class s extends fe{constructor(e={}){super(),hs in e&&(this.requireExplicitPolicy=c(e,hs,s.defaultValues(hs))),ds in e&&(this.inhibitPolicyMapping=c(e,ds,s.defaultValues(ds))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hs:case ds:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Le({name:t.requireExplicitPolicy||w,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Le({name:t.inhibitPolicyMapping||w,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){ne(e,$g);const t=de(e,e,s.schema({names:{requireExplicitPolicy:hs,inhibitPolicyMapping:ds}}));if(le.assertSchema(t,this.className),hs in t.result){const i=t.result.requireExplicitPolicy;i.idBlock.tagClass=1,i.idBlock.tagNumber=2;const o=Et(i.toBER(!1));le.assert(o,"Integer"),this.requireExplicitPolicy=o.result.valueBlock.valueDec}if(ds in t.result){const i=t.result.inhibitPolicyMapping;i.idBlock.tagClass=1,i.idBlock.tagNumber=2;const o=Et(i.toBER(!1));le.assert(o,"Integer"),this.inhibitPolicyMapping=o.result.valueBlock.valueDec}}toSchema(){const e=[];if(hs in this){const t=new Q({value:this.requireExplicitPolicy});t.idBlock.tagClass=3,t.idBlock.tagNumber=0,e.push(t)}if(ds in this){const t=new Q({value:this.inhibitPolicyMapping});t.idBlock.tagClass=3,t.idBlock.tagNumber=1,e.push(t)}return new U({value:e})}toJSON(){const e={};return hs in this&&(e.requireExplicitPolicy=this.requireExplicitPolicy),ds in this&&(e.inhibitPolicyMapping=this.inhibitPolicyMapping),e}}return s.CLASS_NAME="PolicyConstraints",s})();const Pa="issuerDomainPolicy",Da="subjectDomainPolicy",Gg=[Pa,Da];let bf=(()=>{class s extends fe{constructor(e={}){super(),this.issuerDomainPolicy=c(e,Pa,s.defaultValues(Pa)),this.subjectDomainPolicy=c(e,Da,s.defaultValues(Da)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Pa:case Da:return w;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.issuerDomainPolicy||w}),new Ve({name:t.subjectDomainPolicy||w})]})}fromSchema(e){ne(e,Gg);const t=de(e,e,s.schema({names:{issuerDomainPolicy:Pa,subjectDomainPolicy:Da}}));le.assertSchema(t,this.className),this.issuerDomainPolicy=t.result.issuerDomainPolicy.valueBlock.toString(),this.subjectDomainPolicy=t.result.subjectDomainPolicy.valueBlock.toString()}toSchema(){return new U({value:[new Ve({value:this.issuerDomainPolicy}),new Ve({value:this.subjectDomainPolicy})]})}toJSON(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}return s.CLASS_NAME="PolicyMapping",s})();const Ua="mappings",Jg=[Ua];let qg=(()=>{class s extends fe{constructor(e={}){super(),this.mappings=c(e,Ua,s.defaultValues(Ua)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Ua?[]:super.defaultValues(e)}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ke({name:t.mappings||w,value:bf.schema()})]})}fromSchema(e){ne(e,Jg);const t=de(e,e,s.schema({names:{mappings:Ua}}));le.assertSchema(t,this.className),this.mappings=Array.from(t.result.mappings,i=>new bf({schema:i}))}toSchema(){return new U({value:Array.from(this.mappings,e=>e.toSchema())})}toJSON(){return{mappings:Array.from(this.mappings,e=>e.toJSON())}}}return s.CLASS_NAME="PolicyMappings",s})();const Fs="notBefore",Hs="notAfter",zg=[Fs,Hs];let Wg=(()=>{class s extends fe{constructor(e={}){super(),Fs in e&&(this.notBefore=c(e,Fs,s.defaultValues(Fs))),Hs in e&&(this.notAfter=c(e,Hs,s.defaultValues(Hs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fs:case Hs:return new Date;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Le({name:t.notBefore||w,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Le({name:t.notAfter||w,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){ne(e,zg);const t=de(e,e,s.schema({names:{notBefore:Fs,notAfter:Hs}}));if(le.assertSchema(t,this.className),Fs in t.result){const i=new ht;i.fromBuffer(t.result.notBefore.valueBlock.valueHex),this.notBefore=i.toDate()}if(Hs in t.result){const i=new ht({valueHex:t.result.notAfter.valueBlock.valueHex});i.fromBuffer(t.result.notAfter.valueBlock.valueHex),this.notAfter=i.toDate()}}toSchema(){const e=[];return Fs in this&&e.push(new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:new ht({valueDate:this.notBefore}).valueBlock.valueHexView})),Hs in this&&e.push(new Le({idBlock:{tagClass:3,tagNumber:1},valueHex:new ht({valueDate:this.notAfter}).valueBlock.valueHexView})),new U({value:e})}toJSON(){const e={};return this.notBefore&&(e.notBefore=this.notBefore),this.notAfter&&(e.notAfter=this.notAfter),e}}return s.CLASS_NAME="PrivateKeyUsagePeriod",s})();const qr="id",fs="type",zr="values",Yg=[qr,fs],Xg=[zr];let Af=(()=>{class s extends fe{constructor(e={}){super(),this.id=c(e,qr,s.defaultValues(qr)),fs in e&&(this.type=c(e,fs,s.defaultValues(fs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case qr:return w;case fs:return new At;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case qr:return t===w;case fs:return t instanceof At;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.id||w}),new Fe({name:t.type||w,optional:!0})]})}fromSchema(e){ne(e,Yg);const t=de(e,e,s.schema({names:{id:qr,type:fs}}));le.assertSchema(t,this.className),this.id=t.result.id.valueBlock.toString(),fs in t.result&&(this.type=t.result.type)}toSchema(){const e=[new Ve({value:this.id})];return fs in this&&e.push(this.type),new U({value:e})}toJSON(){const e={id:this.id};return this.type&&(e.type=this.type.toJSON()),e}}return s.CLASS_NAME="QCStatement",s})(),Qg=(()=>{class s extends fe{constructor(e={}){super(),this.values=c(e,zr,s.defaultValues(zr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===zr?[]:super.defaultValues(e)}static compareWithDefault(e,t){return e===zr?0===t.length:super.defaultValues(e)}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ke({name:t.values||w,value:Af.schema(t.value||{})})]})}fromSchema(e){ne(e,Xg);const t=de(e,e,s.schema({names:{values:zr}}));le.assertSchema(t,this.className),this.values=Array.from(t.result.values,i=>new Af({schema:i}))}toSchema(){return new U({value:Array.from(this.values,e=>e.toSchema())})}toJSON(){return{values:Array.from(this.values,e=>e.toJSON())}}}return s.CLASS_NAME="QCStatements",s})();var Pi;class js{static register(r,e,t){this.namedCurves[r.toLowerCase()]=this.namedCurves[e]={name:r,id:e,size:t}}static find(r){return this.namedCurves[r.toLowerCase()]||null}}Pi=js,js.namedCurves={},Pi.register("P-256","1.2.840.10045.3.1.7",32),Pi.register("P-384","1.3.132.0.34",48),Pi.register("P-521","1.3.132.0.35",66),Pi.register("brainpoolP256r1","1.3.36.3.3.2.8.1.1.7",32),Pi.register("brainpoolP384r1","1.3.36.3.3.2.8.1.1.11",48),Pi.register("brainpoolP512r1","1.3.36.3.3.2.8.1.1.13",64);const ql="namedCurve";let $s=(()=>{class s extends fe{constructor(e={}){super(),this.x=c(e,"x",s.defaultValues("x")),this.y=c(e,"y",s.defaultValues("y")),this.namedCurve=c(e,ql,s.defaultValues(ql)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"x":case"y":return Nt;case ql:return w;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"x":case"y":return t instanceof ArrayBuffer&&W(t,s.defaultValues(e));case ql:return"string"==typeof t&&t===s.defaultValues(e);default:return super.defaultValues(e)}}static schema(){return new Ul}fromSchema(e){const t=L._H.toUint8Array(e);if(4!==t[0])throw new Error("Object's schema was not verified against input data for ECPublicKey");const i=js.find(this.namedCurve);if(!i)throw new Error(`Incorrect curve OID: ${this.namedCurve}`);const a=i.size;if(t.byteLength!==2*a+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.namedCurve=i.name,this.x=t.slice(1,a+1).buffer,this.y=t.slice(1+a,2*a+1).buffer}toSchema(){return new Ul({data:K(new Uint8Array([4]).buffer,this.x,this.y)})}toJSON(){const e=js.find(this.namedCurve);return{crv:e?e.name:this.namedCurve,x:j(Ie(this.x),!0,!0,!1),y:j(Ie(this.y),!0,!0,!1)}}fromJSON(e){st.assert("json",e,"crv","x","y");let t=0;const i=js.find(e.crv);i&&(this.namedCurve=i.id,t=i.size);const a=_e(q(e.x,!0));if(a.byteLength<t){this.x=new ArrayBuffer(t);const u=new Uint8Array(this.x),h=new Uint8Array(a);u.set(h,1)}else this.x=a.slice(0,t);const o=_e(q(e.y,!0));if(o.byteLength<t){this.y=new ArrayBuffer(t);const u=new Uint8Array(this.y),h=new Uint8Array(o);u.set(h,1)}else this.y=o.slice(0,t)}}return s.CLASS_NAME="ECPublicKey",s})();const Ma="modulus",La="publicExponent",Zg=[Ma,La];let kf=(()=>{class s extends fe{constructor(e={}){super(),this.modulus=c(e,Ma,s.defaultValues(Ma)),this.publicExponent=c(e,La,s.defaultValues(La)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ma:case La:return new Q;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.modulus||w}),new Q({name:t.publicExponent||w})]})}fromSchema(e){ne(e,Zg);const t=de(e,e,s.schema({names:{modulus:Ma,publicExponent:La}}));le.assertSchema(t,this.className),this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent}toSchema(){return new U({value:[this.modulus.convertToDER(),this.publicExponent]})}toJSON(){return{n:L.U$.ToBase64Url(this.modulus.valueBlock.valueHexView),e:L.U$.ToBase64Url(this.publicExponent.valueBlock.valueHexView)}}fromJSON(e){st.assert("json",e,"n","e");const t=_e(q(e.n,!0));this.modulus=new Q({valueHex:t.slice(0,Math.pow(2,Je(t.byteLength)))}),this.publicExponent=new Q({valueHex:_e(q(e.e,!0)).slice(0,3)})}}return s.CLASS_NAME="RSAPublicKey",s})();const Fa="algorithm",Ha="subjectPublicKey",ep=[Fa,Ha];let ns=(()=>{class s extends fe{get parsedKey(){if(void 0===this._parsedKey){switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":if("algorithmParams"in this.algorithm&&this.algorithm.algorithmParams.constructor.blockName()===Ve.blockName())try{this._parsedKey=new $s({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHexView})}catch{}break;case"1.2.840.113549.1.1.1":{const e=Et(this.subjectPublicKey.valueBlock.valueHexView);if(-1!==e.offset)try{this._parsedKey=new kf({schema:e.result})}catch{}}}this._parsedKey||(this._parsedKey=null)}return this._parsedKey||void 0}set parsedKey(e){this._parsedKey=e}constructor(e={}){super(),this.algorithm=c(e,Fa,s.defaultValues(Fa)),this.subjectPublicKey=c(e,Ha,s.defaultValues(Ha));const t=c(e,"parsedKey",null);t&&(this.parsedKey=t),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fa:return new Z;case Ha:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[Z.schema(t.algorithm||{}),new et({name:t.subjectPublicKey||w})]})}fromSchema(e){ne(e,ep);const t=de(e,e,s.schema({names:{algorithm:{names:{blockName:Fa}},subjectPublicKey:Ha}}));le.assertSchema(t,this.className),this.algorithm=new Z({schema:t.result.algorithm}),this.subjectPublicKey=t.result.subjectPublicKey}toSchema(){return new U({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}toJSON(){if(!this.parsedKey)return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()};const e={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();return Object.assign(e,t),e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new $s({json:e}),this.algorithm=new Z({algorithmId:"1.2.840.10045.2.1",algorithmParams:new Ve({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new kf({json:e}),this.algorithm=new Z({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new At});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.subjectPublicKey=new et({valueHex:this.parsedKey.toSchema().toBER(!1)})}}importKey(e,t=Ge(!0)){var i=this;return(0,E.A)(function*(){try{if(!e)throw new Error("Need to provide publicKey input parameter");const o=Et(yield t.exportKey("spki",e));try{i.fromSchema(o.result)}catch{throw new Error("Error during initializing object from schema")}}catch(a){const o=a instanceof Error?a.message:`${a}`;throw new Error(`Error during exporting public key: ${o}`)}})()}}return s.CLASS_NAME="PublicKeyInfo",s})();const Wr="version",Yr="privateKey",Qt="namedCurve",Ks="publicKey",tp=[Wr,Yr,Qt,Ks];let Ef=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,Wr,s.defaultValues(Wr)),this.privateKey=c(e,Yr,s.defaultValues(Yr)),Qt in e&&(this.namedCurve=c(e,Qt,s.defaultValues(Qt))),Ks in e&&(this.publicKey=c(e,Ks,s.defaultValues(Ks))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Wr:return 1;case Yr:return new me;case Qt:return w;case Ks:return new $s;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Wr:return t===s.defaultValues(e);case Yr:return t.isEqual(s.defaultValues(e));case Qt:return t===w;case Ks:return $s.compareWithDefault(Qt,t.namedCurve)&&$s.compareWithDefault("x",t.x)&&$s.compareWithDefault("y",t.y);default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.version||w}),new me({name:t.privateKey||w}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ve({name:t.namedCurve||w})]}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new et({name:t.publicKey||w})]})]})}fromSchema(e){ne(e,tp);const t=de(e,e,s.schema({names:{version:Wr,privateKey:Yr,namedCurve:Qt,publicKey:Ks}}));if(le.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.privateKey=t.result.privateKey,Qt in t.result&&(this.namedCurve=t.result.namedCurve.valueBlock.toString()),Ks in t.result){const i={schema:t.result.publicKey.valueBlock.valueHex};Qt in this&&(i.namedCurve=this.namedCurve),this.publicKey=new $s(i)}}toSchema(){const e=[new Q({value:this.version}),this.privateKey];return this.namedCurve&&e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:[new Ve({value:this.namedCurve})]})),this.publicKey&&e.push(new z({idBlock:{tagClass:3,tagNumber:1},value:[new et({valueHex:this.publicKey.toSchema().toBER(!1)})]})),new U({value:e})}toJSON(){if(!this.namedCurve||s.compareWithDefault(Qt,this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');const e=js.find(this.namedCurve),t={crv:e?e.name:this.namedCurve,d:L.U$.ToBase64Url(this.privateKey.valueBlock.valueHexView)};if(this.publicKey){const i=this.publicKey.toJSON();t.x=i.x,t.y=i.y}return t}fromJSON(e){st.assert("json",e,"crv","d");let t=0;const i=js.find(e.crv);i&&(this.namedCurve=i.id,t=i.size);const a=L.U$.FromBase64Url(e.d);if(a.byteLength<t){const o=new ArrayBuffer(t),u=new Uint8Array(o),h=new Uint8Array(a);u.set(h,1),this.privateKey=new me({valueHex:o})}else this.privateKey=new me({valueHex:a.slice(0,t)});e.x&&e.y&&(this.publicKey=new $s({json:e}))}}return s.CLASS_NAME="ECPrivateKey",s})();const ja="prime",$a="exponent",Ka="coefficient",sp=[ja,$a,Ka];let _u=(()=>{class s extends fe{constructor(e={}){super(),this.prime=c(e,ja,s.defaultValues(ja)),this.exponent=c(e,$a,s.defaultValues($a)),this.coefficient=c(e,Ka,s.defaultValues(Ka)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ja:case $a:case Ka:return new Q;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.prime||w}),new Q({name:t.exponent||w}),new Q({name:t.coefficient||w})]})}fromSchema(e){ne(e,sp);const t=de(e,e,s.schema({names:{prime:ja,exponent:$a,coefficient:Ka}}));le.assertSchema(t,this.className),this.prime=t.result.prime.convertFromDER(),this.exponent=t.result.exponent.convertFromDER(),this.coefficient=t.result.coefficient.convertFromDER()}toSchema(){return new U({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}toJSON(){return{r:L.U$.ToBase64Url(this.prime.valueBlock.valueHexView),d:L.U$.ToBase64Url(this.exponent.valueBlock.valueHexView),t:L.U$.ToBase64Url(this.coefficient.valueBlock.valueHexView)}}fromJSON(e){st.assert("json",e,"r","d","r"),this.prime=new Q({valueHex:L.U$.FromBase64Url(e.r)}),this.exponent=new Q({valueHex:L.U$.FromBase64Url(e.d)}),this.coefficient=new Q({valueHex:L.U$.FromBase64Url(e.t)})}}return s.CLASS_NAME="OtherPrimeInfo",s})();const Ga="version",Ja="modulus",qa="publicExponent",za="privateExponent",Wa="prime1",Ya="prime2",Xa="exponent1",Qa="exponent2",Za="coefficient",Di="otherPrimeInfos",ip=[Ga,Ja,qa,za,Wa,Ya,Xa,Qa,Za,Di];let _f=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,Ga,s.defaultValues(Ga)),this.modulus=c(e,Ja,s.defaultValues(Ja)),this.publicExponent=c(e,qa,s.defaultValues(qa)),this.privateExponent=c(e,za,s.defaultValues(za)),this.prime1=c(e,Wa,s.defaultValues(Wa)),this.prime2=c(e,Ya,s.defaultValues(Ya)),this.exponent1=c(e,Xa,s.defaultValues(Xa)),this.exponent2=c(e,Qa,s.defaultValues(Qa)),this.coefficient=c(e,Za,s.defaultValues(Za)),Di in e&&(this.otherPrimeInfos=c(e,Di,s.defaultValues(Di))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ga:return 0;case Ja:case qa:case za:case Wa:case Ya:case Xa:case Qa:case Za:return new Q;case Di:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.version||w}),new Q({name:t.modulus||w}),new Q({name:t.publicExponent||w}),new Q({name:t.privateExponent||w}),new Q({name:t.prime1||w}),new Q({name:t.prime2||w}),new Q({name:t.exponent1||w}),new Q({name:t.exponent2||w}),new Q({name:t.coefficient||w}),new U({optional:!0,value:[new Ke({name:t.otherPrimeInfosName||w,value:_u.schema(t.otherPrimeInfo||{})})]})]})}fromSchema(e){ne(e,ip);const t=de(e,e,s.schema({names:{version:Ga,modulus:Ja,publicExponent:qa,privateExponent:za,prime1:Wa,prime2:Ya,exponent1:Xa,exponent2:Qa,coefficient:Za,otherPrimeInfo:{names:{blockName:Di}}}}));le.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent,this.privateExponent=t.result.privateExponent.convertFromDER(256),this.prime1=t.result.prime1.convertFromDER(128),this.prime2=t.result.prime2.convertFromDER(128),this.exponent1=t.result.exponent1.convertFromDER(128),this.exponent2=t.result.exponent2.convertFromDER(128),this.coefficient=t.result.coefficient.convertFromDER(128),Di in t.result&&(this.otherPrimeInfos=Array.from(t.result.otherPrimeInfos,i=>new _u({schema:i})))}toSchema(){const e=[];return e.push(new Q({value:this.version})),e.push(this.modulus.convertToDER()),e.push(this.publicExponent),e.push(this.privateExponent.convertToDER()),e.push(this.prime1.convertToDER()),e.push(this.prime2.convertToDER()),e.push(this.exponent1.convertToDER()),e.push(this.exponent2.convertToDER()),e.push(this.coefficient.convertToDER()),this.otherPrimeInfos&&e.push(new U({value:Array.from(this.otherPrimeInfos,t=>t.toSchema())})),new U({value:e})}toJSON(){const e={n:L.U$.ToBase64Url(this.modulus.valueBlock.valueHexView),e:L.U$.ToBase64Url(this.publicExponent.valueBlock.valueHexView),d:L.U$.ToBase64Url(this.privateExponent.valueBlock.valueHexView),p:L.U$.ToBase64Url(this.prime1.valueBlock.valueHexView),q:L.U$.ToBase64Url(this.prime2.valueBlock.valueHexView),dp:L.U$.ToBase64Url(this.exponent1.valueBlock.valueHexView),dq:L.U$.ToBase64Url(this.exponent2.valueBlock.valueHexView),qi:L.U$.ToBase64Url(this.coefficient.valueBlock.valueHexView)};return this.otherPrimeInfos&&(e.oth=Array.from(this.otherPrimeInfos,t=>t.toJSON())),e}fromJSON(e){st.assert("json",e,"n","e","d","p","q","dp","dq","qi"),this.modulus=new Q({valueHex:L.U$.FromBase64Url(e.n)}),this.publicExponent=new Q({valueHex:L.U$.FromBase64Url(e.e)}),this.privateExponent=new Q({valueHex:L.U$.FromBase64Url(e.d)}),this.prime1=new Q({valueHex:L.U$.FromBase64Url(e.p)}),this.prime2=new Q({valueHex:L.U$.FromBase64Url(e.q)}),this.exponent1=new Q({valueHex:L.U$.FromBase64Url(e.dp)}),this.exponent2=new Q({valueHex:L.U$.FromBase64Url(e.dq)}),this.coefficient=new Q({valueHex:L.U$.FromBase64Url(e.qi)}),e.oth&&(this.otherPrimeInfos=Array.from(e.oth,t=>new _u({json:t})))}}return s.CLASS_NAME="RSAPrivateKey",s})();const eo="version",to="privateKeyAlgorithm",so="privateKey",Ui="attributes",zl="parsedKey",rp=[eo,to,so,Ui];let Xr=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,eo,s.defaultValues(eo)),this.privateKeyAlgorithm=c(e,to,s.defaultValues(to)),this.privateKey=c(e,so,s.defaultValues(so)),Ui in e&&(this.attributes=c(e,Ui,s.defaultValues(Ui))),zl in e&&(this.parsedKey=c(e,zl,s.defaultValues(zl))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case eo:return 0;case to:return new Z;case so:return new me;case Ui:return[];case zl:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.version||w}),Z.schema(t.privateKeyAlgorithm||{}),new me({name:t.privateKey||w}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ke({name:t.attributes||w,value:it.schema()})]})]})}fromSchema(e){ne(e,rp);const t=de(e,e,s.schema({names:{version:eo,privateKeyAlgorithm:{names:{blockName:to}},privateKey:so,attributes:Ui}}));switch(le.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.privateKeyAlgorithm=new Z({schema:t.result.privateKeyAlgorithm}),this.privateKey=t.result.privateKey,Ui in t.result&&(this.attributes=Array.from(t.result.attributes,i=>new it({schema:i}))),this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":{const i=Et(this.privateKey.valueBlock.valueHexView);-1!==i.offset&&(this.parsedKey=new _f({schema:i.result}))}break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm&&this.privateKeyAlgorithm.algorithmParams instanceof Ve){const i=Et(this.privateKey.valueBlock.valueHexView);-1!==i.offset&&(this.parsedKey=new Ef({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:i.result}))}}}toSchema(){const e=[new Q({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];return this.attributes&&e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,t=>t.toSchema())})),new U({value:e})}toJSON(){if(!this.parsedKey){const i={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};return this.attributes&&(i.attributes=Array.from(this.attributes,a=>a.toJSON())),i}const e={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();return Object.assign(e,t),e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new Ef({json:e}),this.privateKeyAlgorithm=new Z({algorithmId:"1.2.840.10045.2.1",algorithmParams:new Ve({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new _f({json:e}),this.privateKeyAlgorithm=new Z({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new At});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.privateKey=new me({valueHex:this.parsedKey.toSchema().toBER(!1)})}}}return s.CLASS_NAME="PrivateKeyInfo",s})();const Qr="contentType",Zr="contentEncryptionAlgorithm",Mi="encryptedContent",np=[Qr,Zr,Mi];let Mt=(()=>{class s extends fe{constructor(e={}){if(super(),this.contentType=c(e,Qr,s.defaultValues(Qr)),this.contentEncryptionAlgorithm=c(e,Zr,s.defaultValues(Zr)),Mi in e&&e.encryptedContent&&(this.encryptedContent=e.encryptedContent,1===this.encryptedContent.idBlock.tagClass&&4===this.encryptedContent.idBlock.tagNumber&&!1===this.encryptedContent.idBlock.isConstructed&&!e.disableSplit)){const t=new me({idBlock:{isConstructed:!0},isConstructed:!0});let i=0;const a=this.encryptedContent.valueBlock.valueHexView.slice().buffer;let o=a.byteLength;for(;o>0;){const u=new Uint8Array(a,i,i+1024>a.byteLength?a.byteLength-i:1024),h=new ArrayBuffer(u.length),g=new Uint8Array(h);for(let N=0;N<g.length;N++)g[N]=u[N];t.valueBlock.value.push(new me({valueHex:h})),o-=u.length,i+=u.length}this.encryptedContent=t}e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qr:return w;case Zr:return new Z;case Mi:return new me;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Qr:return t===w;case Zr:return t.algorithmId===w&&!("algorithmParams"in t);case Mi:return t.isEqual(s.defaultValues(Mi));default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.contentType||w}),Z.schema(t.contentEncryptionAlgorithm||{}),new dt({value:[new z({name:t.encryptedContent||w,idBlock:{tagClass:3,tagNumber:0},value:[new Ke({value:new me})]}),new Le({name:t.encryptedContent||w,idBlock:{tagClass:3,tagNumber:0}})]})]})}fromSchema(e){ne(e,np);const t=de(e,e,s.schema({names:{contentType:Qr,contentEncryptionAlgorithm:{names:{blockName:Zr}},encryptedContent:Mi}}));le.assertSchema(t,this.className),this.contentType=t.result.contentType.valueBlock.toString(),this.contentEncryptionAlgorithm=new Z({schema:t.result.contentEncryptionAlgorithm}),Mi in t.result&&(this.encryptedContent=t.result.encryptedContent,this.encryptedContent.idBlock.tagClass=1,this.encryptedContent.idBlock.tagNumber=4)}toSchema(){const e={isIndefiniteForm:!1},t=[];if(t.push(new Ve({value:this.contentType})),t.push(this.contentEncryptionAlgorithm.toSchema()),this.encryptedContent){e.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;const i=this.encryptedContent;i.idBlock.tagClass=3,i.idBlock.tagNumber=0,i.lenBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed,t.push(i)}return new U({lenBlock:e,value:t})}toJSON(){const e={contentType:this.contentType,contentEncryptionAlgorithm:this.contentEncryptionAlgorithm.toJSON()};return this.encryptedContent&&(e.encryptedContent=this.encryptedContent.toJSON()),e}getEncryptedContent(){if(!this.encryptedContent)throw new Error("Parameter 'encryptedContent' is undefined");return me.prototype.getValue.call(this.encryptedContent)}}return s.CLASS_NAME="EncryptedContentInfo",s})();const Gs="hashAlgorithm",Js="maskGenAlgorithm",qs="saltLength",zs="trailerField",ap=[Gs,Js,qs,zs];let Cu=(()=>{class s extends fe{constructor(e={}){super(),this.hashAlgorithm=c(e,Gs,s.defaultValues(Gs)),this.maskGenAlgorithm=c(e,Js,s.defaultValues(Js)),this.saltLength=c(e,qs,s.defaultValues(qs)),this.trailerField=c(e,zs,s.defaultValues(zs)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Gs:return new Z({algorithmId:"1.3.14.3.2.26",algorithmParams:new At});case Js:return new Z({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new Z({algorithmId:"1.3.14.3.2.26",algorithmParams:new At}).toSchema()});case qs:return 20;case zs:return 1;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new z({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[Z.schema(t.hashAlgorithm||{})]}),new z({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[Z.schema(t.maskGenAlgorithm||{})]}),new z({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[new Q({name:t.saltLength||w})]}),new z({idBlock:{tagClass:3,tagNumber:3},optional:!0,value:[new Q({name:t.trailerField||w})]})]})}fromSchema(e){ne(e,ap);const t=de(e,e,s.schema({names:{hashAlgorithm:{names:{blockName:Gs}},maskGenAlgorithm:{names:{blockName:Js}},saltLength:qs,trailerField:zs}}));le.assertSchema(t,this.className),Gs in t.result&&(this.hashAlgorithm=new Z({schema:t.result.hashAlgorithm})),Js in t.result&&(this.maskGenAlgorithm=new Z({schema:t.result.maskGenAlgorithm})),qs in t.result&&(this.saltLength=t.result.saltLength.valueBlock.valueDec),zs in t.result&&(this.trailerField=t.result.trailerField.valueBlock.valueDec)}toSchema(){const e=[];return this.hashAlgorithm.isEqual(s.defaultValues(Gs))||e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(s.defaultValues(Js))||e.push(new z({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.saltLength!==s.defaultValues(qs)&&e.push(new z({idBlock:{tagClass:3,tagNumber:2},value:[new Q({value:this.saltLength})]})),this.trailerField!==s.defaultValues(zs)&&e.push(new z({idBlock:{tagClass:3,tagNumber:3},value:[new Q({value:this.trailerField})]})),new U({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(s.defaultValues(Gs))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(s.defaultValues(Js))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.saltLength!==s.defaultValues(qs)&&(e.saltLength=this.saltLength),this.trailerField!==s.defaultValues(zs)&&(e.trailerField=this.trailerField),e}}return s.CLASS_NAME="RSASSAPSSParams",s})();const en="salt",io="iterationCount",Zt="keyLength",ms="prf",op=[en,io,Zt,ms];let ro=(()=>{class s extends fe{constructor(e={}){super(),this.salt=c(e,en,s.defaultValues(en)),this.iterationCount=c(e,io,s.defaultValues(io)),Zt in e&&(this.keyLength=c(e,Zt,s.defaultValues(Zt))),ms in e&&(this.prf=c(e,ms,s.defaultValues(ms))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case en:return{};case io:return-1;case Zt:return 0;case ms:return new Z({algorithmId:"1.3.14.3.2.26",algorithmParams:new At});default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new dt({value:[new me({name:t.saltPrimitive||w}),Z.schema(t.saltConstructed||{})]}),new Q({name:t.iterationCount||w}),new Q({name:t.keyLength||w,optional:!0}),Z.schema(t.prf||{names:{optional:!0}})]})}fromSchema(e){ne(e,op);const t=de(e,e,s.schema({names:{saltPrimitive:en,saltConstructed:{names:{blockName:en}},iterationCount:io,keyLength:Zt,prf:{names:{blockName:ms,optional:!0}}}}));le.assertSchema(t,this.className),this.salt=t.result.salt,this.iterationCount=t.result.iterationCount.valueBlock.valueDec,Zt in t.result&&(this.keyLength=t.result.keyLength.valueBlock.valueDec),ms in t.result&&(this.prf=new Z({schema:t.result.prf}))}toSchema(){const e=[];return e.push(this.salt),e.push(new Q({value:this.iterationCount})),Zt in this&&s.defaultValues(Zt)!==this.keyLength&&e.push(new Q({value:this.keyLength})),this.prf&&!1===s.defaultValues(ms).isEqual(this.prf)&&e.push(this.prf.toSchema()),new U({value:e})}toJSON(){const e={salt:this.salt.toJSON(),iterationCount:this.iterationCount};return Zt in this&&s.defaultValues(Zt)!==this.keyLength&&(e.keyLength=this.keyLength),this.prf&&!1===s.defaultValues(ms).isEqual(this.prf)&&(e.prf=this.prf.toJSON()),e}}return s.CLASS_NAME="PBKDF2Params",s})();const no="keyDerivationFunc",ao="encryptionScheme",lp=[no,ao];let Nf=(()=>{class s extends fe{constructor(e={}){super(),this.keyDerivationFunc=c(e,no,s.defaultValues(no)),this.encryptionScheme=c(e,ao,s.defaultValues(ao)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case no:case ao:return new Z;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[Z.schema(t.keyDerivationFunc||{}),Z.schema(t.encryptionScheme||{})]})}fromSchema(e){ne(e,lp);const t=de(e,e,s.schema({names:{keyDerivationFunc:{names:{blockName:no}},encryptionScheme:{names:{blockName:ao}}}}));le.assertSchema(t,this.className),this.keyDerivationFunc=new Z({schema:t.result.keyDerivationFunc}),this.encryptionScheme=new Z({schema:t.result.encryptionScheme})}toSchema(){return new U({value:[this.keyDerivationFunc.toSchema(),this.encryptionScheme.toSchema()]})}toJSON(){return{keyDerivationFunc:this.keyDerivationFunc.toJSON(),encryptionScheme:this.encryptionScheme.toJSON()}}}return s.CLASS_NAME="PBES2Params",s})();class cp{constructor(r){this.crypto=r.crypto,this.subtle="webkitSubtle"in r.crypto?r.crypto.webkitSubtle:r.crypto.subtle,this.name=c(r,"name",w)}encrypt(...r){var e=this;return(0,E.A)(function*(){return e.subtle.encrypt(...r)})()}decrypt(...r){var e=this;return(0,E.A)(function*(){return e.subtle.decrypt(...r)})()}sign(...r){return this.subtle.sign(...r)}verify(...r){var e=this;return(0,E.A)(function*(){return e.subtle.verify(...r)})()}digest(...r){var e=this;return(0,E.A)(function*(){return e.subtle.digest(...r)})()}generateKey(...r){var e=this;return(0,E.A)(function*(){return e.subtle.generateKey(...r)})()}deriveKey(...r){var e=this;return(0,E.A)(function*(){return e.subtle.deriveKey(...r)})()}deriveBits(...r){var e=this;return(0,E.A)(function*(){return e.subtle.deriveBits(...r)})()}wrapKey(...r){var e=this;return(0,E.A)(function*(){return e.subtle.wrapKey(...r)})()}unwrapKey(...r){var e=this;return(0,E.A)(function*(){return e.subtle.unwrapKey(...r)})()}exportKey(...r){return this.subtle.exportKey(...r)}importKey(...r){return this.subtle.importKey(...r)}getRandomValues(r){return this.crypto.getRandomValues(r)}}function If(s,r,e,t,i){return Nu.apply(this,arguments)}function Nu(){return(Nu=(0,E.A)(function*(s,r,e,t,i){let a,o,u;switch(s.toUpperCase()){case"SHA-1":a=20,o=64,u=xm;break;case"SHA-256":a=32,o=64,u=Om;break;case"SHA-384":a=48,o=128,u=eg;break;case"SHA-512":a=64,o=128,u=Zm;break;default:throw new Error("Unsupported hashing algorithm")}const h=new Uint8Array(e);let g=(new TextDecoder).decode(e);(new TextEncoder).encode(g).some((ce,pe)=>ce!==h[pe])&&(g=String.fromCharCode(...h));const x=new Uint8Array(2*g.length+2),G=new DataView(x.buffer);for(let ce=0;ce<g.length;ce++)G.setUint16(2*ce,g.charCodeAt(ce),!1);G.setUint16(2*g.length,0,!1);const H=new Uint8Array(o).fill(3),re=new Uint8Array(t),Ae=new Uint8Array(o*Math.ceil(re.length/o)).map((ce,pe)=>re[pe%re.length]),we=new Uint8Array(o*Math.ceil(x.length/o)).map((ce,pe)=>x[pe%x.length]);let ie=new Uint8Array(Ae.length+we.length);ie.set(Ae),ie.set(we,Ae.length);const ye=Math.ceil((r>>3)/a),oe=[];for(let ce=0;ce<ye;ce++){let pe=new Uint8Array(H.length+ie.length);pe.set(H),pe.set(ie,H.length);for(let Ue=0;Ue<i;Ue++)pe=u(pe);const be=new Uint8Array(o).map((Ue,We)=>pe[We%pe.length]),Be=Math.ceil(re.length/o)+Math.ceil(x.length/o),xe=[];for(let Ue=0;Ue<Be;Ue++){const We=Array.from(ie.slice(Ue*o,(Ue+1)*o));let bt=511;for(let Ye=be.length-1;Ye>=0;Ye--)bt>>=8,bt+=be[Ye]+(We[Ye]||0),We[Ye]=255&bt;xe.push(...We)}ie=new Uint8Array(xe),oe.push(...pe)}return new Uint8Array(oe.slice(0,r>>3)).buffer})).apply(this,arguments)}function Bf(s){const r="string"==typeof s?{name:s}:s;return"hash"in r?{...r,hash:Bf(r.hash)}:r}class Wl extends cp{importKey(r,e,t,i,a){var o=this;return(0,E.A)(function*(){var u,h,g,N,x,G;let H={};const re=Bf(t);switch(r.toLowerCase()){case"raw":return o.subtle.importKey("raw",e,t,i,a);case"spki":{const Ae=Et(L._H.toArrayBuffer(e));le.assert(Ae,"keyData");const we=new ns;try{we.fromSchema(Ae.result)}catch{throw new ot("Incorrect keyData")}switch(re.name.toUpperCase()){case"RSA-PSS":if(!re.hash)throw new st("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(re.hash.name.toUpperCase()){case"SHA-1":H.alg="PS1";break;case"SHA-256":H.alg="PS256";break;case"SHA-384":H.alg="PS384";break;case"SHA-512":H.alg="PS512";break;default:throw new Error(`Incorrect hash algorithm: ${re.hash.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(a=["verify"],H.kty="RSA",H.ext=i,H.key_ops=a,"1.2.840.113549.1.1.1"!==we.algorithm.algorithmId)throw new Error(`Incorrect public key algorithm: ${we.algorithm.algorithmId}`);if(!H.alg){if(!re.hash)throw new st("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(re.hash.name.toUpperCase()){case"SHA-1":H.alg="RS1";break;case"SHA-256":H.alg="RS256";break;case"SHA-384":H.alg="RS384";break;case"SHA-512":H.alg="RS512";break;default:throw new Error(`Incorrect hash algorithm: ${re.hash.name.toUpperCase()}`)}}const ie=we.toJSON();Object.assign(H,ie)}break;case"ECDSA":a=["verify"];case"ECDH":{if(H={kty:"EC",ext:i,key_ops:a},"1.2.840.10045.2.1"!==we.algorithm.algorithmId)throw new Error(`Incorrect public key algorithm: ${we.algorithm.algorithmId}`);const ie=we.toJSON();Object.assign(H,ie)}break;case"RSA-OAEP":{if(H.kty="RSA",H.ext=i,H.key_ops=a,"safari"===o.name.toLowerCase())H.alg="RSA-OAEP";else{if(!re.hash)throw new st("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(re.hash.name.toUpperCase()){case"SHA-1":H.alg="RSA-OAEP";break;case"SHA-256":H.alg="RSA-OAEP-256";break;case"SHA-384":H.alg="RSA-OAEP-384";break;case"SHA-512":H.alg="RSA-OAEP-512";break;default:throw new Error(`Incorrect hash algorithm: ${re.hash.name.toUpperCase()}`)}}const ie=we.toJSON();Object.assign(H,ie)}break;case"RSAES-PKCS1-V1_5":{H.kty="RSA",H.ext=i,H.key_ops=a,H.alg="PS1";const ie=we.toJSON();Object.assign(H,ie)}break;default:throw new Error(`Incorrect algorithm name: ${re.name.toUpperCase()}`)}}break;case"pkcs8":{const Ae=new Xr,we=Et(L._H.toArrayBuffer(e));le.assert(we,"keyData");try{Ae.fromSchema(we.result)}catch{throw new Error("Incorrect keyData")}if(!Ae.parsedKey)throw new Error("Incorrect keyData");switch(re.name.toUpperCase()){case"RSA-PSS":switch(null===(u=re.hash)||void 0===u?void 0:u.name.toUpperCase()){case"SHA-1":H.alg="PS1";break;case"SHA-256":H.alg="PS256";break;case"SHA-384":H.alg="PS384";break;case"SHA-512":H.alg="PS512";break;default:throw new Error(`Incorrect hash algorithm: ${null===(h=re.hash)||void 0===h?void 0:h.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(a=["sign"],H.kty="RSA",H.ext=i,H.key_ops=a,"1.2.840.113549.1.1.1"!==Ae.privateKeyAlgorithm.algorithmId)throw new Error(`Incorrect private key algorithm: ${Ae.privateKeyAlgorithm.algorithmId}`);if(!("alg"in H))switch(null===(g=re.hash)||void 0===g?void 0:g.name.toUpperCase()){case"SHA-1":H.alg="RS1";break;case"SHA-256":H.alg="RS256";break;case"SHA-384":H.alg="RS384";break;case"SHA-512":H.alg="RS512";break;default:throw new Error(`Incorrect hash algorithm: ${null===(N=re.hash)||void 0===N?void 0:N.name.toUpperCase()}`)}const ie=Ae.toJSON();Object.assign(H,ie)}break;case"ECDSA":a=["sign"];case"ECDH":{if(H={kty:"EC",ext:i,key_ops:a},"1.2.840.10045.2.1"!==Ae.privateKeyAlgorithm.algorithmId)throw new Error(`Incorrect algorithm: ${Ae.privateKeyAlgorithm.algorithmId}`);const ie=Ae.toJSON();Object.assign(H,ie)}break;case"RSA-OAEP":{if(H.kty="RSA",H.ext=i,H.key_ops=a,"safari"===o.name.toLowerCase())H.alg="RSA-OAEP";else switch(null===(x=re.hash)||void 0===x?void 0:x.name.toUpperCase()){case"SHA-1":H.alg="RSA-OAEP";break;case"SHA-256":H.alg="RSA-OAEP-256";break;case"SHA-384":H.alg="RSA-OAEP-384";break;case"SHA-512":H.alg="RSA-OAEP-512";break;default:throw new Error(`Incorrect hash algorithm: ${null===(G=re.hash)||void 0===G?void 0:G.name.toUpperCase()}`)}const ie=Ae.toJSON();Object.assign(H,ie)}break;case"RSAES-PKCS1-V1_5":{a=["decrypt"],H.kty="RSA",H.ext=i,H.key_ops=a,H.alg="PS1";const ie=Ae.toJSON();Object.assign(H,ie)}break;default:throw new Error(`Incorrect algorithm name: ${re.name.toUpperCase()}`)}}break;case"jwk":H=e;break;default:throw new Error(`Incorrect format: ${r}`)}if("safari"===o.name.toLowerCase())try{return o.subtle.importKey("jwk",_e(JSON.stringify(H)),t,i,a)}catch{return o.subtle.importKey("jwk",H,t,i,a)}return o.subtle.importKey("jwk",H,t,i,a)})()}exportKey(r,e){var t=this;return(0,E.A)(function*(){let i=yield t.subtle.exportKey("jwk",e);switch("safari"===t.name.toLowerCase()&&i instanceof ArrayBuffer&&(i=JSON.parse(Ie(i))),r.toLowerCase()){case"raw":return t.subtle.exportKey("raw",e);case"spki":{const a=new ns;try{a.fromJSON(i)}catch{throw new Error("Incorrect key data")}return a.toSchema().toBER(!1)}case"pkcs8":{const a=new Xr;try{a.fromJSON(i)}catch{throw new Error("Incorrect key data")}return a.toSchema().toBER(!1)}case"jwk":return i;default:throw new Error(`Incorrect format: ${r}`)}})()}convert(r,e,t,i,a,o){var u=this;return(0,E.A)(function*(){if(r.toLowerCase()===e.toLowerCase())return t;const h=yield u.importKey(r,t,i,a,o);return u.exportKey(e,h)})()}getAlgorithmByOID(r,e=!1,t){switch(r){case"1.2.840.113549.1.1.1":return{name:"RSAES-PKCS1-v1_5"};case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"}}if(e)throw new Error(`Unsupported algorithm identifier ${t?`for ${t} `:w}: ${r}`);return{}}getOIDByAlgorithm(r,e=!1,t){let i=w;switch(r.name.toUpperCase()){case"RSAES-PKCS1-V1_5":i="1.2.840.113549.1.1.1";break;case"RSASSA-PKCS1-V1_5":switch(r.hash.name.toUpperCase()){case"SHA-1":i="1.2.840.113549.1.1.5";break;case"SHA-256":i="1.2.840.113549.1.1.11";break;case"SHA-384":i="1.2.840.113549.1.1.12";break;case"SHA-512":i="1.2.840.113549.1.1.13"}break;case"RSA-PSS":i="1.2.840.113549.1.1.10";break;case"RSA-OAEP":i="1.2.840.113549.1.1.7";break;case"ECDSA":switch(r.hash.name.toUpperCase()){case"SHA-1":i="1.2.840.10045.4.1";break;case"SHA-256":i="1.2.840.10045.4.3.2";break;case"SHA-384":i="1.2.840.10045.4.3.3";break;case"SHA-512":i="1.2.840.10045.4.3.4"}break;case"ECDH":switch(r.kdf.toUpperCase()){case"SHA-1":i="1.3.133.16.840.63.0.2";break;case"SHA-256":i="1.3.132.1.11.1";break;case"SHA-384":i="1.3.132.1.11.2";break;case"SHA-512":i="1.3.132.1.11.3"}break;case"AES-CTR":case"AES-CMAC":case"CONCAT":case"HKDF":break;case"AES-CBC":switch(r.length){case 128:i="2.16.840.1.101.3.4.1.2";break;case 192:i="2.16.840.1.101.3.4.1.22";break;case 256:i="2.16.840.1.101.3.4.1.42"}break;case"AES-GCM":switch(r.length){case 128:i="2.16.840.1.101.3.4.1.6";break;case 192:i="2.16.840.1.101.3.4.1.26";break;case 256:i="2.16.840.1.101.3.4.1.46"}break;case"AES-CFB":switch(r.length){case 128:i="2.16.840.1.101.3.4.1.4";break;case 192:i="2.16.840.1.101.3.4.1.24";break;case 256:i="2.16.840.1.101.3.4.1.44"}break;case"AES-KW":switch(r.length){case 128:i="2.16.840.1.101.3.4.1.5";break;case 192:i="2.16.840.1.101.3.4.1.25";break;case 256:i="2.16.840.1.101.3.4.1.45"}break;case"HMAC":switch(r.hash.name.toUpperCase()){case"SHA-1":i="1.2.840.113549.2.7";break;case"SHA-256":i="1.2.840.113549.2.9";break;case"SHA-384":i="1.2.840.113549.2.10";break;case"SHA-512":i="1.2.840.113549.2.11"}break;case"DH":i="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":i="1.3.14.3.2.26";break;case"SHA-256":i="2.16.840.1.101.3.4.2.1";break;case"SHA-384":i="2.16.840.1.101.3.4.2.2";break;case"SHA-512":i="2.16.840.1.101.3.4.2.3";break;case"PBKDF2":i="1.2.840.113549.1.5.12";break;case"P-256":i="1.2.840.10045.3.1.7";break;case"P-384":i="1.3.132.0.34";break;case"P-521":i="1.3.132.0.35"}if(!i&&e)throw new Error(`Unsupported algorithm ${t?`for ${t} `:w}: ${r.name}`);return i}getAlgorithmParameters(r,e){let t={algorithm:{},usages:[]};switch(r.toUpperCase()){case"RSAES-PKCS1-V1_5":case"RSASSA-PKCS1-V1_5":switch(e.toLowerCase()){case"generatekey":t={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":t={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(e.toLowerCase()){case"sign":case"verify":t={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":t={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":t={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(e.toLowerCase()){case"encrypt":case"decrypt":t={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":t={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":t={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(e.toLowerCase()){case"generatekey":t={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":t={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":t={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(e.toLowerCase()){case"exportkey":case"importkey":case"generatekey":t={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":t={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(e.toLowerCase()){case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":t={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(e.toLowerCase()){case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":t={algorithm:{name:"AES-CBC",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(e.toLowerCase()){case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":t={algorithm:{name:"AES-GCM",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(e.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":t={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(e.toLowerCase()){case"sign":case"verify":t={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":if("derivekey"!==e.toLowerCase())return{algorithm:{name:"HKDF"},usages:[]};t={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;case"PBKDF2":if("derivekey"!==e.toLowerCase())return{algorithm:{name:"PBKDF2"},usages:[]};t={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e4},usages:["encrypt","decrypt"]}}return t}getHashAlgorithm(r){let e=w;switch(r.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":e="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":e="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":e="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":e="SHA-512";break;case"1.2.840.113549.1.1.10":try{const t=new Cu({schema:r.algorithmParams});if(t.hashAlgorithm){const i=this.getAlgorithmByOID(t.hashAlgorithm.algorithmId);if(!("name"in i))return w;e=i.name}else e="SHA-1"}catch{}}return e}encryptEncryptedContentInfo(r){var e=this;return(0,E.A)(function*(){st.assert(r,"password","contentEncryptionAlgorithm","hmacHashAlgorithm","iterationCount","contentToEncrypt","contentToEncrypt","contentType");const t=e.getOIDByAlgorithm(r.contentEncryptionAlgorithm,!0,"contentEncryptionAlgorithm"),i=e.getOIDByAlgorithm({name:"PBKDF2"},!0,"PBKDF2"),a=e.getOIDByAlgorithm({name:"HMAC",hash:{name:r.hmacHashAlgorithm}},!0,"hmacHashAlgorithm"),o=new ArrayBuffer(16),u=new Uint8Array(o);e.getRandomValues(u);const h=new ArrayBuffer(64),g=new Uint8Array(h);e.getRandomValues(g);const N=new Uint8Array(r.contentToEncrypt),x=new ro({salt:new me({valueHex:h}),iterationCount:r.iterationCount,prf:new Z({algorithmId:a,algorithmParams:new At})}),G=new Uint8Array(r.password),H=yield e.importKey("raw",G,"PBKDF2",!1,["deriveKey"]),re=yield e.deriveKey({name:"PBKDF2",hash:{name:r.hmacHashAlgorithm},salt:g,iterations:r.iterationCount},H,r.contentEncryptionAlgorithm,!1,["encrypt"]),Ae=yield e.encrypt({name:r.contentEncryptionAlgorithm.name,iv:u},re,N),we=new Nf({keyDerivationFunc:new Z({algorithmId:i,algorithmParams:x.toSchema()}),encryptionScheme:new Z({algorithmId:t,algorithmParams:new me({valueHex:o})})});return new Mt({contentType:r.contentType,contentEncryptionAlgorithm:new Z({algorithmId:"1.2.840.113549.1.5.13",algorithmParams:we.toSchema()}),encryptedContent:new me({valueHex:Ae})})})()}decryptEncryptedContentInfo(r){var e=this;return(0,E.A)(function*(){if(st.assert(r,"password","encryptedContentInfo"),"1.2.840.113549.1.5.13"!==r.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId)throw new Error(`Unknown "contentEncryptionAlgorithm": ${r.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId}`);let t,i;try{t=new Nf({schema:r.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams})}catch{throw new Error('Incorrectly encoded "pbes2Parameters"')}try{i=new ro({schema:t.keyDerivationFunc.algorithmParams})}catch{throw new Error('Incorrectly encoded "pbkdf2Params"')}const a=e.getAlgorithmByOID(t.encryptionScheme.algorithmId,!0),u=new Uint8Array(t.encryptionScheme.algorithmParams.valueBlock.valueHex),g=new Uint8Array(i.salt.valueBlock.valueHex),N=i.iterationCount;let x="SHA-1";i.prf&&(x=e.getAlgorithmByOID(i.prf.algorithmId,!0).hash.name);const G=yield e.importKey("raw",r.password,"PBKDF2",!1,["deriveKey"]),H=yield e.deriveKey({name:"PBKDF2",hash:{name:x},salt:g,iterations:N},G,a,!1,["decrypt"]),re=r.encryptedContentInfo.getEncryptedContent();return e.decrypt({name:a.name,iv:u},H,re)})()}stampDataWithPassword(r){var e=this;return(0,E.A)(function*(){if(!(r instanceof Object))throw new Error('Parameters must have type "Object"');let t;switch(st.assert(r,"password","hashAlgorithm","iterationCount","salt","contentToStamp"),r.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:throw new Error(`Incorrect "parameters.hashAlgorithm" parameter: ${r.hashAlgorithm}`)}const i={name:"HMAC",length:t,hash:{name:r.hashAlgorithm}},a=yield If(r.hashAlgorithm,t,r.password,r.salt,r.iterationCount),o=yield e.importKey("raw",new Uint8Array(a),i,!1,["sign"]);return e.sign(i,o,new Uint8Array(r.contentToStamp))})()}verifyDataStampedWithPassword(r){var e=this;return(0,E.A)(function*(){st.assert(r,"password","hashAlgorithm","salt","iterationCount","contentToVerify","signatureToVerify");let t=0;switch(r.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:throw new Error(`Incorrect "parameters.hashAlgorithm" parameter: ${r.hashAlgorithm}`)}const i={name:"HMAC",length:t,hash:{name:r.hashAlgorithm}},a=yield If(r.hashAlgorithm,t,r.password,r.salt,r.iterationCount),o=yield e.importKey("raw",new Uint8Array(a),i,!1,["verify"]);return e.verify(i,o,new Uint8Array(r.signatureToVerify),new Uint8Array(r.contentToVerify))})()}getSignatureParameters(r,e="SHA-1"){var t=this;return(0,E.A)(function*(){t.getOIDByAlgorithm({name:e},!0,"hashAlgorithm");const i=new Z,a=t.getAlgorithmParameters(r.algorithm.name,"sign");if(!Object.keys(a.algorithm).length)throw new Error("Parameter 'algorithm' is empty");const o=a.algorithm;switch(o.hash.name="hash"in r.algorithm&&r.algorithm.hash&&r.algorithm.hash.name?r.algorithm.hash.name:e,r.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":i.algorithmId=t.getOIDByAlgorithm(o,!0);break;case"RSA-PSS":{switch(o.hash.name.toUpperCase()){case"SHA-256":o.saltLength=32;break;case"SHA-384":o.saltLength=48;break;case"SHA-512":o.saltLength=64}const u={};if("SHA-1"!==o.hash.name.toUpperCase()){const g=t.getOIDByAlgorithm({name:o.hash.name},!0,"hashAlgorithm");u.hashAlgorithm=new Z({algorithmId:g,algorithmParams:new At}),u.maskGenAlgorithm=new Z({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:u.hashAlgorithm.toSchema()})}20!==o.saltLength&&(u.saltLength=o.saltLength);const h=new Cu(u);i.algorithmId="1.2.840.113549.1.1.10",i.algorithmParams=h.toSchema()}break;default:throw new Error(`Unsupported signature algorithm: ${r.algorithm.name}`)}return{signatureAlgorithm:i,parameters:a}})()}signWithPrivateKey(r,e,t){var i=this;return(0,E.A)(function*(){const a=yield i.sign(t.algorithm,e,r);return"ECDSA"===t.algorithm.name?function hp(s){if(s.byteLength%2!=0)return Nt;const r=s.byteLength/2,e=new ArrayBuffer(r);new Uint8Array(e).set(new Uint8Array(s,0,r));const i=new Q({valueHex:e}),a=new ArrayBuffer(r);new Uint8Array(a).set(new Uint8Array(s,r,r));const u=new Q({valueHex:a});return new U({value:[i.convertToDER(),u.convertToDER()]}).toBER(!1)}(a):a})()}fillPublicKeyParameters(r,e){const t={},i=this.getHashAlgorithm(e);if(i===w)throw new Error(`Unsupported signature algorithm: ${e.algorithmId}`);let a;a="1.2.840.113549.1.1.10"===e.algorithmId?e.algorithmId:r.algorithm.algorithmId;const o=this.getAlgorithmByOID(a,!0);if(t.algorithm=this.getAlgorithmParameters(o.name,"importKey"),"hash"in t.algorithm.algorithm&&(t.algorithm.algorithm.hash.name=i),"ECDSA"===o.name){const u=r.algorithm;if(!u.algorithmParams)throw new Error("Algorithm parameters for ECDSA public key are missed");const h=u.algorithmParams;if("idBlock"in u.algorithmParams&&(1!==h.idBlock.tagClass||6!==h.idBlock.tagNumber))throw new Error("Incorrect type for ECDSA public key parameters");const g=this.getAlgorithmByOID(h.valueBlock.toString(),!0);t.algorithm.algorithm.namedCurve=g.name}return t}getPublicKey(r,e,t){var i=this;return(0,E.A)(function*(){t||(t=i.fillPublicKeyParameters(r,e));const a=r.toSchema().toBER(!1);return i.importKey("spki",a,t.algorithm.algorithm,!0,t.algorithm.usages)})()}verifyWithPublicKey(r,e,t,i,a){var o=this;return(0,E.A)(function*(){let u;if(a){const N={};let x;x="1.2.840.113549.1.1.10"===i.algorithmId?i.algorithmId:t.algorithm.algorithmId;const G=o.getAlgorithmByOID(x,!0);if(N.algorithm=o.getAlgorithmParameters(G.name,"importKey"),"hash"in N.algorithm.algorithm&&(N.algorithm.algorithm.hash.name=a),"ECDSA"===G.name){let H=!1;if("algorithmParams"in t.algorithm&&"idBlock"in t.algorithm.algorithmParams&&1===t.algorithm.algorithmParams.idBlock.tagClass&&6===t.algorithm.algorithmParams.idBlock.tagNumber&&(H=!0),!1===H)throw new Error("Incorrect type for ECDSA public key parameters");const re=o.getAlgorithmByOID(t.algorithm.algorithmParams.valueBlock.toString(),!0);N.algorithm.algorithm.namedCurve=re.name}u=yield o.getPublicKey(t,null,N)}else{if(!(a=o.getHashAlgorithm(i)))throw new Error(`Unsupported signature algorithm: ${i.algorithmId}`);u=yield o.getPublicKey(t,i)}const h=o.getAlgorithmParameters(u.algorithm.name,"verify");"hash"in h.algorithm&&(h.algorithm.hash.name=a);let g=e.valueBlock.valueHexView;if("ECDSA"===u.algorithm.name){const N=js.find(u.algorithm.namedCurve);if(!N)throw new Error("Unsupported named curve in use");const x=Et(g);le.assert(x,"Signature value"),g=function dp(s,r){if(!(s instanceof U&&2===s.valueBlock.value.length&&s.valueBlock.value[0]instanceof Q&&s.valueBlock.value[1]instanceof Q))return Nt;const e=s.valueBlock.value[0].convertFromDER().valueBlock.valueHexView,t=s.valueBlock.value[1].convertFromDER().valueBlock.valueHexView,i=new Uint8Array(2*r);return i.set(e,r-e.byteLength),i.set(t,2*r-t.byteLength),i.buffer}(x.result,N.size)}if("RSA-PSS"===u.algorithm.name){const N=new Cu({schema:i.algorithmParams});h.algorithm.saltLength="saltLength"in N?N.saltLength:20;let x="SHA-1";"hashAlgorithm"in N&&(x=o.getAlgorithmByOID(N.hashAlgorithm.algorithmId,!0).name),h.algorithm.hash.name=x}return o.verify(h.algorithm,u,g,r)})()}}let Rf={name:"none",crypto:null};function Tf(s){return!(!s||"object"!=typeof s||!("crypto"in s))}function xf(s,...r){let e=null;if(r.length<2)e=r.length?r[0]:typeof self<"u"&&self.crypto?new Wl({name:"browser",crypto:self.crypto}):null;else{const t=r[0],i=r[1];Tf(i)?e=i:Tf(t)?e=t:"subtle"in t&&"getRandomValues"in t&&(e=new Wl({crypto:t}))}if(typeof process<"u"&&"pid"in process&&typeof global<"u"&&typeof window>"u"){if(typeof global[process.pid]>"u")global[process.pid]={};else if("object"!=typeof global[process.pid])throw new Error(`Name global.${process.pid} already exists and it is not an object`);if(typeof global[process.pid].pkijs>"u")global[process.pid].pkijs={};else if("object"!=typeof global[process.pid].pkijs)throw new Error(`Name global.${process.pid}.pkijs already exists and it is not an object`);global[process.pid].pkijs.engine={name:s,crypto:e}}else Rf={name:s,crypto:e}}function Ge(s=!1){const r=function up(){if(typeof process<"u"&&"pid"in process&&typeof global<"u"&&typeof window>"u"){let s;try{s=global[process.pid].pkijs.engine}catch{throw new Error("Please call 'setEngine' before call to 'getEngine'")}return s}return Rf}();if(!r.crypto&&s)throw new Error("Unable to create WebCrypto object");return r.crypto}function Iu(s){return Ge(!0).getRandomValues(s)}function fp(s,r,e,t,i){return Bu.apply(this,arguments)}function Bu(){return(Bu=(0,E.A)(function*(s,r,e,t,i){switch(s.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;default:throw new ot(`Unknown hash function: ${s}`)}if(ot.assert(r,"zBuffer","ArrayBuffer"),0===r.byteLength)throw new ot("'zBuffer' has zero length, error");if(ot.assert(t,"SharedInfo","ArrayBuffer"),e>255)throw new ot("Please set 'Counter' argument to value less or equal to 255");const a=new ArrayBuffer(4),o=new Uint8Array(a);o[0]=0,o[1]=0,o[2]=0,o[3]=e;let u=Nt;return u=K(u,r),u=K(u,a),u=K(u,t),{counter:e,result:yield i.digest({name:s},u)}})).apply(this,arguments)}function Vf(s,r,e,t){return Ru.apply(this,arguments)}function Ru(){return(Ru=(0,E.A)(function*(s,r,e,t,i=Ge(!0)){let a=0,o=1;switch(s.toUpperCase()){case"SHA-1":a=160;break;case"SHA-256":a=256;break;case"SHA-384":a=384;break;case"SHA-512":a=512;break;default:throw new ot(`Unknown hash function: ${s}`)}if(ot.assert(r,"Zbuffer","ArrayBuffer"),0===r.byteLength)throw new ot("'Zbuffer' has zero length, error");ot.assert(t,"SharedInfo","ArrayBuffer");const u=e/a;Math.floor(u)>0&&(o=Math.floor(u),u-o>0&&o++);const h=[];for(let G=1;G<=o;G++)h.push(yield fp(s,r,G,t,i));let g=Nt,N=1,x=!0;for(;x;){x=!1;for(const G of h)if(G.counter===N){g=K(g,G.result),x=!0;break}N++}if(g.byteLength>(e>>=3)){const G=new ArrayBuffer(e),H=new Uint8Array(G),re=new Uint8Array(g);for(let Ae=0;Ae<e;Ae++)H[Ae]=re[Ae];return G}return g})).apply(this,arguments)}const Tu="version",xu="logID",Vu="extensions",Ou="timestamp",Pu="hashAlgorithm",Du="signatureAlgorithm",Uu="signature",Hf="anonymous";let mp=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,Tu,s.defaultValues(Tu)),this.logID=c(e,xu,s.defaultValues(xu)),this.timestamp=c(e,Ou,s.defaultValues(Ou)),this.extensions=c(e,Vu,s.defaultValues(Vu)),this.hashAlgorithm=c(e,Pu,s.defaultValues(Pu)),this.signatureAlgorithm=c(e,Du,s.defaultValues(Du)),this.signature=c(e,Uu,s.defaultValues(Uu)),"stream"in e&&e.stream&&this.fromStream(e.stream),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Tu:return 0;case xu:case Vu:return Nt;case Ou:return new Date(0);case Pu:case Du:return w;case Uu:return new Fe;default:return super.defaultValues(e)}}fromSchema(e){if(!(e instanceof Ul))throw new Error("Object's schema was not verified against input data for SignedCertificateTimestamp");const t=new ga({stream:new vt({buffer:e.data})});this.fromStream(t)}fromStream(e){const t=e.getUint16();if(this.version=e.getBlock(1)[0],0===this.version){this.logID=new Uint8Array(e.getBlock(32)).buffer.slice(0),this.timestamp=new Date(Pe(new Uint8Array(e.getBlock(8)),8));const i=e.getUint16();switch(this.extensions=new Uint8Array(e.getBlock(i)).buffer.slice(0),e.getBlock(1)[0]){case 0:this.hashAlgorithm="none";break;case 1:this.hashAlgorithm="md5";break;case 2:this.hashAlgorithm="sha1";break;case 3:this.hashAlgorithm="sha224";break;case 4:this.hashAlgorithm="sha256";break;case 5:this.hashAlgorithm="sha384";break;case 6:this.hashAlgorithm="sha512";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}switch(e.getBlock(1)[0]){case 0:this.signatureAlgorithm=Hf;break;case 1:this.signatureAlgorithm="rsa";break;case 2:this.signatureAlgorithm="dsa";break;case 3:this.signatureAlgorithm="ecdsa";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}const a=e.getUint16(),u=Et(new Uint8Array(e.getBlock(a)).buffer.slice(0));if(le.assert(u,"SignedCertificateTimestamp"),this.signature=u.result,t!==47+i+a)throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}}toSchema(){const e=this.toStream();return new Ul({data:e.stream.buffer})}toStream(){const e=new ga;e.appendUint16(47+this.extensions.byteLength+this.signature.valueBeforeDecodeView.byteLength),e.appendChar(this.version),e.appendView(new Uint8Array(this.logID));const t=new ArrayBuffer(8),i=new Uint8Array(t),a=R(this.timestamp.valueOf(),8);let o,u;switch(i.set(new Uint8Array(a),8-a.byteLength),e.appendView(i),e.appendUint16(this.extensions.byteLength),this.extensions.byteLength&&e.appendView(new Uint8Array(this.extensions)),this.hashAlgorithm.toLowerCase()){case"none":o=0;break;case"md5":o=1;break;case"sha1":o=2;break;case"sha224":o=3;break;case"sha256":o=4;break;case"sha384":o=5;break;case"sha512":o=6;break;default:throw new Error(`Incorrect data for hashAlgorithm: ${this.hashAlgorithm}`)}switch(e.appendChar(o),this.signatureAlgorithm.toLowerCase()){case Hf:u=0;break;case"rsa":u=1;break;case"dsa":u=2;break;case"ecdsa":u=3;break;default:throw new Error(`Incorrect data for signatureAlgorithm: ${this.signatureAlgorithm}`)}e.appendChar(u);const h=this.signature.toBER(!1);return e.appendUint16(h.byteLength),e.appendView(new Uint8Array(h)),e}toJSON(){return{version:this.version,logID:se(this.logID),timestamp:this.timestamp,extensions:se(this.extensions),hashAlgorithm:this.hashAlgorithm,signatureAlgorithm:this.signatureAlgorithm,signature:this.signature.toJSON()}}verify(e,t,i=0,a=Ge(!0)){var o=this;return(0,E.A)(function*(){const u=j(Ie(o.logID));let h=null;const g=new ga;for(const Ae of e)if(Ae.log_id===u){h=Ae.key;break}if(!h)throw new Error(`Public key not found for CT with logId: ${u}`);const N=_e(q(h)),x=ns.fromBER(N);g.appendChar(0),g.appendChar(0);const G=new ArrayBuffer(8),H=new Uint8Array(G),re=R(o.timestamp.valueOf(),8);return H.set(new Uint8Array(re),8-re.byteLength),g.appendView(H),g.appendUint16(i),0===i&&g.appendUint24(t.byteLength),g.appendView(new Uint8Array(t)),g.appendUint16(o.extensions.byteLength),0!==o.extensions.byteLength&&g.appendView(new Uint8Array(o.extensions)),a.verifyWithPublicKey(g.buffer.slice(0,g.length),new me({valueHex:o.signature.toBER(!1)}),x,{algorithmId:w},"SHA-256")})()}}return s.CLASS_NAME="SignedCertificateTimestamp",s})();const Yl="timestamps";let gp=(()=>{class s extends fe{constructor(e={}){super(),this.timestamps=c(e,Yl,s.defaultValues(Yl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Yl?[]:super.defaultValues(e)}static compareWithDefault(e,t){return e===Yl?0===t.length:super.defaultValues(e)}static schema(e={}){var t;const i=c(e,"names",{});return null!==(t=i.optional)&&void 0!==t||(i.optional=!1),new me({name:i.blockName||"SignedCertificateTimestampList",optional:i.optional})}fromSchema(e){if(!(e instanceof me))throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");const t=new ga({stream:new vt({buffer:e.valueBlock.valueHex})});if(t.getUint16()!==t.length)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");for(;t.length;)this.timestamps.push(new mp({stream:t}))}toSchema(){const e=new ga;let t=0;const i=[];for(const a of this.timestamps){const o=a.toStream();i.push(o),t+=o.stream.buffer.byteLength}e.appendUint16(t);for(const a of i)e.appendView(a.stream.view);return new me({valueHex:e.stream.buffer.slice(0)})}toJSON(){return{timestamps:Array.from(this.timestamps,e=>e.toJSON())}}}return s.CLASS_NAME="SignedCertificateTimestampList",s})();const oo="attributes",pp=[oo];let vp=(()=>{class s extends fe{constructor(e={}){super(),this.attributes=c(e,oo,s.defaultValues(oo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===oo?[]:super.defaultValues(e)}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ke({name:t.attributes||w,value:it.schema()})]})}fromSchema(e){ne(e,pp);const t=de(e,e,s.schema({names:{attributes:oo}}));le.assertSchema(t,this.className),this.attributes=Array.from(t.result.attributes,i=>new it({schema:i}))}toSchema(){return new U({value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){return{attributes:Array.from(this.attributes,e=>e.toJSON())}}}return s.CLASS_NAME="SubjectDirectoryAttributes",s})();class wt{static getItems(){return this.types||(this.types={},wt.register(zd,"SubjectAltName",Jd),wt.register(Wd,"IssuerAltName",Jd),wt.register(Su,"AuthorityKeyIdentifier",uf),wt.register(wu,"BasicConstraints",hf),wt.register("1.3.6.1.4.1.311.21.1","MicrosoftCaVersion",Bg),wt.register(ef,"CertificatePolicies",mf),wt.register("1.3.6.1.4.1.311.21.10","CertificatePoliciesMicrosoft",mf),wt.register("1.3.6.1.4.1.311.21.7","MicrosoftCertTemplateV2",Gr),wt.register(Zd,"CRLDistributionPoints",wf),wt.register(yu,"FreshestCRL",wf),wt.register("2.5.29.37","ExtKeyUsage",Ug),wt.register(Xd,"CertificateIssuer",Rt),wt.register(bu,"AuthorityInfoAccess",yf),wt.register("1.3.6.1.5.5.7.1.11","SubjectInfoAccess",yf),wt.register(Yd,"IssuingDistributionPoint",Lg),wt.register(Qd,"NameConstraints",jg),wt.register(sf,"PolicyConstraints",Kg),wt.register(tf,"PolicyMappings",qg),wt.register("2.5.29.16","PrivateKeyUsagePeriod",Wg),wt.register("1.3.6.1.5.5.7.1.3","QCStatements",Qg),wt.register("1.3.6.1.4.1.11129.2.4.2","SignedCertificateTimestampList",gp),wt.register("2.5.29.9","SubjectDirectoryAttributes",vp)),this.types}static fromBER(r,e){const t=Et(e);if(-1===t.offset)return null;const i=this.find(r);if(i)try{return new i.type({schema:t.result})}catch{const o=new i.type;return o.parsingError=`Incorrectly formatted value of extension ${i.name} (${r})`,o}return t.result}static find(r){return this.getItems()[r]||null}static register(r,e,t){this.getItems()[r]={name:e,type:t}}}const lo="extnID",Ws="critical",co="extnValue",Xl="parsedValue",wp=[lo,Ws,co];let Li=(()=>{class s extends fe{get parsedValue(){if(void 0===this._parsedValue){const e=wt.fromBER(this.extnID,this.extnValue.valueBlock.valueHexView);this._parsedValue=e}return this._parsedValue||void 0}set parsedValue(e){this._parsedValue=e}constructor(e={}){super(),this.extnID=c(e,lo,s.defaultValues(lo)),this.critical=c(e,Ws,s.defaultValues(Ws)),this.extnValue=co in e?new me({valueHex:e.extnValue}):s.defaultValues(co),Xl in e&&(this.parsedValue=c(e,Xl,s.defaultValues(Xl))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case lo:return w;case Ws:return!1;case co:return new me;case Xl:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.extnID||w}),new Es({name:t.critical||w,optional:!0}),new me({name:t.extnValue||w})]})}fromSchema(e){ne(e,wp);const t=de(e,e,s.schema({names:{extnID:lo,critical:Ws,extnValue:co}}));le.assertSchema(t,this.className),this.extnID=t.result.extnID.valueBlock.toString(),Ws in t.result&&(this.critical=t.result.critical.valueBlock.value),this.extnValue=t.result.extnValue}toSchema(){const e=[];return e.push(new Ve({value:this.extnID})),this.critical!==s.defaultValues(Ws)&&e.push(new Es({value:this.critical})),e.push(this.extnValue),new U({value:e})}toJSON(){const e={extnID:this.extnID,extnValue:this.extnValue.toJSON()};return this.critical!==s.defaultValues(Ws)&&(e.critical=this.critical),this.parsedValue&&this.parsedValue.toJSON&&(e.parsedValue=this.parsedValue.toJSON()),e}}return s.CLASS_NAME="Extension",s})();const uo="extensions",yp=[uo];let Tt=(()=>{class s extends fe{constructor(e={}){super(),this.extensions=c(e,uo,s.defaultValues(uo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===uo?[]:super.defaultValues(e)}static schema(e={},t=!1){const i=c(e,"names",{});return new U({optional:t,name:i.blockName||w,value:[new Ke({name:i.extensions||w,value:Li.schema(i.extension||{})})]})}fromSchema(e){ne(e,yp);const t=de(e,e,s.schema({names:{extensions:uo}}));le.assertSchema(t,this.className),this.extensions=Array.from(t.result.extensions,i=>new Li({schema:i}))}toSchema(){return new U({value:Array.from(this.extensions,e=>e.toSchema())})}toJSON(){return{extensions:this.extensions.map(e=>e.toJSON())}}}return s.CLASS_NAME="Extensions",s})();const ho="issuer",fo="serialNumber",Fi="issuerUID",Sp=[ho,fo,Fi];let gs=(()=>{class s extends fe{constructor(e={}){super(),this.issuer=c(e,ho,s.defaultValues(ho)),this.serialNumber=c(e,fo,s.defaultValues(fo)),Fi in e&&(this.issuerUID=c(e,Fi,s.defaultValues(Fi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ho:return new Rt;case fo:return new Q;case Fi:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[Rt.schema(t.issuer||{}),new Q({name:t.serialNumber||w}),new et({optional:!0,name:t.issuerUID||w})]})}fromSchema(e){ne(e,Sp);const t=de(e,e,s.schema({names:{issuer:{names:{blockName:ho}},serialNumber:fo,issuerUID:Fi}}));le.assertSchema(t,this.className),this.issuer=new Rt({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber,Fi in t.result&&(this.issuerUID=t.result.issuerUID)}toSchema(){const e=new U({value:[this.issuer.toSchema(),this.serialNumber]});return this.issuerUID&&e.valueBlock.value.push(this.issuerUID),e}toJSON(){const e={issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()};return this.issuerUID&&(e.issuerUID=this.issuerUID.toJSON()),e}}return s.CLASS_NAME="IssuerSerial",s})();const mo="version",Hi="baseCertificateID",ji="subjectName",go="issuer",po="signature",vo="serialNumber",wo="attrCertValidityPeriod",yo="attributes",$i="issuerUniqueID",Ki="extensions",bp=[mo,Hi,ji,go,po,vo,wo,yo,$i,Ki];let Lu=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,mo,s.defaultValues(mo)),Hi in e&&(this.baseCertificateID=c(e,Hi,s.defaultValues(Hi))),ji in e&&(this.subjectName=c(e,ji,s.defaultValues(ji))),this.issuer=c(e,go,s.defaultValues(go)),this.signature=c(e,po,s.defaultValues(po)),this.serialNumber=c(e,vo,s.defaultValues(vo)),this.attrCertValidityPeriod=c(e,wo,s.defaultValues(wo)),this.attributes=c(e,yo,s.defaultValues(yo)),$i in e&&(this.issuerUniqueID=c(e,$i,s.defaultValues($i))),Ki in e&&(this.extensions=c(e,Ki,s.defaultValues(Ki))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case mo:return 0;case Hi:return new gs;case ji:case go:return new Rt;case po:return new Z;case vo:return new Q;case wo:return new Kr;case yo:return[];case $i:return new et;case Ki:return new Tt;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.version||w}),new dt({value:[new z({name:t.baseCertificateID||w,idBlock:{tagClass:3,tagNumber:0},value:gs.schema().valueBlock.value}),new z({name:t.subjectName||w,idBlock:{tagClass:3,tagNumber:1},value:Rt.schema().valueBlock.value})]}),Rt.schema({names:{blockName:t.issuer||w}}),Z.schema(t.signature||{}),new Q({name:t.serialNumber||w}),Kr.schema(t.attrCertValidityPeriod||{}),new U({name:t.attributes||w,value:[new Ke({value:it.schema()})]}),new et({optional:!0,name:t.issuerUniqueID||w}),Tt.schema(t.extensions||{},!0)]})}fromSchema(e){ne(e,bp);const t=de(e,e,s.schema({names:{version:mo,baseCertificateID:Hi,subjectName:ji,issuer:go,signature:{names:{blockName:po}},serialNumber:vo,attrCertValidityPeriod:{names:{blockName:wo}},attributes:yo,issuerUniqueID:$i,extensions:{names:{blockName:Ki}}}}));le.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,Hi in t.result&&(this.baseCertificateID=new gs({schema:new U({value:t.result.baseCertificateID.valueBlock.value})})),ji in t.result&&(this.subjectName=new Rt({schema:new U({value:t.result.subjectName.valueBlock.value})})),this.issuer=t.result.issuer,this.signature=new Z({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new Kr({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,i=>new it({schema:i})),$i in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),Ki in t.result&&(this.extensions=new Tt({schema:t.result.extensions}))}toSchema(){const e=new U({value:[new Q({value:this.version})]});return this.baseCertificateID&&e.valueBlock.value.push(new z({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.subjectName&&e.valueBlock.value.push(new z({idBlock:{tagClass:3,tagNumber:1},value:this.subjectName.toSchema().valueBlock.value})),e.valueBlock.value.push(this.issuer.toSchema()),e.valueBlock.value.push(this.signature.toSchema()),e.valueBlock.value.push(this.serialNumber),e.valueBlock.value.push(this.attrCertValidityPeriod.toSchema()),e.valueBlock.value.push(new U({value:Array.from(this.attributes,t=>t.toSchema())})),this.issuerUniqueID&&e.valueBlock.value.push(this.issuerUniqueID),this.extensions&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version};return this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.subjectName&&(e.subjectName=this.subjectName.toJSON()),e.issuer=this.issuer.toJSON(),e.signature=this.signature.toJSON(),e.serialNumber=this.serialNumber.toJSON(),e.attrCertValidityPeriod=this.attrCertValidityPeriod.toJSON(),e.attributes=Array.from(this.attributes,t=>t.toJSON()),this.issuerUniqueID&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),this.extensions&&(e.extensions=this.extensions.toJSON()),e}}return s.CLASS_NAME="AttributeCertificateInfoV1",s})();const So="acinfo",bo="signatureAlgorithm",Ao="signatureValue",Ap=[So,Ao,bo];let Fu=(()=>{class s extends fe{constructor(e={}){super(),this.acinfo=c(e,So,s.defaultValues(So)),this.signatureAlgorithm=c(e,bo,s.defaultValues(bo)),this.signatureValue=c(e,Ao,s.defaultValues(Ao)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case So:return new Lu;case bo:return new Z;case Ao:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[Lu.schema(t.acinfo||{}),Z.schema(t.signatureAlgorithm||{}),new et({name:t.signatureValue||w})]})}fromSchema(e){ne(e,Ap);const t=de(e,e,s.schema({names:{acinfo:{names:{blockName:So}},signatureAlgorithm:{names:{blockName:bo}},signatureValue:Ao}}));le.assertSchema(t,this.className),this.acinfo=new Lu({schema:t.result.acinfo}),this.signatureAlgorithm=new Z({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new U({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}return s.CLASS_NAME="AttributeCertificateV1",s})();const ko="digestedObjectType",Gi="otherObjectTypeID",Eo="digestAlgorithm",_o="objectDigest",kp=[ko,Gi,Eo,_o];let tn=(()=>{class s extends fe{constructor(e={}){super(),this.digestedObjectType=c(e,ko,s.defaultValues(ko)),Gi in e&&(this.otherObjectTypeID=c(e,Gi,s.defaultValues(Gi))),this.digestAlgorithm=c(e,Eo,s.defaultValues(Eo)),this.objectDigest=c(e,_o,s.defaultValues(_o)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ko:return new da;case Gi:return new Ve;case Eo:return new Z;case _o:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new da({name:t.digestedObjectType||w}),new Ve({optional:!0,name:t.otherObjectTypeID||w}),Z.schema(t.digestAlgorithm||{}),new et({name:t.objectDigest||w})]})}fromSchema(e){ne(e,kp);const t=de(e,e,s.schema({names:{digestedObjectType:ko,otherObjectTypeID:Gi,digestAlgorithm:{names:{blockName:Eo}},objectDigest:_o}}));le.assertSchema(t,this.className),this.digestedObjectType=t.result.digestedObjectType,Gi in t.result&&(this.otherObjectTypeID=t.result.otherObjectTypeID),this.digestAlgorithm=new Z({schema:t.result.digestAlgorithm}),this.objectDigest=t.result.objectDigest}toSchema(){const e=new U({value:[this.digestedObjectType]});return this.otherObjectTypeID&&e.valueBlock.value.push(this.otherObjectTypeID),e.valueBlock.value.push(this.digestAlgorithm.toSchema()),e.valueBlock.value.push(this.objectDigest),e}toJSON(){const e={digestedObjectType:this.digestedObjectType.toJSON(),digestAlgorithm:this.digestAlgorithm.toJSON(),objectDigest:this.objectDigest.toJSON()};return this.otherObjectTypeID&&(e.otherObjectTypeID=this.otherObjectTypeID.toJSON()),e}}return s.CLASS_NAME="ObjectDigestInfo",s})();const Ji="issuerName",qi="baseCertificateID",zi="objectDigestInfo",Ep=[Ji,qi,zi];let Gf=(()=>{class s extends fe{constructor(e={}){super(),Ji in e&&(this.issuerName=c(e,Ji,s.defaultValues(Ji))),qi in e&&(this.baseCertificateID=c(e,qi,s.defaultValues(qi))),zi in e&&(this.objectDigestInfo=c(e,zi,s.defaultValues(zi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ji:return new Rt;case qi:return new gs;case zi:return new tn;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[Rt.schema({names:{blockName:t.issuerName}},!0),new z({optional:!0,name:t.baseCertificateID||w,idBlock:{tagClass:3,tagNumber:0},value:gs.schema().valueBlock.value}),new z({optional:!0,name:t.objectDigestInfo||w,idBlock:{tagClass:3,tagNumber:1},value:tn.schema().valueBlock.value})]})}fromSchema(e){ne(e,Ep);const t=de(e,e,s.schema({names:{issuerName:Ji,baseCertificateID:qi,objectDigestInfo:zi}}));le.assertSchema(t,this.className),Ji in t.result&&(this.issuerName=new Rt({schema:t.result.issuerName})),qi in t.result&&(this.baseCertificateID=new gs({schema:new U({value:t.result.baseCertificateID.valueBlock.value})})),zi in t.result&&(this.objectDigestInfo=new tn({schema:new U({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new U;return this.issuerName&&e.valueBlock.value.push(this.issuerName.toSchema()),this.baseCertificateID&&e.valueBlock.value.push(new z({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.objectDigestInfo&&e.valueBlock.value.push(new z({idBlock:{tagClass:3,tagNumber:1},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return this.issuerName&&(e.issuerName=this.issuerName.toJSON()),this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.objectDigestInfo&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}return s.CLASS_NAME="V2Form",s})();const Wi="baseCertificateID",Yi="entityName",Xi="objectDigestInfo",_p=[Wi,Yi,Xi];let Hu=(()=>{class s extends fe{constructor(e={}){super(),Wi in e&&(this.baseCertificateID=c(e,Wi,s.defaultValues(Wi))),Yi in e&&(this.entityName=c(e,Yi,s.defaultValues(Yi))),Xi in e&&(this.objectDigestInfo=c(e,Xi,s.defaultValues(Xi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Wi:return new gs;case Yi:return new Rt;case Xi:return new tn;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new z({optional:!0,name:t.baseCertificateID||w,idBlock:{tagClass:3,tagNumber:0},value:gs.schema().valueBlock.value}),new z({optional:!0,name:t.entityName||w,idBlock:{tagClass:3,tagNumber:1},value:Rt.schema().valueBlock.value}),new z({optional:!0,name:t.objectDigestInfo||w,idBlock:{tagClass:3,tagNumber:2},value:tn.schema().valueBlock.value})]})}fromSchema(e){ne(e,_p);const t=de(e,e,s.schema({names:{baseCertificateID:Wi,entityName:Yi,objectDigestInfo:Xi}}));le.assertSchema(t,this.className),Wi in t.result&&(this.baseCertificateID=new gs({schema:new U({value:t.result.baseCertificateID.valueBlock.value})})),Yi in t.result&&(this.entityName=new Rt({schema:new U({value:t.result.entityName.valueBlock.value})})),Xi in t.result&&(this.objectDigestInfo=new tn({schema:new U({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new U;return this.baseCertificateID&&e.valueBlock.value.push(new z({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.entityName&&e.valueBlock.value.push(new z({idBlock:{tagClass:3,tagNumber:1},value:this.entityName.toSchema().valueBlock.value})),this.objectDigestInfo&&e.valueBlock.value.push(new z({idBlock:{tagClass:3,tagNumber:2},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.entityName&&(e.entityName=this.entityName.toJSON()),this.objectDigestInfo&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}return s.CLASS_NAME="Holder",s})();const Co="version",No="holder",Io="issuer",Bo="signature",Ro="serialNumber",To="attrCertValidityPeriod",xo="attributes",Qi="issuerUniqueID",Zi="extensions",Cp=[Co,No,Io,Bo,Ro,To,xo,Qi,Zi];let ju=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,Co,s.defaultValues(Co)),this.holder=c(e,No,s.defaultValues(No)),this.issuer=c(e,Io,s.defaultValues(Io)),this.signature=c(e,Bo,s.defaultValues(Bo)),this.serialNumber=c(e,Ro,s.defaultValues(Ro)),this.attrCertValidityPeriod=c(e,To,s.defaultValues(To)),this.attributes=c(e,xo,s.defaultValues(xo)),Qi in e&&(this.issuerUniqueID=c(e,Qi,s.defaultValues(Qi))),Zi in e&&(this.extensions=c(e,Zi,s.defaultValues(Zi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Co:return 1;case No:return new Hu;case Io:return{};case Bo:return new Z;case Ro:return new Q;case To:return new Kr;case xo:return[];case Qi:return new et;case Zi:return new Tt;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.version||w}),Hu.schema(t.holder||{}),new dt({value:[Rt.schema({names:{blockName:t.issuer||w}}),new z({name:t.issuer||w,idBlock:{tagClass:3,tagNumber:0},value:Gf.schema().valueBlock.value})]}),Z.schema(t.signature||{}),new Q({name:t.serialNumber||w}),Kr.schema(t.attrCertValidityPeriod||{}),new U({name:t.attributes||w,value:[new Ke({value:it.schema()})]}),new et({optional:!0,name:t.issuerUniqueID||w}),Tt.schema(t.extensions||{},!0)]})}fromSchema(e){ne(e,Cp);const t=de(e,e,s.schema({names:{version:Co,holder:{names:{blockName:No}},issuer:Io,signature:{names:{blockName:Bo}},serialNumber:Ro,attrCertValidityPeriod:{names:{blockName:To}},attributes:xo,issuerUniqueID:Qi,extensions:{names:{blockName:Zi}}}}));if(3!==(le.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.holder=new Hu({schema:t.result.holder}),t.result.issuer.idBlock.tagClass))throw new Error("Incorrect value for 'issuer' in AttributeCertificateInfoV2");this.issuer=new Gf({schema:new U({value:t.result.issuer.valueBlock.value})}),this.signature=new Z({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new Kr({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,i=>new it({schema:i})),Qi in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),Zi in t.result&&(this.extensions=new Tt({schema:t.result.extensions}))}toSchema(){const e=new U({value:[new Q({value:this.version}),this.holder.toSchema(),new z({idBlock:{tagClass:3,tagNumber:0},value:this.issuer.toSchema().valueBlock.value}),this.signature.toSchema(),this.serialNumber,this.attrCertValidityPeriod.toSchema(),new U({value:Array.from(this.attributes,t=>t.toSchema())})]});return this.issuerUniqueID&&e.valueBlock.value.push(this.issuerUniqueID),this.extensions&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version,holder:this.holder.toJSON(),issuer:this.issuer.toJSON(),signature:this.signature.toJSON(),serialNumber:this.serialNumber.toJSON(),attrCertValidityPeriod:this.attrCertValidityPeriod.toJSON(),attributes:Array.from(this.attributes,t=>t.toJSON())};return this.issuerUniqueID&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),this.extensions&&(e.extensions=this.extensions.toJSON()),e}}return s.CLASS_NAME="AttributeCertificateInfoV2",s})();const Vo="acinfo",Oo="signatureAlgorithm",Po="signatureValue",Np=[Vo,Oo,Po];let er=(()=>{class s extends fe{constructor(e={}){super(),this.acinfo=c(e,Vo,s.defaultValues(Vo)),this.signatureAlgorithm=c(e,Oo,s.defaultValues(Oo)),this.signatureValue=c(e,Po,s.defaultValues(Po)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Vo:return new ju;case Oo:return new Z;case Po:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[ju.schema(t.acinfo||{}),Z.schema(t.signatureAlgorithm||{}),new et({name:t.signatureValue||w})]})}fromSchema(e){ne(e,Np);const t=de(e,e,s.schema({names:{acinfo:{names:{blockName:Vo}},signatureAlgorithm:{names:{blockName:Oo}},signatureValue:Po}}));le.assertSchema(t,this.className),this.acinfo=new ju({schema:t.result.acinfo}),this.signatureAlgorithm=new Z({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new U({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}return s.CLASS_NAME="AttributeCertificateV2",s})();const tr="contentType",sn="content",Ip=[tr,sn];let Lt=(()=>{class s extends fe{constructor(e={}){super(),this.contentType=c(e,tr,s.defaultValues(tr)),this.content=c(e,sn,s.defaultValues(sn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case tr:return w;case sn:return new Fe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case tr:return"string"==typeof t&&t===this.defaultValues(tr);case sn:return t instanceof Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return"optional"in t||(t.optional=!1),new U({name:t.blockName||"ContentInfo",optional:t.optional,value:[new Ve({name:t.contentType||tr}),new z({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.content||sn})]})]})}fromSchema(e){ne(e,Ip);const t=de(e,e,s.schema());le.assertSchema(t,this.className),this.contentType=t.result.contentType.valueBlock.toString(),this.content=t.result.content}toSchema(){return new U({value:[new Ve({value:this.contentType}),new z({idBlock:{tagClass:3,tagNumber:0},value:[this.content]})]})}toJSON(){const e={contentType:this.contentType};return this.content instanceof Fe||(e.content=this.content.toJSON()),e}}return s.CLASS_NAME="ContentInfo",s.DATA=Au,s.SIGNED_DATA="1.2.840.113549.1.7.2",s.ENVELOPED_DATA=nf,s.ENCRYPTED_DATA=af,s})();const $u="type",Ku="value",Gu="utcTimeName",Ju="generalTimeName",Bp=[Gu,Ju];let xt=(()=>{class s extends fe{constructor(e={}){super(),this.type=c(e,$u,s.defaultValues($u)),this.value=c(e,Ku,s.defaultValues(Ku)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $u:return 0;case Ku:return new Date(0,0,0);default:return super.defaultValues(e)}}static schema(e={},t=!1){const i=c(e,"names",{});return new dt({optional:t,value:[new Lr({name:i.utcTimeName||w}),new ht({name:i.generalTimeName||w})]})}fromSchema(e){ne(e,Bp);const t=de(e,e,s.schema({names:{utcTimeName:Gu,generalTimeName:Ju}}));le.assertSchema(t,this.className),Gu in t.result&&(this.type=0,this.value=t.result.utcTimeName.toDate()),Ju in t.result&&(this.type=1,this.value=t.result.generalTimeName.toDate())}toSchema(){return 0===this.type?new Lr({valueDate:this.value}):1===this.type?new ht({valueDate:this.value}):{}}toJSON(){return{type:this.type,value:this.value}}}return s.CLASS_NAME="Time",s})();const Ys="version",Ql="serialNumber",Zl="signature",ec="issuer",tc="notBefore",sc="notAfter",ic="subject",rc="subjectPublicKeyInfo",Do="issuerUniqueID",Uo="subjectUniqueID",Mo="extensions",Lo="signatureAlgorithm",Fo="signatureValue",jt="tbsCertificate",nc=`${jt}.${Ys}`,zu=`${jt}.${Ql}`,Wu=`${jt}.${Zl}`,Yu=`${jt}.${ec}`,ac=`${jt}.${tc}`,oc=`${jt}.${sc}`,Xu=`${jt}.${ic}`,Qu=`${jt}.${rc}`,lc=`${jt}.${Do}`,cc=`${jt}.${Uo}`,Ho=`${jt}.${Mo}`,Tp=[jt,nc,zu,Wu,Yu,ac,oc,Xu,Qu,lc,cc,Ho,Lo,Fo];function xp(s={}){const r=c(s,"names",{});return new U({name:r.blockName||jt,value:[new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Q({name:r.tbsCertificateVersion||nc})]}),new Q({name:r.tbsCertificateSerialNumber||zu}),Z.schema(r.signature||{names:{blockName:Wu}}),ft.schema(r.issuer||{names:{blockName:Yu}}),new U({name:r.tbsCertificateValidity||"tbsCertificate.validity",value:[xt.schema(r.notBefore||{names:{utcTimeName:ac,generalTimeName:ac}}),xt.schema(r.notAfter||{names:{utcTimeName:oc,generalTimeName:oc}})]}),ft.schema(r.subject||{names:{blockName:Xu}}),ns.schema(r.subjectPublicKeyInfo||{names:{blockName:Qu}}),new Le({name:r.tbsCertificateIssuerUniqueID||lc,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Le({name:r.tbsCertificateSubjectUniqueID||cc,optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[Tt.schema(r.extensions||{names:{blockName:Ho}})]})]})}let zt=(()=>{class s extends fe{get tbs(){return L._H.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(c(e,"tbs",s.defaultValues("tbs"))),this.version=c(e,Ys,s.defaultValues(Ys)),this.serialNumber=c(e,Ql,s.defaultValues(Ql)),this.signature=c(e,Zl,s.defaultValues(Zl)),this.issuer=c(e,ec,s.defaultValues(ec)),this.notBefore=c(e,tc,s.defaultValues(tc)),this.notAfter=c(e,sc,s.defaultValues(sc)),this.subject=c(e,ic,s.defaultValues(ic)),this.subjectPublicKeyInfo=c(e,rc,s.defaultValues(rc)),Do in e&&(this.issuerUniqueID=c(e,Do,s.defaultValues(Do))),Uo in e&&(this.subjectUniqueID=c(e,Uo,s.defaultValues(Uo))),Mo in e&&(this.extensions=c(e,Mo,s.defaultValues(Mo))),this.signatureAlgorithm=c(e,Lo,s.defaultValues(Lo)),this.signatureValue=c(e,Fo,s.defaultValues(Fo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return Nt;case Ys:return 0;case Ql:return new Q;case Zl:return new Z;case ec:return new ft;case tc:case sc:return new xt;case ic:return new ft;case rc:return new ns;case Do:case Uo:return Nt;case Mo:return[];case Lo:return new Z;case Fo:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[xp(t.tbsCertificate),Z.schema(t.signatureAlgorithm||{names:{blockName:Lo}}),new et({name:t.signatureValue||Fo})]})}fromSchema(e){ne(e,Tp);const t=de(e,e,s.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:Ho}}}}}}));le.assertSchema(t,this.className),this.tbsView=t.result.tbsCertificate.valueBeforeDecodeView,nc in t.result&&(this.version=t.result[nc].valueBlock.valueDec),this.serialNumber=t.result[zu],this.signature=new Z({schema:t.result[Wu]}),this.issuer=new ft({schema:t.result[Yu]}),this.notBefore=new xt({schema:t.result[ac]}),this.notAfter=new xt({schema:t.result[oc]}),this.subject=new ft({schema:t.result[Xu]}),this.subjectPublicKeyInfo=new ns({schema:t.result[Qu]}),lc in t.result&&(this.issuerUniqueID=t.result[lc].valueBlock.valueHex),cc in t.result&&(this.subjectUniqueID=t.result[cc].valueBlock.valueHex),Ho in t.result&&(this.extensions=Array.from(t.result[Ho],i=>new Li({schema:i}))),this.signatureAlgorithm=new Z({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return Ys in this&&this.version!==s.defaultValues(Ys)&&e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Q({value:this.version})]})),e.push(this.serialNumber),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(new U({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),e.push(this.subject.toSchema()),e.push(this.subjectPublicKeyInfo.toSchema()),this.issuerUniqueID&&e.push(new Le({optional:!0,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID})),this.subjectUniqueID&&e.push(new Le({optional:!0,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID})),this.extensions&&e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[new U({value:Array.from(this.extensions,t=>t.toSchema())})]})),new U({value:e})}toSchema(e=!1){let t;if(!1===e){if(!this.tbsView.byteLength)return s.schema().value[0];const i=Et(this.tbsView);le.assert(i,"TBS Certificate"),t=i.result}else t=this.encodeTBS();return new U({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:L.U$.ToHex(this.tbsView),version:this.version,serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return Ys in this&&this.version!==s.defaultValues(Ys)&&(e.version=this.version),this.issuerUniqueID&&(e.issuerUniqueID=L.U$.ToHex(this.issuerUniqueID)),this.subjectUniqueID&&(e.subjectUniqueID=L.U$.ToHex(this.subjectUniqueID)),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}getPublicKey(e,t=Ge(!0)){var i=this;return(0,E.A)(function*(){return t.getPublicKey(i.subjectPublicKeyInfo,i.signatureAlgorithm,e)})()}getKeyHash(e="SHA-1",t=Ge(!0)){var i=this;return(0,E.A)(function*(){return t.digest({name:e},i.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView)})()}sign(e,t="SHA-1",i=Ge(!0)){var a=this;return(0,E.A)(function*(){if(!e)throw new Error("Need to provide a private key for signing");const o=yield i.getSignatureParameters(e,t),u=o.parameters;a.signature=o.signatureAlgorithm,a.signatureAlgorithm=o.signatureAlgorithm,a.tbsView=new Uint8Array(a.encodeTBS().toBER());const h=yield i.signWithPrivateKey(a.tbsView,e,u);a.signatureValue=new et({valueHex:h})})()}verify(e,t=Ge(!0)){var i=this;return(0,E.A)(function*(){let a;if(e?a=e.subjectPublicKeyInfo:i.issuer.isEqual(i.subject)&&(a=i.subjectPublicKeyInfo),!(a instanceof ns))throw new Error("Please provide issuer certificate as a parameter");return t.verifyWithPublicKey(i.tbsView,i.signatureValue,a,i.signatureAlgorithm)})()}}return s.CLASS_NAME="Certificate",s})();function Jf(s,r=null){if(r&&s.issuer.isEqual(r.issuer)&&s.serialNumber.isEqual(r.serialNumber))return null;let e=!1;if(s.extensions)for(const t of s.extensions)if(t.extnID===wu&&t.parsedValue instanceof hf&&t.parsedValue.cA){e=!0;break}return e?s:null}const rn="certId",nn="certValue",an="parsedValue",Vp=[rn,nn];let Zu=(()=>{class s extends fe{constructor(e={}){super(),this.certId=c(e,rn,s.defaultValues(rn)),this.certValue=c(e,nn,s.defaultValues(nn)),an in e&&(this.parsedValue=c(e,an,s.defaultValues(an))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case rn:return w;case nn:return new Fe;case an:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case rn:return t===w;case nn:return t instanceof Fe;case an:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.id||"id"}),new z({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.value||"value"})]})]})}fromSchema(e){ne(e,Vp);const t=de(e,e,s.schema({names:{id:rn,value:nn}}));le.assertSchema(t,this.className),this.certId=t.result.certId.valueBlock.toString(),this.certValue=t.result.certValue;const i=this.certValue.valueBlock.valueHexView;switch(this.certId){case of:try{this.parsedValue=zt.fromBER(i)}catch{er.fromBER(i)}break;case lf:this.parsedValue=er.fromBER(i);break;default:throw new Error(`Incorrect CERT_ID value in CertBag: ${this.certId}`)}}toSchema(){return an in this&&(this.certId="acinfo"in this.parsedValue?lf:of,this.certValue=new me({valueHex:this.parsedValue.toSchema().toBER(!1)})),new U({value:[new Ve({value:this.certId}),new z({idBlock:{tagClass:3,tagNumber:0},value:["toSchema"in this.certValue?this.certValue.toSchema():this.certValue]})]})}toJSON(){return{certId:this.certId,certValue:this.certValue.toJSON()}}}return s.CLASS_NAME="CertBag",s})();const jo="userCertificate",on="revocationDate",sr="crlEntryExtensions",Op=[jo,on,sr];let Pp=(()=>{class s extends fe{constructor(e={}){super(),this.userCertificate=c(e,jo,s.defaultValues(jo)),this.revocationDate=c(e,on,s.defaultValues(on)),sr in e&&(this.crlEntryExtensions=c(e,sr,s.defaultValues(sr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case jo:return new Q;case on:return new xt;case sr:return new Tt;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.userCertificate||jo}),xt.schema({names:{utcTimeName:t.revocationDate||on,generalTimeName:t.revocationDate||on}}),Tt.schema({names:{blockName:t.crlEntryExtensions||sr}},!0)]})}fromSchema(e){ne(e,Op);const t=de(e,e,s.schema());le.assertSchema(t,this.className),this.userCertificate=t.result.userCertificate,this.revocationDate=new xt({schema:t.result.revocationDate}),sr in t.result&&(this.crlEntryExtensions=new Tt({schema:t.result.crlEntryExtensions}))}toSchema(){const e=[this.userCertificate,this.revocationDate.toSchema()];return this.crlEntryExtensions&&e.push(this.crlEntryExtensions.toSchema()),new U({value:e})}toJSON(){const e={userCertificate:this.userCertificate.toJSON(),revocationDate:this.revocationDate.toJSON()};return this.crlEntryExtensions&&(e.crlEntryExtensions=this.crlEntryExtensions.toJSON()),e}}return s.CLASS_NAME="RevokedCertificate",s})();const $o="version",th="signature",sh="issuer",ih="thisUpdate",uc="nextUpdate",hc="revokedCertificates",dc="crlExtensions",Ko="signatureAlgorithm",Go="signatureValue",ps="tbsCertList",fc=`${ps}.version`,rh=`${ps}.signature`,nh=`${ps}.issuer`,mc=`${ps}.thisUpdate`,Jo=`${ps}.nextUpdate`,gc=`${ps}.revokedCertificates`,pc=`${ps}.extensions`,Dp=[ps,fc,rh,nh,mc,Jo,gc,pc,Ko,Go];function Up(s={}){const r=c(s,"names",{});return new U({name:r.blockName||ps,value:[new Q({optional:!0,name:r.tbsCertListVersion||fc,value:2}),Z.schema(r.signature||{names:{blockName:rh}}),ft.schema(r.issuer||{names:{blockName:nh}}),xt.schema(r.tbsCertListThisUpdate||{names:{utcTimeName:mc,generalTimeName:mc}}),xt.schema(r.tbsCertListNextUpdate||{names:{utcTimeName:Jo,generalTimeName:Jo}},!0),new U({optional:!0,value:[new Ke({name:r.tbsCertListRevokedCertificates||gc,value:new U({value:[new Q,xt.schema(),Tt.schema({},!0)]})})]}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[Tt.schema(r.crlExtensions||{names:{blockName:pc}})]})]})}const Mp=[Su,Wd,"2.5.29.20","2.5.29.27",Yd,yu,bu,"2.5.29.21","2.5.29.24",Xd];let vc=(()=>{class s extends fe{get tbs(){return L._H.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(c(e,"tbs",s.defaultValues("tbs"))),this.version=c(e,$o,s.defaultValues($o)),this.signature=c(e,th,s.defaultValues(th)),this.issuer=c(e,sh,s.defaultValues(sh)),this.thisUpdate=c(e,ih,s.defaultValues(ih)),uc in e&&(this.nextUpdate=c(e,uc,s.defaultValues(uc))),hc in e&&(this.revokedCertificates=c(e,hc,s.defaultValues(hc))),dc in e&&(this.crlExtensions=c(e,dc,s.defaultValues(dc))),this.signatureAlgorithm=c(e,Ko,s.defaultValues(Ko)),this.signatureValue=c(e,Go,s.defaultValues(Go)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return Nt;case $o:return 0;case th:return new Z;case sh:return new ft;case ih:case uc:return new xt;case hc:return[];case dc:return new Tt;case Ko:return new Z;case Go:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||"CertificateList",value:[Up(e),Z.schema(t.signatureAlgorithm||{names:{blockName:Ko}}),new et({name:t.signatureValue||Go})]})}fromSchema(e){ne(e,Dp);const t=de(e,e,s.schema());le.assertSchema(t,this.className),this.tbsView=t.result.tbsCertList.valueBeforeDecodeView,fc in t.result&&(this.version=t.result[fc].valueBlock.valueDec),this.signature=new Z({schema:t.result[rh]}),this.issuer=new ft({schema:t.result[nh]}),this.thisUpdate=new xt({schema:t.result[mc]}),Jo in t.result&&(this.nextUpdate=new xt({schema:t.result[Jo]})),gc in t.result&&(this.revokedCertificates=Array.from(t.result[gc],i=>new Pp({schema:i}))),pc in t.result&&(this.crlExtensions=new Tt({schema:t.result[pc]})),this.signatureAlgorithm=new Z({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return this.version!==s.defaultValues($o)&&e.push(new Q({value:this.version})),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(this.thisUpdate.toSchema()),this.nextUpdate&&e.push(this.nextUpdate.toSchema()),this.revokedCertificates&&e.push(new U({value:Array.from(this.revokedCertificates,t=>t.toSchema())})),this.crlExtensions&&e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.crlExtensions.toSchema()]})),new U({value:e})}toSchema(e=!1){let t;if(e)t=this.encodeTBS();else{if(!this.tbsView.byteLength)return s.schema();const i=Et(this.tbsView);le.assert(i,"TBS Certificate Revocation List"),t=i.result}return new U({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:L.U$.ToHex(this.tbsView),version:this.version,signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),thisUpdate:this.thisUpdate.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return this.version!==s.defaultValues($o)&&(e.version=this.version),this.nextUpdate&&(e.nextUpdate=this.nextUpdate.toJSON()),this.revokedCertificates&&(e.revokedCertificates=Array.from(this.revokedCertificates,t=>t.toJSON())),this.crlExtensions&&(e.crlExtensions=this.crlExtensions.toJSON()),e}isCertificateRevoked(e){if(!this.issuer.isEqual(e.issuer)||!this.revokedCertificates)return!1;for(const t of this.revokedCertificates)if(t.userCertificate.isEqual(e.serialNumber))return!0;return!1}sign(e,t="SHA-1",i=Ge(!0)){var a=this;return(0,E.A)(function*(){if(!e)throw new Error("Need to provide a private key for signing");const o=yield i.getSignatureParameters(e,t),{parameters:u}=o;a.signature=o.signatureAlgorithm,a.signatureAlgorithm=o.signatureAlgorithm,a.tbsView=new Uint8Array(a.encodeTBS().toBER());const h=yield i.signWithPrivateKey(a.tbsView,e,u);a.signatureValue=new et({valueHex:h})})()}verify(e={},t=Ge(!0)){var i=this;return(0,E.A)(function*(){let a;if(e.issuerCertificate&&(a=e.issuerCertificate.subjectPublicKeyInfo,!i.issuer.isEqual(e.issuerCertificate.subject)))return!1;if(e.publicKeyInfo&&(a=e.publicKeyInfo),!a)throw new Error("Issuer's certificate must be provided as an input parameter");if(i.crlExtensions)for(const o of i.crlExtensions.extensions)if(o.critical&&!Mp.includes(o.extnID))return!1;return t.verifyWithPublicKey(i.tbsView,i.signatureValue,a,i.signatureAlgorithm)})()}}return s.CLASS_NAME="CertificateRevocationList",s})();const ln="crlId",cn="crlValue",qo="parsedValue",Lp=[ln,cn];let Fp=(()=>{class s extends fe{constructor(e={}){super(),this.crlId=c(e,ln,s.defaultValues(ln)),this.crlValue=c(e,cn,s.defaultValues(cn)),qo in e&&(this.parsedValue=c(e,qo,s.defaultValues(qo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ln:return w;case cn:return new Fe;case qo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ln:return t===w;case cn:return t instanceof Fe;case qo:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.id||"id"}),new z({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.value||"value"})]})]})}fromSchema(e){ne(e,Lp);const t=de(e,e,s.schema({names:{id:ln,value:cn}}));if(le.assertSchema(t,this.className),this.crlId=t.result.crlId.valueBlock.toString(),this.crlValue=t.result.crlValue,this.crlId!==cf)throw new Error(`Incorrect CRL_ID value in CRLBag: ${this.crlId}`);this.parsedValue=vc.fromBER(this.certValue.valueBlock.valueHex)}toSchema(){return this.parsedValue&&(this.crlId=cf,this.crlValue=new me({valueHex:this.parsedValue.toSchema().toBER(!1)})),new U({value:[new Ve({value:this.crlId}),new z({idBlock:{tagClass:3,tagNumber:0},value:[this.crlValue.toSchema()]})]})}toJSON(){return{crlId:this.crlId,crlValue:this.crlValue.toJSON()}}}return s.CLASS_NAME="CRLBag",s})();const un="version",hn="encryptedContentInfo",Xs="unprotectedAttrs",Hp=[un,hn,Xs];let wc=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,un,s.defaultValues(un)),this.encryptedContentInfo=c(e,hn,s.defaultValues(hn)),Xs in e&&(this.unprotectedAttrs=c(e,Xs,s.defaultValues(Xs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case un:return 0;case hn:return new Mt;case Xs:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case un:return 0===t;case hn:return Mt.compareWithDefault("contentType",t.contentType)&&Mt.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&Mt.compareWithDefault("encryptedContent",t.encryptedContent);case Xs:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.version||w}),Mt.schema(t.encryptedContentInfo||{}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Ke({name:t.unprotectedAttrs||w,value:it.schema()})]})]})}fromSchema(e){ne(e,Hp);const t=de(e,e,s.schema({names:{version:un,encryptedContentInfo:{names:{blockName:hn}},unprotectedAttrs:Xs}}));le.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.encryptedContentInfo=new Mt({schema:t.result.encryptedContentInfo}),Xs in t.result&&(this.unprotectedAttrs=Array.from(t.result.unprotectedAttrs,i=>new it({schema:i})))}toSchema(){const e=[];return e.push(new Q({value:this.version})),e.push(this.encryptedContentInfo.toSchema()),this.unprotectedAttrs&&e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,t=>t.toSchema())})),new U({value:e})}toJSON(){const e={version:this.version,encryptedContentInfo:this.encryptedContentInfo.toJSON()};return this.unprotectedAttrs&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,t=>t.toJSON())),e}encrypt(e,t=Ge(!0)){var i=this;return(0,E.A)(function*(){ot.assert(e,"parameters","object");const a={...e,contentType:"1.2.840.113549.1.7.1"};i.encryptedContentInfo=yield t.encryptEncryptedContentInfo(a)})()}decrypt(e,t=Ge(!0)){var i=this;return(0,E.A)(function*(){ot.assert(e,"parameters","object");const a={...e,encryptedContentInfo:i.encryptedContentInfo};return t.decryptEncryptedContentInfo(a)})()}}return s.CLASS_NAME="EncryptedData",s})();const ir="encryptionAlgorithm",Qs="encryptedData",zo="parsedValue",jp=[ir,Qs];let qf=(()=>{class s extends fe{constructor(e={}){super(),this.encryptionAlgorithm=c(e,ir,s.defaultValues(ir)),this.encryptedData=c(e,Qs,s.defaultValues(Qs)),zo in e&&(this.parsedValue=c(e,zo,s.defaultValues(zo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ir:return new Z;case Qs:return new me;case zo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ir:return Z.compareWithDefault("algorithmId",t.algorithmId)&&!("algorithmParams"in t);case Qs:return t.isEqual(s.defaultValues(e));case zo:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[Z.schema(t.encryptionAlgorithm||{names:{blockName:ir}}),new dt({value:[new me({name:t.encryptedData||Qs}),new me({idBlock:{isConstructed:!0},name:t.encryptedData||Qs})]})]})}fromSchema(e){ne(e,jp);const t=de(e,e,s.schema({names:{encryptionAlgorithm:{names:{blockName:ir}},encryptedData:Qs}}));le.assertSchema(t,this.className),this.encryptionAlgorithm=new Z({schema:t.result.encryptionAlgorithm}),this.encryptedData=t.result.encryptedData}toSchema(){return new U({value:[this.encryptionAlgorithm.toSchema(),this.encryptedData]})}toJSON(){return{encryptionAlgorithm:this.encryptionAlgorithm.toJSON(),encryptedData:this.encryptedData.toJSON()}}parseInternalValues(e,t=Ge(!0)){var i=this;return(0,E.A)(function*(){const o=yield new wc({encryptedContentInfo:new Mt({contentEncryptionAlgorithm:i.encryptionAlgorithm,encryptedContent:i.encryptedData})}).decrypt(e,t);i.parsedValue=Xr.fromBER(o)})()}makeInternalValues(e,t=Ge(!0)){var i=this;return(0,E.A)(function*(){if(!i.parsedValue)throw new Error('Please initialize "parsedValue" first');const a=new wc,o={...e,contentToEncrypt:i.parsedValue.toSchema().toBER(!1)};if(yield a.encrypt(o,t),!a.encryptedContentInfo.encryptedContent)throw new Error("The filed `encryptedContent` in EncryptedContentInfo is empty");i.encryptionAlgorithm=a.encryptedContentInfo.contentEncryptionAlgorithm,i.encryptedData=a.encryptedContentInfo.encryptedContent})()}}return s.CLASS_NAME="PKCS8ShroudedKeyBag",s})();const dn="secretTypeId",fn="secretValue",$p=[dn,fn];let Kp=(()=>{class s extends fe{constructor(e={}){super(),this.secretTypeId=c(e,dn,s.defaultValues(dn)),this.secretValue=c(e,fn,s.defaultValues(fn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case dn:return w;case fn:return new Fe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case dn:return t===w;case fn:return t instanceof Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.id||"id"}),new z({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.value||"value"})]})]})}fromSchema(e){ne(e,$p);const t=de(e,e,s.schema({names:{id:dn,value:fn}}));le.assertSchema(t,this.className),this.secretTypeId=t.result.secretTypeId.valueBlock.toString(),this.secretValue=t.result.secretValue}toSchema(){return new U({value:[new Ve({value:this.secretTypeId}),new z({idBlock:{tagClass:3,tagNumber:0},value:[this.secretValue.toSchema()]})]})}toJSON(){return{secretTypeId:this.secretTypeId,secretValue:this.secretValue.toJSON()}}}return s.CLASS_NAME="SecretBag",s})();class Zs{static getItems(){return this.items||(this.items={},Zs.register("1.2.840.113549.1.12.10.1.1",Xr),Zs.register("1.2.840.113549.1.12.10.1.2",qf),Zs.register("1.2.840.113549.1.12.10.1.3",Zu),Zs.register("1.2.840.113549.1.12.10.1.4",Fp),Zs.register("1.2.840.113549.1.12.10.1.5",Kp),Zs.register("1.2.840.113549.1.12.10.1.6",ar)),this.items}static register(r,e){this.getItems()[r]=e}static find(r){return this.getItems()[r]||null}}const rr="bagId",nr="bagValue",vs="bagAttributes",Gp=[rr,nr,vs];let Wo=(()=>{class s extends fe{constructor(e={}){super(),this.bagId=c(e,rr,s.defaultValues(rr)),this.bagValue=c(e,nr,s.defaultValues(nr)),vs in e&&(this.bagAttributes=c(e,vs,s.defaultValues(vs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case rr:return w;case nr:return new Fe;case vs:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case rr:return t===w;case nr:return t instanceof Fe;case vs:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.bagId||rr}),new z({idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.bagValue||nr})]}),new kt({optional:!0,value:[new Ke({name:t.bagAttributes||vs,value:it.schema()})]})]})}fromSchema(e){ne(e,Gp);const t=de(e,e,s.schema({names:{bagId:rr,bagValue:nr,bagAttributes:vs}}));le.assertSchema(t,this.className),this.bagId=t.result.bagId.valueBlock.toString();const i=Zs.find(this.bagId);if(!i)throw new Error(`Invalid BAG_ID for SafeBag: ${this.bagId}`);this.bagValue=new i({schema:t.result.bagValue}),vs in t.result&&(this.bagAttributes=Array.from(t.result.bagAttributes,a=>new it({schema:a})))}toSchema(){const e=[new Ve({value:this.bagId}),new z({idBlock:{tagClass:3,tagNumber:0},value:[this.bagValue.toSchema()]})];return this.bagAttributes&&e.push(new kt({value:Array.from(this.bagAttributes,t=>t.toSchema())})),new U({value:e})}toJSON(){const e={bagId:this.bagId,bagValue:this.bagValue.toJSON()};return this.bagAttributes&&(e.bagAttributes=Array.from(this.bagAttributes,t=>t.toJSON())),e}}return s.CLASS_NAME="SafeBag",s})();const mn="safeBags";let ar=(()=>{class s extends fe{constructor(e={}){super(),this.safeBags=c(e,mn,s.defaultValues(mn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===mn?[]:super.defaultValues(e)}static compareWithDefault(e,t){return e===mn?0===t.length:super.defaultValues(e)}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ke({name:t.safeBags||w,value:Wo.schema()})]})}fromSchema(e){ne(e,[mn]);const t=de(e,e,s.schema({names:{safeBags:mn}}));le.assertSchema(t,this.className),this.safeBags=Array.from(t.result.safeBags,i=>new Wo({schema:i}))}toSchema(){return new U({value:Array.from(this.safeBags,e=>e.toSchema())})}toJSON(){return{safeBags:Array.from(this.safeBags,e=>e.toJSON())}}}return s.CLASS_NAME="SafeContents",s})();const Yo="otherCertFormat",Xo="otherCert",Jp=[Yo,Xo];class ei extends fe{constructor(r={}){super(),this.otherCertFormat=c(r,Yo,ei.defaultValues(Yo)),this.otherCert=c(r,Xo,ei.defaultValues(Xo)),r.schema&&this.fromSchema(r.schema)}static defaultValues(r){switch(r){case Yo:return w;case Xo:return new Fe;default:return super.defaultValues(r)}}static schema(r={}){const e=c(r,"names",{});return new U({name:e.blockName||w,value:[new Ve({name:e.otherCertFormat||Yo}),new Fe({name:e.otherCert||Xo})]})}fromSchema(r){ne(r,Jp);const e=de(r,r,ei.schema());le.assertSchema(e,this.className),this.otherCertFormat=e.result.otherCertFormat.valueBlock.toString(),this.otherCert=e.result.otherCert}toSchema(){return new U({value:[new Ve({value:this.otherCertFormat}),this.otherCert]})}toJSON(){const r={otherCertFormat:this.otherCertFormat};return this.otherCert instanceof Fe||(r.otherCert=this.otherCert.toJSON()),r}}const Qo="certificates",qp=[Qo];let gn=(()=>{class s extends fe{constructor(e={}){super(),this.certificates=c(e,Qo,s.defaultValues(Qo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Qo?[]:super.defaultValues(e)}static schema(e={}){const t=c(e,"names",{});return new kt({name:t.blockName||w,value:[new Ke({name:t.certificates||Qo,value:new dt({value:[zt.schema(),new z({idBlock:{tagClass:3,tagNumber:0},value:[new Fe]}),new z({idBlock:{tagClass:3,tagNumber:1},value:[new U]}),new z({idBlock:{tagClass:3,tagNumber:2},value:er.schema().valueBlock.value}),new z({idBlock:{tagClass:3,tagNumber:3},value:ei.schema().valueBlock.value})]})})]})}fromSchema(e){ne(e,qp);const t=de(e,e,s.schema());le.assertSchema(t,this.className),this.certificates=Array.from(t.result.certificates||[],i=>{const a=i.idBlock.tagNumber;if(1===i.idBlock.tagClass)return new zt({schema:i});const o=new U({value:i.valueBlock.value});switch(a){case 1:return 1===o.valueBlock.value[0].valueBlock.value[0].valueBlock.valueDec?new er({schema:o}):new Fu({schema:o});case 2:return new er({schema:o});case 3:return new ei({schema:o})}return i})}toSchema(){return new kt({value:Array.from(this.certificates,e=>{switch(!0){case e instanceof zt:return e.toSchema();case e instanceof Fu:return new z({idBlock:{tagClass:3,tagNumber:1},value:e.toSchema().valueBlock.value});case e instanceof er:return new z({idBlock:{tagClass:3,tagNumber:2},value:e.toSchema().valueBlock.value});case e instanceof ei:return new z({idBlock:{tagClass:3,tagNumber:3},value:e.toSchema().valueBlock.value})}return e.toSchema()})})}toJSON(){return{certificates:Array.from(this.certificates,e=>e.toJSON())}}}return s.CLASS_NAME="CertificateSet",s})();const Zo="otherRevInfoFormat",el="otherRevInfo",zp=[Zo,el];let yc=(()=>{class s extends fe{constructor(e={}){super(),this.otherRevInfoFormat=c(e,Zo,s.defaultValues(Zo)),this.otherRevInfo=c(e,el,s.defaultValues(el)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Zo:return w;case el:return new Fe;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.otherRevInfoFormat||Zo}),new Fe({name:t.otherRevInfo||el})]})}fromSchema(e){ne(e,zp);const t=de(e,e,s.schema());le.assertSchema(t,this.className),this.otherRevInfoFormat=t.result.otherRevInfoFormat.valueBlock.toString(),this.otherRevInfo=t.result.otherRevInfo}toSchema(){return new U({value:[new Ve({value:this.otherRevInfoFormat}),this.otherRevInfo]})}toJSON(){const e={otherRevInfoFormat:this.otherRevInfoFormat};return this.otherRevInfo instanceof Fe||(e.otherRevInfo=this.otherRevInfo.toJSON()),e}}return s.CLASS_NAME="OtherRevocationInfoFormat",s})();const tl="crls",ah="otherRevocationInfos",Wp=[tl];let Sc=(()=>{class s extends fe{constructor(e={}){super(),this.crls=c(e,tl,s.defaultValues(tl)),this.otherRevocationInfos=c(e,ah,s.defaultValues(ah)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case tl:case ah:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new kt({name:t.blockName||w,value:[new Ke({name:t.crls||w,value:new dt({value:[vc.schema(),new z({idBlock:{tagClass:3,tagNumber:1},value:[new Ve,new Fe]})]})})]})}fromSchema(e){ne(e,Wp);const t=de(e,e,s.schema({names:{crls:tl}}));if(le.assertSchema(t,this.className),t.result.crls)for(const i of t.result.crls)1===i.idBlock.tagClass?this.crls.push(new vc({schema:i})):this.otherRevocationInfos.push(new yc({schema:i}))}toSchema(){const e=[];return e.push(...Array.from(this.crls,t=>t.toSchema())),e.push(...Array.from(this.otherRevocationInfos,t=>{const i=t.toSchema();return i.idBlock.tagClass=3,i.idBlock.tagNumber=1,i})),new kt({value:e})}toJSON(){return{crls:Array.from(this.crls,e=>e.toJSON()),otherRevocationInfos:Array.from(this.otherRevocationInfos,e=>e.toJSON())}}}return s.CLASS_NAME="RevocationInfoChoices",s})();const sl="certs",or="crls",Yp=[sl,or];let oh=(()=>{class s extends fe{constructor(e={}){super(),this.crls=c(e,or,s.defaultValues(or)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case sl:return new gn;case or:return new Sc;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case sl:return 0===t.certificates.length;case or:return 0===t.crls.length&&0===t.otherRevocationInfos.length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new z({name:t.certs||w,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:gn.schema().valueBlock.value}),new z({name:t.crls||w,optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Sc.schema().valueBlock.value})]})}fromSchema(e){ne(e,Yp);const t=de(e,e,s.schema({names:{certs:sl,crls:or}}));le.assertSchema(t,this.className),sl in t.result&&(this.certs=new gn({schema:new kt({value:t.result.certs.valueBlock.value})})),or in t.result&&(this.crls=new Sc({schema:new kt({value:t.result.crls.valueBlock.value})}))}toSchema(){const e=[];return this.certs&&e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:this.certs.toSchema().valueBlock.value})),this.crls&&e.push(new z({idBlock:{tagClass:3,tagNumber:1},value:this.crls.toSchema().valueBlock.value})),new U({value:e})}toJSON(){const e={};return this.certs&&(e.certs=this.certs.toJSON()),this.crls&&(e.crls=this.crls.toJSON()),e}}return s.CLASS_NAME="OriginatorInfo",s})();const il="issuer",rl="serialNumber",Xp=[il,rl];let Vt=(()=>{class s extends fe{constructor(e={}){super(),this.issuer=c(e,il,s.defaultValues(il)),this.serialNumber=c(e,rl,s.defaultValues(rl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case il:return new ft;case rl:return new Q;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[ft.schema(t.issuer||{}),new Q({name:t.serialNumber||w})]})}fromSchema(e){ne(e,Xp);const t=de(e,e,s.schema({names:{issuer:{names:{blockName:il}},serialNumber:rl}}));le.assertSchema(t,this.className),this.issuer=new ft({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber}toSchema(){return new U({value:[this.issuer.toSchema(),this.serialNumber]})}toJSON(){return{issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()}}}return s.CLASS_NAME="IssuerAndSerialNumber",s})();const bc="variant",nl="value",Qp=["blockName"];let Zp=(()=>{class s extends fe{constructor(e={}){super(),this.variant=c(e,bc,s.defaultValues(bc)),nl in e&&(this.value=c(e,nl,s.defaultValues(nl))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case bc:return-1;case nl:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case bc:return-1===t;case nl:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new dt({value:[Vt.schema({names:{blockName:t.blockName||w}}),new Le({name:t.blockName||w,idBlock:{tagClass:3,tagNumber:0}})]})}fromSchema(e){ne(e,Qp);const t=de(e,e,s.schema({names:{blockName:"blockName"}}));le.assertSchema(t,this.className),1===t.result.blockName.idBlock.tagClass?(this.variant=1,this.value=new Vt({schema:t.result.blockName})):(this.variant=2,this.value=new me({valueHex:t.result.blockName.valueBlock.valueHex}))}toSchema(){switch(this.variant){case 1:if(!(this.value instanceof Vt))throw new Error("Incorrect type of RecipientIdentifier.value. It should be IssuerAndSerialNumber.");return this.value.toSchema();case 2:if(!(this.value instanceof me))throw new Error("Incorrect type of RecipientIdentifier.value. It should be ASN.1 OctetString.");return new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:this.value.valueBlock.valueHexView});default:return new Fe}}toJSON(){const e={variant:this.variant};return(1===this.variant||2===this.variant)&&this.value&&(e.value=this.value.toJSON()),e}}return s.CLASS_NAME="RecipientIdentifier",s})();const lr="version",pn="rid",vn="keyEncryptionAlgorithm",wn="encryptedKey",Ac="recipientCertificate",ev=[lr,pn,vn,wn];let lh=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,lr,s.defaultValues(lr)),this.rid=c(e,pn,s.defaultValues(pn)),this.keyEncryptionAlgorithm=c(e,vn,s.defaultValues(vn)),this.encryptedKey=c(e,wn,s.defaultValues(wn)),this.recipientCertificate=c(e,Ac,s.defaultValues(Ac)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case lr:return-1;case pn:return{};case vn:return new Z;case wn:return new me;case Ac:return new zt;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case lr:return t===s.defaultValues(lr);case pn:return 0===Object.keys(t).length;case vn:case wn:return t.isEqual(s.defaultValues(e));case Ac:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.version||w}),Zp.schema(t.rid||{}),Z.schema(t.keyEncryptionAlgorithm||{}),new me({name:t.encryptedKey||w})]})}fromSchema(e){ne(e,ev);const t=de(e,e,s.schema({names:{version:lr,rid:{names:{blockName:pn}},keyEncryptionAlgorithm:{names:{blockName:vn}},encryptedKey:wn}}));le.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.rid=3===t.result.rid.idBlock.tagClass?new me({valueHex:t.result.rid.valueBlock.valueHex}):new Vt({schema:t.result.rid}),this.keyEncryptionAlgorithm=new Z({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){const e=[];return this.rid instanceof Vt?(this.version=0,e.push(new Q({value:this.version})),e.push(this.rid.toSchema())):(this.version=2,e.push(new Q({value:this.version})),e.push(new Le({idBlock:{tagClass:3,tagNumber:0},valueHex:this.rid.valueBlock.valueHexView}))),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new U({value:e})}toJSON(){return{version:this.version,rid:this.rid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}return s.CLASS_NAME="KeyTransRecipientInfo",s})();const yn="algorithm",Sn="publicKey",tv=[yn,Sn];let ch=(()=>{class s extends fe{constructor(e={}){super(),this.algorithm=c(e,yn,s.defaultValues(yn)),this.publicKey=c(e,Sn,s.defaultValues(Sn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case yn:return new Z;case Sn:return new et;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case yn:case Sn:return t.isEqual(s.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[Z.schema(t.algorithm||{}),new et({name:t.publicKey||w})]})}fromSchema(e){ne(e,tv);const t=de(e,e,s.schema({names:{algorithm:{names:{blockName:yn}},publicKey:Sn}}));le.assertSchema(t,this.className),this.algorithm=new Z({schema:t.result.algorithm}),this.publicKey=t.result.publicKey}toSchema(){return new U({value:[this.algorithm.toSchema(),this.publicKey]})}toJSON(){return{algorithm:this.algorithm.toJSON(),publicKey:this.publicKey.toJSON()}}}return s.CLASS_NAME="OriginatorPublicKey",s})();const kc="variant",al="value",sv=["blockName"];let Ec=(()=>{class s extends fe{constructor(e={}){super(),this.variant=c(e,kc,s.defaultValues(kc)),al in e&&(this.value=c(e,al,s.defaultValues(al))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case kc:return-1;case al:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case kc:return-1===t;case al:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new dt({value:[Vt.schema({names:{blockName:t.blockName||w}}),new Le({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||w}),new z({idBlock:{tagClass:3,tagNumber:1},name:t.blockName||w,value:ch.schema().valueBlock.value})]})}fromSchema(e){ne(e,sv);const t=de(e,e,s.schema({names:{blockName:"blockName"}}));le.assertSchema(t,this.className),1===t.result.blockName.idBlock.tagClass?(this.variant=1,this.value=new Vt({schema:t.result.blockName})):0===t.result.blockName.idBlock.tagNumber?(t.result.blockName.idBlock.tagClass=1,t.result.blockName.idBlock.tagNumber=4,this.variant=2,this.value=t.result.blockName):(this.variant=3,this.value=new ch({schema:new U({value:t.result.blockName.valueBlock.value})}))}toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return this.value.idBlock.tagClass=3,this.value.idBlock.tagNumber=0,this.value;case 3:{const e=this.value.toSchema();return e.idBlock.tagClass=3,e.idBlock.tagNumber=1,e}default:return new Fe}}toJSON(){const e={variant:this.variant};return(1===this.variant||2===this.variant||3===this.variant)&&(e.value=this.value.toJSON()),e}}return s.CLASS_NAME="OriginatorIdentifierOrKey",s})();const bn="keyAttrId",as="keyAttr",iv=[bn,as];let An=(()=>{class s extends fe{constructor(e={}){super(),this.keyAttrId=c(e,bn,s.defaultValues(bn)),as in e&&(this.keyAttr=c(e,as,s.defaultValues(as))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case bn:return w;case as:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case bn:return"string"==typeof t&&t===w;case as:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({optional:t.optional||!0,name:t.blockName||w,value:[new Ve({name:t.keyAttrId||w}),new Fe({optional:!0,name:t.keyAttr||w})]})}fromSchema(e){ne(e,iv);const t=de(e,e,s.schema({names:{keyAttrId:bn,keyAttr:as}}));le.assertSchema(t,this.className),this.keyAttrId=t.result.keyAttrId.valueBlock.toString(),as in t.result&&(this.keyAttr=t.result.keyAttr)}toSchema(){const e=[];return e.push(new Ve({value:this.keyAttrId})),as in this&&e.push(this.keyAttr),new U({value:e})}toJSON(){const e={keyAttrId:this.keyAttrId};return as in this&&(e.keyAttr=this.keyAttr.toJSON()),e}}return s.CLASS_NAME="OtherKeyAttribute",s})();const cr="subjectKeyIdentifier",ti="date",si="other",rv=[cr,ti,si];let uh=(()=>{class s extends fe{constructor(e={}){super(),this.subjectKeyIdentifier=c(e,cr,s.defaultValues(cr)),ti in e&&(this.date=c(e,ti,s.defaultValues(ti))),si in e&&(this.other=c(e,si,s.defaultValues(si))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case cr:return new me;case ti:return new ht;case si:return new An;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case cr:return t.isEqual(s.defaultValues(cr));case ti:return 0===t.year&&0===t.month&&0===t.day&&0===t.hour&&0===t.minute&&0===t.second&&0===t.millisecond;case si:return t.keyAttrId===w&&!("keyAttr"in t);default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new me({name:t.subjectKeyIdentifier||w}),new ht({optional:!0,name:t.date||w}),An.schema(t.other||{})]})}fromSchema(e){ne(e,rv);const t=de(e,e,s.schema({names:{subjectKeyIdentifier:cr,date:ti,other:{names:{blockName:si}}}}));le.assertSchema(t,this.className),this.subjectKeyIdentifier=t.result.subjectKeyIdentifier,ti in t.result&&(this.date=t.result.date),si in t.result&&(this.other=new An({schema:t.result.other}))}toSchema(){const e=[];return e.push(this.subjectKeyIdentifier),this.date&&e.push(this.date),this.other&&e.push(this.other.toSchema()),new U({value:e})}toJSON(){const e={subjectKeyIdentifier:this.subjectKeyIdentifier.toJSON()};return this.date&&(e.date=this.date.toJSON()),this.other&&(e.other=this.other.toJSON()),e}}return s.CLASS_NAME="RecipientKeyIdentifier",s})();const _c="variant",Cc="value",nv=["blockName"];let ol=(()=>{class s extends fe{constructor(e={}){super(),this.variant=c(e,_c,s.defaultValues(_c)),this.value=c(e,Cc,s.defaultValues(Cc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case _c:return-1;case Cc:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case _c:return-1===t;case Cc:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new dt({value:[Vt.schema(t.issuerAndSerialNumber||{names:{blockName:t.blockName||w}}),new z({name:t.blockName||w,idBlock:{tagClass:3,tagNumber:0},value:uh.schema(t.rKeyId||{names:{blockName:t.blockName||w}}).valueBlock.value})]})}fromSchema(e){ne(e,nv);const t=de(e,e,s.schema({names:{blockName:"blockName"}}));le.assertSchema(t,this.className),1===t.result.blockName.idBlock.tagClass?(this.variant=1,this.value=new Vt({schema:t.result.blockName})):(this.variant=2,this.value=new uh({schema:new U({value:t.result.blockName.valueBlock.value})}))}toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return new z({idBlock:{tagClass:3,tagNumber:0},value:this.value.toSchema().valueBlock.value});default:return new Fe}}toJSON(){const e={variant:this.variant};return(1===this.variant||2===this.variant)&&(e.value=this.value.toJSON()),e}}return s.CLASS_NAME="KeyAgreeRecipientIdentifier",s})();const kn="rid",ur="encryptedKey",av=[kn,ur];let hh=(()=>{class s extends fe{constructor(e={}){super(),this.rid=c(e,kn,s.defaultValues(kn)),this.encryptedKey=c(e,ur,s.defaultValues(ur)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case kn:return new ol;case ur:return new me;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case kn:return-1===t.variant&&!("value"in t);case ur:return t.isEqual(s.defaultValues(ur));default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[ol.schema(t.rid||{}),new me({name:t.encryptedKey||w})]})}fromSchema(e){ne(e,av);const t=de(e,e,s.schema({names:{rid:{names:{blockName:kn}},encryptedKey:ur}}));le.assertSchema(t,this.className),this.rid=new ol({schema:t.result.rid}),this.encryptedKey=t.result.encryptedKey}toSchema(){return new U({value:[this.rid.toSchema(),this.encryptedKey]})}toJSON(){return{rid:this.rid.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}return s.CLASS_NAME="RecipientEncryptedKey",s})();const Nc="encryptedKeys",zf="RecipientEncryptedKeys",ov=[zf];let Ic=(()=>{class s extends fe{constructor(e={}){super(),this.encryptedKeys=c(e,Nc,s.defaultValues(Nc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){return e===Nc?[]:super.defaultValues(e)}static compareWithDefault(e,t){return e===Nc?0===t.length:super.defaultValues(e)}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ke({name:t.RecipientEncryptedKeys||w,value:hh.schema()})]})}fromSchema(e){ne(e,ov);const t=de(e,e,s.schema({names:{RecipientEncryptedKeys:zf}}));le.assertSchema(t,this.className),this.encryptedKeys=Array.from(t.result.RecipientEncryptedKeys,i=>new hh({schema:i}))}toSchema(){return new U({value:Array.from(this.encryptedKeys,e=>e.toSchema())})}toJSON(){return{encryptedKeys:Array.from(this.encryptedKeys,e=>e.toJSON())}}}return s.CLASS_NAME="RecipientEncryptedKeys",s})();const En="version",_n="originator",ws="ukm",Cn="keyEncryptionAlgorithm",Nn="recipientEncryptedKeys",Bc="recipientCertificate",Rc="recipientPublicKey",lv=[En,_n,ws,Cn,Nn];let dh=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,En,s.defaultValues(En)),this.originator=c(e,_n,s.defaultValues(_n)),ws in e&&(this.ukm=c(e,ws,s.defaultValues(ws))),this.keyEncryptionAlgorithm=c(e,Cn,s.defaultValues(Cn)),this.recipientEncryptedKeys=c(e,Nn,s.defaultValues(Nn)),this.recipientCertificate=c(e,Bc,s.defaultValues(Bc)),this.recipientPublicKey=c(e,Rc,s.defaultValues(Rc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case En:return 0;case _n:return new Ec;case ws:return new me;case Cn:return new Z;case Nn:return new Ic;case Bc:return new zt;case Rc:return null;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case En:return 0===t;case _n:return-1===t.variant&&!("value"in t);case ws:return t.isEqual(s.defaultValues(ws));case Cn:return t.algorithmId===w&&!("algorithmParams"in t);case Nn:return 0===t.encryptedKeys.length;case Bc:case Rc:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.version||w}),new z({idBlock:{tagClass:3,tagNumber:0},value:[Ec.schema(t.originator||{})]}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new me({name:t.ukm||w})]}),Z.schema(t.keyEncryptionAlgorithm||{}),Ic.schema(t.recipientEncryptedKeys||{})]})}fromSchema(e){ne(e,lv);const t=de(e,e,s.schema({names:{version:En,originator:{names:{blockName:_n}},ukm:ws,keyEncryptionAlgorithm:{names:{blockName:Cn}},recipientEncryptedKeys:{names:{blockName:Nn}}}}));le.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.originator=new Ec({schema:t.result.originator}),ws in t.result&&(this.ukm=t.result.ukm),this.keyEncryptionAlgorithm=new Z({schema:t.result.keyEncryptionAlgorithm}),this.recipientEncryptedKeys=new Ic({schema:t.result.recipientEncryptedKeys})}toSchema(){const e=[];return e.push(new Q({value:this.version})),e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:[this.originator.toSchema()]})),this.ukm&&e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[this.ukm]})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.recipientEncryptedKeys.toSchema()),new U({value:e})}toJSON(){const e={version:this.version,originator:this.originator.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),recipientEncryptedKeys:this.recipientEncryptedKeys.toJSON()};return this.ukm&&(e.ukm=this.ukm.toJSON()),e}}return s.CLASS_NAME="KeyAgreeRecipientInfo",s})();const hr="keyIdentifier",ii="date",ri="other",cv=[hr,ii,ri];let Tc=(()=>{class s extends fe{constructor(e={}){super(),this.keyIdentifier=c(e,hr,s.defaultValues(hr)),ii in e&&(this.date=c(e,ii,s.defaultValues(ii))),ri in e&&(this.other=c(e,ri,s.defaultValues(ri))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hr:return new me;case ii:return new ht;case ri:return new An;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case hr:return t.isEqual(s.defaultValues(hr));case ii:return 0===t.year&&0===t.month&&0===t.day&&0===t.hour&&0===t.minute&&0===t.second&&0===t.millisecond;case ri:return t.compareWithDefault("keyAttrId",t.keyAttrId)&&!("keyAttr"in t);default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new me({name:t.keyIdentifier||w}),new ht({optional:!0,name:t.date||w}),An.schema(t.other||{})]})}fromSchema(e){ne(e,cv);const t=de(e,e,s.schema({names:{keyIdentifier:hr,date:ii,other:{names:{blockName:ri}}}}));le.assertSchema(t,this.className),this.keyIdentifier=t.result.keyIdentifier,ii in t.result&&(this.date=t.result.date),ri in t.result&&(this.other=new An({schema:t.result.other}))}toSchema(){const e=[];return e.push(this.keyIdentifier),this.date&&e.push(this.date),this.other&&e.push(this.other.toSchema()),new U({value:e})}toJSON(){const e={keyIdentifier:this.keyIdentifier.toJSON()};return this.date&&(e.date=this.date),this.other&&(e.other=this.other.toJSON()),e}}return s.CLASS_NAME="KEKIdentifier",s})();const In="version",Bn="kekid",Rn="keyEncryptionAlgorithm",dr="encryptedKey",xc="preDefinedKEK",uv=[In,Bn,Rn,dr];let fh=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,In,s.defaultValues(In)),this.kekid=c(e,Bn,s.defaultValues(Bn)),this.keyEncryptionAlgorithm=c(e,Rn,s.defaultValues(Rn)),this.encryptedKey=c(e,dr,s.defaultValues(dr)),this.preDefinedKEK=c(e,xc,s.defaultValues(xc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case In:return 0;case Bn:return new Tc;case Rn:return new Z;case dr:return new me;case xc:return Nt;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"KEKRecipientInfo":return t===s.defaultValues(In);case Bn:return t.compareWithDefault("keyIdentifier",t.keyIdentifier)&&!("date"in t)&&!("other"in t);case Rn:return t.algorithmId===w&&!("algorithmParams"in t);case dr:return t.isEqual(s.defaultValues(dr));case xc:return 0===t.byteLength;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.version||w}),Tc.schema(t.kekid||{}),Z.schema(t.keyEncryptionAlgorithm||{}),new me({name:t.encryptedKey||w})]})}fromSchema(e){ne(e,uv);const t=de(e,e,s.schema({names:{version:In,kekid:{names:{blockName:Bn}},keyEncryptionAlgorithm:{names:{blockName:Rn}},encryptedKey:dr}}));le.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.kekid=new Tc({schema:t.result.kekid}),this.keyEncryptionAlgorithm=new Z({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){return new U({value:[new Q({value:this.version}),this.kekid.toSchema(),this.keyEncryptionAlgorithm.toSchema(),this.encryptedKey]})}toJSON(){return{version:this.version,kekid:this.kekid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}return s.CLASS_NAME="KEKRecipientInfo",s})();const Tn="version",ni="keyDerivationAlgorithm",xn="keyEncryptionAlgorithm",fr="encryptedKey",Vc="password",hv=[Tn,ni,xn,fr];let mh=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,Tn,s.defaultValues(Tn)),ni in e&&(this.keyDerivationAlgorithm=c(e,ni,s.defaultValues(ni))),this.keyEncryptionAlgorithm=c(e,xn,s.defaultValues(xn)),this.encryptedKey=c(e,fr,s.defaultValues(fr)),this.password=c(e,Vc,s.defaultValues(Vc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Tn:return-1;case ni:case xn:return new Z;case fr:return new me;case Vc:return Nt;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Tn:return-1===t;case ni:case xn:return t.algorithmId===w&&!("algorithmParams"in t);case fr:return t.isEqual(s.defaultValues(fr));case Vc:return 0===t.byteLength;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.version||w}),new z({name:t.keyDerivationAlgorithm||w,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Z.schema().valueBlock.value}),Z.schema(t.keyEncryptionAlgorithm||{}),new me({name:t.encryptedKey||w})]})}fromSchema(e){ne(e,hv);const t=de(e,e,s.schema({names:{version:Tn,keyDerivationAlgorithm:ni,keyEncryptionAlgorithm:{names:{blockName:xn}},encryptedKey:fr}}));le.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,ni in t.result&&(this.keyDerivationAlgorithm=new Z({schema:new U({value:t.result.keyDerivationAlgorithm.valueBlock.value})})),this.keyEncryptionAlgorithm=new Z({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){const e=[];return e.push(new Q({value:this.version})),this.keyDerivationAlgorithm&&e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:this.keyDerivationAlgorithm.toSchema().valueBlock.value})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new U({value:e})}toJSON(){const e={version:this.version,keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()};return this.keyDerivationAlgorithm&&(e.keyDerivationAlgorithm=this.keyDerivationAlgorithm.toJSON()),e}}return s.CLASS_NAME="PasswordRecipientInfo",s})();const Vn="oriType",mr="oriValue",dv=[Vn,mr];let Wf=(()=>{class s extends fe{constructor(e={}){super(),this.oriType=c(e,Vn,s.defaultValues(Vn)),this.oriValue=c(e,mr,s.defaultValues(mr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Vn:return w;case mr:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Vn:return t===w;case mr:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.oriType||w}),new Fe({name:t.oriValue||w})]})}fromSchema(e){ne(e,dv);const t=de(e,e,s.schema({names:{oriType:Vn,oriValue:mr}}));le.assertSchema(t,this.className),this.oriType=t.result.oriType.valueBlock.toString(),this.oriValue=t.result.oriValue}toSchema(){return new U({value:[new Ve({value:this.oriType}),this.oriValue]})}toJSON(){const e={oriType:this.oriType};return s.compareWithDefault(mr,this.oriValue)||(e.oriValue=this.oriValue.toJSON()),e}}return s.CLASS_NAME="OtherRecipientInfo",s})();const Oc="variant",ll="value",fv=["blockName"];let On=(()=>{class s extends fe{constructor(e={}){super(),this.variant=c(e,Oc,s.defaultValues(Oc)),ll in e&&(this.value=c(e,ll,s.defaultValues(ll))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Oc:return-1;case ll:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Oc:return t===s.defaultValues(e);case ll:return 0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new dt({value:[lh.schema({names:{blockName:t.blockName||w}}),new z({name:t.blockName||w,idBlock:{tagClass:3,tagNumber:1},value:dh.schema().valueBlock.value}),new z({name:t.blockName||w,idBlock:{tagClass:3,tagNumber:2},value:fh.schema().valueBlock.value}),new z({name:t.blockName||w,idBlock:{tagClass:3,tagNumber:3},value:mh.schema().valueBlock.value}),new z({name:t.blockName||w,idBlock:{tagClass:3,tagNumber:4},value:Wf.schema().valueBlock.value})]})}fromSchema(e){ne(e,fv);const t=de(e,e,s.schema({names:{blockName:"blockName"}}));if(le.assertSchema(t,this.className),1===t.result.blockName.idBlock.tagClass)this.variant=1,this.value=new lh({schema:t.result.blockName});else{const i=new U({value:t.result.blockName.valueBlock.value});switch(t.result.blockName.idBlock.tagNumber){case 1:this.variant=2,this.value=new dh({schema:i});break;case 2:this.variant=3,this.value=new fh({schema:i});break;case 3:this.variant=4,this.value=new mh({schema:i});break;case 4:this.variant=5,this.value=new Wf({schema:i});break;default:throw new Error("Incorrect structure of RecipientInfo block")}}}toSchema(){st.assertEmpty(this.value,"value","RecipientInfo");const e=this.value.toSchema();switch(this.variant){case 1:return e;case 2:case 3:case 4:return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.variant-1,e;default:return new Fe}}toJSON(){const e={variant:this.variant};return this.value&&this.variant>=1&&this.variant<=4&&(e.value=this.value.toJSON()),e}}return s.CLASS_NAME="RecipientInfo",s})();const ai="hashAlgorithm",oi="maskGenAlgorithm",li="pSourceAlgorithm",mv=[ai,oi,li];let gh=(()=>{class s extends fe{constructor(e={}){super(),this.hashAlgorithm=c(e,ai,s.defaultValues(ai)),this.maskGenAlgorithm=c(e,oi,s.defaultValues(oi)),this.pSourceAlgorithm=c(e,li,s.defaultValues(li)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ai:return new Z({algorithmId:"1.3.14.3.2.26",algorithmParams:new At});case oi:return new Z({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new Z({algorithmId:"1.3.14.3.2.26",algorithmParams:new At}).toSchema()});case li:return new Z({algorithmId:"1.2.840.113549.1.1.9",algorithmParams:new me({valueHex:new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer})});default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new z({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[Z.schema(t.hashAlgorithm||{})]}),new z({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[Z.schema(t.maskGenAlgorithm||{})]}),new z({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[Z.schema(t.pSourceAlgorithm||{})]})]})}fromSchema(e){ne(e,mv);const t=de(e,e,s.schema({names:{hashAlgorithm:{names:{blockName:ai}},maskGenAlgorithm:{names:{blockName:oi}},pSourceAlgorithm:{names:{blockName:li}}}}));le.assertSchema(t,this.className),ai in t.result&&(this.hashAlgorithm=new Z({schema:t.result.hashAlgorithm})),oi in t.result&&(this.maskGenAlgorithm=new Z({schema:t.result.maskGenAlgorithm})),li in t.result&&(this.pSourceAlgorithm=new Z({schema:t.result.pSourceAlgorithm}))}toSchema(){const e=[];return this.hashAlgorithm.isEqual(s.defaultValues(ai))||e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(s.defaultValues(oi))||e.push(new z({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.pSourceAlgorithm.isEqual(s.defaultValues(li))||e.push(new z({idBlock:{tagClass:3,tagNumber:2},value:[this.pSourceAlgorithm.toSchema()]})),new U({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(s.defaultValues(ai))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(s.defaultValues(oi))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.pSourceAlgorithm.isEqual(s.defaultValues(li))||(e.pSourceAlgorithm=this.pSourceAlgorithm.toJSON()),e}}return s.CLASS_NAME="RSAESOAEPParams",s})();const Pn="keyInfo",ci="entityUInfo",Dn="suppPubInfo",gv=[Pn,ci,Dn];let Yf=(()=>{class s extends fe{constructor(e={}){super(),this.keyInfo=c(e,Pn,s.defaultValues(Pn)),ci in e&&(this.entityUInfo=c(e,ci,s.defaultValues(ci))),this.suppPubInfo=c(e,Dn,s.defaultValues(Dn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Pn:return new Z;case ci:case Dn:return new me;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Pn:case ci:case Dn:return t.isEqual(s.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[Z.schema(t.keyInfo||{}),new z({name:t.entityUInfo||w,idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[new me]}),new z({name:t.suppPubInfo||w,idBlock:{tagClass:3,tagNumber:2},value:[new me]})]})}fromSchema(e){ne(e,gv);const t=de(e,e,s.schema({names:{keyInfo:{names:{blockName:Pn}},entityUInfo:ci,suppPubInfo:Dn}}));le.assertSchema(t,this.className),this.keyInfo=new Z({schema:t.result.keyInfo}),ci in t.result&&(this.entityUInfo=t.result.entityUInfo.valueBlock.value[0]),this.suppPubInfo=t.result.suppPubInfo.valueBlock.value[0]}toSchema(){const e=[];return e.push(this.keyInfo.toSchema()),this.entityUInfo&&e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:[this.entityUInfo]})),e.push(new z({idBlock:{tagClass:3,tagNumber:2},value:[this.suppPubInfo]})),new U({value:e})}toJSON(){const e={keyInfo:this.keyInfo.toJSON(),suppPubInfo:this.suppPubInfo.toJSON()};return this.entityUInfo&&(e.entityUInfo=this.entityUInfo.toJSON()),e}}return s.CLASS_NAME="ECCCMSSharedInfo",s})();const Un="version",ui="originatorInfo",Mn="recipientInfos",Ln="encryptedContentInfo",hi="unprotectedAttrs",pv=[Un,ui,Mn,Ln,hi],Xf={kdfAlgorithm:"SHA-512",kekEncryptionLength:256},vv={"P-256":256,"P-384":384,"P-521":528};let Qf=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,Un,s.defaultValues(Un)),ui in e&&(this.originatorInfo=c(e,ui,s.defaultValues(ui))),this.recipientInfos=c(e,Mn,s.defaultValues(Mn)),this.encryptedContentInfo=c(e,Ln,s.defaultValues(Ln)),hi in e&&(this.unprotectedAttrs=c(e,hi,s.defaultValues(hi))),this.policy={disableSplit:!!e.disableSplit},e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Un:return 0;case ui:return new oh;case Mn:return[];case Ln:return new Mt;case hi:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Un:return t===s.defaultValues(e);case ui:return 0===t.certs.certificates.length&&0===t.crls.crls.length;case Mn:case hi:return 0===t.length;case Ln:return Mt.compareWithDefault("contentType",t.contentType)&&Mt.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&Mt.compareWithDefault("encryptedContent",t.encryptedContent);default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.version||w}),new z({name:t.originatorInfo||w,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:oh.schema().valueBlock.value}),new kt({value:[new Ke({name:t.recipientInfos||w,value:On.schema()})]}),Mt.schema(t.encryptedContentInfo||{}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Ke({name:t.unprotectedAttrs||w,value:it.schema()})]})]})}fromSchema(e){ne(e,pv);const t=de(e,e,s.schema({names:{version:Un,originatorInfo:ui,recipientInfos:Mn,encryptedContentInfo:{names:{blockName:Ln}},unprotectedAttrs:hi}}));le.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,ui in t.result&&(this.originatorInfo=new oh({schema:new U({value:t.result.originatorInfo.valueBlock.value})})),this.recipientInfos=Array.from(t.result.recipientInfos,i=>new On({schema:i})),this.encryptedContentInfo=new Mt({schema:t.result.encryptedContentInfo}),hi in t.result&&(this.unprotectedAttrs=Array.from(t.result.unprotectedAttrs,i=>new it({schema:i})))}toSchema(){const e=[];return e.push(new Q({value:this.version})),this.originatorInfo&&e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:this.originatorInfo.toSchema().valueBlock.value})),e.push(new kt({value:Array.from(this.recipientInfos,t=>t.toSchema())})),e.push(this.encryptedContentInfo.toSchema()),this.unprotectedAttrs&&e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,t=>t.toSchema())})),new U({value:e})}toJSON(){const e={version:this.version,recipientInfos:Array.from(this.recipientInfos,t=>t.toJSON()),encryptedContentInfo:this.encryptedContentInfo.toJSON()};return this.originatorInfo&&(e.originatorInfo=this.originatorInfo.toJSON()),this.unprotectedAttrs&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,t=>t.toJSON())),e}addRecipientByCertificate(e,t,i,a=Ge(!0)){const o=Object.assign({useOAEP:!0,oaepHashAlgorithm:"SHA-512"},Xf,t||{});if(-1!==e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.113549"))i=1;else{if(-1===e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.10045"))throw new Error(`Unknown type of certificate's public key: ${e.subjectPublicKeyInfo.algorithm.algorithmId}`);i=2}switch(i){case 1:{let u,h;if(!0===o.useOAEP){u=a.getOIDByAlgorithm({name:"RSA-OAEP"},!0,"keyEncryptionAlgorithm");const N=a.getOIDByAlgorithm({name:o.oaepHashAlgorithm},!0,"RSAES-OAEP-params"),x=new Z({algorithmId:N,algorithmParams:new At});h=new gh({hashAlgorithm:x,maskGenAlgorithm:new Z({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:x.toSchema()})}).toSchema()}else{if(u=a.getOIDByAlgorithm({name:"RSAES-PKCS1-v1_5"}),u===w)throw new Error("Can not find OID for RSAES-PKCS1-v1_5");h=new At}const g=new lh({version:0,rid:new Vt({issuer:e.issuer,serialNumber:e.serialNumber}),keyEncryptionAlgorithm:new Z({algorithmId:u,algorithmParams:h}),recipientCertificate:e});this.recipientInfos.push(new On({variant:1,value:g}))}break;case 2:{const u=new ol({variant:1,value:new Vt({issuer:e.issuer,serialNumber:e.serialNumber})});this._addKeyAgreeRecipientInfo(u,o,{recipientCertificate:e},a)}break;default:throw new Error(`Unknown "variant" value: ${i}`)}return!0}addRecipientByPreDefinedData(e,t={},i,a=Ge(!0)){if(ot.assert(e,"preDefinedData","ArrayBuffer"),!e.byteLength)throw new Error("Pre-defined data could have zero length");if(!t.keyIdentifier){const o=new ArrayBuffer(16),u=new Uint8Array(o);a.getRandomValues(u),t.keyIdentifier=o}switch(t.hmacHashAlgorithm||(t.hmacHashAlgorithm="SHA-512"),void 0===t.iterationCount&&(t.iterationCount=2048),t.keyEncryptionAlgorithm||(t.keyEncryptionAlgorithm={name:"AES-KW",length:256}),t.keyEncryptionAlgorithmParams||(t.keyEncryptionAlgorithmParams=new At),i){case 1:{const o=a.getOIDByAlgorithm(t.keyEncryptionAlgorithm,!0,"keyEncryptionAlgorithm"),u=new fh({version:4,kekid:new Tc({keyIdentifier:new me({valueHex:t.keyIdentifier})}),keyEncryptionAlgorithm:new Z({algorithmId:o,algorithmParams:t.keyEncryptionAlgorithmParams}),preDefinedKEK:e});this.recipientInfos.push(new On({variant:3,value:u}))}break;case 2:{const o=a.getOIDByAlgorithm({name:"PBKDF2"},!0,"keyDerivationAlgorithm"),u=new ArrayBuffer(64),h=new Uint8Array(u);a.getRandomValues(h);const g=a.getOIDByAlgorithm({name:"HMAC",hash:{name:t.hmacHashAlgorithm}},!0,"hmacHashAlgorithm"),N=new ro({salt:new me({valueHex:u}),iterationCount:t.iterationCount,prf:new Z({algorithmId:g,algorithmParams:new At})}),x=a.getOIDByAlgorithm(t.keyEncryptionAlgorithm,!0,"keyEncryptionAlgorithm"),G=new mh({version:0,keyDerivationAlgorithm:new Z({algorithmId:o,algorithmParams:N.toSchema()}),keyEncryptionAlgorithm:new Z({algorithmId:x,algorithmParams:t.keyEncryptionAlgorithmParams}),password:e});this.recipientInfos.push(new On({variant:4,value:G}))}break;default:throw new Error(`Unknown value for "variant": ${i}`)}}addRecipientByKeyIdentifier(e,t,i,a=Ge(!0)){const o=Object.assign({},Xf,i||{}),u=new ol({variant:2,value:new uh({subjectKeyIdentifier:new me({valueHex:t})})});this._addKeyAgreeRecipientInfo(u,o,{recipientPublicKey:e},a)}_addKeyAgreeRecipientInfo(e,t,i,a=Ge(!0)){const o=new hh({rid:e}),u=a.getOIDByAlgorithm({name:"AES-KW",length:t.kekEncryptionLength},!0,"keyEncryptionAlgorithm"),h=new Z({algorithmId:u}),g=a.getOIDByAlgorithm({name:"ECDH",kdf:t.kdfAlgorithm},!0,"KeyAgreeRecipientInfo"),N=new ArrayBuffer(64),x=new Uint8Array(N);a.getRandomValues(x);const G={version:3,ukm:new me({valueHex:N}),keyEncryptionAlgorithm:new Z({algorithmId:g,algorithmParams:h.toSchema()}),recipientEncryptedKeys:new Ic({encryptedKeys:[o]})},H=new dh(Object.assign(G,i));this.recipientInfos.push(new On({variant:2,value:H}))}encrypt(e,t,i=Ge(!0)){var a=this;return(0,E.A)(function*(){const o=new ArrayBuffer(16),u=new Uint8Array(o);i.getRandomValues(u);const h=new Uint8Array(t),g=i.getOIDByAlgorithm(e,!0,"contentEncryptionAlgorithm"),N=yield i.generateKey(e,!0,["encrypt"]),x=yield i.encrypt({name:e.name,iv:u},N,h),G=yield i.exportKey("raw",N);a.version=2,a.encryptedContentInfo=new Mt({disableSplit:a.policy.disableSplit,contentType:"1.2.840.113549.1.7.1",contentEncryptionAlgorithm:new Z({algorithmId:g,algorithmParams:new me({valueHex:o})}),encryptedContent:new me({valueHex:x})});const H=function(){var ye=(0,E.A)(function*(oe){const ce=a.recipientInfos[oe].value;let pe,be;if(ce.recipientPublicKey)pe=ce.recipientPublicKey.algorithm.namedCurve,be=ce.recipientPublicKey;else{if(!ce.recipientCertificate)throw new Error("Unsupported RecipientInfo");{const Oe=ce.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(Oe.constructor.blockName()!==Ve.blockName())throw new Error(`Incorrect "recipientCertificate" for index ${oe}`);switch(Oe.valueBlock.toString()){case"1.2.840.10045.3.1.7":pe="P-256";break;case"1.3.132.0.34":pe="P-384";break;case"1.3.132.0.35":pe="P-521";break;default:throw new Error(`Incorrect curve OID for index ${oe}`)}be=yield ce.recipientCertificate.getPublicKey({algorithm:{algorithm:{name:"ECDH",namedCurve:pe},usages:[]}},i)}}const Be=vv[pe],xe=yield i.generateKey({name:"ECDH",namedCurve:pe},!0,["deriveBits"]),Ue=yield i.exportKey("spki",xe.publicKey),We=yield i.deriveBits({name:"ECDH",public:be},xe.privateKey,Be),bt=new Z({schema:ce.keyEncryptionAlgorithm.algorithmParams}),Ye=i.getAlgorithmByOID(bt.algorithmId,!0,"aesKWAlgorithm");let lt=Ye.length;const Kt=new ArrayBuffer(4),Pt=new Uint8Array(Kt);for(let Oe=3;Oe>=0;Oe--)Pt[Oe]=lt,lt>>=8;const ks=new Yf({keyInfo:new Z({algorithmId:bt.algorithmId}),entityUInfo:ce.ukm,suppPubInfo:new me({valueHex:Kt})}).toSchema().toBER(!1),Wt=i.getAlgorithmByOID(ce.keyEncryptionAlgorithm.algorithmId,!0,"ecdhAlgorithm"),ct=yield Vf(Wt.kdf,We,Ye.length,ks,i),nt=yield i.importKey("raw",ct,{name:"AES-KW"},!0,["wrapKey"]),De=yield i.wrapKey("raw",N,nt,{name:"AES-KW"}),je=new Ec;return je.variant=3,je.value=ch.fromBER(Ue),ce.originator=je,ce.recipientEncryptedKeys.encryptedKeys[0].encryptedKey=new me({valueHex:De}),{ecdhPrivateKey:xe.privateKey}});return function(ce){return ye.apply(this,arguments)}}(),re=function(){var ye=(0,E.A)(function*(oe){const ce=a.recipientInfos[oe].value,pe=i.getAlgorithmByOID(ce.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm");if("RSA-OAEP"===pe.name){const Be=new gh({schema:ce.keyEncryptionAlgorithm.algorithmParams});if(pe.hash=i.getAlgorithmByOID(Be.hashAlgorithm.algorithmId),!("name"in pe.hash))throw new Error(`Incorrect OID for hash algorithm: ${Be.hashAlgorithm.algorithmId}`)}try{const be=yield ce.recipientCertificate.getPublicKey({algorithm:{algorithm:pe,usages:["encrypt","wrapKey"]}},i),Be=yield i.encrypt(be.algorithm,be,G);ce.encryptedKey=new me({valueHex:Be})}catch{}});return function(ce){return ye.apply(this,arguments)}}(),Ae=function(){var ye=(0,E.A)(function*(oe){const ce=a.recipientInfos[oe].value,pe=i.getAlgorithmByOID(ce.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm"),be=yield i.importKey("raw",new Uint8Array(ce.preDefinedKEK),pe,!0,["wrapKey"]),Be=yield i.wrapKey("raw",N,be,pe);ce.encryptedKey=new me({valueHex:Be})});return function(ce){return ye.apply(this,arguments)}}(),we=function(){var ye=(0,E.A)(function*(oe){const ce=a.recipientInfos[oe].value;let pe;if(!ce.keyDerivationAlgorithm)throw new Error('Please append encoded "keyDerivationAlgorithm"');if(!ce.keyDerivationAlgorithm.algorithmParams)throw new Error('Incorrectly encoded "keyDerivationAlgorithm"');try{pe=new ro({schema:ce.keyDerivationAlgorithm.algorithmParams})}catch{throw new Error('Incorrectly encoded "keyDerivationAlgorithm"')}const be=new Uint8Array(ce.password),Be=yield i.importKey("raw",be,"PBKDF2",!1,["deriveKey"]),xe=i.getAlgorithmByOID(ce.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm");let Ue="SHA-1";pe.prf&&(Ue=i.getAlgorithmByOID(pe.prf.algorithmId,!0,"prfAlgorithm").hash.name);const We=new Uint8Array(pe.salt.valueBlock.valueHex),bt=pe.iterationCount,Ye=yield i.deriveKey({name:"PBKDF2",hash:{name:Ue},salt:We,iterations:bt},Be,xe,!0,["wrapKey"]),lt=yield i.wrapKey("raw",N,Ye,xe);ce.encryptedKey=new me({valueHex:lt})});return function(ce){return ye.apply(this,arguments)}}(),ie=[];for(let ye=0;ye<a.recipientInfos.length;ye++)switch(a.recipientInfos[ye].variant){case 1:ie.push(yield re(ye));break;case 2:ie.push(yield H(ye));break;case 3:ie.push(yield Ae(ye));break;case 4:ie.push(yield we(ye));break;default:throw new Error(`Unknown recipient type in array with index ${ye}`)}return ie})()}decrypt(e,t,i=Ge(!0)){var a=this;return(0,E.A)(function*(){const o=t||{};if(e+1>a.recipientInfos.length)throw new Error('Maximum value for "index" is: '+(a.recipientInfos.length-1));const u=function(){var ie=(0,E.A)(function*(ye){const oe=a.recipientInfos[ye].value;let ce,pe,be;const Be=oe.originator;if(o.recipientCertificate){const ct=o.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(ct.constructor.blockName()!==Ve.blockName())throw new Error(`Incorrect "recipientCertificate" for index ${ye}`);ce=ct.valueBlock.toString()}else{if(!Be.value.algorithm.algorithmParams)throw new Error('Parameter "recipientCertificate" is mandatory for "KeyAgreeRecipientInfo" if algorithm params are missing from originator');{const ct=Be.value.algorithm.algorithmParams;if(ct.constructor.blockName()!==Ve.blockName())throw new Error(`Incorrect originator for index ${ye}`);ce=ct.valueBlock.toString()}}if(!o.recipientPrivateKey)throw new Error('Parameter "recipientPrivateKey" is mandatory for "KeyAgreeRecipientInfo"');switch(ce){case"1.2.840.10045.3.1.7":pe="P-256",be=256;break;case"1.3.132.0.34":pe="P-384",be=384;break;case"1.3.132.0.35":pe="P-521",be=528;break;default:throw new Error(`Incorrect curve OID for index ${ye}`)}let xe,Ue=i;L._H.isBufferSource(o.recipientPrivateKey)?xe=yield i.importKey("pkcs8",o.recipientPrivateKey,{name:"ECDH",namedCurve:pe},!0,["deriveBits"]):(xe=o.recipientPrivateKey,"crypto"in o&&o.crypto&&(Ue=o.crypto.subtle)),"algorithmParams"in Be.value.algorithm||(Be.value.algorithm.algorithmParams=new Ve({value:ce}));const We=Be.value.toSchema().toBER(!1),bt=yield i.importKey("spki",We,{name:"ECDH",namedCurve:pe},!0,[]),Ye=yield Ue.deriveBits({name:"ECDH",public:bt},xe,be);function lt(ct){return Kt.apply(this,arguments)}function Kt(){return(Kt=(0,E.A)(function*(ct){ct=ct||!1;const nt=new Z({schema:oe.keyEncryptionAlgorithm.algorithmParams}),De=i.getAlgorithmByOID(nt.algorithmId,!0,"kwAlgorithm");let je=De.length;const Oe=new ArrayBuffer(4),ze=new Uint8Array(Oe);for(let Qe=3;Qe>=0;Qe--)ze[Qe]=je,je>>=8;const rt={algorithmId:nt.algorithmId};ct&&(rt.algorithmParams=new At);const ss=new Yf({keyInfo:new Z(rt),entityUInfo:oe.ukm,suppPubInfo:new me({valueHex:Oe})}).toSchema().toBER(!1),mt=i.getAlgorithmByOID(oe.keyEncryptionAlgorithm.algorithmId,!0,"ecdhAlgorithm");if(!mt.name)throw new Error(`Incorrect OID for key encryption algorithm: ${oe.keyEncryptionAlgorithm.algorithmId}`);return Vf(mt.kdf,Ye,De.length,ss,i)})).apply(this,arguments)}const Pt=yield lt(),Pr=function(){var ct=(0,E.A)(function*(nt){return i.importKey("raw",nt,{name:"AES-KW"},!0,["unwrapKey"])});return function(De){return ct.apply(this,arguments)}}(),ks=yield Pr(Pt),Wt=function(){var ct=(0,E.A)(function*(nt){const je=i.getAlgorithmByOID(a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,!0,"contentEncryptionAlgorithm");return i.unwrapKey("raw",oe.recipientEncryptedKeys.encryptedKeys[0].encryptedKey.valueBlock.valueHexView,nt,{name:"AES-KW"},je,!0,["decrypt"])});return function(De){return ct.apply(this,arguments)}}();try{return yield Wt(ks)}catch{const ct=yield lt(!0);return Wt(yield Pr(ct))}});return function(oe){return ie.apply(this,arguments)}}(),h=function(){var ie=(0,E.A)(function*(ye){const oe=a.recipientInfos[ye].value;if(!o.recipientPrivateKey)throw new Error('Parameter "recipientPrivateKey" is mandatory for "KeyTransRecipientInfo"');const ce=i.getAlgorithmByOID(oe.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm");if("RSA-OAEP"===ce.name){const bt=new gh({schema:oe.keyEncryptionAlgorithm.algorithmParams});if(ce.hash=i.getAlgorithmByOID(bt.hashAlgorithm.algorithmId),!("name"in ce.hash))throw new Error(`Incorrect OID for hash algorithm: ${bt.hashAlgorithm.algorithmId}`)}let pe,be=i;L._H.isBufferSource(o.recipientPrivateKey)?pe=yield i.importKey("pkcs8",o.recipientPrivateKey,ce,!0,["decrypt"]):(pe=o.recipientPrivateKey,"crypto"in o&&o.crypto&&(be=o.crypto.subtle));const Be=yield be.decrypt(pe.algorithm,pe,oe.encryptedKey.valueBlock.valueHexView),xe=a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,Ue=i.getAlgorithmByOID(xe,!0,"contentEncryptionAlgorithm");if(!("name"in Ue))throw new Error(`Incorrect "contentEncryptionAlgorithm": ${xe}`);return i.importKey("raw",Be,Ue,!0,["decrypt"])});return function(oe){return ie.apply(this,arguments)}}(),g=function(){var ie=(0,E.A)(function*(ye){const oe=a.recipientInfos[ye].value;if(!o.preDefinedData)throw new Error('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');const ce=i.getAlgorithmByOID(oe.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm"),pe=yield i.importKey("raw",o.preDefinedData,ce,!0,["unwrapKey"]),be=a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,Be=i.getAlgorithmByOID(be,!0,"contentEncryptionAlgorithm");if(!Be.name)throw new Error(`Incorrect "contentEncryptionAlgorithm": ${be}`);return i.unwrapKey("raw",oe.encryptedKey.valueBlock.valueHexView,pe,ce,Be,!0,["decrypt"])});return function(oe){return ie.apply(this,arguments)}}(),N=function(){var ie=(0,E.A)(function*(ye){const oe=a.recipientInfos[ye].value;let ce;if(!o.preDefinedData)throw new Error('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');if(!oe.keyDerivationAlgorithm)throw new Error('Please append encoded "keyDerivationAlgorithm"');if(!oe.keyDerivationAlgorithm.algorithmParams)throw new Error('Incorrectly encoded "keyDerivationAlgorithm"');try{ce=new ro({schema:oe.keyDerivationAlgorithm.algorithmParams})}catch{throw new Error('Incorrectly encoded "keyDerivationAlgorithm"')}const pe=yield i.importKey("raw",o.preDefinedData,"PBKDF2",!1,["deriveKey"]),be=i.getAlgorithmByOID(oe.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm"),Be=ce.prf?i.getAlgorithmByOID(ce.prf.algorithmId,!0,"prfAlgorithm").hash.name:"SHA-1",xe=new Uint8Array(ce.salt.valueBlock.valueHex),Ue=ce.iterationCount,We=yield i.deriveKey({name:"PBKDF2",hash:{name:Be},salt:xe,iterations:Ue},pe,be,!0,["unwrapKey"]),Ye=i.getAlgorithmByOID(a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,!0,"contentEncryptionAlgorithm");return i.unwrapKey("raw",oe.encryptedKey.valueBlock.valueHexView,We,be,Ye,!0,["decrypt"])});return function(oe){return ie.apply(this,arguments)}}();let x;switch(a.recipientInfos[e].variant){case 1:x=yield h(e);break;case 2:x=yield u(e);break;case 3:x=yield g(e);break;case 4:x=yield N(e);break;default:throw new Error(`Unknown recipient type in array with index ${e}`)}const H=i.getAlgorithmByOID(a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,!0,"contentEncryptionAlgorithm"),Ae=new Uint8Array(a.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams.valueBlock.valueHex);if(!a.encryptedContentInfo.encryptedContent)throw new Error("Required property `encryptedContent` is empty");const we=a.encryptedContentInfo.getEncryptedContent();return i.decrypt({name:H.name,iv:Ae},x,we)})()}}return s.CLASS_NAME="EnvelopedData",s})();const Fn="safeContents",cl="parsedValue",Zf="contentInfos";let ph=(()=>{class s extends fe{constructor(e={}){super(),this.safeContents=c(e,Fn,s.defaultValues(Fn)),cl in e&&(this.parsedValue=c(e,cl,s.defaultValues(cl))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fn:return[];case cl:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Fn:return 0===t.length;case cl:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ke({name:t.contentInfos||w,value:Lt.schema()})]})}fromSchema(e){ne(e,[Zf]);const t=de(e,e,s.schema({names:{contentInfos:Zf}}));le.assertSchema(t,this.className),this.safeContents=Array.from(t.result.contentInfos,i=>new Lt({schema:i}))}toSchema(){return new U({value:Array.from(this.safeContents,e=>e.toSchema())})}toJSON(){return{safeContents:Array.from(this.safeContents,e=>e.toJSON())}}parseInternalValues(e,t=Ge(!0)){var i=this;return(0,E.A)(function*(){if(st.assert(e,Fn),ot.assert(e.safeContents,Fn,"Array"),e.safeContents.length!==i.safeContents.length)throw new ot('Length of "parameters.safeContents" must be equal to "this.safeContents.length"');i.parsedValue={safeContents:[]};for(const[a,o]of i.safeContents.entries()){const u=e.safeContents[a],h=`parameters.safeContents[${a}]`;switch(o.contentType){case Au:{ot.assert(o.content,"this.safeContents[j].content",me);const g=o.content.getValue();i.parsedValue.safeContents.push({privacyMode:0,value:ar.fromBER(g)})}break;case nf:{const g=new Qf({schema:o.content});st.assert(h,u,"recipientCertificate","recipientKey");const x=u.recipientCertificate,G=u.recipientKey,H=yield g.decrypt(0,{recipientCertificate:x,recipientPrivateKey:G},t);i.parsedValue.safeContents.push({privacyMode:2,value:ar.fromBER(H)})}break;case af:{const g=new wc({schema:o.content});st.assert(h,u,"password");const N=u.password,x=yield g.decrypt({password:N},t);i.parsedValue.safeContents.push({privacyMode:1,value:ar.fromBER(x)})}break;default:throw new Error(`Unknown "contentType" for AuthenticatedSafe: " ${o.contentType}`)}}})()}makeInternalValues(e,t=Ge(!0)){var i=this;return(0,E.A)(function*(){if(!i.parsedValue)throw new Error('Please run "parseValues" first or add "parsedValue" manually');if(ot.assert(i.parsedValue,"this.parsedValue","object"),ot.assert(i.parsedValue.safeContents,"this.parsedValue.safeContents","Array"),ot.assert(e,"parameters","object"),st.assert(e,"safeContents"),ot.assert(e.safeContents,"parameters.safeContents","Array"),e.safeContents.length!==i.parsedValue.safeContents.length)throw new ot('Length of "parameters.safeContents" must be equal to "this.parsedValue.safeContents"');i.safeContents=[];for(const[a,o]of i.parsedValue.safeContents.entries())switch(st.assert("content",o,"privacyMode","value"),ot.assert(o.value,"content.value",ar),o.privacyMode){case 0:{const u=o.value.toSchema().toBER(!1);i.safeContents.push(new Lt({contentType:"1.2.840.113549.1.7.1",content:new me({valueHex:u})}))}break;case 1:{const u=new wc,h=e.safeContents[a];h.contentToEncrypt=o.value.toSchema().toBER(!1),yield u.encrypt(h,t),i.safeContents.push(new Lt({contentType:"1.2.840.113549.1.7.6",content:u.toSchema()}))}break;case 2:{const u=new Qf,h=o.value.toSchema().toBER(!1),g=e.safeContents[a];switch(st.assert(`parameters.safeContents[${a}]`,g,"encryptingCertificate","encryptionAlgorithm"),!0){case"aes-cbc"===g.encryptionAlgorithm.name.toLowerCase():case"aes-gcm"===g.encryptionAlgorithm.name.toLowerCase():break;default:throw new Error(`Incorrect parameter "encryptionAlgorithm" in "parameters.safeContents[i]": ${g.encryptionAlgorithm}`)}switch(!0){case 128===g.encryptionAlgorithm.length:case 192===g.encryptionAlgorithm.length:case 256===g.encryptionAlgorithm.length:break;default:throw new Error(`Incorrect parameter "encryptionAlgorithm.length" in "parameters.safeContents[i]": ${g.encryptionAlgorithm.length}`)}const N=g.encryptionAlgorithm;u.addRecipientByCertificate(g.encryptingCertificate,{},void 0,t),yield u.encrypt(N,h,t),i.safeContents.push(new Lt({contentType:"1.2.840.113549.1.7.3",content:u.toSchema()}))}break;default:throw new Error(`Incorrect value for "content.privacyMode": ${o.privacyMode}`)}return i})()}}return s.CLASS_NAME="AuthenticatedSafe",s})();const gr="hashAlgorithm",Hn="issuerNameHash",jn="issuerKeyHash",pr="serialNumber",wv=[gr,Hn,jn,pr];let di=(()=>{class s extends fe{static create(e,t,i=Ge(!0)){return(0,E.A)(function*(){const a=new s;return yield a.createForCertificate(e,t,i),a})()}constructor(e={}){super(),this.hashAlgorithm=c(e,gr,s.defaultValues(gr)),this.issuerNameHash=c(e,Hn,s.defaultValues(Hn)),this.issuerKeyHash=c(e,jn,s.defaultValues(jn)),this.serialNumber=c(e,pr,s.defaultValues(pr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case gr:return new Z;case Hn:case jn:return new me;case pr:return new Q;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case gr:return t.algorithmId===w&&!("algorithmParams"in t);case Hn:case jn:case pr:return t.isEqual(s.defaultValues(pr));default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[Z.schema(t.hashAlgorithmObject||{names:{blockName:t.hashAlgorithm||w}}),new me({name:t.issuerNameHash||w}),new me({name:t.issuerKeyHash||w}),new Q({name:t.serialNumber||w})]})}fromSchema(e){ne(e,wv);const t=de(e,e,s.schema({names:{hashAlgorithm:gr,issuerNameHash:Hn,issuerKeyHash:jn,serialNumber:pr}}));le.assertSchema(t,this.className),this.hashAlgorithm=new Z({schema:t.result.hashAlgorithm}),this.issuerNameHash=t.result.issuerNameHash,this.issuerKeyHash=t.result.issuerKeyHash,this.serialNumber=t.result.serialNumber}toSchema(){return new U({value:[this.hashAlgorithm.toSchema(),this.issuerNameHash,this.issuerKeyHash,this.serialNumber]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),issuerNameHash:this.issuerNameHash.toJSON(),issuerKeyHash:this.issuerKeyHash.toJSON(),serialNumber:this.serialNumber.toJSON()}}isEqual(e){return!(this.hashAlgorithm.algorithmId!==e.hashAlgorithm.algorithmId||!L._H.isEqual(this.issuerNameHash.valueBlock.valueHexView,e.issuerNameHash.valueBlock.valueHexView)||!L._H.isEqual(this.issuerKeyHash.valueBlock.valueHexView,e.issuerKeyHash.valueBlock.valueHexView)||!this.serialNumber.isEqual(e.serialNumber))}createForCertificate(e,t,i=Ge(!0)){var a=this;return(0,E.A)(function*(){st.assert(t,gr,"issuerCertificate");const o=i.getOIDByAlgorithm({name:t.hashAlgorithm},!0,"hashAlgorithm");a.hashAlgorithm=new Z({algorithmId:o,algorithmParams:new At});const u=t.issuerCertificate;a.serialNumber=e.serialNumber;const h=yield i.digest({name:t.hashAlgorithm},u.subject.toSchema().toBER(!1));a.issuerNameHash=new me({valueHex:h});const g=u.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView,N=yield i.digest({name:t.hashAlgorithm},g);a.issuerKeyHash=new me({valueHex:N})})()}}return s.CLASS_NAME="CertID",s})();const $n="certID",Kn="certStatus",Gn="thisUpdate",fi="nextUpdate",vr="singleExtensions",yv=[$n,Kn,Gn,fi,vr];let em=(()=>{class s extends fe{constructor(e={}){super(),this.certID=c(e,$n,s.defaultValues($n)),this.certStatus=c(e,Kn,s.defaultValues(Kn)),this.thisUpdate=c(e,Gn,s.defaultValues(Gn)),fi in e&&(this.nextUpdate=c(e,fi,s.defaultValues(fi))),vr in e&&(this.singleExtensions=c(e,vr,s.defaultValues(vr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $n:return new di;case Kn:return{};case Gn:case fi:return new Date(0,0,0);case vr:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case $n:return di.compareWithDefault("hashAlgorithm",t.hashAlgorithm)&&di.compareWithDefault("issuerNameHash",t.issuerNameHash)&&di.compareWithDefault("issuerKeyHash",t.issuerKeyHash)&&di.compareWithDefault("serialNumber",t.serialNumber);case Kn:return 0===Object.keys(t).length;case Gn:case fi:return t===s.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[di.schema(t.certID||{}),new dt({value:[new Le({name:t.certStatus||w,idBlock:{tagClass:3,tagNumber:0}}),new z({name:t.certStatus||w,idBlock:{tagClass:3,tagNumber:1},value:[new ht,new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new da]})]}),new Le({name:t.certStatus||w,idBlock:{tagClass:3,tagNumber:2},lenBlock:{length:1}})]}),new ht({name:t.thisUpdate||w}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ht({name:t.nextUpdate||w})]}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[Tt.schema(t.singleExtensions||{})]})]})}fromSchema(e){ne(e,yv);const t=de(e,e,s.schema({names:{certID:{names:{blockName:$n}},certStatus:Kn,thisUpdate:Gn,nextUpdate:fi,singleExtensions:{names:{blockName:vr}}}}));le.assertSchema(t,this.className),this.certID=new di({schema:t.result.certID}),this.certStatus=t.result.certStatus,this.thisUpdate=t.result.thisUpdate.toDate(),fi in t.result&&(this.nextUpdate=t.result.nextUpdate.toDate()),vr in t.result&&(this.singleExtensions=Array.from(t.result.singleExtensions.valueBlock.value,i=>new Li({schema:i})))}toSchema(){const e=[];return e.push(this.certID.toSchema()),e.push(this.certStatus),e.push(new ht({valueDate:this.thisUpdate})),this.nextUpdate&&e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:[new ht({valueDate:this.nextUpdate})]})),this.singleExtensions&&e.push(new U({value:Array.from(this.singleExtensions,t=>t.toSchema())})),new U({value:e})}toJSON(){const e={certID:this.certID.toJSON(),certStatus:this.certStatus.toJSON(),thisUpdate:this.thisUpdate};return this.nextUpdate&&(e.nextUpdate=this.nextUpdate),this.singleExtensions&&(e.singleExtensions=Array.from(this.singleExtensions,t=>t.toJSON())),e}}return s.CLASS_NAME="SingleResponse",s})();const Pc="tbs",wr="version",ul="responderID",hl="producedAt",dl="responses",Jn="responseExtensions",yr="ResponseData",Dc=`${yr}.${wr}`,qn=`${yr}.${ul}`,vh=`${yr}.${hl}`,wh=`${yr}.${dl}`,Uc=`${yr}.${Jn}`,Sv=[yr,Dc,qn,vh,wh,Uc];let mi=(()=>{class s extends fe{get tbs(){return L._H.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(c(e,Pc,s.defaultValues(Pc))),wr in e&&(this.version=c(e,wr,s.defaultValues(wr))),this.responderID=c(e,ul,s.defaultValues(ul)),this.producedAt=c(e,hl,s.defaultValues(hl)),this.responses=c(e,dl,s.defaultValues(dl)),Jn in e&&(this.responseExtensions=c(e,Jn,s.defaultValues(Jn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wr:return 0;case Pc:return Nt;case ul:return{};case hl:return new Date(0,0,0);case dl:case Jn:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Pc:return 0===t.byteLength;case ul:return 0===Object.keys(t).length;case hl:return t===s.defaultValues(e);case dl:case Jn:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||yr,value:[new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Q({name:t.version||Dc})]}),new dt({value:[new z({name:t.responderID||qn,idBlock:{tagClass:3,tagNumber:1},value:[ft.schema(t.ResponseDataByName||{names:{blockName:"ResponseData.byName"}})]}),new z({name:t.responderID||qn,idBlock:{tagClass:3,tagNumber:2},value:[new me({name:t.ResponseDataByKey||"ResponseData.byKey"})]})]}),new ht({name:t.producedAt||vh}),new U({value:[new Ke({name:wh,value:em.schema(t.response||{})})]}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[Tt.schema(t.extensions||{names:{blockName:Uc}})]})]})}fromSchema(e){ne(e,Sv);const t=de(e,e,s.schema());le.assertSchema(t,this.className),this.tbsView=t.result.ResponseData.valueBeforeDecodeView,Dc in t.result&&(this.version=t.result[Dc].valueBlock.valueDec),this.responderID=1===t.result[qn].idBlock.tagNumber?new ft({schema:t.result[qn].valueBlock.value[0]}):t.result[qn].valueBlock.value[0],this.producedAt=t.result[vh].toDate(),this.responses=Array.from(t.result[wh],i=>new em({schema:i})),Uc in t.result&&(this.responseExtensions=Array.from(t.result[Uc].valueBlock.value,i=>new Li({schema:i})))}toSchema(e=!1){let t;if(!1===e){if(!this.tbsView.byteLength)return s.schema();const i=Et(this.tbsView);le.assert(i,"TBS Response Data"),t=i.result}else{const i=[];wr in this&&i.push(new z({idBlock:{tagClass:3,tagNumber:0},value:[new Q({value:this.version})]})),i.push(new z(this.responderID instanceof ft?{idBlock:{tagClass:3,tagNumber:1},value:[this.responderID.toSchema()]}:{idBlock:{tagClass:3,tagNumber:2},value:[this.responderID]})),i.push(new ht({valueDate:this.producedAt})),i.push(new U({value:Array.from(this.responses,a=>a.toSchema())})),this.responseExtensions&&i.push(new z({idBlock:{tagClass:3,tagNumber:1},value:[new U({value:Array.from(this.responseExtensions,a=>a.toSchema())})]})),t=new U({value:i})}return t}toJSON(){const e={};return wr in this&&(e.version=this.version),this.responderID&&(e.responderID=this.responderID),this.producedAt&&(e.producedAt=this.producedAt),this.responses&&(e.responses=Array.from(this.responses,t=>t.toJSON())),this.responseExtensions&&(e.responseExtensions=Array.from(this.responseExtensions,t=>t.toJSON())),e}}return s.CLASS_NAME="ResponseData",s})();const yh="trustedCerts",Sh="certs",bh="crls",Ah="ocsps",kh="checkDate",Eh="findOrigin",_h="findIssuer";var zn=function(s){return s[s.unknown=-1]="unknown",s[s.success=0]="success",s[s.noRevocation=11]="noRevocation",s[s.noPath=60]="noPath",s[s.noValidPath=97]="noValidPath",s}(zn||{});let fl=(()=>{class s extends Error{constructor(e,t){super(t),this.name=s.NAME,this.code=e,this.message=t}}return s.NAME="ChainValidationError",s})();class Mc{constructor(r={}){this.trustedCerts=c(r,yh,this.defaultValues(yh)),this.certs=c(r,Sh,this.defaultValues(Sh)),this.crls=c(r,bh,this.defaultValues(bh)),this.ocsps=c(r,Ah,this.defaultValues(Ah)),this.checkDate=c(r,kh,this.defaultValues(kh)),this.findOrigin=c(r,Eh,this.defaultValues(Eh)),this.findIssuer=c(r,_h,this.defaultValues(_h))}static defaultFindOrigin(r,e){0===r.tbsView.byteLength&&(r.tbsView=new Uint8Array(r.encodeTBS().toBER()));for(const t of e.certs)if(0===t.tbsView.byteLength&&(t.tbsView=new Uint8Array(t.encodeTBS().toBER())),L._H.isEqual(r.tbsView,t.tbsView))return"Intermediate Certificates";for(const t of e.trustedCerts)if(0===t.tbsView.byteLength&&(t.tbsView=new Uint8Array(t.encodeTBS().toBER())),L._H.isEqual(r.tbsView,t.tbsView))return"Trusted Certificates";return"Unknown"}defaultFindIssuer(r,e,t=Ge(!0)){return(0,E.A)(function*(){const i=[];let a=null,o=null,u=null;if(r.subject.isEqual(r.issuer))try{if(yield r.verify(void 0,t))return[r]}catch{}if(r.extensions)for(const g of r.extensions)if(g.extnID===Su&&g.parsedValue instanceof uf){g.parsedValue.keyIdentifier?a=g.parsedValue.keyIdentifier:(g.parsedValue.authorityCertIssuer&&(o=g.parsedValue.authorityCertIssuer),g.parsedValue.authorityCertSerialNumber&&(u=g.parsedValue.authorityCertSerialNumber));break}function h(g){if(null!==a&&g.extensions){let x=!1;for(const G of g.extensions)if("2.5.29.14"===G.extnID&&G.parsedValue){x=!0,L._H.isEqual(G.parsedValue.valueBlock.valueHex,a.valueBlock.valueHexView)&&i.push(g);break}if(x)return}let N=!1;null!==u&&(N=g.serialNumber.isEqual(u)),null!==o?g.subject.isEqual(o)&&N&&i.push(g):r.issuer.isEqual(g.subject)&&i.push(g)}for(const g of e.trustedCerts)h(g);for(const g of e.certs)h(g);for(let g=i.length-1;g>=0;g--)try{!1===(yield r.verify(i[g],t))&&i.splice(g,1)}catch{i.splice(g,1)}return i})()}defaultValues(r){switch(r){case yh:case Sh:case bh:case Ah:return[];case kh:return new Date;case Eh:return Mc.defaultFindOrigin;case _h:return this.defaultFindIssuer;default:throw new Error(`Invalid member name for CertificateChainValidationEngine class: ${r}`)}}sort(r=!1,e=Ge(!0)){var t=this;return(0,E.A)(function*(){const i=[],a=function(){var we=(0,E.A)(function*(ie,ye){const oe=[];function ce(be){let Be=!0;for(let xe=0;xe<be.length;xe++){for(let Ue=0;Ue<be.length;Ue++)if(Ue!==xe&&be[xe]===be[Ue]){Be=!1;break}if(!Be)break}return Be}if(function bv(s,r){for(let e=0;e<r.length;e++)if(L._H.isEqual(s.tbsView,r[e].tbsView))return!0;return!1}(ie,t.trustedCerts))return[[ie]];const pe=yield t.findIssuer(ie,t,ye);if(0===pe.length)throw new Error("No valid certificate paths found");for(let be=0;be<pe.length;be++){if(L._H.isEqual(pe[be].tbsView,ie.tbsView)){oe.push([pe[be]]);continue}const Be=yield a(pe[be],ye);for(let xe=0;xe<Be.length;xe++){const Ue=Be[xe].slice();Ue.splice(0,0,pe[be]),ce(Ue)?oe.push(Ue):oe.push(Be[xe])}}return oe});return function(ye,oe){return we.apply(this,arguments)}}(),o=function(){var we=(0,E.A)(function*(ie){const ye=[],oe=[],ce=[];if(ye.push(...i.filter(pe=>ie.issuer.isEqual(pe.subject))),0===ye.length)return{status:1,statusMessage:"No certificate's issuers"};if(oe.push(...t.crls.filter(pe=>pe.issuer.isEqual(ie.issuer))),0===oe.length)return{status:2,statusMessage:"No CRLs for specific certificate issuer"};for(let pe=0;pe<oe.length;pe++){const be=oe[pe];if(!(be.nextUpdate&&be.nextUpdate.value<t.checkDate))for(let Be=0;Be<ye.length;Be++)try{if(yield oe[pe].verify({issuerCertificate:ye[Be]},e)){ce.push({crl:oe[pe],certificate:ye[Be]});break}}catch{}}return ce.length?{status:0,statusMessage:w,result:ce}:{status:3,statusMessage:"No valid CRLs found"}});return function(ye){return we.apply(this,arguments)}}(),u=function(){var we=(0,E.A)(function*(ie,ye){const oe=e.getAlgorithmByOID(ie.signatureAlgorithm.algorithmId);if(!oe.name||!oe.hash)return 1;for(let ce=0;ce<t.ocsps.length;ce++){const be=yield t.ocsps[ce].getCertificateStatus(ie,ye,e);if(be.isForCertificate)return 0===be.status?0:1}return 2});return function(ye,oe){return we.apply(this,arguments)}}();function h(we){return g.apply(this,arguments)}function g(){return(g=(0,E.A)(function*(we,ie=!1){let ye=!1,oe=!1,ce=!1,pe=!1;if(we.extensions){for(let be=0;be<we.extensions.length;be++){const Be=we.extensions[be];if(Be.critical&&!Be.parsedValue)return{result:!1,resultCode:6,resultMessage:`Unable to parse critical certificate extension: ${Be.extnID}`};if("2.5.29.15"===Be.extnID){ce=!0;const xe=new Uint8Array(Be.parsedValue.valueBlock.valueHex);!(4&~xe[0])&&(oe=!0),!(2&~xe[0])&&(pe=!0)}Be.extnID===wu&&"cA"in Be.parsedValue&&!0===Be.parsedValue.cA&&(ye=!0)}if(!0===oe&&!1===ye)return{result:!1,resultCode:3,resultMessage:'Unable to build certificate chain - using "keyCertSign" flag set without BasicConstraints'};if(!0===ce&&!0===ye&&!1===oe)return{result:!1,resultCode:4,resultMessage:'Unable to build certificate chain - "keyCertSign" flag was not set'};if(!0===ye&&!0===ce&&ie&&!1===pe)return{result:!1,resultCode:5,resultMessage:'Unable to build certificate chain - intermediate certificate must have "cRLSign" key usage flag'}}return!1===ye?{result:!1,resultCode:7,resultMessage:"Unable to build certificate chain - more than one possible end-user certificate"}:{result:!0,resultCode:0,resultMessage:w}})).apply(this,arguments)}const N=function(){var we=(0,E.A)(function*(ie,ye){for(let oe=0;oe<ie.length;oe++)if(ie[oe].notBefore.value>ye||ie[oe].notAfter.value<ye)return{result:!1,resultCode:8,resultMessage:"The certificate is either not yet valid or expired"};if(ie.length<2)return{result:!1,resultCode:9,resultMessage:"Too short certificate path"};for(let oe=ie.length-2;oe>=0;oe--)if(!1===ie[oe].issuer.isEqual(ie[oe].subject)&&!1===ie[oe].issuer.isEqual(ie[oe+1].subject))return{result:!1,resultCode:10,resultMessage:"Incorrect name chaining"};if(0!==t.crls.length||0!==t.ocsps.length)for(let oe=0;oe<ie.length-1;oe++){let ce=2,pe={status:0,statusMessage:w};if(0!==t.ocsps.length)switch(ce=yield u(ie[oe],ie[oe+1]),ce){case 0:continue;case 1:return{result:!1,resultCode:12,resultMessage:"One of certificates was revoked via OCSP response"}}if(0!==t.crls.length){if(pe=yield o(ie[oe]),0===pe.status&&pe.result)for(let be=0;be<pe.result.length;be++){if(pe.result[be].crl.isCertificateRevoked(ie[oe]))return{result:!1,resultCode:12,resultMessage:"One of certificates had been revoked"};if(!1===(yield h(pe.result[be].certificate,!0)).result)return{result:!1,resultCode:13,resultMessage:"CRL issuer certificate is not a CA certificate or does not have crlSign flag"}}else if(!1===r)throw new fl(zn.noRevocation,`No revocation values found for one of certificates: ${pe.statusMessage}`)}else if(2===ce)return{result:!1,resultCode:11,resultMessage:"No revocation values found for one of certificates"};if(2===ce&&2===pe.status&&r){const be=ie[oe+1];let Be=!1;if(be.extensions)for(const xe of be.extensions)switch(xe.extnID){case Zd:case yu:case bu:Be=!0}if(Be)throw new fl(zn.noRevocation,`No revocation values found for one of certificates: ${pe.statusMessage}`)}}for(const[oe,ce]of ie.entries())if(oe&&!(yield h(ce)).result)return{result:!1,resultCode:14,resultMessage:"One of intermediate certificates is not a CA certificate"};return{result:!0}});return function(ye,oe){return we.apply(this,arguments)}}();i.push(...t.trustedCerts),i.push(...t.certs);for(let we=0;we<i.length;we++)for(let ie=0;ie<i.length;ie++)if(we!==ie&&L._H.isEqual(i[we].tbsView,i[ie].tbsView)){i.splice(ie,1),we=0;break}const x=i[i.length-1];let G;const H=[x];if(G=yield a(x,e),0===G.length)throw new fl(zn.noPath,"Unable to find certificate path");for(let we=G.length-1;we>=0;we--){let ie=!1;for(let ye=0;ye<G[we].length;ye++){const oe=G[we][ye];for(let ce=0;ce<t.trustedCerts.length;ce++)if(L._H.isEqual(oe.tbsView,t.trustedCerts[ce].tbsView)){ie=!0;break}if(ie)break}ie||G.splice(we,1)}if(0===G.length)throw new fl(zn.noValidPath,"No valid certificate paths found");let re=G[0].length,Ae=0;for(let we=0;we<G.length;we++)G[we].length<re&&(re=G[we].length,Ae=we);for(let we=0;we<G[Ae].length;we++)H.push(G[Ae][we]);if(G=yield N(H,t.checkDate),!1===G.result)throw G;return H})()}verify(r={},e=Ge(!0)){var t=this;return(0,E.A)(function*(){function i(g,N){const x=Rs(g),G=Rs(N),H=x.split("."),re=G.split("."),Ae=H.length,we=re.length;if(0===Ae||0===we||Ae<we)return!1;for(let ie=0;ie<Ae;ie++)if(0===H[ie].length)return!1;for(let ie=0;ie<we;ie++)if(0===re[ie].length){if(0===ie){if(1===we)return!1;continue}return!1}for(let ie=0;ie<we;ie++)if(0!==re[we-1-ie].length&&0!==H[Ae-1-ie].localeCompare(re[we-1-ie]))return!1;return!0}function a(g,N){const x=Rs(g),G=Rs(N),H=x.split("@"),re=G.split("@");if(0===H.length||0===re.length||H.length<re.length)return!1;if(1===re.length){if(i(H[1],re[0])){const we=H[1].split("."),ie=re[0].split(".");return 0===ie[0].length||we.length===ie.length}return!1}return 0===x.localeCompare(G)}function o(g,N){let x=Rs(g);const G=Rs(N),H=x.split("/");if(G.split("/").length>1)return!1;if(H.length>1)for(let we=0;we<H.length;we++)if(H[we].length>0&&":"!==H[we].charAt(H[we].length-1)){x=H[we].split(":")[0];break}if(i(x,G)){const we=x.split("."),ie=G.split(".");return 0===ie[0].length||we.length===ie.length}return!1}function u(g,N){const x=g.valueBlock.valueHexView,G=N.valueBlock.valueHexView;if(4===x.length&&8===G.length){for(let H=0;H<4;H++)if((x[H]^G[H])&G[H+4])return!1;return!0}if(16===x.length&&32===G.length){for(let H=0;H<16;H++)if((x[H]^G[H])&G[H+16])return!1;return!0}return!1}function h(g,N){if(0===g.typesAndValues.length||0===N.typesAndValues.length)return!0;if(g.typesAndValues.length<N.typesAndValues.length)return!1;let x=!0,G=0;for(let H=0;H<N.typesAndValues.length;H++){let re=!1;for(let Ae=G;Ae<g.typesAndValues.length;Ae++)if(re=g.typesAndValues[Ae].isEqual(N.typesAndValues[H]),g.typesAndValues[Ae].type===N.typesAndValues[H].type&&(x=x&&re),!0===re){if(0===G||G===Ae){G=Ae+1;break}return!1}if(!1===re)return!1}return 0!==G&&x}try{if(0===t.certs.length)throw new Error("Empty certificate array");const g=r.passedWhenNotRevValues||!1,N=r.initialPolicySet||[qt];let ie=r.initialExplicitPolicy||!1,ye=r.initialPolicyMappingInhibit||!1,oe=r.initialInhibitPolicy||!1;const ce=[!1,!1,!1];let pe=0,be=0,Be=0,xe=r.initialPermittedSubtreesSet||[],Ue=r.initialExcludedSubtreesSet||[];const We=r.initialRequiredNameForms||[];let bt=1;t.certs=yield t.sort(g,e);const Ye=[];Ye.push(qt);const lt=[],Kt=new Array(t.certs.length-1);for(let De=0;De<t.certs.length-1;De++)Kt[De]=!0;lt.push(Kt);const Pt=new Array(t.certs.length-1),Pr=new Array(t.certs.length-1);let ks=ie?t.certs.length-1:-1;for(let De=t.certs.length-2;De>=0;De--,bt++){const je=t.certs[De];if(je.extensions){for(let Oe=0;Oe<je.extensions.length;Oe++){const ze=je.extensions[Oe];if(ze.extnID===ef){Pr[De]=ze.parsedValue;for(let rt=0;rt<Ye.length;rt++)if(Ye[rt]===qt){delete lt[rt][De];break}for(let rt=0;rt<ze.parsedValue.certificatePolicies.length;rt++){let Ft=-1;const ss=ze.parsedValue.certificatePolicies[rt].policyIdentifier;for(let mt=0;mt<Ye.length;mt++)if(ss===Ye[mt]){Ft=mt;break}if(-1===Ft){Ye.push(ss);const mt=new Array(t.certs.length-1);mt[De]=!0,lt.push(mt)}else lt[Ft][De]=!0}}if(ze.extnID===tf){if(ye)return{result:!1,resultCode:98,resultMessage:"Policy mapping prohibited"};Pt[De]=ze.parsedValue}ze.extnID===sf&&!1===ie&&(0===ze.parsedValue.requireExplicitPolicy?(ie=!0,ks=De):!1===ce[0]?(ce[0]=!0,pe=ze.parsedValue.requireExplicitPolicy):pe=pe>ze.parsedValue.requireExplicitPolicy?ze.parsedValue.requireExplicitPolicy:pe,0===ze.parsedValue.inhibitPolicyMapping?ye=!0:!1===ce[1]?(ce[1]=!0,be=ze.parsedValue.inhibitPolicyMapping+1):be=be>ze.parsedValue.inhibitPolicyMapping+1?ze.parsedValue.inhibitPolicyMapping+1:be),"2.5.29.54"===ze.extnID&&!1===oe&&(0===ze.parsedValue.valueBlock.valueDec?oe=!0:!1===ce[2]?(ce[2]=!0,Be=ze.parsedValue.valueBlock.valueDec):Be=Be>ze.parsedValue.valueBlock.valueDec?ze.parsedValue.valueBlock.valueDec:Be)}if(!0===oe){let Oe=-1;for(let ze=0;ze<Ye.length;ze++)if(Ye[ze]===qt){Oe=ze;break}-1!==Oe&&delete lt[0][De]}!1===ie&&!0===ce[0]&&(pe--,0===pe&&(ie=!0,ks=De,ce[0]=!1)),!1===ye&&!0===ce[1]&&(be--,0===be&&(ye=!0,ce[1]=!1)),!1===oe&&!0===ce[2]&&(Be--,0===Be&&(oe=!0,ce[2]=!1))}}for(let De=0;De<t.certs.length-1;De++)if(De<t.certs.length-2&&typeof Pt[De+1]<"u")for(let je=0;je<Pt[De+1].mappings.length;je++){if(Pt[De+1].mappings[je].issuerDomainPolicy===qt||Pt[De+1].mappings[je].subjectDomainPolicy===qt)return{result:!1,resultCode:99,resultMessage:'The "anyPolicy" should not be a part of policy mapping scheme'};let Oe=-1,ze=-1;for(let rt=0;rt<Ye.length;rt++)Ye[rt]===Pt[De+1].mappings[je].issuerDomainPolicy&&(Oe=rt),Ye[rt]===Pt[De+1].mappings[je].subjectDomainPolicy&&(ze=rt);typeof lt[Oe][De]<"u"&&delete lt[Oe][De];for(let rt=0;rt<Pr[De].certificatePolicies.length;rt++)if(Pt[De+1].mappings[je].subjectDomainPolicy===Pr[De].certificatePolicies[rt].policyIdentifier&&-1!==Oe&&-1!==ze)for(let Ft=0;Ft<=De;Ft++)typeof lt[ze][Ft]<"u"&&(lt[Oe][Ft]=!0,delete lt[ze][Ft])}for(let De=0;De<Ye.length;De++)if(Ye[De]===qt)for(let je=0;je<ks;je++)delete lt[De][je];const Wt=[];for(let De=0;De<lt.length;De++){let je=!0;for(let Oe=0;Oe<t.certs.length-1;Oe++){let ze=!1;if(Oe<ks&&Ye[De]===qt&&Ye.length>1){je=!1;break}if(typeof lt[De][Oe]>"u"){if(Oe>=ks)for(let rt=0;rt<Ye.length;rt++)if(Ye[rt]===qt){!0===lt[rt][Oe]&&(ze=!0);break}if(!ze){je=!1;break}}}!0===je&&Wt.push(Ye[De])}let ct=[];if(1===N.length&&N[0]===qt&&!1===ie)ct=N;else if(1===Wt.length&&Wt[0]===qt)ct=N;else for(let De=0;De<Wt.length;De++)for(let je=0;je<N.length;je++)if(N[je]===Wt[De]||N[je]===qt){ct.push(Wt[De]);break}const nt={result:ct.length>0,resultCode:0,resultMessage:ct.length>0?w:'Zero "userConstrPolicies" array, no intersections with "authConstrPolicies"',authConstrPolicies:Wt,userConstrPolicies:ct,explicitPolicyIndicator:ie,policyMappings:Pt,certificatePath:t.certs};if(0===ct.length||!1===nt.result)return nt;bt=1;for(let De=t.certs.length-2;De>=0;De--,bt++){const je=t.certs[De];let Oe=[],ze=[],rt=[];if(je.extensions)for(let Qe=0;Qe<je.extensions.length;Qe++){const He=je.extensions[Qe];He.extnID===Qd&&("permittedSubtrees"in He.parsedValue&&(ze=ze.concat(He.parsedValue.permittedSubtrees)),"excludedSubtrees"in He.parsedValue&&(rt=rt.concat(He.parsedValue.excludedSubtrees))),He.extnID===zd&&(Oe=Oe.concat(He.parsedValue.altNames))}let Ft=We.length<=0;for(let Qe=0;Qe<We.length;Qe++)switch(We[Qe].base.type){case 4:if(We[Qe].base.value.typesAndValues.length!==je.subject.typesAndValues.length)continue;Ft=!0;for(let He=0;He<je.subject.typesAndValues.length;He++)if(je.subject.typesAndValues[He].type!==We[Qe].base.value.typesAndValues[He].type){Ft=!1;break}if(!0===Ft)break}if(!1===Ft)throw nt.result=!1,nt.resultCode=21,nt.resultMessage="No necessary name form found",nt;const ss=[[],[],[],[],[]];for(let Qe=0;Qe<xe.length;Qe++)switch(xe[Qe].base.type){case 1:ss[0].push(xe[Qe]);break;case 2:ss[1].push(xe[Qe]);break;case 4:ss[2].push(xe[Qe]);break;case 6:ss[3].push(xe[Qe]);break;case 7:ss[4].push(xe[Qe])}for(let Qe=0;Qe<5;Qe++){let He=!1,Dr=!1;const wi=ss[Qe];for(let yi=0;yi<wi.length;yi++){switch(Qe){case 0:if(Oe.length>0)for(let gt=0;gt<Oe.length;gt++)1===Oe[gt].type&&(Dr=!0,He=He||a(Oe[gt].value,wi[yi].base.value));else for(let gt=0;gt<je.subject.typesAndValues.length;gt++)("1.2.840.113549.1.9.1"===je.subject.typesAndValues[gt].type||"0.9.2342.19200300.100.1.3"===je.subject.typesAndValues[gt].type)&&(Dr=!0,He=He||a(je.subject.typesAndValues[gt].value.valueBlock.value,wi[yi].base.value));break;case 1:if(Oe.length>0)for(let gt=0;gt<Oe.length;gt++)2===Oe[gt].type&&(Dr=!0,He=He||i(Oe[gt].value,wi[yi].base.value));break;case 2:Dr=!0,He=h(je.subject,wi[yi].base.value);break;case 3:if(Oe.length>0)for(let gt=0;gt<Oe.length;gt++)6===Oe[gt].type&&(Dr=!0,He=He||o(Oe[gt].value,wi[yi].base.value));break;case 4:if(Oe.length>0)for(let gt=0;gt<Oe.length;gt++)7===Oe[gt].type&&(Dr=!0,He=He||u(Oe[gt].value,wi[yi].base.value))}if(He)break}if(!1===He&&wi.length>0&&Dr)throw nt.result=!1,nt.resultCode=41,nt.resultMessage='Failed to meet "permitted sub-trees" name constraint',nt}let mt=!1;for(let Qe=0;Qe<Ue.length;Qe++){switch(Ue[Qe].base.type){case 1:if(Oe.length>=0)for(let He=0;He<Oe.length;He++)1===Oe[He].type&&(mt=mt||a(Oe[He].value,Ue[Qe].base.value));else for(let He=0;He<je.subject.typesAndValues.length;He++)("1.2.840.113549.1.9.1"===je.subject.typesAndValues[He].type||"0.9.2342.19200300.100.1.3"===je.subject.typesAndValues[He].type)&&(mt=mt||a(je.subject.typesAndValues[He].value.valueBlock.value,Ue[Qe].base.value));break;case 2:if(Oe.length>0)for(let He=0;He<Oe.length;He++)2===Oe[He].type&&(mt=mt||i(Oe[He].value,Ue[Qe].base.value));break;case 4:mt=mt||h(je.subject,Ue[Qe].base.value);break;case 6:if(Oe.length>0)for(let He=0;He<Oe.length;He++)6===Oe[He].type&&(mt=mt||o(Oe[He].value,Ue[Qe].base.value));break;case 7:if(Oe.length>0)for(let He=0;He<Oe.length;He++)7===Oe[He].type&&(mt=mt||u(Oe[He].value,Ue[Qe].base.value))}if(mt)break}if(!0===mt)throw nt.result=!1,nt.resultCode=42,nt.resultMessage='Failed to meet "excluded sub-trees" name constraint',nt;xe=xe.concat(ze),Ue=Ue.concat(rt)}return nt}catch(g){return g instanceof Error?g instanceof fl?{result:!1,resultCode:g.code,resultMessage:g.message,error:g}:{result:!1,resultCode:zn.unknown,resultMessage:g.message,error:g}:g&&"object"==typeof g&&"resultMessage"in g?g:{result:!1,resultCode:-1,resultMessage:`${g}`}}})()}}const Lc="tbsResponseData",ml="signatureAlgorithm",gl="signature",Wn="certs",pl="BasicOCSPResponse",Ch=`${pl}.${Lc}`,Nh=`${pl}.${ml}`,Ih=`${pl}.${gl}`,Fc=`${pl}.${Wn}`,Av=[Ch,Nh,Ih,Fc];let kv=(()=>{class s extends fe{constructor(e={}){super(),this.tbsResponseData=c(e,Lc,s.defaultValues(Lc)),this.signatureAlgorithm=c(e,ml,s.defaultValues(ml)),this.signature=c(e,gl,s.defaultValues(gl)),Wn in e&&(this.certs=c(e,Wn,s.defaultValues(Wn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Lc:return new mi;case ml:return new Z;case gl:return new et;case Wn:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"type":{let i=mi.compareWithDefault("tbs",t.tbs)&&mi.compareWithDefault("responderID",t.responderID)&&mi.compareWithDefault("producedAt",t.producedAt)&&mi.compareWithDefault("responses",t.responses);return"responseExtensions"in t&&(i=i&&mi.compareWithDefault("responseExtensions",t.responseExtensions)),i}case ml:return t.algorithmId===w&&!("algorithmParams"in t);case gl:return t.isEqual(s.defaultValues(e));case Wn:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||pl,value:[mi.schema(t.tbsResponseData||{names:{blockName:Ch}}),Z.schema(t.signatureAlgorithm||{names:{blockName:Nh}}),new et({name:t.signature||Ih}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new U({value:[new Ke({name:Fc,value:zt.schema(t.certs||{})})]})]})]})}fromSchema(e){ne(e,Av);const t=de(e,e,s.schema());le.assertSchema(t,this.className),this.tbsResponseData=new mi({schema:t.result[Ch]}),this.signatureAlgorithm=new Z({schema:t.result[Nh]}),this.signature=t.result[Ih],Fc in t.result&&(this.certs=Array.from(t.result[Fc],i=>new zt({schema:i})))}toSchema(){const e=[];return e.push(this.tbsResponseData.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.certs&&e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:[new U({value:Array.from(this.certs,t=>t.toSchema())})]})),new U({value:e})}toJSON(){const e={tbsResponseData:this.tbsResponseData.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.certs&&(e.certs=Array.from(this.certs,t=>t.toJSON())),e}getCertificateStatus(e,t,i=Ge(!0)){var a=this;return(0,E.A)(function*(){const o={isForCertificate:!1,status:2},u={},h=[];for(const g of a.tbsResponseData.responses){const N=i.getAlgorithmByOID(g.certID.hashAlgorithm.algorithmId,!0,"CertID.hashAlgorithm");if(!u[N.name]){u[N.name]=1;const x=new di;h.push(x),yield x.createForCertificate(e,{hashAlgorithm:N.name,issuerCertificate:t},i)}}for(const g of a.tbsResponseData.responses)for(const N of h)if(g.certID.isEqual(N)){o.isForCertificate=!0;try{switch(g.certStatus.idBlock.isConstructed){case!0:1===g.certStatus.idBlock.tagNumber&&(o.status=1);break;case!1:switch(g.certStatus.idBlock.tagNumber){case 0:o.status=0;break;case 2:o.status=2}}}catch{}return o}return o})()}sign(e,t="SHA-1",i=Ge(!0)){var a=this;return(0,E.A)(function*(){if(!e)throw new Error("Need to provide a private key for signing");const o=yield i.getSignatureParameters(e,t),u=o.parameters.algorithm;if(!("name"in u))throw new Error("Empty algorithm");a.signatureAlgorithm=o.signatureAlgorithm,a.tbsResponseData.tbsView=new Uint8Array(a.tbsResponseData.toSchema(!0).toBER());const h=yield i.signWithPrivateKey(a.tbsResponseData.tbsView,e,{algorithm:u});a.signature=new et({valueHex:h})})()}verify(e={},t=Ge(!0)){var i=this;return(0,E.A)(function*(){let a=null,o=-1;const u=e.trustedCerts||[];if(!i.certs)throw new Error("No certificates attached to the BasicOCSPResponse");switch(!0){case i.tbsResponseData.responderID instanceof ft:for(const[x,G]of i.certs.entries())if(G.subject.isEqual(i.tbsResponseData.responderID)){o=x;break}break;case i.tbsResponseData.responderID instanceof me:for(const[x,G]of i.certs.entries())if(W(yield t.digest({name:"sha-1"},G.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView),i.tbsResponseData.responderID.valueBlock.valueHex)){o=x;break}break;default:throw new Error("Wrong value for responderID")}if(-1===o)throw new Error("Correct certificate was not found in OCSP response");a=i.certs[o];const h=[a];for(const x of i.certs){const G=yield Jf(x,a);G&&h.push(G)}if(!(yield new Mc({certs:h,trustedCerts:u}).verify({},t)).result)throw new Error("Validation of signer's certificate failed");return t.verifyWithPublicKey(i.tbsResponseData.tbsView,i.signature,i.certs[o].subjectPublicKeyInfo,i.signatureAlgorithm)})()}}return s.CLASS_NAME="BasicOCSPResponse",s})();const Rh="version",Th="subject",xh="subjectPublicKeyInfo",Yn="attributes",vl="signatureAlgorithm",wl="signatureValue",Xn="CertificationRequestInfo",Vh=`${Xn}.version`,Oh=`${Xn}.subject`,Ph=`${Xn}.subjectPublicKeyInfo`,Hc=`${Xn}.attributes`,Ev=[Xn,Vh,Oh,Ph,Hc,vl,wl];function _v(s={}){const r=c(s,"names",{});return new U({name:r.CertificationRequestInfo||Xn,value:[new Q({name:r.CertificationRequestInfoVersion||Vh}),ft.schema(r.subject||{names:{blockName:Oh}}),ns.schema({names:{blockName:Ph}}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ke({optional:!0,name:r.CertificationRequestInfoAttributes||Hc,value:it.schema(r.attributes||{})})]})]})}let Cv=(()=>{class s extends fe{get tbs(){return L._H.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(c(e,"tbs",s.defaultValues("tbs"))),this.version=c(e,Rh,s.defaultValues(Rh)),this.subject=c(e,Th,s.defaultValues(Th)),this.subjectPublicKeyInfo=c(e,xh,s.defaultValues(xh)),Yn in e&&(this.attributes=c(e,Yn,s.defaultValues(Yn))),this.signatureAlgorithm=c(e,vl,s.defaultValues(vl)),this.signatureValue=c(e,wl,s.defaultValues(wl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return Nt;case Rh:return 0;case Th:return new ft;case xh:return new ns;case Yn:return[];case vl:return new Z;case wl:return new et;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({value:[_v(t.certificationRequestInfo||{}),new U({name:t.signatureAlgorithm||vl,value:[new Ve,new Fe({optional:!0})]}),new et({name:t.signatureValue||wl})]})}fromSchema(e){ne(e,Ev);const t=de(e,e,s.schema());le.assertSchema(t,this.className),this.tbsView=t.result.CertificationRequestInfo.valueBeforeDecodeView,this.version=t.result[Vh].valueBlock.valueDec,this.subject=new ft({schema:t.result[Oh]}),this.subjectPublicKeyInfo=new ns({schema:t.result[Ph]}),Hc in t.result&&(this.attributes=Array.from(t.result[Hc],i=>new it({schema:i}))),this.signatureAlgorithm=new Z({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[new Q({value:this.version}),this.subject.toSchema(),this.subjectPublicKeyInfo.toSchema()];return Yn in this&&e.push(new z({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes||[],t=>t.toSchema())})),new U({value:e})}toSchema(e=!1){let t;if(!1===e){if(0===this.tbsView.byteLength)return s.schema();const i=Et(this.tbsView);le.assert(i,"PKCS#10 Certificate Request"),t=i.result}else t=this.encodeTBS();return new U({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:L.U$.ToHex(this.tbsView),version:this.version,subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return Yn in this&&(e.attributes=Array.from(this.attributes||[],t=>t.toJSON())),e}sign(e,t="SHA-1",i=Ge(!0)){var a=this;return(0,E.A)(function*(){if(!e)throw new Error("Need to provide a private key for signing");const o=yield i.getSignatureParameters(e,t),u=o.parameters;a.signatureAlgorithm=o.signatureAlgorithm,a.tbsView=new Uint8Array(a.encodeTBS().toBER());const h=yield i.signWithPrivateKey(a.tbsView,e,u);a.signatureValue=new et({valueHex:h})})()}verify(e=Ge(!0)){var t=this;return(0,E.A)(function*(){return e.verifyWithPublicKey(t.tbsView,t.signatureValue,t.subjectPublicKeyInfo,t.signatureAlgorithm)})()}getPublicKey(e,t=Ge(!0)){var i=this;return(0,E.A)(function*(){return t.getPublicKey(i.subjectPublicKeyInfo,i.signatureAlgorithm,e)})()}}return s.CLASS_NAME="CertificationRequest",s})();const Sr="digestAlgorithm",br="digest",Nv=[Sr,br];let Qn=(()=>{class s extends fe{constructor(e={}){super(),this.digestAlgorithm=c(e,Sr,s.defaultValues(Sr)),this.digest=c(e,br,s.defaultValues(br)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Sr:return new Z;case br:return new me;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Sr:return Z.compareWithDefault("algorithmId",t.algorithmId)&&!("algorithmParams"in t);case br:return t.isEqual(s.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[Z.schema(t.digestAlgorithm||{names:{blockName:Sr}}),new me({name:t.digest||br})]})}fromSchema(e){ne(e,Nv);const t=de(e,e,s.schema({names:{digestAlgorithm:{names:{blockName:Sr}},digest:br}}));le.assertSchema(t,this.className),this.digestAlgorithm=new Z({schema:t.result.digestAlgorithm}),this.digest=t.result.digest}toSchema(){return new U({value:[this.digestAlgorithm.toSchema(),this.digest]})}toJSON(){return{digestAlgorithm:this.digestAlgorithm.toJSON(),digest:this.digest.toJSON()}}}return s.CLASS_NAME="DigestInfo",s})();const Zn="eContentType",es="eContent",Iv=[Zn,es];let ea=(()=>{class s extends fe{constructor(e={}){if(super(),this.eContentType=c(e,Zn,s.defaultValues(Zn)),es in e&&(this.eContent=c(e,es,s.defaultValues(es)),1===this.eContent.idBlock.tagClass&&4===this.eContent.idBlock.tagNumber&&!1===this.eContent.idBlock.isConstructed)){const t=new me({idBlock:{isConstructed:!0},isConstructed:!0});let i=0;const a=this.eContent.valueBlock.valueHexView.slice().buffer;let o=a.byteLength;for(;o>0;){const u=new Uint8Array(a,i,i+65536>a.byteLength?a.byteLength-i:65536),h=new ArrayBuffer(u.length),g=new Uint8Array(h);for(let N=0;N<g.length;N++)g[N]=u[N];t.valueBlock.value.push(new me({valueHex:h})),o-=u.length,i+=u.length}this.eContent=t}e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Zn:return w;case es:return new me;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Zn:return t===w;case es:return 1===t.idBlock.tagClass&&4===t.idBlock.tagNumber&&t.isEqual(s.defaultValues(es));default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Ve({name:t.eContentType||w}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Fe({name:t.eContent||w})]})]})}fromSchema(e){ne(e,Iv);const t=de(e,e,s.schema({names:{eContentType:Zn,eContent:es}}));le.assertSchema(t,this.className),this.eContentType=t.result.eContentType.valueBlock.toString(),es in t.result&&(this.eContent=t.result.eContent)}toSchema(){const e=[];return e.push(new Ve({value:this.eContentType})),this.eContent&&!1===s.compareWithDefault(es,this.eContent)&&e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.eContent]})),new U({value:e})}toJSON(){const e={eContentType:this.eContentType};return this.eContent&&!1===s.compareWithDefault(es,this.eContent)&&(e.eContent=this.eContent.toJSON()),e}}return s.CLASS_NAME="EncapsulatedContentInfo",s})();const Ar="mac",kr="macSalt",ys="iterations",Bv=[Ar,kr,ys];let Er=(()=>{class s extends fe{constructor(e={}){super(),this.mac=c(e,Ar,s.defaultValues(Ar)),this.macSalt=c(e,kr,s.defaultValues(kr)),ys in e&&(this.iterations=c(e,ys,s.defaultValues(ys))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ar:return new Qn;case kr:return new me;case ys:return 1;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ar:return Qn.compareWithDefault("digestAlgorithm",t.digestAlgorithm)&&Qn.compareWithDefault("digest",t.digest);case kr:return t.isEqual(s.defaultValues(e));case ys:return t===s.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,optional:t.optional||!0,value:[Qn.schema(t.mac||{names:{blockName:Ar}}),new me({name:t.macSalt||kr}),new Q({optional:!0,name:t.iterations||ys})]})}fromSchema(e){ne(e,Bv);const t=de(e,e,s.schema({names:{mac:{names:{blockName:Ar}},macSalt:kr,iterations:ys}}));le.assertSchema(t,this.className),this.mac=new Qn({schema:t.result.mac}),this.macSalt=t.result.macSalt,ys in t.result&&(this.iterations=t.result.iterations.valueBlock.valueDec)}toSchema(){const e=[this.mac.toSchema(),this.macSalt];return void 0!==this.iterations&&e.push(new Q({value:this.iterations})),new U({value:e})}toJSON(){const e={mac:this.mac.toJSON(),macSalt:this.macSalt.toJSON()};return void 0!==this.iterations&&(e.iterations=this.iterations),e}}return s.CLASS_NAME="MacData",s})();const _r="hashAlgorithm",Cr="hashedMessage",Rv=[_r,Cr];let yl=(()=>{class s extends fe{static create(e,t,i=Ge(!0)){return(0,E.A)(function*(){const a=i.getOIDByAlgorithm({name:e},!0,"hashAlgorithm"),o=yield i.digest(e,t);return new s({hashAlgorithm:new Z({algorithmId:a,algorithmParams:new At}),hashedMessage:new me({valueHex:o})})})()}constructor(e={}){super(),this.hashAlgorithm=c(e,_r,s.defaultValues(_r)),this.hashedMessage=c(e,Cr,s.defaultValues(Cr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case _r:return new Z;case Cr:return new me;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case _r:return t.algorithmId===w&&!("algorithmParams"in t);case Cr:return 0===t.isEqual(s.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[Z.schema(t.hashAlgorithm||{}),new me({name:t.hashedMessage||w})]})}fromSchema(e){ne(e,Rv);const t=de(e,e,s.schema({names:{hashAlgorithm:{names:{blockName:_r}},hashedMessage:Cr}}));le.assertSchema(t,this.className),this.hashAlgorithm=new Z({schema:t.result.hashAlgorithm}),this.hashedMessage=t.result.hashedMessage}toSchema(){return new U({value:[this.hashAlgorithm.toSchema(),this.hashedMessage]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),hashedMessage:this.hashedMessage.toJSON()}}}return s.CLASS_NAME="MessageImprint",s})();const Nr="type",Ss="attributes",jc="encodedValue",Mv=[Ss];let $t=(()=>{class s extends fe{constructor(e={}){super(),this.type=c(e,Nr,s.defaultValues(Nr)),this.attributes=c(e,Ss,s.defaultValues(Ss)),this.encodedValue=c(e,jc,s.defaultValues(jc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Nr:return-1;case Ss:return[];case jc:return Nt;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Nr:return t===s.defaultValues(Nr);case Ss:return 0===t.length;case jc:return 0===t.byteLength;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new z({name:t.blockName||w,optional:!0,idBlock:{tagClass:3,tagNumber:t.tagNumber||0},value:[new Ke({name:t.attributes||w,value:it.schema()})]})}fromSchema(e){ne(e,Mv);const t=de(e,e,s.schema({names:{tagNumber:this.type,attributes:Ss}}));if(le.assertSchema(t,this.className),this.type=t.result.idBlock.tagNumber,this.encodedValue=L._H.toArrayBuffer(t.result.valueBeforeDecodeView),new Uint8Array(this.encodedValue)[0]=49,Ss in t.result)this.attributes=Array.from(t.result.attributes,a=>new it({schema:a}));else if(0===this.type)throw new Error("Wrong structure of SignedUnsignedAttributes")}toSchema(){if(s.compareWithDefault(Nr,this.type)||s.compareWithDefault(Ss,this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return new z({optional:!0,idBlock:{tagClass:3,tagNumber:this.type},value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){if(s.compareWithDefault(Nr,this.type)||s.compareWithDefault(Ss,this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return{type:this.type,attributes:Array.from(this.attributes,e=>e.toJSON())}}}return s.CLASS_NAME="SignedAndUnsignedAttributes",s})();const ta="version",Ir="sid",sa="digestAlgorithm",gi="signedAttrs",ia="signatureAlgorithm",bl="signature",pi="unsignedAttrs",vi="SignerInfo",Dh=`${vi}.${ta}`,Al=`${vi}.${Ir}`,Uh=`${vi}.${sa}`,$c=`${vi}.${gi}`,Mh=`${vi}.${ia}`,Lh=`${vi}.${bl}`,Kc=`${vi}.${pi}`,Lv=[Dh,Al,Uh,$c,Mh,Lh,Kc];let Fh=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,ta,s.defaultValues(ta)),this.sid=c(e,Ir,s.defaultValues(Ir)),this.digestAlgorithm=c(e,sa,s.defaultValues(sa)),gi in e&&(this.signedAttrs=c(e,gi,s.defaultValues(gi))),this.signatureAlgorithm=c(e,ia,s.defaultValues(ia)),this.signature=c(e,bl,s.defaultValues(bl)),pi in e&&(this.unsignedAttrs=c(e,pi,s.defaultValues(pi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ta:return 0;case Ir:return new Fe;case sa:return new Z;case gi:return new $t({type:0});case ia:return new Z;case bl:return new me;case pi:return new $t({type:1});default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ta:return s.defaultValues(ta)===t;case Ir:return t instanceof Fe;case sa:return t instanceof Z&&t.isEqual(s.defaultValues(sa));case gi:return $t.compareWithDefault("type",t.type)&&$t.compareWithDefault("attributes",t.attributes)&&$t.compareWithDefault("encodedValue",t.encodedValue);case ia:return t instanceof Z&&t.isEqual(s.defaultValues(ia));case bl:case pi:return $t.compareWithDefault("type",t.type)&&$t.compareWithDefault("attributes",t.attributes)&&$t.compareWithDefault("encodedValue",t.encodedValue);default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:vi,value:[new Q({name:t.version||Dh}),new dt({value:[Vt.schema(t.sidSchema||{names:{blockName:Al}}),new dt({value:[new z({optional:!0,name:t.sid||Al,idBlock:{tagClass:3,tagNumber:0},value:[new me]}),new Le({optional:!0,name:t.sid||Al,idBlock:{tagClass:3,tagNumber:0}})]})]}),Z.schema(t.digestAlgorithm||{names:{blockName:Uh}}),$t.schema(t.signedAttrs||{names:{blockName:$c,tagNumber:0}}),Z.schema(t.signatureAlgorithm||{names:{blockName:Mh}}),new me({name:t.signature||Lh}),$t.schema(t.unsignedAttrs||{names:{blockName:Kc,tagNumber:1}})]})}fromSchema(e){ne(e,Lv);const t=de(e,e,s.schema());le.assertSchema(t,this.className),this.version=t.result[Dh].valueBlock.valueDec;const i=t.result[Al];this.sid=1===i.idBlock.tagClass?new Vt({schema:i}):i,this.digestAlgorithm=new Z({schema:t.result[Uh]}),$c in t.result&&(this.signedAttrs=new $t({type:0,schema:t.result[$c]})),this.signatureAlgorithm=new Z({schema:t.result[Mh]}),this.signature=t.result[Lh],Kc in t.result&&(this.unsignedAttrs=new $t({type:1,schema:t.result[Kc]}))}toSchema(){if(s.compareWithDefault(Ir,this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e=[];return e.push(new Q({value:this.version})),e.push(this.sid instanceof Vt?this.sid.toSchema():this.sid),e.push(this.digestAlgorithm.toSchema()),this.signedAttrs&&!1===s.compareWithDefault(gi,this.signedAttrs)&&e.push(this.signedAttrs.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.unsignedAttrs&&!1===s.compareWithDefault(pi,this.unsignedAttrs)&&e.push(this.unsignedAttrs.toSchema()),new U({value:e})}toJSON(){if(s.compareWithDefault(Ir,this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e={version:this.version,digestAlgorithm:this.digestAlgorithm.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.sid instanceof Fe||(e.sid=this.sid.toJSON()),this.signedAttrs&&!1===s.compareWithDefault(gi,this.signedAttrs)&&(e.signedAttrs=this.signedAttrs.toJSON()),this.unsignedAttrs&&!1===s.compareWithDefault(pi,this.unsignedAttrs)&&(e.unsignedAttrs=this.unsignedAttrs.toJSON()),e}}return s.CLASS_NAME="SignerInfo",s})();const kl="version",El="policy",_l="messageImprint",Cl="serialNumber",Nl="genTime",Br="ordering",Rr="nonce",ra="accuracy",na="tsa",aa="extensions",ts="TSTInfo",Hh=`${ts}.${kl}`,jh=`${ts}.${El}`,$h=`${ts}.${_l}`,Kh=`${ts}.${Cl}`,Gh=`${ts}.${Nl}`,Gc=`${ts}.${ra}`,Jc=`${ts}.${Br}`,qc=`${ts}.${Rr}`,zc=`${ts}.${na}`,Wc=`${ts}.${aa}`,Fv=[Hh,jh,$h,Kh,Gh,Gc,Jc,qc,zc,Wc];let Hv=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,kl,s.defaultValues(kl)),this.policy=c(e,El,s.defaultValues(El)),this.messageImprint=c(e,_l,s.defaultValues(_l)),this.serialNumber=c(e,Cl,s.defaultValues(Cl)),this.genTime=c(e,Nl,s.defaultValues(Nl)),ra in e&&(this.accuracy=c(e,ra,s.defaultValues(ra))),Br in e&&(this.ordering=c(e,Br,s.defaultValues(Br))),Rr in e&&(this.nonce=c(e,Rr,s.defaultValues(Rr))),na in e&&(this.tsa=c(e,na,s.defaultValues(na))),aa in e&&(this.extensions=c(e,aa,s.defaultValues(aa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case kl:return 0;case El:return w;case _l:return new yl;case Cl:return new Q;case Nl:return new Date(0,0,0);case ra:return new Fr;case Br:return!1;case Rr:return new Q;case na:return new St;case aa:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case kl:case El:case Nl:case Br:return t===s.defaultValues(Br);case _l:return yl.compareWithDefault(_r,t.hashAlgorithm)&&yl.compareWithDefault(Cr,t.hashedMessage);case Cl:case Rr:return t.isEqual(s.defaultValues(Rr));case ra:return Fr.compareWithDefault(Ts,t.seconds)&&Fr.compareWithDefault(xs,t.millis)&&Fr.compareWithDefault(Vs,t.micros);case na:return St.compareWithDefault(wa,t.type)&&St.compareWithDefault(ya,t.value);case aa:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||ts,value:[new Q({name:t.version||Hh}),new Ve({name:t.policy||jh}),yl.schema(t.messageImprint||{names:{blockName:$h}}),new Q({name:t.serialNumber||Kh}),new ht({name:t.genTime||Gh}),Fr.schema(t.accuracy||{names:{blockName:Gc}}),new Es({name:t.ordering||Jc,optional:!0}),new Q({name:t.nonce||qc,optional:!0}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[St.schema(t.tsa||{names:{blockName:zc}})]}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Ke({name:t.extensions||Wc,value:Li.schema(t.extension||{})})]})]})}fromSchema(e){ne(e,Fv);const t=de(e,e,s.schema());le.assertSchema(t,this.className),this.version=t.result[Hh].valueBlock.valueDec,this.policy=t.result[jh].valueBlock.toString(),this.messageImprint=new yl({schema:t.result[$h]}),this.serialNumber=t.result[Kh],this.genTime=t.result[Gh].toDate(),Gc in t.result&&(this.accuracy=new Fr({schema:t.result[Gc]})),Jc in t.result&&(this.ordering=t.result[Jc].valueBlock.value),qc in t.result&&(this.nonce=t.result[qc]),zc in t.result&&(this.tsa=new St({schema:t.result[zc]})),Wc in t.result&&(this.extensions=Array.from(t.result[Wc],i=>new Li({schema:i})))}toSchema(){const e=[];return e.push(new Q({value:this.version})),e.push(new Ve({value:this.policy})),e.push(this.messageImprint.toSchema()),e.push(this.serialNumber),e.push(new ht({valueDate:this.genTime})),this.accuracy&&e.push(this.accuracy.toSchema()),void 0!==this.ordering&&e.push(new Es({value:this.ordering})),this.nonce&&e.push(this.nonce),this.tsa&&e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.tsa.toSchema()]})),this.extensions&&e.push(new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.extensions,t=>t.toSchema())})),new U({value:e})}toJSON(){const e={version:this.version,policy:this.policy,messageImprint:this.messageImprint.toJSON(),serialNumber:this.serialNumber.toJSON(),genTime:this.genTime};return this.accuracy&&(e.accuracy=this.accuracy.toJSON()),void 0!==this.ordering&&(e.ordering=this.ordering),this.nonce&&(e.nonce=this.nonce.toJSON()),this.tsa&&(e.tsa=this.tsa.toJSON()),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}verify(e,t=Ge(!0)){var i=this;return(0,E.A)(function*(){if(!e.data)throw new Error('"data" is a mandatory attribute for TST_INFO verification');const a=e.data;if(e.notBefore&&i.genTime<e.notBefore)throw new Error("Generation time for TSTInfo object is less than notBefore value");if(e.notAfter&&i.genTime>e.notAfter)throw new Error("Generation time for TSTInfo object is more than notAfter value");const o=t.getAlgorithmByOID(i.messageImprint.hashAlgorithm.algorithmId,!0,"MessageImprint.hashAlgorithm"),u=yield t.digest(o.name,new Uint8Array(a));return L._H.isEqual(u,i.messageImprint.hashedMessage.valueBlock.valueHexView)})()}}return s.CLASS_NAME="TSTInfo",s})();const oa="version",Il="digestAlgorithms",Bl="encapContentInfo",la="certificates",ca="crls",Rl="signerInfos",Tl="ocsps",Tr="SignedData",Jh=`${Tr}.${oa}`,Yc=`${Tr}.${Il}`,qh=`${Tr}.${Bl}`,Xc=`${Tr}.${la}`,Qc=`${Tr}.${ca}`,Zc=`${Tr}.${Rl}`,jv=[Jh,Yc,qh,Xc,Qc,Zc];class Ot extends Error{constructor({message:r,code:e=0,date:t=new Date,signatureVerified:i=null,signerCertificate:a=null,signerCertificateVerified:o=null,timestampSerial:u=null,certificatePath:h=[]}){super(r),this.name="SignedDataVerifyError",this.date=t,this.code=e,this.timestampSerial=u,this.signatureVerified=i,this.signerCertificate=a,this.signerCertificateVerified=o,this.certificatePath=h}}let tm=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,oa,s.defaultValues(oa)),this.digestAlgorithms=c(e,Il,s.defaultValues(Il)),this.encapContentInfo=c(e,Bl,s.defaultValues(Bl)),la in e&&(this.certificates=c(e,la,s.defaultValues(la))),ca in e&&(this.crls=c(e,ca,s.defaultValues(ca))),Tl in e&&(this.ocsps=c(e,Tl,s.defaultValues(Tl))),this.signerInfos=c(e,Rl,s.defaultValues(Rl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case oa:return 0;case Il:return[];case Bl:return new ea;case la:case ca:case Tl:case Rl:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case oa:return t===s.defaultValues(oa);case Bl:return ea.compareWithDefault("eContentType",t.eContentType)&&ea.compareWithDefault("eContent",t.eContent);case Il:case la:case ca:case Tl:case Rl:return 0===t.length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return void 0===t.optional&&(t.optional=!1),new U({name:t.blockName||Tr,optional:t.optional,value:[new Q({name:t.version||Jh}),new kt({value:[new Ke({name:t.digestAlgorithms||Yc,value:Z.schema()})]}),ea.schema(t.encapContentInfo||{names:{blockName:qh}}),new z({name:t.certificates||Xc,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:gn.schema().valueBlock.value}),new z({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Sc.schema(t.crls||{names:{crls:Qc}}).valueBlock.value}),new kt({value:[new Ke({name:t.signerInfos||Zc,value:Fh.schema()})]})]})}fromSchema(e){ne(e,jv);const t=de(e,e,s.schema());if(le.assertSchema(t,this.className),this.version=t.result[Jh].valueBlock.valueDec,Yc in t.result&&(this.digestAlgorithms=Array.from(t.result[Yc],i=>new Z({schema:i}))),this.encapContentInfo=new ea({schema:t.result[qh]}),Xc in t.result){const i=new gn({schema:new kt({value:t.result[Xc].valueBlock.value})});this.certificates=i.certificates.slice(0)}Qc in t.result&&(this.crls=Array.from(t.result[Qc],i=>1===i.idBlock.tagClass?new vc({schema:i}):(i.idBlock.tagClass=1,i.idBlock.tagNumber=16,new yc({schema:i})))),Zc in t.result&&(this.signerInfos=Array.from(t.result[Zc],i=>new Fh({schema:i})))}toSchema(e=!1){const t=[];if(this.version=this.certificates&&this.certificates.length&&this.certificates.some(i=>i instanceof ei)||this.crls&&this.crls.length&&this.crls.some(i=>i instanceof yc)?5:this.certificates&&this.certificates.length&&this.certificates.some(i=>i instanceof er)?4:this.certificates&&this.certificates.length&&this.certificates.some(i=>i instanceof Fu)||this.signerInfos.some(i=>3===i.version)||this.encapContentInfo.eContentType!==s.ID_DATA?3:1,t.push(new Q({value:this.version})),t.push(new kt({value:Array.from(this.digestAlgorithms,i=>i.toSchema())})),t.push(this.encapContentInfo.toSchema()),this.certificates){const a=new gn({certificates:this.certificates}).toSchema();t.push(new z({idBlock:{tagClass:3,tagNumber:0},value:a.valueBlock.value}))}return this.crls&&t.push(new z({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.crls,i=>{if(i instanceof yc){const a=i.toSchema();return a.idBlock.tagClass=3,a.idBlock.tagNumber=1,a}return i.toSchema(e)})})),t.push(new kt({value:Array.from(this.signerInfos,i=>i.toSchema())})),new U({value:t})}toJSON(){const e={version:this.version,digestAlgorithms:Array.from(this.digestAlgorithms,t=>t.toJSON()),encapContentInfo:this.encapContentInfo.toJSON(),signerInfos:Array.from(this.signerInfos,t=>t.toJSON())};return this.certificates&&(e.certificates=Array.from(this.certificates,t=>t.toJSON())),this.crls&&(e.crls=Array.from(this.crls,t=>t.toJSON())),e}verify({signer:e=-1,data:t=Nt,trustedCerts:i=[],checkDate:a=new Date,checkChain:o=!1,passedWhenNotRevValues:u=!1,extendedMode:h=!1,findOrigin:g=null,findIssuer:N=null}={},x=Ge(!0)){var G=this;return(0,E.A)(function*(){let H=null,re=null;try{let Ae=Nt,we=w,ie=[];const ye=G.signerInfos[e];if(!ye)throw new Ot({date:a,code:1,message:"Unable to get signer by supplied index"});if(!G.certificates)throw new Ot({date:a,code:2,message:"No certificates attached to this signed data"});if(ye.sid instanceof Vt){for(const be of G.certificates)if(be instanceof zt&&be.issuer.isEqual(ye.sid.issuer)&&be.serialNumber.isEqual(ye.sid.serialNumber)){H=be;break}}else{const be=ye.sid,Be=be.idBlock.isConstructed?be.valueBlock.value[0].valueBlock.valueHex:be.valueBlock.valueHex;for(const xe of G.certificates)if(xe instanceof zt&&W(yield x.digest({name:"sha-1"},xe.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView),Be)){H=xe;break}}if(!H)throw new Ot({date:a,code:3,message:"Unable to find signer certificate"});if("1.2.840.113549.1.9.16.1.4"===G.encapContentInfo.eContentType){if(!G.encapContentInfo.eContent)throw new Ot({date:a,code:15,message:"Error during verification: TSTInfo eContent is empty",signatureVerified:null,signerCertificate:H,timestampSerial:re,signerCertificateVerified:!0});let be;try{be=Hv.fromBER(G.encapContentInfo.eContent.valueBlock.valueHexView)}catch{throw new Ot({date:a,code:15,message:"Error during verification: TSTInfo wrong ASN.1 schema ",signatureVerified:null,signerCertificate:H,timestampSerial:re,signerCertificateVerified:!0})}if(a=be.genTime,re=be.serialNumber.valueBlock.valueHexView.slice(),0===t.byteLength)throw new Ot({date:a,code:4,message:"Missed detached data input array"});if(!(yield be.verify({data:t},x)))throw new Ot({date:a,code:15,message:"Error during verification: TSTInfo verification is failed",signatureVerified:!1,signerCertificate:H,timestampSerial:re,signerCertificateVerified:!0})}if(o){const be=G.certificates.filter(We=>We instanceof zt&&!!Jf(We,H)),Be={checkDate:a,certs:be,trustedCerts:i};N&&(Be.findIssuer=N),g&&(Be.findOrigin=g);const xe=new Mc(Be);if(xe.certs.push(H),G.crls)for(const We of G.crls)"thisUpdate"in We?xe.crls.push(We):"1.3.6.1.5.5.7.48.1.1"===We.otherRevInfoFormat&&xe.ocsps.push(new kv({schema:We.otherRevInfo}));G.ocsps&&xe.ocsps.push(...G.ocsps);const Ue=yield xe.verify({passedWhenNotRevValues:u},x).catch(We=>{throw new Ot({date:a,code:5,message:`Validation of signer's certificate failed with error: ${We instanceof Object?We.resultMessage:We}`,signerCertificate:H,signerCertificateVerified:!1})});if(Ue.certificatePath&&(ie=Ue.certificatePath),!Ue.result)throw new Ot({date:a,code:5,message:`Validation of signer's certificate failed: ${Ue.resultMessage}`,signerCertificate:H,signerCertificateVerified:!1})}const oe=x.getAlgorithmByOID(ye.digestAlgorithm.algorithmId);if(!("name"in oe))throw new Ot({date:a,code:7,message:`Unsupported signature algorithm: ${ye.digestAlgorithm.algorithmId}`,signerCertificate:H,signerCertificateVerified:!0});we=oe.name;const ce=G.encapContentInfo.eContent;if(ce)t=1===ce.idBlock.tagClass&&4===ce.idBlock.tagNumber?ce.getValue():ce.valueBlock.valueBeforeDecodeView;else if(0===t.byteLength)throw new Ot({date:a,code:8,message:"Missed detached data input array",signerCertificate:H,signerCertificateVerified:!0});if(ye.signedAttrs){let be=!1,Be=!1;for(const xe of ye.signedAttrs.attributes)if("1.2.840.113549.1.9.3"===xe.type&&(be=!0),"1.2.840.113549.1.9.4"===xe.type&&(Be=!0,Ae=xe.values[0].valueBlock.valueHex),be&&Be)break;if(!1===be)throw new Ot({date:a,code:9,message:'Attribute "content-type" is a mandatory attribute for "signed attributes"',signerCertificate:H,signerCertificateVerified:!0});if(!1===Be)throw new Ot({date:a,code:10,message:'Attribute "message-digest" is a mandatory attribute for "signed attributes"',signatureVerified:null,signerCertificate:H,signerCertificateVerified:!0})}if(ye.signedAttrs){if(!W(yield x.digest(we,new Uint8Array(t)),Ae))throw new Ot({date:a,code:15,message:"Error during verification: Message digest doesn't match",signatureVerified:null,signerCertificate:H,timestampSerial:re,signerCertificateVerified:!0});t=ye.signedAttrs.encodedValue}const pe="1.2.840.113549.1.1.1"===ye.signatureAlgorithm.algorithmId?yield x.verifyWithPublicKey(t,ye.signature,H.subjectPublicKeyInfo,ye.signatureAlgorithm,we):yield x.verifyWithPublicKey(t,ye.signature,H.subjectPublicKeyInfo,ye.signatureAlgorithm);return h?{date:a,code:14,message:w,signatureVerified:pe,signerCertificate:H,timestampSerial:re,signerCertificateVerified:!0,certificatePath:ie}:pe}catch(Ae){throw Ae instanceof Ot?Ae:new Ot({date:a,code:15,message:`Error during verification: ${Ae instanceof Error?Ae.message:Ae}`,signatureVerified:null,signerCertificate:H,timestampSerial:re,signerCertificateVerified:!0})}})()}sign(e,t,i="SHA-1",a=Nt,o=Ge(!0)){var u=this;return(0,E.A)(function*(){var h;if(!e)throw new Error("Need to provide a private key for signing");const g=u.signerInfos[t];if(!g)throw new RangeError("SignerInfo index is out of range");(null===(h=g.signedAttrs)||void 0===h||!h.attributes.length)&&"hash"in e.algorithm&&"hash"in e.algorithm&&e.algorithm.hash&&(i=e.algorithm.hash.name);const N=o.getOIDByAlgorithm({name:i},!0,"hashAlgorithm");0===u.digestAlgorithms.filter(re=>re.algorithmId===N).length&&u.digestAlgorithms.push(new Z({algorithmId:N,algorithmParams:new At})),g.digestAlgorithm=new Z({algorithmId:N,algorithmParams:new At});const x=yield o.getSignatureParameters(e,i),G=x.parameters;if(g.signatureAlgorithm=x.signatureAlgorithm,g.signedAttrs)0!==g.signedAttrs.encodedValue.byteLength?a=g.signedAttrs.encodedValue:(a=g.signedAttrs.toSchema().toBER(),L._H.toUint8Array(a)[0]=49);else{const re=u.encapContentInfo.eContent;if(re)a=1===re.idBlock.tagClass&&4===re.idBlock.tagNumber?re.getValue():re.valueBlock.valueBeforeDecodeView;else if(0===a.byteLength)throw new Error("Missed detached data input array")}const H=yield o.signWithPrivateKey(a,e,G);g.signature=new me({valueHex:H})})()}}return s.CLASS_NAME="SignedData",s.ID_DATA=Au,s})();const xr="version",Vr="authSafe",As="macData",xl="parsedValue",$v=[xr,Vr,As];let Kv=(()=>{class s extends fe{constructor(e={}){super(),this.version=c(e,xr,s.defaultValues(xr)),this.authSafe=c(e,Vr,s.defaultValues(Vr)),As in e&&(this.macData=c(e,As,s.defaultValues(As))),xl in e&&(this.parsedValue=c(e,xl,s.defaultValues(xl))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xr:return 3;case Vr:return new Lt;case As:return new Er;case xl:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case xr:return t===s.defaultValues(e);case Vr:return Lt.compareWithDefault("contentType",t.contentType)&&Lt.compareWithDefault("content",t.content);case As:return Er.compareWithDefault("mac",t.mac)&&Er.compareWithDefault("macSalt",t.macSalt)&&Er.compareWithDefault("iterations",t.iterations);case xl:return t instanceof Object&&0===Object.keys(t).length;default:return super.defaultValues(e)}}static schema(e={}){const t=c(e,"names",{});return new U({name:t.blockName||w,value:[new Q({name:t.version||xr}),Lt.schema(t.authSafe||{names:{blockName:Vr}}),Er.schema(t.macData||{names:{blockName:As,optional:!0}})]})}fromSchema(e){ne(e,$v);const t=de(e,e,s.schema({names:{version:xr,authSafe:{names:{blockName:Vr}},macData:{names:{blockName:As}}}}));le.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.authSafe=new Lt({schema:t.result.authSafe}),As in t.result&&(this.macData=new Er({schema:t.result.macData}))}toSchema(){const e=[new Q({value:this.version}),this.authSafe.toSchema()];return this.macData&&e.push(this.macData.toSchema()),new U({value:e})}toJSON(){const e={version:this.version,authSafe:this.authSafe.toJSON()};return this.macData&&(e.macData=this.macData.toJSON()),e}makeInternalValues(e={},t=Ge(!0)){var i=this;return(0,E.A)(function*(){if(ot.assert(e,"parameters","object"),!i.parsedValue)throw new Error('Please call "parseValues" function first in order to make "parsedValue" data');switch(st.assertEmpty(i.parsedValue.integrityMode,"integrityMode","parsedValue"),st.assertEmpty(i.parsedValue.authenticatedSafe,"authenticatedSafe","parsedValue"),i.parsedValue.integrityMode){case 0:{if(!("iterations"in e))throw new st("iterations");st.assertEmpty(e.pbkdf2HashAlgorithm,"pbkdf2HashAlgorithm"),st.assertEmpty(e.hmacHashAlgorithm,"hmacHashAlgorithm"),st.assertEmpty(e.password,"password");const a=new ArrayBuffer(64),o=new Uint8Array(a);t.getRandomValues(o);const u=i.parsedValue.authenticatedSafe.toSchema().toBER(!1);i.authSafe=new Lt({contentType:Lt.DATA,content:new me({valueHex:u})});const h=yield t.stampDataWithPassword({password:e.password,hashAlgorithm:e.hmacHashAlgorithm,salt:a,iterationCount:e.iterations,contentToStamp:u});i.macData=new Er({mac:new Qn({digestAlgorithm:new Z({algorithmId:t.getOIDByAlgorithm({name:e.hmacHashAlgorithm},!0,"hmacHashAlgorithm")}),digest:new me({valueHex:h})}),macSalt:new me({valueHex:a}),iterations:e.iterations})}break;case 1:{if(!("signingCertificate"in e))throw new st("signingCertificate");st.assertEmpty(e.privateKey,"privateKey"),st.assertEmpty(e.hashAlgorithm,"hashAlgorithm");const a=i.parsedValue.authenticatedSafe.toSchema().toBER(!1),o=new tm({version:1,encapContentInfo:new ea({eContentType:"1.2.840.113549.1.7.1",eContent:new me({valueHex:a})}),certificates:[e.signingCertificate]}),u=yield t.digest({name:e.hashAlgorithm},new Uint8Array(a)),h=[];h.push(new it({type:"1.2.840.113549.1.9.3",values:[new Ve({value:"1.2.840.113549.1.7.1"})]})),h.push(new it({type:"1.2.840.113549.1.9.5",values:[new Lr({valueDate:new Date})]})),h.push(new it({type:"1.2.840.113549.1.9.4",values:[new me({valueHex:u})]})),o.signerInfos.push(new Fh({version:1,sid:new Vt({issuer:e.signingCertificate.issuer,serialNumber:e.signingCertificate.serialNumber}),signedAttrs:new $t({type:0,attributes:h})})),yield o.sign(e.privateKey,0,e.hashAlgorithm,void 0,t),i.authSafe=new Lt({contentType:"1.2.840.113549.1.7.2",content:o.toSchema(!0)})}break;default:throw new Error(`Parameter "integrityMode" has unknown value: ${i.parsedValue.integrityMode}`)}})()}parseInternalValues(e,t=Ge(!0)){var i=this;return(0,E.A)(function*(){switch(ot.assert(e,"parameters","object"),void 0===e.checkIntegrity&&(e.checkIntegrity=!0),i.parsedValue={},i.authSafe.contentType){case Lt.DATA:{st.assertEmpty(e.password,"password"),i.parsedValue.integrityMode=0,ot.assert(i.authSafe.content,"authSafe.content",me);const a=i.authSafe.content.getValue();if(i.parsedValue.authenticatedSafe=ph.fromBER(a),e.checkIntegrity){if(!i.macData)throw new Error('Absent "macData" value, can not check PKCS#12 data integrity');const o=t.getAlgorithmByOID(i.macData.mac.digestAlgorithm.algorithmId,!0,"digestAlgorithm");if(!(yield t.verifyDataStampedWithPassword({password:e.password,hashAlgorithm:o.name,salt:L._H.toArrayBuffer(i.macData.macSalt.valueBlock.valueHexView),iterationCount:i.macData.iterations||1,contentToVerify:a,signatureToVerify:L._H.toArrayBuffer(i.macData.mac.digest.valueBlock.valueHexView)})))throw new Error("Integrity for the PKCS#12 data is broken!")}}break;case Lt.SIGNED_DATA:{i.parsedValue.integrityMode=1;const a=new tm({schema:i.authSafe.content}),o=a.encapContentInfo.eContent;st.assert(o,"eContent","cmsSigned.encapContentInfo"),ot.assert(o,"eContent",me);const u=o.getValue();if(i.parsedValue.authenticatedSafe=ph.fromBER(u),!(yield a.verify({signer:0,checkChain:!1},t)))throw new Error("Integrity for the PKCS#12 data is broken!")}break;default:throw new Error(`Incorrect value for "this.authSafe.contentType": ${i.authSafe.contentType}`)}})()}}return s.CLASS_NAME="PFX",s})();!function lw(){if(typeof self<"u"){if("crypto"in self){let s="webcrypto";"webkitSubtle"in self.crypto&&(s="safari"),xf(s,new Wl({name:s,crypto}))}}else if(typeof crypto<"u"&&"webcrypto"in crypto){const s="NodeJS ^15",r=crypto.webcrypto;xf(s,new Wl({name:s,crypto:r}))}}();const cw=function(){var s=(0,E.A)(function*(r,e,t,i,a,o){try{const u={name:"ECDSA",namedCurve:"P-384",typedCurve:""},h=yield crypto.subtle.generateKey(u,!0,["sign","verify"]),g=new Cv;g.subject.typesAndValues.push(new pu({type:"2.5.4.3",value:new Jt({value:"Test"})})),yield g.subjectPublicKeyInfo.importKey(h.publicKey),yield g.sign(h.privateKey,"SHA-384");const N=g.toSchema().toBER(!1),x=Vl(N,"CERTIFICATE REQUEST"),G=yield new Promise((we,ie)=>{r.issueNewCertificate(x,e,t,i).subscribe(ye=>{},ye=>{201===ye.status?we(ye.error.text):(console.error("Error when trying to issue new certificate:",ye.error.message),ie(ye))})}),H=yield crypto.subtle.exportKey("pkcs8",h.privateKey),re=yield crypto.subtle.exportKey("spki",h.publicKey),Ae=new Xr({schema:Et(H).result});if(a){const ie=uw(G).map(ce=>new zt({schema:Et(ce).result})),ye=hw(),oe=yield dw(Ae,ie,ye);return{certificate:G,publicKey:Vl(re,"PUBLIC KEY"),privateKey:Vl(H,"PRIVATE KEY"),pkcs12Keystore:oe,keystorePassword:ye}}return{certificate:G,publicKey:Vl(re,"PUBLIC KEY"),privateKey:Vl(H,"PRIVATE KEY")}}catch(u){return void console.error("Error while issuing new certificate:",u)}});return function(e,t,i,a,o,u){return s.apply(this,arguments)}}(),Vl=(s,r)=>{let e=L.U$.ToBase64(s),t="";for(;e.length>0;)t+=e.substring(0,64)+"\n",e=e.substring(64);return`-----BEGIN ${r}-----\n${t}-----END ${r}-----\n`},uw=s=>{let r=s.split(/-----END CERTIFICATE-----/);return r=r.slice(0,r.length-1),r.map(t=>t.split(/-----BEGIN CERTIFICATE-----/)[1].replace(/\n/gm,"")).map(t=>L.U$.FromBase64(t))},hw=()=>{const r=new Uint32Array(26);crypto.getRandomValues(r);let e="";for(const t of r)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_^$#&!%"[t%70];return e},dw=function(){var s=(0,E.A)(function*(r,e,t){const i=new ArrayBuffer(4);Iu(new Uint8Array(i));const o=new ArrayBuffer(4);Iu(new Uint8Array(o));const h=new ArrayBuffer(4);Iu(new Uint8Array(h));const N=new ArrayBuffer(1);new Uint8Array(N)[0]|=128;const G=new et({valueHex:N,unusedBits:7});r.attributes=[new it({type:"2.5.29.15",values:[G]})];let H="";e[0].subject.typesAndValues.forEach(ie=>{"2.5.4.3"===ie.type&&(H=ie.value.valueBlock.value)});let re="";e[1].subject.typesAndValues.forEach(ie=>{"2.5.4.3"===ie.type&&(re=ie.value.valueBlock.value)});const Ae=new Kv({parsedValue:{integrityMode:0,authenticatedSafe:new ph({parsedValue:{safeContents:[{privacyMode:0,value:new ar({safeBags:[new Wo({bagId:"1.2.840.113549.1.12.10.1.2",bagValue:new qf({parsedValue:r}),bagAttributes:[new it({type:"1.2.840.113549.1.9.20",values:[new Xt({value:"PKCS8ShroudedKeyBag from PKIjs"})]}),new it({type:"1.2.840.113549.1.9.21",values:[new me({valueHex:i})]}),new it({type:"1.3.6.1.4.1.311.17.1",values:[new Xt({value:"MCP using https://pkijs.org/"})]})]})]})},{privacyMode:1,value:new ar({safeBags:[new Wo({bagId:"1.2.840.113549.1.12.10.1.3",bagValue:new Zu({parsedValue:e[0]}),bagAttributes:[new it({type:"1.2.840.113549.1.9.20",values:[new Xt({value:H})]}),new it({type:"1.2.840.113549.1.9.21",values:[new me({valueHex:o})]}),new it({type:"1.3.6.1.4.1.311.17.1",values:[new Xt({value:"MCP using https://pkijs.org/"})]})]}),new Wo({bagId:"1.2.840.113549.1.12.10.1.3",bagValue:new Zu({parsedValue:e[1]}),bagAttributes:[new it({type:"1.2.840.113549.1.9.20",values:[new Xt({value:re})]}),new it({type:"1.2.840.113549.1.9.21",values:[new me({valueHex:h})]}),new it({type:"1.3.6.1.4.1.311.17.1",values:[new Xt({value:"MCP using https://pkijs.org/"})]})]})]})}]}})}}),we=_e(t);return yield Ae.parsedValue.authenticatedSafe.parsedValue.safeContents[0].value.safeBags[0].bagValue.makeInternalValues({password:we,contentEncryptionAlgorithm:{name:"AES-CBC",length:128},hmacHashAlgorithm:"SHA-1",iterationCount:1e5}),yield Ae.parsedValue.authenticatedSafe.makeInternalValues({safeContents:[{},{password:we,contentEncryptionAlgorithm:{name:"AES-CBC",length:128},hmacHashAlgorithm:"SHA-1",iterationCount:1e5}]}),yield Ae.makeInternalValues({password:we,iterations:1e5,pbkdf2HashAlgorithm:"SHA-256",hmacHashAlgorithm:"SHA-256"}),Ae.toSchema().toBER(!1)});return function(e,t,i){return s.apply(this,arguments)}}();var Or=$(5004),os=$(7277);const im=s=>{switch(s){case os.q.RevocationReasonEnum.Aacompromise:return{value:s,title:"AA compromised",description:"This reason indicates that it is known or suspected that the certificate subject's private key has been compromised. It applies to authority attribute (AA) certificates only.",reference:"https://docs.oracle.com/javase/8/docs/api/java/security/cert/CRLReason.html"};case os.q.RevocationReasonEnum.Affiliationchanged:return{value:s,title:"Affiliation changed",description:"The user has terminated his or her relationship with the organization indicated in the Distinguished Name attribute of the certificate. This revocation code is typically used when an individual is terminated or has resigned from an organization. You do not have to revoke a certificate when a user changes departments, unless your security policy requires different certificate be issued by a departmental CA.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Cacompromise:return{value:s,title:"CA compromised",description:"The token or disk location where the CA's private key is stored has been compromised and is in the possession of an unauthorized individual. When a CA's private key is revoked, this results in all certificates issued by the CA that are signed using the private key associated with the revoked certificate being considered revoked.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Certificatehold:return{value:s,title:"Certificate Hold",description:"A temporary revocation that indicates that a CA will not vouch for a certificate at a specific point in time. Once a certificate is revoked with a CertificateHold reason code, the certificate can then be revoked with another Reason Code, or unrevoked and returned to use.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Cessationofoperation:return{value:s,title:"Cessation of Operation",description:"If a CA is decommissioned, no longer to be used, the CA's certificate should be revoked with this reason code. Do not revoke the CA's certificate if the CA no longer issues new certificates, yet still publishes CRLs for the currently issued certificates.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Keycompromise:return{value:s,title:"Key compromised",description:"The token or disk location where the private key associated with the certificate has been compromised and is in the possession of an unauthorized individual. This can include the case where a laptop is stolen, or a smart card is lost.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Privilegewithdrawn:return{value:s,title:"Privilege withdrawn",description:"A certificate (public-key or attribute certificate) was revoked because a privilege contained within that certificate has been withdrawn",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Removefromcrl:return{value:s,title:"Remove from CRL",description:'If a certificate is revoked with the CertificateHold reason code, it is possible to "unrevoke" a certificate. The unrevoking process still lists the certificate in the CRL, but with the reason code set to RemoveFromCRL.',reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};case os.q.RevocationReasonEnum.Superseded:return{value:s,title:"Superseded",description:"A replacement certificate has been issued to a user, and the reason does not fall under the previous reasons. This revocation reason is typically used when a smart card fails, the password for a token is forgotten by a user, or the user has changed their legal name.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"};default:return{value:s,title:"Unspecified",description:"It is possible to revoke a certificate without providing a specific reason code. While it is possible to revoke a certificate with the Unspecified reason code, this is not recommended, as it does not provide an audit trail as to why a certificate is revoked.",reference:"https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc700843(v=technet.10)?redirectedfrom=MSDN#revocation-reasons"}}};var fw=$(1224),rm=$(698),mw=$(3830),gw=$(8168);let pw=(()=>{class s{constructor(e,t,i,a,o,u){this.organizationsService=e,this.devicesService=t,this.servicesService=i,this.usersService=a,this.vesselsService=o,this.mmsService=u}ngOnInit(){}formatCerts(e){let t=[];for(const i in e){const a=e[i];for(const o in a)e[i][o]=a[o];a.revoked&&(a.revokeInfo=a.revokedAt,a.revokeReasonText=im(a.revokeReason).title),t.push(a)}return t}splitByRevokeStatus(e){let t=[],i=[];for(const a in e){const o=e[a];o.revoked?i.push(o):t.push(o)}return t.sort((a,o)=>a.end-o.end),i.sort((a,o)=>a.end-o.end),{activeCertificates:this.formatCerts(t),revokedCertificates:this.formatCerts(i)}}issueNewCertificate(e,t,i,a){if(null==t||!i)throw new Error("Internal state lost");switch(t){case l.SP.Organization:return this.organizationsService.newOrgCertFromCsr(e,i);case l.SP.Device:return this.devicesService.newDeviceCertFromCsr(e,a,i);case l.SP.Service:return this.servicesService.newServiceCertFromCsr1(e,a,i);case l.SP.User:return this.usersService.newUserCertFromCsr(e,a,i);case l.SP.Vessel:return this.vesselsService.newVesselCertFromCsr(e,a,i);case l.SP.MMS:return this.mmsService.newMMSCertFromCsr(e,a,i);default:throw new Error("Unknown item type")}}revokeCertificate(e,t,i,a,o,u){if(null==e||!t)throw new Error("Internal state lost");switch(e){case l.SP.Organization:return this.organizationsService.revokeOrgCert(o,t,a);case l.SP.Device:return this.devicesService.revokeDeviceCert(o,i,t,a);case l.SP.Service:return u?this.servicesService.revokeServiceCert(o,i,t,u,a):this.servicesService.revokeServiceCert1(o,i,t,a);case l.SP.User:return this.usersService.revokeUserCert(o,i,t,a);case l.SP.Vessel:return this.vesselsService.revokeVesselCert(o,i,t,a);case l.SP.MMS:return this.mmsService.revokeMMSCert(o,i,t,a);default:throw new Error("Unknown item type")}}static#e=this.\u0275fac=function(t){return new(t||s)(n.KVO(Or.PZ),n.KVO(Or.SV),n.KVO(Or.dd),n.KVO(Or.Tz),n.KVO(Or.YY),n.KVO(Or.tZ))};static#t=this.\u0275prov=n.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var nm=$(9380),vw=$(5189),zh=$(5540),ww=$(8721);let yw=(()=>{class s{constructor(e){this.translate=e}downloadPemCertificate(e,t,i){try{const a=t.split(" ").join("_"),o=new ww;o.file("Certificate_"+a+".pem",e.certificate),e.privateKey&&o.file("PrivateKey_"+a+".pem",e.privateKey),e.publicKey&&o.file("PublicKey_"+a+".pem",e.publicKey),e.pkcs12Keystore&&o.file("Keystore_"+a+".p12",e.pkcs12Keystore),e.keystorePassword&&o.file("KeystorePassword_"+a+".txt",e.keystorePassword),o.generateAsync({type:"blob"}).then(function(u){zh.saveAs(u,"Certificate_"+a+".zip")})}catch(a){i.notify("error",this.translate.instant("error.file.downloadcert")+a)}}downloadXml(e,t){e?this.downloadFile(e.content,e.contentContentType,e.name,t):t.notify("error",this.translate.instant("error.file.empty"))}downloadDoc(e,t){if(!e)return void t.notify("error",this.translate.instant("error.file.empty"));if(e.filecontent.length>1&&e.filecontent.length<10)return void t.notify("error",this.translate.instant("error.file.wrongformat")+e.name);let i=e.filecontent.toString();this.downloadBase64File(i,e.filecontentContentType,e.name,t)}downloadBase64File(e,t,i,a){try{let o=this.convertBase64ToByteArray(e),u=new Blob([o],{type:t});zh.saveAs(u,i)}catch(o){a.notify("error",this.translate.instant("error.file.downloaderror")+o)}}downloadFile(e,t,i,a){try{let o=new Blob([e],{type:t});zh.saveAs(o,i)}catch(o){a.notify("error",this.translate.instant("error.file.downloaderror")+o)}}convertBase64ToByteArray(e){let t=window.atob(e),i=new Array(t.length);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return new Uint8Array(i)}static#e=this.\u0275fac=function(t){return new(t||s)(n.KVO(nm.c$))};static#t=this.\u0275prov=n.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var Sw=$(6482);const bw=["certModal"],Aw=["revokeModal"],kw=["migrateModal"];function Ew(s,r){1&s&&n.EFF(0," Organization details ")}function _w(s,r){if(1&s&&n.EFF(0),2&s){const e=n.XpG();n.SpI(" ",e.capitalize(e.itemType)," details ")}}function Cw(s,r){if(1&s&&(n.j41(0,"span",40),n.EFF(1),n.k0s()),2&s){const e=n.XpG(2).$implicit,t=n.XpG();n.xc7("width",400,"px"),n.R7$(),n.JRh(t.convertTimeString(t.item[e.key]))}}function Nw(s,r){if(1&s&&(n.j41(0,"span",40),n.EFF(1),n.k0s()),2&s){const e=n.XpG(2).$implicit,t=n.XpG();n.xc7("width",400,"px"),n.R7$(),n.JRh(t.item[e.key])}}function Iw(s,r){if(1&s&&n.DNE(0,Cw,2,3,"span",39)(1,Nw,2,3,"span",39),2&s){const e=n.XpG().$implicit,t=n.XpG();n.vxM(t.isTimestampFormat(e.key)?0:1)}}function Bw(s,r){1&s&&n.nrm(0,"span",40),2&s&&n.xc7("width",400,"px")}function Rw(s,r){if(1&s&&(n.j41(0,"div",36)(1,"label",37),n.EFF(2),n.k0s(),n.j41(3,"div",38)(4,"div",32),n.DNE(5,Iw,2,1)(6,Bw,1,2,"span",39),n.k0s()()()),2&s){const e=r.$implicit,t=n.XpG();n.R7$(2),n.JRh(e.value.title),n.R7$(3),n.vxM(t.item[e.key]?5:6)}}function Tw(s,r){if(1&s){const e=n.RV6();n.j41(0,"div",36)(1,"label",41),n.EFF(2,"Active certificates"),n.k0s(),n.j41(3,"div",5)(4,"app-cert-table",42),n.bIt("onAdd",function(){n.eBV(e);const i=n.XpG();return n.Njj(i.openCertModal())})("onDownload",function(i){n.eBV(e);const a=n.XpG();return n.Njj(a.clickDownloadBtn(i))})("onRevoke",function(i){n.eBV(e);const a=n.XpG();return n.Njj(a.clickRevokeBtn(i))}),n.k0s()()(),n.j41(5,"div",36)(6,"label",41),n.EFF(7,"Revoked certificates"),n.k0s(),n.j41(8,"div",5),n.nrm(9,"app-cert-table",43),n.k0s()()}if(2&s){const e=n.XpG();n.R7$(4),n.Y8G("data",e.activeCertificates)("serial",e.serial),n.R7$(5),n.Y8G("data",e.revokedCertificates)}}function xw(s,r){if(1&s&&n.nrm(0,"app-item-form",12,3),2&s){const e=n.XpG();n.Y8G("isForNew",!0)("itemType",e.userItemType)("item",e.adminUser)("mrnPrefix",e.adminUserMrnPrefix)}}function Vw(s,r){if(1&s){const e=n.RV6();n.j41(0,"button",44),n.bIt("click",function(){n.eBV(e);const i=n.XpG();return n.Njj(i.clickMigrateBtn())}),n.EFF(1,"Migrate"),n.k0s()}}function Ow(s,r){if(1&s){const e=n.RV6();n.j41(0,"button",45),n.bIt("click",function(){n.eBV(e);const i=n.XpG();return n.Njj(i.approve())}),n.EFF(1,"Approve"),n.k0s()}}function Pw(s,r){if(1&s){const e=n.RV6();n.j41(0,"button",44),n.bIt("click",function(){n.eBV(e);const i=n.XpG();return n.Njj(i.edit())}),n.EFF(1,"Edit"),n.k0s()}}function Dw(s,r){1&s&&(n.j41(0,"div",21)(1,"p"),n.EFF(2,"Here is your certificate bundle. You can download it by clicking the button below."),n.k0s()())}function Uw(s,r){if(1&s&&(n.j41(0,"h3",18),n.EFF(1),n.k0s()),2&s){const e=n.XpG();n.R7$(),n.SpI("Revoke ",e.selectedActiveCerts.length," certificates")}}function Mw(s,r){if(1&s&&(n.j41(0,"h3",18),n.EFF(1),n.k0s()),2&s){const e=n.XpG();n.R7$(),n.SpI("Revoke ",e.selectedActiveCerts.length," certificate")}}function Lw(s,r){if(1&s){const e=n.RV6();n.j41(0,"clr-radio-wrapper")(1,"input",46),n.bIt("click",function(){const i=n.eBV(e).$implicit,a=n.XpG();return n.Njj(a.revokeReason=i)}),n.k0s(),n.j41(2,"label"),n.EFF(3),n.k0s()()}if(2&s){const e=r.$implicit;n.R7$(3),n.JRh(e.title)}}function Fw(s,r){if(1&s&&(n.j41(0,"div")(1,"span"),n.EFF(2),n.k0s()(),n.j41(3,"div")(4,"a",47),n.EFF(5,"More info"),n.k0s()()),2&s){const e=n.XpG();n.R7$(2),n.JRh(e.revokeReason.description),n.R7$(2),n.Y8G("href",e.revokeReason.reference,n.B4B)}}function Hw(s,r){1&s&&(n.j41(0,"div")(1,"span"),n.EFF(2,"Select reason name"),n.k0s()())}let jw=(()=>{class s{constructor(e,t,i,a,o,u){this.certificateService=e,this.translate=t,this.notifier=i,this.fileHelper=a,this.locale=u,this.itemType=l.SP.None,this.item={},this.orgMrn="",this.mrnPrefix="urn:mrn:",this.instanceVersion=void 0,this.serial=void 0,this.onEdit=new n.bkB,this.onMigrate=new n.bkB,this.onDelete=new n.bkB,this.onRefresh=new n.bkB,this.onApprove=new n.bkB,this.onDownloadCert=new n.bkB,this.viewContext="detail",this.columnForMenu={},this.itemId="",this.activeCertificates=[],this.revokedCertificates=[],this.revokeModalOpened=!1,this.certModalOpened=!1,this.fromBrowser=!0,this.revokeReason=void 0,this.revokeReasons=[],this.selectedActiveCerts=[],this.revokeAt=void 0,this.reasonTitle="",this.certificateBundle=void 0,this.migrateModalOpened=!1,this.newServiceMrn="",this.userItemType=l.SP.User,this.adminUser={permissions:gw.s},this.adminUserMrnPrefix="urn:mrn:mcp:",this.setForm=()=>{Object.entries(b.Y[this.itemType.toString()]).map(([h,g])=>{g.visibleFrom&&(g.visibleFrom&&!g.visibleFrom.includes(this.viewContext)||(this.columnForMenu[h]=g))})},this.assignCertificatesByStatus=h=>{this.activeCertificates=[],this.revokedCertificates=[],h.sort((g,N)=>g.start<N.start?1:-1),h.map(g=>{g.revoked?this.revokedCertificates.push(g):this.activeCertificates.push(g)}),this.revokedCertificates=this.updateRevokeReason(this.revokedCertificates)},this.updateRevokeReason=h=>h.map(g=>({...g,revokeReason:this.revokeReasons.filter(N=>N.value===g.revokeReason)[0].title})),this.sortColumnForMenu=(h,g)=>((s,r)=>s.order>r.order?-1:1)(h,g),this.edit=()=>{this.onEdit.emit(this.item)},this.migrate=()=>{this.onMigrate.emit(this.newServiceMrn)},this.approve=()=>{this.newAdminUserForm?.isValid()&&(this.adminUser=this.newAdminUserForm?.getFormValue(),this.onApprove.emit({...this.item,adminUser:this.adminUser}))},this.deleteItem=()=>{this.onDelete.emit(this.item)},this.convertTimeString=h=>(0,m.t)(h),this.openCertModal=()=>{this.itemType===l.SP.Service&&this.instanceVersion?this.notifier.notify("error",this.translate.instant("error.form.requiremigrate")):(this.certModal?.open(),this.certModalOpened=!0,this.issue())},this.issue=()=>{cw(this.certificateService,this.itemType,this.itemId,this.orgMrn,this.fromBrowser,this.instanceVersion).then(h=>{this.certificateBundle=h,this.notifier.notify("success",this.translate.instant("success.resource.create"))})},this.revokeCerts=h=>{this.revokeAt=new Date(Date.parse(this.revokeAt.toLocaleString()));const g={revokedAt:this.revokeAt,revocationReason:this.revokeReason?.value};h.forEach(N=>{this.certificateService.revokeCertificate(this.itemType,this.item.mrn,this.orgMrn,N.serialNumber,g,this.instanceVersion).subscribe(x=>{this.notifier.notify("success",this.translate.instant("success.certificate.revoke")),this.cancel()},x=>{this.notifier.notify("error",this.translate.instant("error.certificate.revoke"))})})},this.clickDownloadBtn=h=>{0!==h.length?h.forEach(g=>{const N=(0,p.Yq)(g.end,"yyyy-MM-ddTHH-mm-ss",this.locale);this.fileHelper.downloadPemCertificate({certificate:g.certificate},this.item.mrn+"_exp_"+N,this.notifier)}):this.notifier.notify("warning",this.translate.instant("error.selection.noSelection"))},this.clickRevokeBtn=h=>{this.itemType===l.SP.Service&&this.instanceVersion?this.notifier.notify("error",this.translate.instant("error.form.requiremigrate")):0!==h.length?(this.revokeModalOpened=!0,this.selectedActiveCerts=h):this.notifier.notify("warning",this.translate.instant("error.selection.noSelection"))},this.clickMigrateBtn=()=>{this.migrateModal?.open(),this.migrateModalOpened=!0,this.newServiceMrn=this.item.mrn+":"+this.instanceVersion},this.cancel=()=>{this.certModal?.close(),this.certModalOpened=!1,this.revokeModal?.close(),this.revokeModalOpened=!1,this.migrateModal?.close(),this.migrateModalOpened=!1,this.onRefresh.emit(),this.newServiceMrn="",this.certificateBundle=void 0},this.refreshData=()=>{this.onRefresh.emit()},this.issueFromBrowser=()=>{this.fromBrowser=!0},this.issueManualKeystore=()=>{this.fromBrowser=!1},this.capitalize=h=>h[0].toUpperCase()+h.slice(1);for(const h in Or.qQ.RevocationReasonEnum)this.revokeReasons.push(im(h.toLocaleLowerCase()));this.revokeReasons.sort((h,g)=>h.value.localeCompare(g.value)),o.getOrgMrn().then(h=>{this.orgMrn=h})}ngOnChanges(e){!e.item||!e.item.currentValue||(this.item=e.item.currentValue&&e.item.currentValue,this.item&&this.itemType===l.SP.Role?(this.itemId=this.item.id,this.setForm()):this.item&&this.item.mrn&&(this.itemId=this.item.mrn,this.item.instanceVersion&&(this.instanceVersion=this.item.instanceVersion),this.itemType===l.SP.Vessel&&(this.item=(0,fw.BY)(this.item)),this.setForm(),this.item.certificates&&this.assignCertificatesByStatus(this.item.certificates)),this.itemType===l.SP.OrgCandidate&&(this.adminUserMrnPrefix=(0,mw.B)(this.item.mrn)))}isTimestampFormat(e){return l.N3.includes(e)}download(){this.certificateBundle&&(this.fileHelper.downloadPemCertificate(this.certificateBundle,this.itemId,this.notifier),this.notifier.notify("success",this.translate.instant("success.certificate.chosen")))}static#e=this.\u0275fac=function(t){return new(t||s)(n.rXU(pw),n.rXU(nm.c$),n.rXU(vw.iJ),n.rXU(yw),n.rXU(Sw.u),n.rXU(n.xe9))};static#t=this.\u0275cmp=n.VBU({type:s,selectors:[["app-item-view"]],viewQuery:function(t,i){if(1&t&&(n.GBs(bw,7),n.GBs(Aw,7),n.GBs(kw,7),n.GBs(rm.j,5)),2&t){let a;n.mGM(a=n.lsd())&&(i.certModal=a.first),n.mGM(a=n.lsd())&&(i.revokeModal=a.first),n.mGM(a=n.lsd())&&(i.migrateModal=a.first),n.mGM(a=n.lsd())&&(i.newAdminUserForm=a.first)}},inputs:{itemType:"itemType",item:"item",orgMrn:"orgMrn",mrnPrefix:"mrnPrefix",instanceVersion:"instanceVersion",serial:"serial"},outputs:{onEdit:"onEdit",onMigrate:"onMigrate",onDelete:"onDelete",onRefresh:"onRefresh",onApprove:"onApprove",onDownloadCert:"onDownloadCert"},standalone:!0,features:[n.OA$,n.aNF],decls:102,vars:18,consts:[["certModal",""],["revokeModal",""],["migrateModal",""],["newAdminUserForm",""],[1,"clr-row"],[1,"clr-col-lg-12","clr-col-md-8","clr-col-12"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"card-text"],[1,"clr-form","clr-form-horizontal"],["class","clr-form-horizontal clr-form-control clr-row",4,"ngFor","ngForOf"],["title","New administrator user",3,"isForNew","itemType","item","mrnPrefix"],[1,"card-footer"],[1,"btn","btn-primary"],[1,"btn","btn-success"],[1,"btn","btn-danger",3,"click"],["clrModalSize","lg",1,"modal",3,"clrModalOpenChange","clrModalOpen"],[1,"modal-title"],["aria-label","Close","type","button",1,"close",3,"click"],[1,"modal-body"],[1,"clr-col-sm-12","clr-col-md-12"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-outline",3,"click"],[1,"clr-col-4"],[1,"clr-col-8"],["type","date","autocomplete","off","clrDate","","name","demo",3,"ngModelChange","ngModel"],[1,"clr-form"],[1,"clr-form-control"],["for","basic",1,"clr-control-label"],[1,"clr-control-container"],[1,"clr-input-wrapper"],["type","text","id","basic","placeholder","Enter value here",1,"clr-input",3,"value"],["shape","exclamation-circle",1,"clr-validate-icon"],[1,"clr-subtext"],[1,"clr-form-horizontal","clr-form-control","clr-row"],[1,"clr-control-label","clr-col-12","clr-col-md-2"],["ng-reflect-ng-class","clr-col-md-10 clr-col-12",1,"clr-control-container","clr-col-md-10","clr-col-12"],["clrinput","","type","string","ng-reflect-name","mrn","ng-reflect-required","true","required","","aria-describedby","clr-form-control-1-helper",1,"clr-input","ng-untouched","ng-pristine","ng-invalid","ng-star-inserted",3,"width"],["clrinput","","type","string","ng-reflect-name","mrn","ng-reflect-required","true","required","","aria-describedby","clr-form-control-1-helper",1,"clr-input","ng-untouched","ng-pristine","ng-invalid","ng-star-inserted"],[1,"clr-control-label"],["context","active",3,"onAdd","onDownload","onRevoke","data","serial"],["context","revoked",3,"data"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-success",3,"click"],["type","radio","clrRadio","","name","options","required","",3,"click"],["target","_blank",3,"href"]],template:function(t,i){if(1&t){const a=n.RV6();n.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7),n.DNE(4,Ew,1,0)(5,_w,1,1),n.k0s(),n.j41(6,"div",8)(7,"div",9)(8,"div",10),n.DNE(9,Rw,7,2,"div",11),n.nI1(10,"keyvalue"),n.DNE(11,Tw,10,3)(12,xw,2,4,"app-item-form",12),n.k0s()()(),n.j41(13,"div",13),n.DNE(14,Vw,2,0,"button",14)(15,Ow,2,0,"button",15)(16,Pw,2,0,"button",14),n.j41(17,"button",16),n.bIt("click",function(){return n.eBV(a),n.Njj(i.deleteItem())}),n.EFF(18,"Delete"),n.k0s()()()()(),n.j41(19,"clr-modal",17,0),n.mxI("clrModalOpenChange",function(u){return n.eBV(a),n.DH7(i.certModalOpened,u)||(i.certModalOpened=u),n.Njj(u)}),n.j41(21,"div",18)(22,"button",19),n.bIt("click",function(){return n.eBV(a),n.Njj(i.cancel())}),n.k0s(),n.j41(23,"h3",18),n.EFF(24,"Issue a new certificate"),n.k0s()(),n.j41(25,"div",20),n.DNE(26,Dw,3,0,"div",21),n.k0s(),n.j41(27,"div",22)(28,"button",23),n.bIt("click",function(){return n.eBV(a),n.Njj(i.download())}),n.EFF(29,"Download certificate"),n.k0s(),n.j41(30,"button",24),n.bIt("click",function(){return n.eBV(a),n.Njj(i.cancel())}),n.EFF(31,"Close"),n.k0s()()(),n.j41(32,"clr-modal",17,1),n.mxI("clrModalOpenChange",function(u){return n.eBV(a),n.DH7(i.revokeModalOpened,u)||(i.revokeModalOpened=u),n.Njj(u)}),n.j41(34,"div",18)(35,"button",19),n.bIt("click",function(){return n.eBV(a),n.Njj(i.cancel())}),n.k0s(),n.DNE(36,Uw,2,1,"h3",18)(37,Mw,2,1,"h3",18),n.k0s(),n.j41(38,"div",20)(39,"div",21)(40,"div",4)(41,"span")(42,"b"),n.EFF(43,"Warning: chosen certificates will no longer be valid when they are revoked!"),n.k0s()()(),n.j41(44,"div",4)(45,"div",25)(46,"div")(47,"h5"),n.EFF(48,"Reason name"),n.k0s()(),n.j41(49,"div"),n.Z7z(50,Lw,4,1,"clr-radio-wrapper",null,n.fX1),n.k0s()(),n.j41(52,"div",26)(53,"div")(54,"h5"),n.EFF(55,"Explanation"),n.k0s()(),n.j41(56,"div"),n.DNE(57,Fw,6,2)(58,Hw,3,0,"div"),n.k0s()()(),n.j41(59,"div",4)(60,"div",25)(61,"div")(62,"h5"),n.EFF(63,"Revoke at"),n.k0s()()(),n.j41(64,"div",26)(65,"clr-date-container")(66,"input",27),n.mxI("ngModelChange",function(u){return n.eBV(a),n.DH7(i.revokeAt,u)||(i.revokeAt=u),n.Njj(u)}),n.k0s()()()(),n.j41(67,"div",4)(68,"div")(69,"p"),n.EFF(70,"Choose revocation reason and date to proceed."),n.k0s()()()()(),n.j41(71,"div",22)(72,"button",23),n.bIt("click",function(){return n.eBV(a),n.Njj(i.revokeCerts(i.selectedActiveCerts))}),n.EFF(73,"Revoke"),n.k0s(),n.j41(74,"button",24),n.bIt("click",function(){return n.eBV(a),n.Njj(i.cancel())}),n.EFF(75,"Cancel"),n.k0s()()(),n.j41(76,"clr-modal",17,2),n.mxI("clrModalOpenChange",function(u){return n.eBV(a),n.DH7(i.migrateModalOpened,u)||(i.migrateModalOpened=u),n.Njj(u)}),n.j41(78,"div",18)(79,"button",19),n.bIt("click",function(){return n.eBV(a),n.Njj(i.cancel())}),n.k0s(),n.EFF(80," Migrate service "),n.k0s(),n.j41(81,"div",20)(82,"div",21)(83,"div",4)(84,"span"),n.EFF(85,"This migration allows you to remove the version from an existing service's MRN by assigning a new MRN that includes the version. It simplifies version management and future updates, making it easier for users to maintain and update services. The MRN below is given as an example, but you can edit it as you want."),n.k0s()(),n.j41(86,"div",4)(87,"form",28)(88,"div",29)(89,"label",30),n.EFF(90,"Recommended new MRN for your service"),n.k0s(),n.j41(91,"div",31)(92,"div",32),n.nrm(93,"input",33)(94,"cds-icon",34),n.k0s(),n.j41(95,"span",35),n.EFF(96,"New MRN can have the version of service inside."),n.k0s()()()()()()(),n.j41(97,"div",22)(98,"button",23),n.bIt("click",function(){return n.eBV(a),n.Njj(i.migrate())}),n.EFF(99,"Migrate"),n.k0s(),n.j41(100,"button",24),n.bIt("click",function(){return n.eBV(a),n.Njj(i.cancel())}),n.EFF(101,"Cancel"),n.k0s()()()}2&t&&(n.R7$(4),n.vxM("orgcandidate"===i.itemType?4:5),n.R7$(5),n.Y8G("ngForOf",n.i5U(10,15,i.columnForMenu,i.sortColumnForMenu)),n.R7$(2),n.vxM("role"!==i.itemType&&"orgcandidate"!==i.itemType?11:-1),n.R7$(),n.vxM("orgcandidate"===i.itemType?12:-1),n.R7$(2),n.vxM("service"===i.itemType&&i.instanceVersion?14:"orgcandidate"===i.itemType?15:16),n.R7$(5),n.R50("clrModalOpen",i.certModalOpened),n.R7$(7),n.vxM(i.certificateBundle?26:-1),n.R7$(6),n.R50("clrModalOpen",i.revokeModalOpened),n.R7$(4),n.vxM(i.selectedActiveCerts.length>1?36:37),n.R7$(14),n.Dyx(i.revokeReasons),n.R7$(7),n.vxM(i.revokeReason?57:58),n.R7$(9),n.R50("ngModel",i.revokeAt),n.R7$(10),n.R50("clrModalOpen",i.migrateModalOpened),n.R7$(17),n.xc7("width",400,"px"),n.Y8G("value",i.newServiceMrn))},dependencies:[S.G,p.Sq,p.lG,C.z7t,C.bZN,C.zN1,C.BlU,C.jsN,C.aZZ,C.fkp,C.cIb,C.CxT,C.lnv,C._Qf,C.WF1,rm.j,I,k.YN,k.qT,k.me,k.BC,k.cb,k.vS,k.cV]})}return s})()},3426:(_t,F,$)=>{"use strict";$.d(F,{d:()=>R});var n=$(6994),l=$(5950),A=$(3585),m=$(5166),_=$(3685),D=$(1066),M=$(8745),O=$(6482),T=$(5004);function y(K,f){if(1&K){const P=l.RV6();l.j41(0,"div")(1,"button",1),l.bIt("click",function(){l.eBV(P);const W=l.XpG();return l.Njj(W.back())}),l.EFF(2,"Back"),l.k0s()(),l.j41(3,"div",2)(4,"div",3)(5,"app-item-view",4),l.bIt("onEdit",function(){l.eBV(P);const W=l.XpG();return l.Njj(W.edit(W.selectedItem))})("onDelete",function(){l.eBV(P);const W=l.XpG();return l.Njj(W.deleteItem(W.selectedItem))})("onRefresh",function(){l.eBV(P);const W=l.XpG();return l.Njj(W.refreshData())})("onMigrate",function(W){l.eBV(P);const ke=l.XpG();return l.Njj(ke.migrate(W))})("onApprove",function(W){l.eBV(P);const ke=l.XpG();return l.Njj(ke.approve(W))}),l.k0s()()()}if(2&K){const P=l.XpG();l.R7$(5),l.Y8G("itemType",P.itemType)("item",P.selectedItem)}}function I(K,f){if(1&K){const P=l.RV6();l.j41(0,"div",9)(1,"button",10),l.bIt("click",function(){l.eBV(P);const W=l.XpG(3);return l.Njj(W.onAdd())}),l.nrm(2,"cds-icon",11),l.EFF(3),l.k0s()()}if(2&K){const P=l.XpG(3);l.R7$(3),l.SpI(" ",P.addText," ")}}function b(K,f){if(1&K){const P=l.RV6();l.j41(0,"div",9)(1,"button",10),l.bIt("click",function(){l.eBV(P);const W=l.XpG(3);return l.Njj(W.onDelete(W.selected))}),l.nrm(2,"cds-icon",12),l.EFF(3),l.k0s(),l.j41(4,"button",10),l.bIt("click",function(){l.eBV(P);const W=l.XpG(3);return l.Njj(W.onDownload(W.selected))}),l.nrm(5,"cds-icon",13),l.EFF(6),l.k0s()()}if(2&K){const P=l.XpG(3);l.R7$(3),l.SpI(" ",P.deleteText,""),l.R7$(3),l.SpI(" ",P.downloadText,"")}}function k(K,f){if(1&K){const P=l.RV6();l.j41(0,"div",9)(1,"button",10),l.bIt("click",function(){l.eBV(P);const W=l.XpG(3);return l.Njj(W.onDelete(W.selected))}),l.nrm(2,"cds-icon",12),l.EFF(3),l.k0s()()}if(2&K){const P=l.XpG(3);l.R7$(3),l.SpI(" ",P.deleteText,"")}}function v(K,f){if(1&K&&(l.j41(0,"clr-dg-action-bar"),l.DNE(1,I,4,1,"div",9)(2,b,7,2,"div",9)(3,k,4,1,"div",9),l.k0s()),2&K){const P=l.XpG(2);l.R7$(),l.vxM(void 0!==P.onAdd?1:-1),l.R7$(),l.vxM(void 0!==P.onDelete&&void 0!==P.onDownload?2:void 0!==P.onDelete?3:-1)}}function p(K,f){if(1&K&&(l.j41(0,"clr-dg-column"),l.EFF(1),l.k0s()),2&K){const P=f.$implicit;l.R7$(),l.JRh(P)}}function S(K,f){if(1&K){const P=l.RV6();l.j41(0,"clr-dg-cell",15),l.bIt("click",function(){l.eBV(P);const W=l.XpG(2).$implicit,ke=l.XpG(2);return l.Njj(ke.userRowSelect(W))}),l.EFF(1),l.k0s()}if(2&K){const P=l.XpG().$implicit,ae=l.XpG().$implicit,W=l.XpG(2);l.R7$(),l.JRh(W.convertTimeString(ae[P]))}}function C(K,f){if(1&K){const P=l.RV6();l.j41(0,"clr-dg-cell",15),l.bIt("click",function(){l.eBV(P);const W=l.XpG(2).$implicit,ke=l.XpG(2);return l.Njj(ke.userRowSelect(W))}),l.EFF(1),l.k0s()}if(2&K){const P=l.XpG().$implicit,ae=l.XpG().$implicit;l.R7$(),l.JRh(ae[P])}}function E(K,f){if(1&K&&l.DNE(0,S,2,1,"clr-dg-cell")(1,C,2,1,"clr-dg-cell"),2&K){const P=f.$implicit,ae=l.XpG(3);l.vxM(ae.isTimestampFormat(P)?0:1)}}function L(K,f){if(1&K&&(l.j41(0,"clr-dg-row",14),l.Z7z(1,E,2,1,null,null,l.fX1),l.k0s()),2&K){const P=f.$implicit,ae=l.XpG(2);l.Y8G("clrDgItem",P),l.R7$(),l.Dyx(ae.labelKeys)}}function ee(K,f){if(1&K&&(l.j41(0,"clr-dg-detail")(1,"clr-dg-detail-header"),l.EFF(2),l.k0s(),l.j41(3,"clr-dg-detail-body"),l.nrm(4,"app-item-view",17),l.k0s()()),2&K){const P=f.$implicit,ae=l.XpG(3);l.R7$(2),l.JRh(P.mrn),l.R7$(2),l.Y8G("itemType",ae.itemType)("item",P)}}function c(K,f){1&K&&l.DNE(0,ee,5,3,"clr-dg-detail",16)}function se(K,f){if(1&K){const P=l.RV6();l.j41(0,"button",19),l.bIt("click",function(){const W=l.eBV(P).$implicit,ke=l.XpG(3);return l.Njj(ke.loadData(W))}),l.EFF(1),l.k0s()}if(2&K){const P=f.$implicit,ae=l.XpG(3);l.Y8G("disabled",P==ae.currentPageNumber),l.R7$(),l.JRh(P+1)}}function ve(K,f){if(1&K){const P=l.RV6();l.j41(0,"div",8)(1,"div",18)(2,"button",19),l.bIt("click",function(){l.eBV(P);const W=l.XpG(2);return l.Njj(W.changePageRange(-1))}),l.EFF(3," \xab "),l.k0s(),l.Z7z(4,se,2,2,"button",20,l.fX1),l.j41(6,"button",19),l.bIt("click",function(){l.eBV(P);const W=l.XpG(2);return l.Njj(W.changePageRange(1))}),l.EFF(7," \xbb "),l.k0s()()()}if(2&K){const P=l.XpG(2);l.R7$(2),l.Y8G("disabled",0===P.currentPageRange),l.R7$(2),l.Dyx(P.visiblePageNumbers),l.R7$(2),l.Y8G("disabled",(P.currentPageRange+1)*P.elementsPerPage>=P.totalPages)}}function Pe(K,f){if(1&K){const P=l.RV6();l.j41(0,"clr-datagrid",5),l.mxI("clrDgSelectedChange",function(W){l.eBV(P);const ke=l.XpG();return l.DH7(ke.selected,W)||(ke.selected=W),l.Njj(W)}),l.bIt("clrDgRefresh",function(W){l.eBV(P);const ke=l.XpG();return l.Njj(ke.refresh(W))}),l.DNE(1,v,4,2,"clr-dg-action-bar"),l.Z7z(2,p,2,1,"clr-dg-column",null,l.fX1),l.j41(4,"clr-dg-placeholder",6),l.EFF(5),l.k0s(),l.DNE(6,L,3,1,"clr-dg-row",7)(7,c,1,0,"clr-dg-detail"),l.j41(8,"clr-dg-footer"),l.DNE(9,ve,8,2,"div",8),l.k0s()()}if(2&K){const P=l.XpG();l.R50("clrDgSelected",P.selected),l.Y8G("clrDgLoading",P.isLoading),l.R7$(),l.vxM(P.onAdd||P.onDelete||P.onDownload?1:-1),l.R7$(),l.Dyx(P.labelTitles),l.R7$(3),l.JRh(P.placeholder),l.R7$(),l.Y8G("clrDgItemsOf",P.data),l.R7$(),l.vxM(P.detailView?7:-1),l.R7$(2),l.vxM(P.totalPages>1?9:-1)}}let R=(()=>{class K{constructor(P,ae,W){this.router=P,this.authService=ae,this.roleService=W,this.itemType=m.SP.Device,this.labels=void 0,this.placeholder="We couldn't find any data!",this.deleteText="Delete",this.downloadText="Download",this.addText="Add",this.totalPages=0,this.totalElements=0,this.getData=ke=>new Promise((X,Te)=>X([])),this.onRowSelect=new l.bkB,this.onRevokeCerts=new l.bkB,this.onDownloadCerts=new l.bkB,this.onEdit=new l.bkB,this.onMigrate=new l.bkB,this.onRefresh=new l.bkB,this.onApprove=new l.bkB,this.data=void 0,this.selected=[],this.detail={},this.selectedItem={},this.expanded=!1,this.detailView=!1,this.labelKeys=[],this.labelTitles=[],this.isLoading=!1,this.pageNumbers=[],this.currentPageNumber=0,this.currentPageRange=0,this.visiblePageNumbers=[],this.elementsPerPage=10,this.roles=[],this.userRowSelect=ke=>{this.expanded=!0,this.selectedItem=ke,this.onRowSelect.emit(ke)},this.back=()=>{this.expanded=!1,this.selectedItem={}},this.edit=ke=>{this.expanded=!0,this.selectedItem=ke,this.onEdit.emit(ke)},this.approve=ke=>{this.onApprove.emit(ke)},this.migrate=ke=>{this.onMigrate.emit({...this.selectedItem,newServiceMrn:ke})},this.deleteItem=ke=>{this.onDelete?.call(this,[ke])},this.convertTimeString=ke=>(0,D.t)(ke),this.refreshData=()=>{this.loadData().then(()=>{if(this.selectedItem&&this.selectedItem.mrn){const ke=this.data?.find(X=>this.itemType===m.SP.Service?X.mrn===this.selectedItem.mrn&&X.instanceVersion===this.selectedItem.instanceVersion:this.itemType===m.SP.Role?X.id===this.selectedItem.id:X.mrn===this.selectedItem.mrn);ke&&(this.selectedItem=ke)}})},this.isLoading=!0}ngOnInit(){this.labels&&(this.labelKeys=Object.keys(this.labels),this.labelTitles=Object.values(this.labels).map(P=>P.title)),this.authService.getOrgMrn().then(P=>{this.roleService.getRoles(P).subscribe(ae=>{this.roles=ae})})}ngOnChanges(P){P.totalPages&&(this.pageNumbers=Array(this.totalPages).fill(0).map((ae,W)=>W)),this.updateVisiblePageNumbers()}updateVisiblePageNumbers(){const P=this.currentPageRange*this.elementsPerPage,ae=Math.min(P+this.elementsPerPage,this.totalPages);this.visiblePageNumbers=Array.from({length:ae-P},(W,ke)=>P+ke)}changePageRange(P){this.currentPageRange+=P,this.updateVisiblePageNumbers()}loadData(P=this.currentPageNumber){var ae=this;return(0,n.A)(function*(){ae.data=(yield ae.getData(ae.itemType,P,ae.elementsPerPage))||[],P!==ae.currentPageNumber&&(ae.currentPageNumber=P),ae.isLoading=!1})()}refresh(P){var ae=this;return(0,n.A)(function*(){ae.data||ae.loadData()})()}isTimestampFormat(P){return m.N3.includes(P)}static#e=this.\u0275fac=function(ae){return new(ae||K)(l.rXU(M.Ix),l.rXU(O.u),l.rXU(T.Ky))};static#t=this.\u0275cmp=l.VBU({type:K,selectors:[["app-smart-expandable-table"]],inputs:{itemType:"itemType",labels:"labels",placeholder:"placeholder",onDownload:"onDownload",onDelete:"onDelete",onAdd:"onAdd",deleteText:"deleteText",downloadText:"downloadText",addText:"addText",totalPages:"totalPages",totalElements:"totalElements",getData:"getData"},outputs:{onRowSelect:"onRowSelect",onRevokeCerts:"onRevokeCerts",onDownloadCerts:"onDownloadCerts",onEdit:"onEdit",onMigrate:"onMigrate",onRefresh:"onRefresh",onApprove:"onApprove"},standalone:!0,features:[l.OA$,l.aNF],decls:2,vars:1,consts:[[3,"clrDgSelected","clrDgLoading"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"clr-row"],[1,"clr-col-lg-12","clr-col-md-8","clr-col-12"],[3,"onEdit","onDelete","onRefresh","onMigrate","onApprove","itemType","item"],[3,"clrDgSelectedChange","clrDgRefresh","clrDgSelected","clrDgLoading"],[1,"datagrid-empty"],[3,"clrDgItem",4,"clrDgItems","clrDgItemsOf"],[1,"clr-row","clr-justify-content-center"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],["shape","times"],["shape","download"],[3,"clrDgItem"],[3,"click"],[4,"clrIfDetail"],[3,"itemType","item"],[1,"btn-group","btn-outline-primary","btn-sm"],[1,"btn",3,"click","disabled"],[1,"btn",3,"disabled"]],template:function(ae,W){1&ae&&l.DNE(0,y,6,2)(1,Pe,10,7,"clr-datagrid",0),2&ae&&l.vxM(W.expanded?0:1)},dependencies:[A.PuD,A.ghA,A.fQA,A.slD,A.scM,A.f1O,A.PNO,A.ig6,A.Lwm,A.AtP,A.XTg,A.E1i,A.aFj,A.NTI,A.cIg,A.qDI,A.v0q,A.Aup,A.rpC,A.mCo,A.BlU,A.oFi,_.Y]})}return K})()},2537:(_t,F,$)=>{"use strict";$.d(F,{B:()=>Pe});var n=$(5950),l=$(3585),A=$(1232),m=$(5930);const D=["download",(0,m.s)({outline:'<path d="M31,31H5a1,1,0,0,0,0,2H31a1,1,0,0,0,0-2Z"/><path d="M18,29.48,28.61,18.87a1,1,0,0,0-1.41-1.41L19,25.65V5a1,1,0,0,0-2,0V25.65L8.81,17.46a1,1,0,1,0-1.41,1.41Z"/>',outlineAlerted:'<path d="M31,31H5a1,1,0,0,0,0,2H31a1,1,0,0,0,0-2Z"/><path d="M18,29.48,28.61,18.87a1,1,0,0,0-1.41-1.41L19,25.65V5a1,1,0,0,0-2,0V25.65L8.81,17.46a1,1,0,1,0-1.41,1.41Z"/>',outlineBadged:'<path d="M31,31H5a1,1,0,0,0,0,2H31a1,1,0,0,0,0-2Z"/><path d="M18,29.48,28.61,18.87a1,1,0,0,0-1.41-1.41L19,25.65V5a1,1,0,0,0-2,0V25.65L8.81,17.46a1,1,0,1,0-1.41,1.41Z"/>'})];var M=$(673);const T=["plus",(0,m.s)({outline:'<path d="M30,17H19V6a1,1,0,1,0-2,0V17H6a1,1,0,0,0-1,1,.91.91,0,0,0,1,.94H17V30a1,1,0,1,0,2,0V19H30a1,1,0,0,0,1-1A1,1,0,0,0,30,17Z"/>'})];var y=$(5166),I=$(1066);const b=()=>[10,20,50,100];function k(R,K){1&R&&(n.j41(0,"clr-spinner"),n.EFF(1,"Loading"),n.k0s())}function v(R,K){if(1&R){const f=n.RV6();n.j41(0,"div",7)(1,"button",8),n.bIt("click",function(){n.eBV(f);const ae=n.XpG(3);return n.Njj(ae.onAdd())}),n.nrm(2,"cds-icon",9),n.EFF(3),n.k0s()()}if(2&R){const f=n.XpG(3);n.R7$(3),n.SpI(" ",f.addText," ")}}function p(R,K){if(1&R){const f=n.RV6();n.j41(0,"div",7)(1,"button",8),n.bIt("click",function(){n.eBV(f);const ae=n.XpG(3);return n.Njj(ae.onDelete(ae.selected))}),n.nrm(2,"cds-icon",10),n.EFF(3),n.k0s(),n.j41(4,"button",8),n.bIt("click",function(){n.eBV(f);const ae=n.XpG(3);return n.Njj(ae.onDownload(ae.selected))}),n.nrm(5,"cds-icon",11),n.EFF(6),n.k0s()()}if(2&R){const f=n.XpG(3);n.R7$(3),n.SpI(" ",f.deleteText,""),n.R7$(3),n.SpI(" ",f.downloadText,"")}}function S(R,K){if(1&R){const f=n.RV6();n.j41(0,"div",7)(1,"button",8),n.bIt("click",function(){n.eBV(f);const ae=n.XpG(3);return n.Njj(ae.onDelete(ae.selected))}),n.nrm(2,"cds-icon",10),n.EFF(3),n.k0s()()}if(2&R){const f=n.XpG(3);n.R7$(3),n.SpI(" ",f.deleteText,"")}}function C(R,K){if(1&R&&(n.j41(0,"clr-dg-action-bar"),n.DNE(1,v,4,1,"div",7)(2,p,7,2,"div",7)(3,S,4,1,"div",7),n.k0s()),2&R){const f=n.XpG(2);n.R7$(),n.vxM(void 0!==f.onAdd?1:-1),n.R7$(),n.vxM(void 0!==f.onDelete&&void 0!==f.onDownload?2:void 0!==f.onDelete?3:-1)}}function E(R,K){if(1&R&&(n.j41(0,"clr-dg-column"),n.EFF(1),n.k0s()),2&R){const f=K.$implicit;n.R7$(),n.JRh(f)}}function L(R,K){if(1&R){const f=n.RV6();n.j41(0,"clr-dg-cell",13),n.bIt("click",function(){n.eBV(f);const ae=n.XpG(2).$implicit,W=n.XpG(2);return n.Njj(W.userRowSelect(ae))}),n.EFF(1),n.k0s()}if(2&R){const f=n.XpG().$implicit,P=n.XpG().$implicit,ae=n.XpG(2);n.R7$(),n.JRh(ae.convertTimeString(P[f]))}}function ee(R,K){if(1&R){const f=n.RV6();n.j41(0,"clr-dg-cell",13),n.bIt("click",function(){n.eBV(f);const ae=n.XpG(2).$implicit,W=n.XpG(2);return n.Njj(W.userRowSelect(ae))}),n.EFF(1),n.k0s()}if(2&R){const f=n.XpG().$implicit,P=n.XpG().$implicit;n.R7$(),n.JRh(P[f])}}function c(R,K){if(1&R&&n.DNE(0,L,2,1,"clr-dg-cell")(1,ee,2,1,"clr-dg-cell"),2&R){const f=K.$implicit,P=n.XpG(3);n.vxM(P.isTimestampFormat(f)?0:1)}}function se(R,K){if(1&R&&(n.j41(0,"clr-dg-row",12),n.Z7z(1,c,2,1,null,null,n.fX1),n.k0s()),2&R){const f=K.$implicit,P=n.XpG(2);n.Y8G("clrDgItem",f),n.R7$(),n.Dyx(P.labelKeys)}}function ve(R,K){if(1&R){const f=n.RV6();n.j41(0,"clr-datagrid",2),n.mxI("clrDgSelectedChange",function(ae){n.eBV(f);const W=n.XpG();return n.DH7(W.selected,ae)||(W.selected=ae),n.Njj(ae)}),n.DNE(1,C,4,2,"clr-dg-action-bar"),n.Z7z(2,E,2,1,"clr-dg-column",null,n.fX1),n.j41(4,"clr-dg-placeholder",3),n.EFF(5),n.k0s(),n.DNE(6,se,3,1,"clr-dg-row",4),n.j41(7,"clr-dg-footer")(8,"clr-dg-pagination",5,0)(10,"clr-dg-page-size",6),n.EFF(11," items per page"),n.k0s(),n.EFF(12),n.k0s()()()}if(2&R){const f=n.sdS(9),P=n.XpG();n.R50("clrDgSelected",P.selected),n.R7$(),n.vxM(P.onAdd||P.onDelete||P.onDownload?1:-1),n.R7$(),n.Dyx(P.labelTitles),n.R7$(3),n.JRh(P.placeholder),n.R7$(),n.Y8G("clrDgItemsOf",P.data),n.R7$(2),n.Y8G("clrDgPageSize",10),n.R7$(2),n.Y8G("clrPageSizeOptions",n.lJ4(9,b)),n.R7$(2),n.E5c(" ",f.firstItem+1," - ",f.lastItem+1," of ",f.totalItems," certificates ")}}A.h.addIcons(D,M.a,T);let Pe=(()=>{class R{constructor(){this.data=[],this.itemType=y.SP.Device,this.labels={},this.placeholder="We couldn't find any data!",this.deleteText="Delete",this.downloadText="Download",this.addText="Add",this.selectedIds=[],this.onRowSelect=new n.bkB,this.selected=[],this.detail={},this.isLoading=!1,this.labelKeys=[],this.labelTitles=[],this.userRowSelect=f=>{this.onRowSelect&&this.onRowSelect.emit(f)},this.convertTimeString=f=>(0,I.t)(f),this.isLoading=!0}ngOnChanges(f){f.data.currentValue.length>0&&(this.labelKeys=Object.keys(this.labels),this.labelTitles=Object.values(this.labels).map(P=>P.title)),this.isLoading=!1,this.data.length>0&&this.selectedIds.length>0&&(this.selected=this.data.filter(P=>this.selectedIds[0]===P.serialNumber))}isTimestampFormat(f){return y.N3.includes(f)}static#e=this.\u0275fac=function(P){return new(P||R)};static#t=this.\u0275cmp=n.VBU({type:R,selectors:[["app-smart-table"]],inputs:{data:"data",itemType:"itemType",labels:"labels",placeholder:"placeholder",onDownload:"onDownload",onDelete:"onDelete",onAdd:"onAdd",deleteText:"deleteText",downloadText:"downloadText",addText:"addText",selectedIds:"selectedIds"},outputs:{onRowSelect:"onRowSelect"},standalone:!0,features:[n.OA$,n.aNF],decls:2,vars:1,consts:[["pagination",""],[3,"clrDgSelected"],[3,"clrDgSelectedChange","clrDgSelected"],[1,"datagrid-empty"],[3,"clrDgItem",4,"clrDgItems","clrDgItemsOf"],[3,"clrDgPageSize"],[3,"clrPageSizeOptions"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],["shape","times"],["shape","download"],[3,"clrDgItem"],[3,"click"]],template:function(P,ae){1&P&&n.DNE(0,k,2,0,"clr-spinner")(1,ve,13,10,"clr-datagrid",1),2&P&&n.vxM(ae.isLoading?0:1)},dependencies:[l.PuD,l.ghA,l.fQA,l.slD,l.scM,l.Lwm,l.AtP,l.oip,l.o3y,l.XTg,l.E1i,l.NTI,l.cIg,l.qDI,l.v0q,l.Aup,l.rpC,l.mCo,l.BlU,l.BkK,l.oFi]})}return R})()},5540:function(_t,F){var $,l;void 0!==(l="function"==typeof($=function(){"use strict";function m(y,I,b){var k=new XMLHttpRequest;k.open("GET",y),k.responseType="blob",k.onload=function(){T(k.response,I,b)},k.onerror=function(){console.error("could not download file")},k.send()}function _(y){var I=new XMLHttpRequest;I.open("HEAD",y,!1);try{I.send()}catch{}return 200<=I.status&&299>=I.status}function D(y){try{y.dispatchEvent(new MouseEvent("click"))}catch{var I=document.createEvent("MouseEvents");I.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),y.dispatchEvent(I)}}var M="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,O=M.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),T=M.saveAs||("object"!=typeof window||window!==M?function(){}:"download"in HTMLAnchorElement.prototype&&!O?function(y,I,b){var k=M.URL||M.webkitURL,v=document.createElement("a");v.download=I=I||y.name||"download",v.rel="noopener","string"==typeof y?(v.href=y,v.origin===location.origin?D(v):_(v.href)?m(y,I,b):D(v,v.target="_blank")):(v.href=k.createObjectURL(y),setTimeout(function(){k.revokeObjectURL(v.href)},4e4),setTimeout(function(){D(v)},0))}:"msSaveOrOpenBlob"in navigator?function(y,I,b){if(I=I||y.name||"download","string"!=typeof y)navigator.msSaveOrOpenBlob(function A(y,I){return typeof I>"u"?I={autoBom:!1}:"object"!=typeof I&&(console.warn("Deprecated: Expected third argument to be a object"),I={autoBom:!I}),I.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(y.type)?new Blob(["\ufeff",y],{type:y.type}):y}(y,b),I);else if(_(y))m(y,I,b);else{var k=document.createElement("a");k.href=y,k.target="_blank",setTimeout(function(){D(k)})}}:function(y,I,b,k){if((k=k||open("","_blank"))&&(k.document.title=k.document.body.innerText="downloading..."),"string"==typeof y)return m(y,I,b);var v="application/octet-stream"===y.type,p=/constructor/i.test(M.HTMLElement)||M.safari,S=/CriOS\/[\d]+/.test(navigator.userAgent);if((S||v&&p||O)&&typeof FileReader<"u"){var C=new FileReader;C.onloadend=function(){var ee=C.result;ee=S?ee:ee.replace(/^data:[^;]*;/,"data:attachment/file;"),k?k.location.href=ee:location=ee,k=null},C.readAsDataURL(y)}else{var E=M.URL||M.webkitURL,L=E.createObjectURL(y);k?k.location=L:location.href=L,k=null,setTimeout(function(){E.revokeObjectURL(L)},4e4)}});M.saveAs=T.saveAs=T,_t.exports=T})?$.apply(F,[]):$)&&(_t.exports=l)},8721:_t=>{_t.exports=function F($,n,l){function A(D,M){if(!n[D]){if(!$[D]){if(m)return m(D,!0);var T=new Error("Cannot find module '"+D+"'");throw T.code="MODULE_NOT_FOUND",T}var y=n[D]={exports:{}};$[D][0].call(y.exports,function(I){return A($[D][1][I]||I)},y,y.exports,F,$,n,l)}return n[D].exports}for(var m=void 0,_=0;_<l.length;_++)A(l[_]);return A}({1:[function(F,$,n){"use strict";var l=F("./utils"),A=F("./support"),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(_){for(var D,M,O,y,I,b,k=[],v=0,p=_.length,S=p,C="string"!==l.getTypeOf(_);v<_.length;)S=p-v,O=C?(D=_[v++],M=v<p?_[v++]:0,v<p?_[v++]:0):(D=_.charCodeAt(v++),M=v<p?_.charCodeAt(v++):0,v<p?_.charCodeAt(v++):0),y=(3&D)<<4|M>>4,I=1<S?(15&M)<<2|O>>6:64,b=2<S?63&O:64,k.push(m.charAt(D>>2)+m.charAt(y)+m.charAt(I)+m.charAt(b));return k.join("")},n.decode=function(_){var D,M,O,T,y,I,b=0,k=0,v="data:";if(_.substr(0,5)===v)throw new Error("Invalid base64 input, it looks like a data url.");var p,S=3*(_=_.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(_.charAt(_.length-1)===m.charAt(64)&&S--,_.charAt(_.length-2)===m.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(p=A.uint8array?new Uint8Array(0|S):new Array(0|S);b<_.length;)D=m.indexOf(_.charAt(b++))<<2|(T=m.indexOf(_.charAt(b++)))>>4,M=(15&T)<<4|(y=m.indexOf(_.charAt(b++)))>>2,O=(3&y)<<6|(I=m.indexOf(_.charAt(b++))),p[k++]=D,64!==y&&(p[k++]=M),64!==I&&(p[k++]=O);return p}},{"./support":30,"./utils":32}],2:[function(F,$,n){"use strict";var l=F("./external"),A=F("./stream/DataWorker"),m=F("./stream/Crc32Probe"),_=F("./stream/DataLengthProbe");function D(M,O,T,y,I){this.compressedSize=M,this.uncompressedSize=O,this.crc32=T,this.compression=y,this.compressedContent=I}D.prototype={getContentWorker:function(){var M=new A(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new _("data_length")),O=this;return M.on("end",function(){if(this.streamInfo.data_length!==O.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),M},getCompressedWorker:function(){return new A(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},D.createWorkerFrom=function(M,O,T){return M.pipe(new m).pipe(new _("uncompressedSize")).pipe(O.compressWorker(T)).pipe(new _("compressedSize")).withStreamInfo("compression",O)},$.exports=D},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(F,$,n){"use strict";var l=F("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},n.DEFLATE=F("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(F,$,n){"use strict";var l=F("./utils"),A=function(){for(var m,_=[],D=0;D<256;D++){m=D;for(var M=0;M<8;M++)m=1&m?3988292384^m>>>1:m>>>1;_[D]=m}return _}();$.exports=function(m,_){return void 0!==m&&m.length?"string"!==l.getTypeOf(m)?function(D,M,O){var y=A,I=0+O;D^=-1;for(var b=0;b<I;b++)D=D>>>8^y[255&(D^M[b])];return~D}(0|_,m,m.length):function(D,M,O){var y=A,I=0+O;D^=-1;for(var b=0;b<I;b++)D=D>>>8^y[255&(D^M.charCodeAt(b))];return~D}(0|_,m,m.length):0}},{"./utils":32}],5:[function(F,$,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(F,$,n){"use strict";var l;l=typeof Promise<"u"?Promise:F("lie"),$.exports={Promise:l}},{lie:37}],7:[function(F,$,n){"use strict";var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",A=F("pako"),m=F("./utils"),_=F("./stream/GenericWorker"),D=l?"uint8array":"array";function M(O,T){_.call(this,"FlateWorker/"+O),this._pako=null,this._pakoAction=O,this._pakoOptions=T,this.meta={}}n.magic="\b\0",m.inherits(M,_),M.prototype.processChunk=function(O){this.meta=O.meta,null===this._pako&&this._createPako(),this._pako.push(m.transformTo(D,O.data),!1)},M.prototype.flush=function(){_.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},M.prototype.cleanUp=function(){_.prototype.cleanUp.call(this),this._pako=null},M.prototype._createPako=function(){this._pako=new A[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var O=this;this._pako.onData=function(T){O.push({data:T,meta:O.meta})}},n.compressWorker=function(O){return new M("Deflate",O)},n.uncompressWorker=function(){return new M("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(F,$,n){"use strict";function l(y,I){var b,k="";for(b=0;b<I;b++)k+=String.fromCharCode(255&y),y>>>=8;return k}function A(y,I,b,k,v,p){var S,C,E=y.file,L=y.compression,ee=p!==D.utf8encode,c=m.transformTo("string",p(E.name)),se=m.transformTo("string",D.utf8encode(E.name)),ve=E.comment,Pe=m.transformTo("string",p(ve)),R=m.transformTo("string",D.utf8encode(ve)),K=se.length!==E.name.length,f=R.length!==ve.length,P="",ae="",W="",ke=E.dir,X=E.date,Te={crc32:0,compressedSize:0,uncompressedSize:0};I&&!b||(Te.crc32=y.crc32,Te.compressedSize=y.compressedSize,Te.uncompressedSize=y.uncompressedSize);var j=0;I&&(j|=8),ee||!K&&!f||(j|=2048);var Ce,ne,q=0,Ie=0;ke&&(q|=16),"UNIX"===v?(Ie=798,q|=(ne=Ce=E.unixPermissions,Ce||(ne=ke?16893:33204),(65535&ne)<<16)):(Ie=20,q|=function(Ce){return 63&(Ce||0)}(E.dosPermissions)),S=X.getUTCHours(),S<<=6,S|=X.getUTCMinutes(),S<<=5,S|=X.getUTCSeconds()/2,C=X.getUTCFullYear()-1980,C<<=4,C|=X.getUTCMonth()+1,C<<=5,C|=X.getUTCDate(),K&&(ae=l(1,1)+l(M(c),4)+se,P+="up"+l(ae.length,2)+ae),f&&(W=l(1,1)+l(M(Pe),4)+R,P+="uc"+l(W.length,2)+W);var _e="";return _e+="\n\0",_e+=l(j,2),_e+=L.magic,_e+=l(S,2),_e+=l(C,2),_e+=l(Te.crc32,4),_e+=l(Te.compressedSize,4),_e+=l(Te.uncompressedSize,4),_e+=l(c.length,2),_e+=l(P.length,2),{fileRecord:O.LOCAL_FILE_HEADER+_e+c+P,dirRecord:O.CENTRAL_FILE_HEADER+l(Ie,2)+_e+l(Pe.length,2)+"\0\0\0\0"+l(q,4)+l(k,4)+c+P+Pe}}var m=F("../utils"),_=F("../stream/GenericWorker"),D=F("../utf8"),M=F("../crc32"),O=F("../signature");function T(y,I,b,k){_.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=I,this.zipPlatform=b,this.encodeFileName=k,this.streamFiles=y,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}m.inherits(T,_),T.prototype.push=function(y){var I=y.meta.percent||0,b=this.entriesCount,k=this._sources.length;this.accumulate?this.contentBuffer.push(y):(this.bytesWritten+=y.data.length,_.prototype.push.call(this,{data:y.data,meta:{currentFile:this.currentFile,percent:b?(I+100*(b-k-1))/b:100}}))},T.prototype.openedSource=function(y){this.currentSourceOffset=this.bytesWritten,this.currentFile=y.file.name;var I=this.streamFiles&&!y.file.dir;if(I){var b=A(y,I,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},T.prototype.closedSource=function(y){this.accumulate=!1;var k,I=this.streamFiles&&!y.file.dir,b=A(y,I,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),I)this.push({data:(k=y,O.DATA_DESCRIPTOR+l(k.crc32,4)+l(k.compressedSize,4)+l(k.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},T.prototype.flush=function(){for(var y=this.bytesWritten,I=0;I<this.dirRecords.length;I++)this.push({data:this.dirRecords[I],meta:{percent:100}});var v,p,S,L,k=(v=this.dirRecords.length,p=this.bytesWritten-y,S=y,L=m.transformTo("string",(0,this.encodeFileName)(this.zipComment)),O.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(v,2)+l(v,2)+l(p,4)+l(S,4)+l(L.length,2)+L);this.push({data:k,meta:{percent:100}})},T.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},T.prototype.registerPrevious=function(y){this._sources.push(y);var I=this;return y.on("data",function(b){I.processChunk(b)}),y.on("end",function(){I.closedSource(I.previous.streamInfo),I._sources.length?I.prepareNextSource():I.end()}),y.on("error",function(b){I.error(b)}),this},T.prototype.resume=function(){return!!_.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},T.prototype.error=function(y){var I=this._sources;if(!_.prototype.error.call(this,y))return!1;for(var b=0;b<I.length;b++)try{I[b].error(y)}catch{}return!0},T.prototype.lock=function(){_.prototype.lock.call(this);for(var y=this._sources,I=0;I<y.length;I++)y[I].lock()},$.exports=T},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(F,$,n){"use strict";var l=F("../compressions"),A=F("./ZipFileWorker");n.generateWorker=function(m,_,D){var M=new A(_.streamFiles,D,_.platform,_.encodeFileName),O=0;try{m.forEach(function(T,y){O++;var I=function(p,S){var C=p||S,E=l[C];if(!E)throw new Error(C+" is not a valid compression method !");return E}(y.options.compression,_.compression),k=y.dir,v=y.date;y._compressWorker(I,y.options.compressionOptions||_.compressionOptions||{}).withStreamInfo("file",{name:T,dir:k,date:v,comment:y.comment||"",unixPermissions:y.unixPermissions,dosPermissions:y.dosPermissions}).pipe(M)}),M.entriesCount=O}catch(T){M.error(T)}return M}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(F,$,n){"use strict";function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var A=new l;for(var m in this)"function"!=typeof this[m]&&(A[m]=this[m]);return A}}(l.prototype=F("./object")).loadAsync=F("./load"),l.support=F("./support"),l.defaults=F("./defaults"),l.version="3.10.1",l.loadAsync=function(A,m){return(new l).loadAsync(A,m)},l.external=F("./external"),$.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(F,$,n){"use strict";var l=F("./utils"),A=F("./external"),m=F("./utf8"),_=F("./zipEntries"),D=F("./stream/Crc32Probe"),M=F("./nodejsUtils");function O(T){return new A.Promise(function(y,I){var b=T.decompressed.getContentWorker().pipe(new D);b.on("error",function(k){I(k)}).on("end",function(){b.streamInfo.crc32!==T.decompressed.crc32?I(new Error("Corrupted zip : CRC32 mismatch")):y()}).resume()})}$.exports=function(T,y){var I=this;return y=l.extend(y||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:m.utf8decode}),M.isNode&&M.isStream(T)?A.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",T,!0,y.optimizedBinaryString,y.base64).then(function(b){var k=new _(y);return k.load(b),k}).then(function(b){var k=[A.Promise.resolve(b)],v=b.files;if(y.checkCRC32)for(var p=0;p<v.length;p++)k.push(O(v[p]));return A.Promise.all(k)}).then(function(b){for(var k=b.shift(),v=k.files,p=0;p<v.length;p++){var S=v[p],C=S.fileNameStr,E=l.resolve(S.fileNameStr);I.file(E,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:y.createFolders}),S.dir||(I.file(E).unsafeOriginalName=C)}return k.zipComment.length&&(I.comment=k.zipComment),I})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(F,$,n){"use strict";var l=F("../utils"),A=F("../stream/GenericWorker");function m(_,D){A.call(this,"Nodejs stream input adapter for "+_),this._upstreamEnded=!1,this._bindStream(D)}l.inherits(m,A),m.prototype._bindStream=function(_){var D=this;(this._stream=_).pause(),_.on("data",function(M){D.push({data:M,meta:{percent:0}})}).on("error",function(M){D.isPaused?this.generatedError=M:D.error(M)}).on("end",function(){D.isPaused?D._upstreamEnded=!0:D.end()})},m.prototype.pause=function(){return!!A.prototype.pause.call(this)&&(this._stream.pause(),!0)},m.prototype.resume=function(){return!!A.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},$.exports=m},{"../stream/GenericWorker":28,"../utils":32}],13:[function(F,$,n){"use strict";var l=F("readable-stream").Readable;function A(m,_,D){l.call(this,_),this._helper=m;var M=this;m.on("data",function(O,T){M.push(O)||M._helper.pause(),D&&D(T)}).on("error",function(O){M.emit("error",O)}).on("end",function(){M.push(null)})}F("../utils").inherits(A,l),A.prototype._read=function(){this._helper.resume()},$.exports=A},{"../utils":32,"readable-stream":16}],14:[function(F,$,n){"use strict";$.exports={isNode:typeof Buffer<"u",newBufferFrom:function(l,A){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,A);if("number"==typeof l)throw new Error('The "data" argument must not be a number');return new Buffer(l,A)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var A=new Buffer(l);return A.fill(0),A},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&"function"==typeof l.on&&"function"==typeof l.pause&&"function"==typeof l.resume}}},{}],15:[function(F,$,n){"use strict";function l(E,L,ee){var c,se=m.getTypeOf(L),ve=m.extend(ee||{},M);ve.date=ve.date||new Date,null!==ve.compression&&(ve.compression=ve.compression.toUpperCase()),"string"==typeof ve.unixPermissions&&(ve.unixPermissions=parseInt(ve.unixPermissions,8)),ve.unixPermissions&&16384&ve.unixPermissions&&(ve.dir=!0),ve.dosPermissions&&16&ve.dosPermissions&&(ve.dir=!0),ve.dir&&(E=v(E)),ve.createFolders&&(c=k(E))&&p.call(this,c,!0),ee&&void 0!==ee.binary||(ve.binary=!("string"===se&&!1===ve.binary&&!1===ve.base64)),(L instanceof O&&0===L.uncompressedSize||ve.dir||!L||0===L.length)&&(ve.base64=!1,ve.binary=!0,L="",ve.compression="STORE",se="string");var R;R=L instanceof O||L instanceof _?L:I.isNode&&I.isStream(L)?new b(E,L):m.prepareContent(E,L,ve.binary,ve.optimizedBinaryString,ve.base64);var K=new T(E,R,ve);this.files[E]=K}var A=F("./utf8"),m=F("./utils"),_=F("./stream/GenericWorker"),D=F("./stream/StreamHelper"),M=F("./defaults"),O=F("./compressedObject"),T=F("./zipObject"),y=F("./generate"),I=F("./nodejsUtils"),b=F("./nodejs/NodejsStreamInputAdapter"),k=function(E){"/"===E.slice(-1)&&(E=E.substring(0,E.length-1));var L=E.lastIndexOf("/");return 0<L?E.substring(0,L):""},v=function(E){return"/"!==E.slice(-1)&&(E+="/"),E},p=function(E,L){return L=void 0!==L?L:M.createFolders,E=v(E),this.files[E]||l.call(this,E,null,{dir:!0,createFolders:L}),this.files[E]};function S(E){return"[object RegExp]"===Object.prototype.toString.call(E)}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var L,ee,c;for(L in this.files)c=this.files[L],(ee=L.slice(this.root.length,L.length))&&L.slice(0,this.root.length)===this.root&&E(ee,c)},filter:function(E){var L=[];return this.forEach(function(ee,c){E(ee,c)&&L.push(c)}),L},file:function(E,L,ee){if(1!==arguments.length)return l.call(this,E=this.root+E,L,ee),this;if(S(E)){var c=E;return this.filter(function(ve,Pe){return!Pe.dir&&c.test(ve)})}var se=this.files[this.root+E];return se&&!se.dir?se:null},folder:function(E){if(!E)return this;if(S(E))return this.filter(function(se,ve){return ve.dir&&E.test(se)});var ee=p.call(this,this.root+E),c=this.clone();return c.root=ee.name,c},remove:function(E){var L=this.files[E=this.root+E];if(L||("/"!==E.slice(-1)&&(E+="/"),L=this.files[E]),L&&!L.dir)delete this.files[E];else for(var ee=this.filter(function(se,ve){return ve.name.slice(0,E.length)===E}),c=0;c<ee.length;c++)delete this.files[ee[c].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var L,ee={};try{if((ee=m.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:A.utf8encode})).type=ee.type.toLowerCase(),ee.compression=ee.compression.toUpperCase(),"binarystring"===ee.type&&(ee.type="string"),!ee.type)throw new Error("No output type specified.");m.checkSupport(ee.type),"darwin"!==ee.platform&&"freebsd"!==ee.platform&&"linux"!==ee.platform&&"sunos"!==ee.platform||(ee.platform="UNIX"),"win32"===ee.platform&&(ee.platform="DOS"),L=y.generateWorker(this,ee,ee.comment||this.comment||"")}catch(se){(L=new _("error")).error(se)}return new D(L,ee.type||"string",ee.mimeType)},generateAsync:function(E,L){return this.generateInternalStream(E).accumulate(L)},generateNodeStream:function(E,L){return(E=E||{}).type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(L)}};$.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(F,$,n){"use strict";$.exports=F("stream")},{stream:void 0}],17:[function(F,$,n){"use strict";var l=F("./DataReader");function A(m){l.call(this,m);for(var _=0;_<this.data.length;_++)m[_]=255&m[_]}F("../utils").inherits(A,l),A.prototype.byteAt=function(m){return this.data[this.zero+m]},A.prototype.lastIndexOfSignature=function(m){for(var _=m.charCodeAt(0),D=m.charCodeAt(1),M=m.charCodeAt(2),O=m.charCodeAt(3),T=this.length-4;0<=T;--T)if(this.data[T]===_&&this.data[T+1]===D&&this.data[T+2]===M&&this.data[T+3]===O)return T-this.zero;return-1},A.prototype.readAndCheckSignature=function(m){var _=m.charCodeAt(0),D=m.charCodeAt(1),M=m.charCodeAt(2),O=m.charCodeAt(3),T=this.readData(4);return _===T[0]&&D===T[1]&&M===T[2]&&O===T[3]},A.prototype.readData=function(m){if(this.checkOffset(m),0===m)return[];var _=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,_},$.exports=A},{"../utils":32,"./DataReader":18}],18:[function(F,$,n){"use strict";var l=F("../utils");function A(m){this.data=m,this.length=m.length,this.index=0,this.zero=0}A.prototype={checkOffset:function(m){this.checkIndex(this.index+m)},checkIndex:function(m){if(this.length<this.zero+m||m<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+m+"). Corrupted zip ?")},setIndex:function(m){this.checkIndex(m),this.index=m},skip:function(m){this.setIndex(this.index+m)},byteAt:function(){},readInt:function(m){var _,D=0;for(this.checkOffset(m),_=this.index+m-1;_>=this.index;_--)D=(D<<8)+this.byteAt(_);return this.index+=m,D},readString:function(m){return l.transformTo("string",this.readData(m))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var m=this.readInt(4);return new Date(Date.UTC(1980+(m>>25&127),(m>>21&15)-1,m>>16&31,m>>11&31,m>>5&63,(31&m)<<1))}},$.exports=A},{"../utils":32}],19:[function(F,$,n){"use strict";var l=F("./Uint8ArrayReader");function A(m){l.call(this,m)}F("../utils").inherits(A,l),A.prototype.readData=function(m){this.checkOffset(m);var _=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,_},$.exports=A},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(F,$,n){"use strict";var l=F("./DataReader");function A(m){l.call(this,m)}F("../utils").inherits(A,l),A.prototype.byteAt=function(m){return this.data.charCodeAt(this.zero+m)},A.prototype.lastIndexOfSignature=function(m){return this.data.lastIndexOf(m)-this.zero},A.prototype.readAndCheckSignature=function(m){return m===this.readData(4)},A.prototype.readData=function(m){this.checkOffset(m);var _=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,_},$.exports=A},{"../utils":32,"./DataReader":18}],21:[function(F,$,n){"use strict";var l=F("./ArrayReader");function A(m){l.call(this,m)}F("../utils").inherits(A,l),A.prototype.readData=function(m){if(this.checkOffset(m),0===m)return new Uint8Array(0);var _=this.data.subarray(this.zero+this.index,this.zero+this.index+m);return this.index+=m,_},$.exports=A},{"../utils":32,"./ArrayReader":17}],22:[function(F,$,n){"use strict";var l=F("../utils"),A=F("../support"),m=F("./ArrayReader"),_=F("./StringReader"),D=F("./NodeBufferReader"),M=F("./Uint8ArrayReader");$.exports=function(O){var T=l.getTypeOf(O);return l.checkSupport(T),"string"!==T||A.uint8array?"nodebuffer"===T?new D(O):A.uint8array?new M(l.transformTo("uint8array",O)):new m(l.transformTo("array",O)):new _(O)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(F,$,n){"use strict";n.LOCAL_FILE_HEADER="PK\x03\x04",n.CENTRAL_FILE_HEADER="PK\x01\x02",n.CENTRAL_DIRECTORY_END="PK\x05\x06",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(F,$,n){"use strict";var l=F("./GenericWorker"),A=F("../utils");function m(_){l.call(this,"ConvertWorker to "+_),this.destType=_}A.inherits(m,l),m.prototype.processChunk=function(_){this.push({data:A.transformTo(this.destType,_.data),meta:_.meta})},$.exports=m},{"../utils":32,"./GenericWorker":28}],25:[function(F,$,n){"use strict";var l=F("./GenericWorker"),A=F("../crc32");function m(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}F("../utils").inherits(m,l),m.prototype.processChunk=function(_){this.streamInfo.crc32=A(_.data,this.streamInfo.crc32||0),this.push(_)},$.exports=m},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(F,$,n){"use strict";var l=F("../utils"),A=F("./GenericWorker");function m(_){A.call(this,"DataLengthProbe for "+_),this.propName=_,this.withStreamInfo(_,0)}l.inherits(m,A),m.prototype.processChunk=function(_){_&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+_.data.length),A.prototype.processChunk.call(this,_)},$.exports=m},{"../utils":32,"./GenericWorker":28}],27:[function(F,$,n){"use strict";var l=F("../utils"),A=F("./GenericWorker");function m(_){A.call(this,"DataWorker");var D=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,_.then(function(M){D.dataIsReady=!0,D.data=M,D.max=M&&M.length||0,D.type=l.getTypeOf(M),D.isPaused||D._tickAndRepeat()},function(M){D.error(M)})}l.inherits(m,A),m.prototype.cleanUp=function(){A.prototype.cleanUp.call(this),this.data=null},m.prototype.resume=function(){return!!A.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},m.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},m.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var _=null,D=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":_=this.data.substring(this.index,D);break;case"uint8array":_=this.data.subarray(this.index,D);break;case"array":case"nodebuffer":_=this.data.slice(this.index,D)}return this.index=D,this.push({data:_,meta:{percent:this.max?this.index/this.max*100:0}})},$.exports=m},{"../utils":32,"./GenericWorker":28}],28:[function(F,$,n){"use strict";function l(A){this.name=A||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(A){this.emit("data",A)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(A){this.emit("error",A)}return!0},error:function(A){return!this.isFinished&&(this.isPaused?this.generatedError=A:(this.isFinished=!0,this.emit("error",A),this.previous&&this.previous.error(A),this.cleanUp()),!0)},on:function(A,m){return this._listeners[A].push(m),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(A,m){if(this._listeners[A])for(var _=0;_<this._listeners[A].length;_++)this._listeners[A][_].call(this,m)},pipe:function(A){return A.registerPrevious(this)},registerPrevious:function(A){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=A.streamInfo,this.mergeStreamInfo(),this.previous=A;var m=this;return A.on("data",function(_){m.processChunk(_)}),A.on("end",function(){m.end()}),A.on("error",function(_){m.error(_)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var A=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),A=!0),this.previous&&this.previous.resume(),!A},flush:function(){},processChunk:function(A){this.push(A)},withStreamInfo:function(A,m){return this.extraStreamInfo[A]=m,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var A in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,A)&&(this.streamInfo[A]=this.extraStreamInfo[A])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var A="Worker "+this.name;return this.previous?this.previous+" -> "+A:A}},$.exports=l},{}],29:[function(F,$,n){"use strict";var l=F("../utils"),A=F("./ConvertWorker"),m=F("./GenericWorker"),_=F("../base64"),D=F("../support"),M=F("../external"),O=null;if(D.nodestream)try{O=F("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(I,b,k){var v=b;switch(b){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=b,this._mimeType=k,l.checkSupport(v),this._worker=I.pipe(new A(v)),I.lock()}catch(p){this._worker=new m("error"),this._worker.error(p)}}y.prototype={accumulate:function(I){return function T(I,b){return new M.Promise(function(k,v){var p=[],S=I._internalType,C=I._outputType,E=I._mimeType;I.on("data",function(L,ee){p.push(L),b&&b(ee)}).on("error",function(L){p=[],v(L)}).on("end",function(){try{var L=function(ee,c,se){switch(ee){case"blob":return l.newBlob(l.transformTo("arraybuffer",c),se);case"base64":return _.encode(c);default:return l.transformTo(ee,c)}}(C,function(ee,c){var se,ve=0,Pe=null,R=0;for(se=0;se<c.length;se++)R+=c[se].length;switch(ee){case"string":return c.join("");case"array":return Array.prototype.concat.apply([],c);case"uint8array":for(Pe=new Uint8Array(R),se=0;se<c.length;se++)Pe.set(c[se],ve),ve+=c[se].length;return Pe;case"nodebuffer":return Buffer.concat(c);default:throw new Error("concat : unsupported type '"+ee+"'")}}(S,p),E);k(L)}catch(ee){v(ee)}p=[]}).resume()})}(this,I)},on:function(I,b){var k=this;return this._worker.on(I,"data"===I?function(v){b.call(k,v.data,v.meta)}:function(){l.delay(b,arguments,k)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(I){if(l.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new O(this,{objectMode:"nodebuffer"!==this._outputType},I)}},$.exports=y},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(F,$,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var l=new ArrayBuffer(0);try{n.blob=0===new Blob([l],{type:"application/zip"}).size}catch{try{var A=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);A.append(l),n.blob=0===A.getBlob("application/zip").size}catch{n.blob=!1}}}try{n.nodestream=!!F("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(F,$,n){"use strict";for(var l=F("./utils"),A=F("./support"),m=F("./nodejsUtils"),_=F("./stream/GenericWorker"),D=new Array(256),M=0;M<256;M++)D[M]=252<=M?6:248<=M?5:240<=M?4:224<=M?3:192<=M?2:1;function O(){_.call(this,"utf-8 decode"),this.leftOver=null}function T(){_.call(this,"utf-8 encode")}D[254]=D[254]=1,n.utf8encode=function(y){return A.nodebuffer?m.newBufferFrom(y,"utf-8"):function(I){var b,k,v,p,S,C=I.length,E=0;for(p=0;p<C;p++)55296==(64512&(k=I.charCodeAt(p)))&&p+1<C&&56320==(64512&(v=I.charCodeAt(p+1)))&&(k=65536+(k-55296<<10)+(v-56320),p++),E+=k<128?1:k<2048?2:k<65536?3:4;for(b=A.uint8array?new Uint8Array(E):new Array(E),p=S=0;S<E;p++)55296==(64512&(k=I.charCodeAt(p)))&&p+1<C&&56320==(64512&(v=I.charCodeAt(p+1)))&&(k=65536+(k-55296<<10)+(v-56320),p++),k<128?b[S++]=k:(k<2048?b[S++]=192|k>>>6:(k<65536?b[S++]=224|k>>>12:(b[S++]=240|k>>>18,b[S++]=128|k>>>12&63),b[S++]=128|k>>>6&63),b[S++]=128|63&k);return b}(y)},n.utf8decode=function(y){return A.nodebuffer?l.transformTo("nodebuffer",y).toString("utf-8"):function(I){var b,k,v,p,S=I.length,C=new Array(2*S);for(b=k=0;b<S;)if((v=I[b++])<128)C[k++]=v;else if(4<(p=D[v]))C[k++]=65533,b+=p-1;else{for(v&=2===p?31:3===p?15:7;1<p&&b<S;)v=v<<6|63&I[b++],p--;1<p?C[k++]=65533:v<65536?C[k++]=v:(C[k++]=55296|(v-=65536)>>10&1023,C[k++]=56320|1023&v)}return C.length!==k&&(C.subarray?C=C.subarray(0,k):C.length=k),l.applyFromCharCode(C)}(y=l.transformTo(A.uint8array?"uint8array":"array",y))},l.inherits(O,_),O.prototype.processChunk=function(y){var I=l.transformTo(A.uint8array?"uint8array":"array",y.data);if(this.leftOver&&this.leftOver.length){if(A.uint8array){var b=I;(I=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),I.set(b,this.leftOver.length)}else I=this.leftOver.concat(I);this.leftOver=null}var k=function(p,S){var C;for((S=S||p.length)>p.length&&(S=p.length),C=S-1;0<=C&&128==(192&p[C]);)C--;return C<0||0===C?S:C+D[p[C]]>S?C:S}(I),v=I;k!==I.length&&(A.uint8array?(v=I.subarray(0,k),this.leftOver=I.subarray(k,I.length)):(v=I.slice(0,k),this.leftOver=I.slice(k,I.length))),this.push({data:n.utf8decode(v),meta:y.meta})},O.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=O,l.inherits(T,_),T.prototype.processChunk=function(y){this.push({data:n.utf8encode(y.data),meta:y.meta})},n.Utf8EncodeWorker=T},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(F,$,n){"use strict";var l=F("./support"),A=F("./base64"),m=F("./nodejsUtils"),_=F("./external");function D(b){return b}function M(b,k){for(var v=0;v<b.length;++v)k[v]=255&b.charCodeAt(v);return k}F("setimmediate"),n.newBlob=function(b,k){n.checkSupport("blob");try{return new Blob([b],{type:k})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(b),v.getBlob(k)}catch{throw new Error("Bug : can't construct the Blob.")}}};var O={stringifyByChunk:function(b,k,v){var p=[],S=0,C=b.length;if(C<=v)return String.fromCharCode.apply(null,b);for(;S<C;)p.push(String.fromCharCode.apply(null,"array"===k||"nodebuffer"===k?b.slice(S,Math.min(S+v,C)):b.subarray(S,Math.min(S+v,C)))),S+=v;return p.join("")},stringifyByChar:function(b){for(var k="",v=0;v<b.length;v++)k+=String.fromCharCode(b[v]);return k},applyCanBeUsed:{uint8array:function(){try{return l.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return l.nodebuffer&&1===String.fromCharCode.apply(null,m.allocBuffer(1)).length}catch{return!1}}()}};function T(b){var k=65536,v=n.getTypeOf(b),p=!0;if("uint8array"===v?p=O.applyCanBeUsed.uint8array:"nodebuffer"===v&&(p=O.applyCanBeUsed.nodebuffer),p)for(;1<k;)try{return O.stringifyByChunk(b,v,k)}catch{k=Math.floor(k/2)}return O.stringifyByChar(b)}function y(b,k){for(var v=0;v<b.length;v++)k[v]=b[v];return k}n.applyFromCharCode=T;var I={};I.string={string:D,array:function(b){return M(b,new Array(b.length))},arraybuffer:function(b){return I.string.uint8array(b).buffer},uint8array:function(b){return M(b,new Uint8Array(b.length))},nodebuffer:function(b){return M(b,m.allocBuffer(b.length))}},I.array={string:T,array:D,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return m.newBufferFrom(b)}},I.arraybuffer={string:function(b){return T(new Uint8Array(b))},array:function(b){return y(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:D,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return m.newBufferFrom(new Uint8Array(b))}},I.uint8array={string:T,array:function(b){return y(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:D,nodebuffer:function(b){return m.newBufferFrom(b)}},I.nodebuffer={string:T,array:function(b){return y(b,new Array(b.length))},arraybuffer:function(b){return I.nodebuffer.uint8array(b).buffer},uint8array:function(b){return y(b,new Uint8Array(b.length))},nodebuffer:D},n.transformTo=function(b,k){if(k=k||"",!b)return k;n.checkSupport(b);var v=n.getTypeOf(k);return I[v][b](k)},n.resolve=function(b){for(var k=b.split("/"),v=[],p=0;p<k.length;p++){var S=k[p];"."===S||""===S&&0!==p&&p!==k.length-1||(".."===S?v.pop():v.push(S))}return v.join("/")},n.getTypeOf=function(b){return"string"==typeof b?"string":"[object Array]"===Object.prototype.toString.call(b)?"array":l.nodebuffer&&m.isBuffer(b)?"nodebuffer":l.uint8array&&b instanceof Uint8Array?"uint8array":l.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(b){if(!l[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(b){var k,v,p="";for(v=0;v<(b||"").length;v++)p+="\\x"+((k=b.charCodeAt(v))<16?"0":"")+k.toString(16).toUpperCase();return p},n.delay=function(b,k,v){setImmediate(function(){b.apply(v||null,k||[])})},n.inherits=function(b,k){function v(){}v.prototype=k.prototype,b.prototype=new v},n.extend=function(){var b,k,v={};for(b=0;b<arguments.length;b++)for(k in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],k)&&void 0===v[k]&&(v[k]=arguments[b][k]);return v},n.prepareContent=function(b,k,v,p,S){return _.Promise.resolve(k).then(function(C){return l.blob&&(C instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C)))&&typeof FileReader<"u"?new _.Promise(function(E,L){var ee=new FileReader;ee.onload=function(c){E(c.target.result)},ee.onerror=function(c){L(c.target.error)},ee.readAsArrayBuffer(C)}):C}).then(function(C){var L,E=n.getTypeOf(C);return E?("arraybuffer"===E?C=n.transformTo("uint8array",C):"string"===E&&(S?C=A.decode(C):v&&!0!==p&&(C=M(L=C,l.uint8array?new Uint8Array(L.length):new Array(L.length)))),C):_.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(F,$,n){"use strict";var l=F("./reader/readerFor"),A=F("./utils"),m=F("./signature"),_=F("./zipEntry"),D=F("./support");function M(O){this.files=[],this.loadOptions=O}M.prototype={checkSignature:function(O){if(!this.reader.readAndCheckSignature(O)){this.reader.index-=4;var T=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+A.pretty(T)+", expected "+A.pretty(O)+")")}},isSignature:function(O,T){var y=this.reader.index;this.reader.setIndex(O);var I=this.reader.readString(4)===T;return this.reader.setIndex(y),I},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var O=this.reader.readData(this.zipCommentLength),y=A.transformTo(D.uint8array?"uint8array":"array",O);this.zipComment=this.loadOptions.decodeFileName(y)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var O,T,y,I=this.zip64EndOfCentralSize-44;0<I;)O=this.reader.readInt(2),T=this.reader.readInt(4),y=this.reader.readData(T),this.zip64ExtensibleData[O]={id:O,length:T,value:y}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var O,T;for(O=0;O<this.files.length;O++)this.reader.setIndex((T=this.files[O]).localHeaderOffset),this.checkSignature(m.LOCAL_FILE_HEADER),T.readLocalPart(this.reader),T.handleUTF8(),T.processAttributes()},readCentralDir:function(){var O;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(m.CENTRAL_FILE_HEADER);)(O=new _({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(O);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var O=this.reader.lastIndexOfSignature(m.CENTRAL_DIRECTORY_END);if(O<0)throw this.isSignature(0,m.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(O);var T=O;if(this.checkSignature(m.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===A.MAX_VALUE_16BITS||this.diskWithCentralDirStart===A.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===A.MAX_VALUE_16BITS||this.centralDirRecords===A.MAX_VALUE_16BITS||this.centralDirSize===A.MAX_VALUE_32BITS||this.centralDirOffset===A.MAX_VALUE_32BITS){if(this.zip64=!0,(O=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(O),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,m.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var y=this.centralDirOffset+this.centralDirSize;this.zip64&&(y+=20,y+=12+this.zip64EndOfCentralSize);var I=T-y;if(0<I)this.isSignature(T,m.CENTRAL_FILE_HEADER)||(this.reader.zero=I);else if(I<0)throw new Error("Corrupted zip: missing "+Math.abs(I)+" bytes.")},prepareReader:function(O){this.reader=l(O)},load:function(O){this.prepareReader(O),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},$.exports=M},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(F,$,n){"use strict";var l=F("./reader/readerFor"),A=F("./utils"),m=F("./compressedObject"),_=F("./crc32"),D=F("./utf8"),M=F("./compressions"),O=F("./support");function T(y,I){this.options=y,this.loadOptions=I}T.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(y){var I,b;if(y.skip(22),this.fileNameLength=y.readInt(2),b=y.readInt(2),this.fileName=y.readData(this.fileNameLength),y.skip(b),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(I=function(k){for(var v in M)if(Object.prototype.hasOwnProperty.call(M,v)&&M[v].magic===k)return M[v];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+A.pretty(this.compressionMethod)+" unknown (inner file : "+A.transformTo("string",this.fileName)+")");this.decompressed=new m(this.compressedSize,this.uncompressedSize,this.crc32,I,y.readData(this.compressedSize))},readCentralPart:function(y){this.versionMadeBy=y.readInt(2),y.skip(2),this.bitFlag=y.readInt(2),this.compressionMethod=y.readString(2),this.date=y.readDate(),this.crc32=y.readInt(4),this.compressedSize=y.readInt(4),this.uncompressedSize=y.readInt(4);var I=y.readInt(2);if(this.extraFieldsLength=y.readInt(2),this.fileCommentLength=y.readInt(2),this.diskNumberStart=y.readInt(2),this.internalFileAttributes=y.readInt(2),this.externalFileAttributes=y.readInt(4),this.localHeaderOffset=y.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");y.skip(I),this.readExtraFields(y),this.parseZIP64ExtraField(y),this.fileComment=y.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var y=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==y&&(this.dosPermissions=63&this.externalFileAttributes),3==y&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var y=l(this.extraFields[1].value);this.uncompressedSize===A.MAX_VALUE_32BITS&&(this.uncompressedSize=y.readInt(8)),this.compressedSize===A.MAX_VALUE_32BITS&&(this.compressedSize=y.readInt(8)),this.localHeaderOffset===A.MAX_VALUE_32BITS&&(this.localHeaderOffset=y.readInt(8)),this.diskNumberStart===A.MAX_VALUE_32BITS&&(this.diskNumberStart=y.readInt(4))}},readExtraFields:function(y){var I,b,k,v=y.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});y.index+4<v;)I=y.readInt(2),b=y.readInt(2),k=y.readData(b),this.extraFields[I]={id:I,length:b,value:k};y.setIndex(v)},handleUTF8:function(){var y=O.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=D.utf8decode(this.fileName),this.fileCommentStr=D.utf8decode(this.fileComment);else{var I=this.findExtraFieldUnicodePath();if(null!==I)this.fileNameStr=I;else{var b=A.transformTo(y,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var k=this.findExtraFieldUnicodeComment();if(null!==k)this.fileCommentStr=k;else{var v=A.transformTo(y,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var y=this.extraFields[28789];if(y){var I=l(y.value);return 1!==I.readInt(1)||_(this.fileName)!==I.readInt(4)?null:D.utf8decode(I.readData(y.length-5))}return null},findExtraFieldUnicodeComment:function(){var y=this.extraFields[25461];if(y){var I=l(y.value);return 1!==I.readInt(1)||_(this.fileComment)!==I.readInt(4)?null:D.utf8decode(I.readData(y.length-5))}return null}},$.exports=T},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(F,$,n){"use strict";function l(I,b,k){this.name=I,this.dir=k.dir,this.date=k.date,this.comment=k.comment,this.unixPermissions=k.unixPermissions,this.dosPermissions=k.dosPermissions,this._data=b,this._dataBinary=k.binary,this.options={compression:k.compression,compressionOptions:k.compressionOptions}}var A=F("./stream/StreamHelper"),m=F("./stream/DataWorker"),_=F("./utf8"),D=F("./compressedObject"),M=F("./stream/GenericWorker");l.prototype={internalStream:function(I){var b=null,k="string";try{if(!I)throw new Error("No output type specified.");var v="string"===(k=I.toLowerCase())||"text"===k;"binarystring"!==k&&"text"!==k||(k="string"),b=this._decompressWorker();var p=!this._dataBinary;p&&!v&&(b=b.pipe(new _.Utf8EncodeWorker)),!p&&v&&(b=b.pipe(new _.Utf8DecodeWorker))}catch(S){(b=new M("error")).error(S)}return new A(b,k,"")},async:function(I,b){return this.internalStream(I).accumulate(b)},nodeStream:function(I,b){return this.internalStream(I||"nodebuffer").toNodejsStream(b)},_compressWorker:function(I,b){if(this._data instanceof D&&this._data.compression.magic===I.magic)return this._data.getCompressedWorker();var k=this._decompressWorker();return this._dataBinary||(k=k.pipe(new _.Utf8EncodeWorker)),D.createWorkerFrom(k,I,b)},_decompressWorker:function(){return this._data instanceof D?this._data.getContentWorker():this._data instanceof M?this._data:new m(this._data)}};for(var O=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],T=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},y=0;y<O.length;y++)l.prototype[O[y]]=T;$.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(F,$,n){(function(l){"use strict";var A,m,_=l.MutationObserver||l.WebKitMutationObserver;if(_){var D=0,M=new _(I),O=l.document.createTextNode("");M.observe(O,{characterData:!0}),A=function(){O.data=D=++D%2}}else if(l.setImmediate||void 0===l.MessageChannel)A="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var b=l.document.createElement("script");b.onreadystatechange=function(){I(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},l.document.documentElement.appendChild(b)}:function(){setTimeout(I,0)};else{var T=new l.MessageChannel;T.port1.onmessage=I,A=function(){T.port2.postMessage(0)}}var y=[];function I(){var b,k;m=!0;for(var v=y.length;v;){for(k=y,y=[],b=-1;++b<v;)k[b]();v=y.length}m=!1}$.exports=function(b){1!==y.push(b)||m||A()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(F,$,n){"use strict";var l=F("immediate");function A(){}var m={},_=["REJECTED"],D=["FULFILLED"],M=["PENDING"];function O(v){if("function"!=typeof v)throw new TypeError("resolver must be a function");this.state=M,this.queue=[],this.outcome=void 0,v!==A&&b(this,v)}function T(v,p,S){this.promise=v,"function"==typeof p&&(this.onFulfilled=p,this.callFulfilled=this.otherCallFulfilled),"function"==typeof S&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function y(v,p,S){l(function(){var C;try{C=p(S)}catch(E){return m.reject(v,E)}C===v?m.reject(v,new TypeError("Cannot resolve promise with itself")):m.resolve(v,C)})}function I(v){var p=v&&v.then;if(v&&("object"==typeof v||"function"==typeof v)&&"function"==typeof p)return function(){p.apply(v,arguments)}}function b(v,p){var S=!1;function C(ee){S||(S=!0,m.reject(v,ee))}function E(ee){S||(S=!0,m.resolve(v,ee))}var L=k(function(){p(E,C)});"error"===L.status&&C(L.value)}function k(v,p){var S={};try{S.value=v(p),S.status="success"}catch(C){S.status="error",S.value=C}return S}($.exports=O).prototype.finally=function(v){if("function"!=typeof v)return this;var p=this.constructor;return this.then(function(S){return p.resolve(v()).then(function(){return S})},function(S){return p.resolve(v()).then(function(){throw S})})},O.prototype.catch=function(v){return this.then(null,v)},O.prototype.then=function(v,p){if("function"!=typeof v&&this.state===D||"function"!=typeof p&&this.state===_)return this;var S=new this.constructor(A);return this.state!==M?y(S,this.state===D?v:p,this.outcome):this.queue.push(new T(S,v,p)),S},T.prototype.callFulfilled=function(v){m.resolve(this.promise,v)},T.prototype.otherCallFulfilled=function(v){y(this.promise,this.onFulfilled,v)},T.prototype.callRejected=function(v){m.reject(this.promise,v)},T.prototype.otherCallRejected=function(v){y(this.promise,this.onRejected,v)},m.resolve=function(v,p){var S=k(I,p);if("error"===S.status)return m.reject(v,S.value);var C=S.value;if(C)b(v,C);else{v.state=D,v.outcome=p;for(var E=-1,L=v.queue.length;++E<L;)v.queue[E].callFulfilled(p)}return v},m.reject=function(v,p){v.state=_,v.outcome=p;for(var S=-1,C=v.queue.length;++S<C;)v.queue[S].callRejected(p);return v},O.resolve=function(v){return v instanceof this?v:m.resolve(new this(A),v)},O.reject=function(v){var p=new this(A);return m.reject(p,v)},O.all=function(v){var p=this;if("[object Array]"!==Object.prototype.toString.call(v))return this.reject(new TypeError("must be an array"));var S=v.length,C=!1;if(!S)return this.resolve([]);for(var E=new Array(S),L=0,ee=-1,c=new this(A);++ee<S;)se(v[ee],ee);return c;function se(ve,Pe){p.resolve(ve).then(function(R){E[Pe]=R,++L!==S||C||(C=!0,m.resolve(c,E))},function(R){C||(C=!0,m.reject(c,R))})}},O.race=function(v){if("[object Array]"!==Object.prototype.toString.call(v))return this.reject(new TypeError("must be an array"));var S=v.length,C=!1;if(!S)return this.resolve([]);for(var E=-1,L=new this(A);++E<S;)this.resolve(v[E]).then(function(c){C||(C=!0,m.resolve(L,c))},function(c){C||(C=!0,m.reject(L,c))});return L}},{immediate:36}],38:[function(F,$,n){"use strict";var l={};(0,F("./lib/utils/common").assign)(l,F("./lib/deflate"),F("./lib/inflate"),F("./lib/zlib/constants")),$.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(F,$,n){"use strict";var l=F("./zlib/deflate"),A=F("./utils/common"),m=F("./utils/strings"),_=F("./zlib/messages"),D=F("./zlib/zstream"),M=Object.prototype.toString,O=0,T=-1,y=0,I=8;function b(v){if(!(this instanceof b))return new b(v);this.options=A.assign({level:T,method:I,chunkSize:16384,windowBits:15,memLevel:8,strategy:y,to:""},v||{});var p=this.options;p.raw&&0<p.windowBits?p.windowBits=-p.windowBits:p.gzip&&0<p.windowBits&&p.windowBits<16&&(p.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var S=l.deflateInit2(this.strm,p.level,p.method,p.windowBits,p.memLevel,p.strategy);if(S!==O)throw new Error(_[S]);if(p.header&&l.deflateSetHeader(this.strm,p.header),p.dictionary){var C;if(C="string"==typeof p.dictionary?m.string2buf(p.dictionary):"[object ArrayBuffer]"===M.call(p.dictionary)?new Uint8Array(p.dictionary):p.dictionary,(S=l.deflateSetDictionary(this.strm,C))!==O)throw new Error(_[S]);this._dict_set=!0}}function k(v,p){var S=new b(p);if(S.push(v,!0),S.err)throw S.msg||_[S.err];return S.result}b.prototype.push=function(v,p){var S,C,E=this.strm,L=this.options.chunkSize;if(this.ended)return!1;C=p===~~p?p:!0===p?4:0,E.input="string"==typeof v?m.string2buf(v):"[object ArrayBuffer]"===M.call(v)?new Uint8Array(v):v,E.next_in=0,E.avail_in=E.input.length;do{if(0===E.avail_out&&(E.output=new A.Buf8(L),E.next_out=0,E.avail_out=L),1!==(S=l.deflate(E,C))&&S!==O)return this.onEnd(S),!(this.ended=!0);0!==E.avail_out&&(0!==E.avail_in||4!==C&&2!==C)||this.onData("string"===this.options.to?m.buf2binstring(A.shrinkBuf(E.output,E.next_out)):A.shrinkBuf(E.output,E.next_out))}while((0<E.avail_in||0===E.avail_out)&&1!==S);return 4===C?(S=l.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===O):2!==C||(this.onEnd(O),!(E.avail_out=0))},b.prototype.onData=function(v){this.chunks.push(v)},b.prototype.onEnd=function(v){v===O&&(this.result="string"===this.options.to?this.chunks.join(""):A.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},n.Deflate=b,n.deflate=k,n.deflateRaw=function(v,p){return(p=p||{}).raw=!0,k(v,p)},n.gzip=function(v,p){return(p=p||{}).gzip=!0,k(v,p)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(F,$,n){"use strict";var l=F("./zlib/inflate"),A=F("./utils/common"),m=F("./utils/strings"),_=F("./zlib/constants"),D=F("./zlib/messages"),M=F("./zlib/zstream"),O=F("./zlib/gzheader"),T=Object.prototype.toString;function y(b){if(!(this instanceof y))return new y(b);this.options=A.assign({chunkSize:16384,windowBits:0,to:""},b||{});var k=this.options;k.raw&&0<=k.windowBits&&k.windowBits<16&&(k.windowBits=-k.windowBits,0===k.windowBits&&(k.windowBits=-15)),!(0<=k.windowBits&&k.windowBits<16)||b&&b.windowBits||(k.windowBits+=32),15<k.windowBits&&k.windowBits<48&&!(15&k.windowBits)&&(k.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new M,this.strm.avail_out=0;var v=l.inflateInit2(this.strm,k.windowBits);if(v!==_.Z_OK)throw new Error(D[v]);this.header=new O,l.inflateGetHeader(this.strm,this.header)}function I(b,k){var v=new y(k);if(v.push(b,!0),v.err)throw v.msg||D[v.err];return v.result}y.prototype.push=function(b,k){var v,p,S,C,E,L,ee=this.strm,c=this.options.chunkSize,se=this.options.dictionary,ve=!1;if(this.ended)return!1;p=k===~~k?k:!0===k?_.Z_FINISH:_.Z_NO_FLUSH,ee.input="string"==typeof b?m.binstring2buf(b):"[object ArrayBuffer]"===T.call(b)?new Uint8Array(b):b,ee.next_in=0,ee.avail_in=ee.input.length;do{if(0===ee.avail_out&&(ee.output=new A.Buf8(c),ee.next_out=0,ee.avail_out=c),(v=l.inflate(ee,_.Z_NO_FLUSH))===_.Z_NEED_DICT&&se&&(L="string"==typeof se?m.string2buf(se):"[object ArrayBuffer]"===T.call(se)?new Uint8Array(se):se,v=l.inflateSetDictionary(this.strm,L)),v===_.Z_BUF_ERROR&&!0===ve&&(v=_.Z_OK,ve=!1),v!==_.Z_STREAM_END&&v!==_.Z_OK)return this.onEnd(v),!(this.ended=!0);ee.next_out&&(0!==ee.avail_out&&v!==_.Z_STREAM_END&&(0!==ee.avail_in||p!==_.Z_FINISH&&p!==_.Z_SYNC_FLUSH)||("string"===this.options.to?(S=m.utf8border(ee.output,ee.next_out),C=ee.next_out-S,E=m.buf2string(ee.output,S),ee.next_out=C,ee.avail_out=c-C,C&&A.arraySet(ee.output,ee.output,S,C,0),this.onData(E)):this.onData(A.shrinkBuf(ee.output,ee.next_out)))),0===ee.avail_in&&0===ee.avail_out&&(ve=!0)}while((0<ee.avail_in||0===ee.avail_out)&&v!==_.Z_STREAM_END);return v===_.Z_STREAM_END&&(p=_.Z_FINISH),p===_.Z_FINISH?(v=l.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===_.Z_OK):p!==_.Z_SYNC_FLUSH||(this.onEnd(_.Z_OK),!(ee.avail_out=0))},y.prototype.onData=function(b){this.chunks.push(b)},y.prototype.onEnd=function(b){b===_.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):A.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},n.Inflate=y,n.inflate=I,n.inflateRaw=function(b,k){return(k=k||{}).raw=!0,I(b,k)},n.ungzip=I},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(F,$,n){"use strict";var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(_){for(var D=Array.prototype.slice.call(arguments,1);D.length;){var M=D.shift();if(M){if("object"!=typeof M)throw new TypeError(M+"must be non-object");for(var O in M)M.hasOwnProperty(O)&&(_[O]=M[O])}}return _},n.shrinkBuf=function(_,D){return _.length===D?_:_.subarray?_.subarray(0,D):(_.length=D,_)};var A={arraySet:function(_,D,M,O,T){if(D.subarray&&_.subarray)_.set(D.subarray(M,M+O),T);else for(var y=0;y<O;y++)_[T+y]=D[M+y]},flattenChunks:function(_){var D,M,O,T,y,I;for(D=O=0,M=_.length;D<M;D++)O+=_[D].length;for(I=new Uint8Array(O),D=T=0,M=_.length;D<M;D++)I.set(y=_[D],T),T+=y.length;return I}},m={arraySet:function(_,D,M,O,T){for(var y=0;y<O;y++)_[T+y]=D[M+y]},flattenChunks:function(_){return[].concat.apply([],_)}};n.setTyped=function(_){_?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,A)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,m))},n.setTyped(l)},{}],42:[function(F,$,n){"use strict";var l=F("./common"),A=!0,m=!0;try{String.fromCharCode.apply(null,[0])}catch{A=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{m=!1}for(var _=new l.Buf8(256),D=0;D<256;D++)_[D]=252<=D?6:248<=D?5:240<=D?4:224<=D?3:192<=D?2:1;function M(O,T){if(T<65537&&(O.subarray&&m||!O.subarray&&A))return String.fromCharCode.apply(null,l.shrinkBuf(O,T));for(var y="",I=0;I<T;I++)y+=String.fromCharCode(O[I]);return y}_[254]=_[254]=1,n.string2buf=function(O){var T,y,I,b,k,v=O.length,p=0;for(b=0;b<v;b++)55296==(64512&(y=O.charCodeAt(b)))&&b+1<v&&56320==(64512&(I=O.charCodeAt(b+1)))&&(y=65536+(y-55296<<10)+(I-56320),b++),p+=y<128?1:y<2048?2:y<65536?3:4;for(T=new l.Buf8(p),b=k=0;k<p;b++)55296==(64512&(y=O.charCodeAt(b)))&&b+1<v&&56320==(64512&(I=O.charCodeAt(b+1)))&&(y=65536+(y-55296<<10)+(I-56320),b++),y<128?T[k++]=y:(y<2048?T[k++]=192|y>>>6:(y<65536?T[k++]=224|y>>>12:(T[k++]=240|y>>>18,T[k++]=128|y>>>12&63),T[k++]=128|y>>>6&63),T[k++]=128|63&y);return T},n.buf2binstring=function(O){return M(O,O.length)},n.binstring2buf=function(O){for(var T=new l.Buf8(O.length),y=0,I=T.length;y<I;y++)T[y]=O.charCodeAt(y);return T},n.buf2string=function(O,T){var y,I,b,k,v=T||O.length,p=new Array(2*v);for(y=I=0;y<v;)if((b=O[y++])<128)p[I++]=b;else if(4<(k=_[b]))p[I++]=65533,y+=k-1;else{for(b&=2===k?31:3===k?15:7;1<k&&y<v;)b=b<<6|63&O[y++],k--;1<k?p[I++]=65533:b<65536?p[I++]=b:(p[I++]=55296|(b-=65536)>>10&1023,p[I++]=56320|1023&b)}return M(p,I)},n.utf8border=function(O,T){var y;for((T=T||O.length)>O.length&&(T=O.length),y=T-1;0<=y&&128==(192&O[y]);)y--;return y<0||0===y?T:y+_[O[y]]>T?y:T}},{"./common":41}],43:[function(F,$,n){"use strict";$.exports=function(l,A,m,_){for(var D=65535&l,M=l>>>16&65535,O=0;0!==m;){for(m-=O=2e3<m?2e3:m;M=M+(D=D+A[_++]|0)|0,--O;);D%=65521,M%=65521}return D|M<<16}},{}],44:[function(F,$,n){"use strict";$.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(F,$,n){"use strict";var l=function(){for(var A,m=[],_=0;_<256;_++){A=_;for(var D=0;D<8;D++)A=1&A?3988292384^A>>>1:A>>>1;m[_]=A}return m}();$.exports=function(A,m,_,D){var M=l,O=D+_;A^=-1;for(var T=D;T<O;T++)A=A>>>8^M[255&(A^m[T])];return~A}},{}],46:[function(F,$,n){"use strict";var l,A=F("../utils/common"),m=F("./trees"),_=F("./adler32"),D=F("./crc32"),M=F("./messages"),O=0,y=0,I=-2,v=2,p=8,C=286,E=30,L=19,ee=2*C+1,c=15,se=3,ve=258,Pe=ve+se+1,R=42,K=113;function ke(d,ue){return d.msg=M[ue],ue}function X(d){return(d<<1)-(4<d?9:0)}function Te(d){for(var ue=d.length;0<=--ue;)d[ue]=0}function j(d){var ue=d.state,te=ue.pending;te>d.avail_out&&(te=d.avail_out),0!==te&&(A.arraySet(d.output,ue.pending_buf,ue.pending_out,te,d.next_out),d.next_out+=te,ue.pending_out+=te,d.total_out+=te,d.avail_out-=te,ue.pending-=te,0===ue.pending&&(ue.pending_out=0))}function q(d,ue){m._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,ue),d.block_start=d.strstart,j(d.strm)}function Ie(d,ue){d.pending_buf[d.pending++]=ue}function _e(d,ue){d.pending_buf[d.pending++]=ue>>>8&255,d.pending_buf[d.pending++]=255&ue}function Ce(d,ue){var te,V,B=d.max_chain_length,J=d.strstart,he=d.prev_length,ge=d.nice_match,Y=d.strstart>d.w_size-Pe?d.strstart-(d.w_size-Pe):0,Ee=d.window,Ne=d.w_mask,Se=d.prev,Me=d.strstart+ve,tt=Ee[J+he-1],Xe=Ee[J+he];d.prev_length>=d.good_match&&(B>>=2),ge>d.lookahead&&(ge=d.lookahead);do{if(Ee[(te=ue)+he]===Xe&&Ee[te+he-1]===tt&&Ee[te]===Ee[J]&&Ee[++te]===Ee[J+1]){J+=2,te++;do{}while(Ee[++J]===Ee[++te]&&Ee[++J]===Ee[++te]&&Ee[++J]===Ee[++te]&&Ee[++J]===Ee[++te]&&Ee[++J]===Ee[++te]&&Ee[++J]===Ee[++te]&&Ee[++J]===Ee[++te]&&Ee[++J]===Ee[++te]&&J<Me);if(V=ve-(Me-J),J=Me-ve,he<V){if(d.match_start=ue,ge<=(he=V))break;tt=Ee[J+he-1],Xe=Ee[J+he]}}}while((ue=Se[ue&Ne])>Y&&0!=--B);return he<=d.lookahead?he:d.lookahead}function Je(d){var ue,te,V,B,J,he,ge,Y,Ee,Ne,Se=d.w_size;do{if(B=d.window_size-d.lookahead-d.strstart,d.strstart>=Se+(Se-Pe)){for(A.arraySet(d.window,d.window,Se,Se,0),d.match_start-=Se,d.strstart-=Se,d.block_start-=Se,ue=te=d.hash_size;V=d.head[--ue],d.head[ue]=Se<=V?V-Se:0,--te;);for(ue=te=Se;V=d.prev[--ue],d.prev[ue]=Se<=V?V-Se:0,--te;);B+=Se}if(0===d.strm.avail_in)break;if(ge=d.window,Y=d.strstart+d.lookahead,Ne=void 0,(Ee=B)<(Ne=(he=d.strm).avail_in)&&(Ne=Ee),te=0===Ne?0:(he.avail_in-=Ne,A.arraySet(ge,he.input,he.next_in,Ne,Y),1===he.state.wrap?he.adler=_(he.adler,ge,Ne,Y):2===he.state.wrap&&(he.adler=D(he.adler,ge,Ne,Y)),he.next_in+=Ne,he.total_in+=Ne,Ne),d.lookahead+=te,d.lookahead+d.insert>=se)for(d.ins_h=d.window[J=d.strstart-d.insert],d.ins_h=(d.ins_h<<d.hash_shift^d.window[J+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[J+se-1])&d.hash_mask,d.prev[J&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=J,J++,d.insert--,!(d.lookahead+d.insert<se)););}while(d.lookahead<Pe&&0!==d.strm.avail_in)}function ne(d,ue){for(var te,V;;){if(d.lookahead<Pe){if(Je(d),d.lookahead<Pe&&ue===O)return 1;if(0===d.lookahead)break}if(te=0,d.lookahead>=se&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+se-1])&d.hash_mask,te=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),0!==te&&d.strstart-te<=d.w_size-Pe&&(d.match_length=Ce(d,te)),d.match_length>=se)if(V=m._tr_tally(d,d.strstart-d.match_start,d.match_length-se),d.lookahead-=d.match_length,d.match_length<=d.max_lazy_match&&d.lookahead>=se){for(d.match_length--;d.strstart++,d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+se-1])&d.hash_mask,te=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart,0!=--d.match_length;);d.strstart++}else d.strstart+=d.match_length,d.match_length=0,d.ins_h=d.window[d.strstart],d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+1])&d.hash_mask;else V=m._tr_tally(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++;if(V&&(q(d,!1),0===d.strm.avail_out))return 1}return d.insert=d.strstart<se-1?d.strstart:se-1,4===ue?(q(d,!0),0===d.strm.avail_out?3:4):d.last_lit&&(q(d,!1),0===d.strm.avail_out)?1:2}function $e(d,ue){for(var te,V,B;;){if(d.lookahead<Pe){if(Je(d),d.lookahead<Pe&&ue===O)return 1;if(0===d.lookahead)break}if(te=0,d.lookahead>=se&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+se-1])&d.hash_mask,te=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),d.prev_length=d.match_length,d.prev_match=d.match_start,d.match_length=se-1,0!==te&&d.prev_length<d.max_lazy_match&&d.strstart-te<=d.w_size-Pe&&(d.match_length=Ce(d,te),d.match_length<=5&&(1===d.strategy||d.match_length===se&&4096<d.strstart-d.match_start)&&(d.match_length=se-1)),d.prev_length>=se&&d.match_length<=d.prev_length){for(B=d.strstart+d.lookahead-se,V=m._tr_tally(d,d.strstart-1-d.prev_match,d.prev_length-se),d.lookahead-=d.prev_length-1,d.prev_length-=2;++d.strstart<=B&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+se-1])&d.hash_mask,te=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),0!=--d.prev_length;);if(d.match_available=0,d.match_length=se-1,d.strstart++,V&&(q(d,!1),0===d.strm.avail_out))return 1}else if(d.match_available){if((V=m._tr_tally(d,0,d.window[d.strstart-1]))&&q(d,!1),d.strstart++,d.lookahead--,0===d.strm.avail_out)return 1}else d.match_available=1,d.strstart++,d.lookahead--}return d.match_available&&(V=m._tr_tally(d,0,d.window[d.strstart-1]),d.match_available=0),d.insert=d.strstart<se-1?d.strstart:se-1,4===ue?(q(d,!0),0===d.strm.avail_out?3:4):d.last_lit&&(q(d,!1),0===d.strm.avail_out)?1:2}function Ze(d,ue,te,V,B){this.good_length=d,this.max_lazy=ue,this.nice_length=te,this.max_chain=V,this.func=B}function at(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=p,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new A.Buf16(2*ee),this.dyn_dtree=new A.Buf16(2*(2*E+1)),this.bl_tree=new A.Buf16(2*(2*L+1)),Te(this.dyn_ltree),Te(this.dyn_dtree),Te(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new A.Buf16(c+1),this.heap=new A.Buf16(2*C+1),Te(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new A.Buf16(2*C+1),Te(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ut(d){var ue;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=v,(ue=d.state).pending=0,ue.pending_out=0,ue.wrap<0&&(ue.wrap=-ue.wrap),ue.status=ue.wrap?R:K,d.adler=2===ue.wrap?0:1,ue.last_flush=O,m._tr_init(ue),y):ke(d,I)}function Bt(d){var te,ue=ut(d);return ue===y&&((te=d.state).window_size=2*te.w_size,Te(te.head),te.max_lazy_match=l[te.level].max_lazy,te.good_match=l[te.level].good_length,te.nice_match=l[te.level].nice_length,te.max_chain_length=l[te.level].max_chain,te.strstart=0,te.block_start=0,te.lookahead=0,te.insert=0,te.match_length=te.prev_length=se-1,te.match_available=0,te.ins_h=0),ue}function Ht(d,ue,te,V,B,J){if(!d)return I;var he=1;if(-1===ue&&(ue=6),V<0?(he=0,V=-V):15<V&&(he=2,V-=16),B<1||9<B||te!==p||V<8||15<V||ue<0||9<ue||J<0||4<J)return ke(d,I);8===V&&(V=9);var ge=new at;return(d.state=ge).strm=d,ge.wrap=he,ge.gzhead=null,ge.w_bits=V,ge.w_size=1<<ge.w_bits,ge.w_mask=ge.w_size-1,ge.hash_bits=B+7,ge.hash_size=1<<ge.hash_bits,ge.hash_mask=ge.hash_size-1,ge.hash_shift=~~((ge.hash_bits+se-1)/se),ge.window=new A.Buf8(2*ge.w_size),ge.head=new A.Buf16(ge.hash_size),ge.prev=new A.Buf16(ge.w_size),ge.lit_bufsize=1<<B+6,ge.pending_buf_size=4*ge.lit_bufsize,ge.pending_buf=new A.Buf8(ge.pending_buf_size),ge.d_buf=1*ge.lit_bufsize,ge.l_buf=3*ge.lit_bufsize,ge.level=ue,ge.strategy=J,ge.method=te,Bt(d)}l=[new Ze(0,0,0,0,function(d,ue){var te=65535;for(te>d.pending_buf_size-5&&(te=d.pending_buf_size-5);;){if(d.lookahead<=1){if(Je(d),0===d.lookahead&&ue===O)return 1;if(0===d.lookahead)break}d.strstart+=d.lookahead,d.lookahead=0;var V=d.block_start+te;if((0===d.strstart||d.strstart>=V)&&(d.lookahead=d.strstart-V,d.strstart=V,q(d,!1),0===d.strm.avail_out)||d.strstart-d.block_start>=d.w_size-Pe&&(q(d,!1),0===d.strm.avail_out))return 1}return d.insert=0,4===ue?(q(d,!0),0===d.strm.avail_out?3:4):(d.strstart>d.block_start&&q(d,!1),1)}),new Ze(4,4,8,4,ne),new Ze(4,5,16,8,ne),new Ze(4,6,32,32,ne),new Ze(4,4,16,16,$e),new Ze(8,16,32,32,$e),new Ze(8,16,128,128,$e),new Ze(8,32,128,256,$e),new Ze(32,128,258,1024,$e),new Ze(32,258,258,4096,$e)],n.deflateInit=function(d,ue){return Ht(d,ue,p,15,8,0)},n.deflateInit2=Ht,n.deflateReset=Bt,n.deflateResetKeep=ut,n.deflateSetHeader=function(d,ue){return d&&d.state?2!==d.state.wrap?I:(d.state.gzhead=ue,y):I},n.deflate=function(d,ue){var te,V,B,J;if(!d||!d.state||5<ue||ue<0)return d?ke(d,I):I;if(V=d.state,!d.output||!d.input&&0!==d.avail_in||666===V.status&&4!==ue)return ke(d,0===d.avail_out?-5:I);if(V.strm=d,te=V.last_flush,V.last_flush=ue,V.status===R)if(2===V.wrap)d.adler=0,Ie(V,31),Ie(V,139),Ie(V,8),V.gzhead?(Ie(V,(V.gzhead.text?1:0)+(V.gzhead.hcrc?2:0)+(V.gzhead.extra?4:0)+(V.gzhead.name?8:0)+(V.gzhead.comment?16:0)),Ie(V,255&V.gzhead.time),Ie(V,V.gzhead.time>>8&255),Ie(V,V.gzhead.time>>16&255),Ie(V,V.gzhead.time>>24&255),Ie(V,9===V.level?2:2<=V.strategy||V.level<2?4:0),Ie(V,255&V.gzhead.os),V.gzhead.extra&&V.gzhead.extra.length&&(Ie(V,255&V.gzhead.extra.length),Ie(V,V.gzhead.extra.length>>8&255)),V.gzhead.hcrc&&(d.adler=D(d.adler,V.pending_buf,V.pending,0)),V.gzindex=0,V.status=69):(Ie(V,0),Ie(V,0),Ie(V,0),Ie(V,0),Ie(V,0),Ie(V,9===V.level?2:2<=V.strategy||V.level<2?4:0),Ie(V,3),V.status=K);else{var he=p+(V.w_bits-8<<4)<<8;he|=(2<=V.strategy||V.level<2?0:V.level<6?1:6===V.level?2:3)<<6,0!==V.strstart&&(he|=32),he+=31-he%31,V.status=K,_e(V,he),0!==V.strstart&&(_e(V,d.adler>>>16),_e(V,65535&d.adler)),d.adler=1}if(69===V.status)if(V.gzhead.extra){for(B=V.pending;V.gzindex<(65535&V.gzhead.extra.length)&&(V.pending!==V.pending_buf_size||(V.gzhead.hcrc&&V.pending>B&&(d.adler=D(d.adler,V.pending_buf,V.pending-B,B)),j(d),B=V.pending,V.pending!==V.pending_buf_size));)Ie(V,255&V.gzhead.extra[V.gzindex]),V.gzindex++;V.gzhead.hcrc&&V.pending>B&&(d.adler=D(d.adler,V.pending_buf,V.pending-B,B)),V.gzindex===V.gzhead.extra.length&&(V.gzindex=0,V.status=73)}else V.status=73;if(73===V.status)if(V.gzhead.name){B=V.pending;do{if(V.pending===V.pending_buf_size&&(V.gzhead.hcrc&&V.pending>B&&(d.adler=D(d.adler,V.pending_buf,V.pending-B,B)),j(d),B=V.pending,V.pending===V.pending_buf_size)){J=1;break}J=V.gzindex<V.gzhead.name.length?255&V.gzhead.name.charCodeAt(V.gzindex++):0,Ie(V,J)}while(0!==J);V.gzhead.hcrc&&V.pending>B&&(d.adler=D(d.adler,V.pending_buf,V.pending-B,B)),0===J&&(V.gzindex=0,V.status=91)}else V.status=91;if(91===V.status)if(V.gzhead.comment){B=V.pending;do{if(V.pending===V.pending_buf_size&&(V.gzhead.hcrc&&V.pending>B&&(d.adler=D(d.adler,V.pending_buf,V.pending-B,B)),j(d),B=V.pending,V.pending===V.pending_buf_size)){J=1;break}J=V.gzindex<V.gzhead.comment.length?255&V.gzhead.comment.charCodeAt(V.gzindex++):0,Ie(V,J)}while(0!==J);V.gzhead.hcrc&&V.pending>B&&(d.adler=D(d.adler,V.pending_buf,V.pending-B,B)),0===J&&(V.status=103)}else V.status=103;if(103===V.status&&(V.gzhead.hcrc?(V.pending+2>V.pending_buf_size&&j(d),V.pending+2<=V.pending_buf_size&&(Ie(V,255&d.adler),Ie(V,d.adler>>8&255),d.adler=0,V.status=K)):V.status=K),0!==V.pending){if(j(d),0===d.avail_out)return V.last_flush=-1,y}else if(0===d.avail_in&&X(ue)<=X(te)&&4!==ue)return ke(d,-5);if(666===V.status&&0!==d.avail_in)return ke(d,-5);if(0!==d.avail_in||0!==V.lookahead||ue!==O&&666!==V.status){var ge=2===V.strategy?function(Y,Ee){for(var Ne;;){if(0===Y.lookahead&&(Je(Y),0===Y.lookahead)){if(Ee===O)return 1;break}if(Y.match_length=0,Ne=m._tr_tally(Y,0,Y.window[Y.strstart]),Y.lookahead--,Y.strstart++,Ne&&(q(Y,!1),0===Y.strm.avail_out))return 1}return Y.insert=0,4===Ee?(q(Y,!0),0===Y.strm.avail_out?3:4):Y.last_lit&&(q(Y,!1),0===Y.strm.avail_out)?1:2}(V,ue):3===V.strategy?function(Y,Ee){for(var Ne,Se,Me,tt,Xe=Y.window;;){if(Y.lookahead<=ve){if(Je(Y),Y.lookahead<=ve&&Ee===O)return 1;if(0===Y.lookahead)break}if(Y.match_length=0,Y.lookahead>=se&&0<Y.strstart&&(Se=Xe[Me=Y.strstart-1])===Xe[++Me]&&Se===Xe[++Me]&&Se===Xe[++Me]){tt=Y.strstart+ve;do{}while(Se===Xe[++Me]&&Se===Xe[++Me]&&Se===Xe[++Me]&&Se===Xe[++Me]&&Se===Xe[++Me]&&Se===Xe[++Me]&&Se===Xe[++Me]&&Se===Xe[++Me]&&Me<tt);Y.match_length=ve-(tt-Me),Y.match_length>Y.lookahead&&(Y.match_length=Y.lookahead)}if(Y.match_length>=se?(Ne=m._tr_tally(Y,1,Y.match_length-se),Y.lookahead-=Y.match_length,Y.strstart+=Y.match_length,Y.match_length=0):(Ne=m._tr_tally(Y,0,Y.window[Y.strstart]),Y.lookahead--,Y.strstart++),Ne&&(q(Y,!1),0===Y.strm.avail_out))return 1}return Y.insert=0,4===Ee?(q(Y,!0),0===Y.strm.avail_out?3:4):Y.last_lit&&(q(Y,!1),0===Y.strm.avail_out)?1:2}(V,ue):l[V.level].func(V,ue);if(3!==ge&&4!==ge||(V.status=666),1===ge||3===ge)return 0===d.avail_out&&(V.last_flush=-1),y;if(2===ge&&(1===ue?m._tr_align(V):5!==ue&&(m._tr_stored_block(V,0,0,!1),3===ue&&(Te(V.head),0===V.lookahead&&(V.strstart=0,V.block_start=0,V.insert=0))),j(d),0===d.avail_out))return V.last_flush=-1,y}return 4!==ue?y:V.wrap<=0?1:(2===V.wrap?(Ie(V,255&d.adler),Ie(V,d.adler>>8&255),Ie(V,d.adler>>16&255),Ie(V,d.adler>>24&255),Ie(V,255&d.total_in),Ie(V,d.total_in>>8&255),Ie(V,d.total_in>>16&255),Ie(V,d.total_in>>24&255)):(_e(V,d.adler>>>16),_e(V,65535&d.adler)),j(d),0<V.wrap&&(V.wrap=-V.wrap),0!==V.pending?y:1)},n.deflateEnd=function(d){var ue;return d&&d.state?(ue=d.state.status)!==R&&69!==ue&&73!==ue&&91!==ue&&103!==ue&&ue!==K&&666!==ue?ke(d,I):(d.state=null,ue===K?ke(d,-3):y):I},n.deflateSetDictionary=function(d,ue){var te,V,B,J,he,ge,Y,Ee,Ne=ue.length;if(!d||!d.state||2===(J=(te=d.state).wrap)||1===J&&te.status!==R||te.lookahead)return I;for(1===J&&(d.adler=_(d.adler,ue,Ne,0)),te.wrap=0,Ne>=te.w_size&&(0===J&&(Te(te.head),te.strstart=0,te.block_start=0,te.insert=0),Ee=new A.Buf8(te.w_size),A.arraySet(Ee,ue,Ne-te.w_size,te.w_size,0),ue=Ee,Ne=te.w_size),he=d.avail_in,ge=d.next_in,Y=d.input,d.avail_in=Ne,d.next_in=0,d.input=ue,Je(te);te.lookahead>=se;){for(V=te.strstart,B=te.lookahead-(se-1);te.ins_h=(te.ins_h<<te.hash_shift^te.window[V+se-1])&te.hash_mask,te.prev[V&te.w_mask]=te.head[te.ins_h],te.head[te.ins_h]=V,V++,--B;);te.strstart=V,te.lookahead=se-1,Je(te)}return te.strstart+=te.lookahead,te.block_start=te.strstart,te.insert=te.lookahead,te.lookahead=0,te.match_length=te.prev_length=se-1,te.match_available=0,d.next_in=ge,d.input=Y,d.avail_in=he,te.wrap=J,y},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(F,$,n){"use strict";$.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(F,$,n){"use strict";$.exports=function(l,A){var m,_,D,M,O,T,y,I,b,k,v,p,S,C,E,L,ee,c,se,ve,Pe,R,K,f,P;f=l.input,D=(_=l.next_in)+(l.avail_in-5),P=l.output,O=(M=l.next_out)-(A-l.avail_out),T=M+(l.avail_out-257),y=(m=l.state).dmax,I=m.wsize,b=m.whave,k=m.wnext,v=m.window,p=m.hold,S=m.bits,C=m.lencode,E=m.distcode,L=(1<<m.lenbits)-1,ee=(1<<m.distbits)-1;e:do{S<15&&(p+=f[_++]<<S,p+=f[_++]<<(S+=8),S+=8),c=C[p&L];t:for(;;){if(p>>>=se=c>>>24,S-=se,0==(se=c>>>16&255))P[M++]=65535&c;else{if(!(16&se)){if(!(64&se)){c=C[(65535&c)+(p&(1<<se)-1)];continue t}if(32&se){m.mode=12;break e}l.msg="invalid literal/length code",m.mode=30;break e}ve=65535&c,(se&=15)&&(S<se&&(p+=f[_++]<<S,S+=8),ve+=p&(1<<se)-1,p>>>=se,S-=se),S<15&&(p+=f[_++]<<S,p+=f[_++]<<(S+=8),S+=8),c=E[p&ee];s:for(;;){if(p>>>=se=c>>>24,S-=se,!(16&(se=c>>>16&255))){if(!(64&se)){c=E[(65535&c)+(p&(1<<se)-1)];continue s}l.msg="invalid distance code",m.mode=30;break e}if(Pe=65535&c,S<(se&=15)&&(p+=f[_++]<<S,(S+=8)<se&&(p+=f[_++]<<S,S+=8)),y<(Pe+=p&(1<<se)-1)){l.msg="invalid distance too far back",m.mode=30;break e}if(p>>>=se,S-=se,(se=M-O)<Pe){if(b<(se=Pe-se)&&m.sane){l.msg="invalid distance too far back",m.mode=30;break e}if(K=v,(R=0)===k){if(R+=I-se,se<ve){for(ve-=se;P[M++]=v[R++],--se;);R=M-Pe,K=P}}else if(k<se){if(R+=I+k-se,(se-=k)<ve){for(ve-=se;P[M++]=v[R++],--se;);if(R=0,k<ve){for(ve-=se=k;P[M++]=v[R++],--se;);R=M-Pe,K=P}}}else if(R+=k-se,se<ve){for(ve-=se;P[M++]=v[R++],--se;);R=M-Pe,K=P}for(;2<ve;)P[M++]=K[R++],P[M++]=K[R++],P[M++]=K[R++],ve-=3;ve&&(P[M++]=K[R++],1<ve&&(P[M++]=K[R++]))}else{for(R=M-Pe;P[M++]=P[R++],P[M++]=P[R++],P[M++]=P[R++],2<(ve-=3););ve&&(P[M++]=P[R++],1<ve&&(P[M++]=P[R++]))}break}}break}}while(_<D&&M<T);_-=ve=S>>3,p&=(1<<(S-=ve<<3))-1,l.next_in=_,l.next_out=M,l.avail_in=_<D?D-_+5:5-(_-D),l.avail_out=M<T?T-M+257:257-(M-T),m.hold=p,m.bits=S}},{}],49:[function(F,$,n){"use strict";var l=F("../utils/common"),A=F("./adler32"),m=F("./crc32"),_=F("./inffast"),D=F("./inftrees"),T=0,y=-2,I=1,b=852,k=592;function v(R){return(R>>>24&255)+(R>>>8&65280)+((65280&R)<<8)+((255&R)<<24)}function p(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(R){var K;return R&&R.state?(R.total_in=R.total_out=(K=R.state).total=0,R.msg="",K.wrap&&(R.adler=1&K.wrap),K.mode=I,K.last=0,K.havedict=0,K.dmax=32768,K.head=null,K.hold=0,K.bits=0,K.lencode=K.lendyn=new l.Buf32(b),K.distcode=K.distdyn=new l.Buf32(k),K.sane=1,K.back=-1,T):y}function C(R){var K;return R&&R.state?((K=R.state).wsize=0,K.whave=0,K.wnext=0,S(R)):y}function E(R,K){var f,P;return R&&R.state?(P=R.state,K<0?(f=0,K=-K):(f=1+(K>>4),K<48&&(K&=15)),K&&(K<8||15<K)?y:(null!==P.window&&P.wbits!==K&&(P.window=null),P.wrap=f,P.wbits=K,C(R))):y}function L(R,K){var f,P;return R?(P=new p,(R.state=P).window=null,(f=E(R,K))!==T&&(R.state=null),f):y}var ee,c,se=!0;function ve(R){if(se){var K;for(ee=new l.Buf32(512),c=new l.Buf32(32),K=0;K<144;)R.lens[K++]=8;for(;K<256;)R.lens[K++]=9;for(;K<280;)R.lens[K++]=7;for(;K<288;)R.lens[K++]=8;for(D(1,R.lens,0,288,ee,0,R.work,{bits:9}),K=0;K<32;)R.lens[K++]=5;D(2,R.lens,0,32,c,0,R.work,{bits:5}),se=!1}R.lencode=ee,R.lenbits=9,R.distcode=c,R.distbits=5}function Pe(R,K,f,P){var ae,W=R.state;return null===W.window&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new l.Buf8(W.wsize)),P>=W.wsize?(l.arraySet(W.window,K,f-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(P<(ae=W.wsize-W.wnext)&&(ae=P),l.arraySet(W.window,K,f-P,ae,W.wnext),(P-=ae)?(l.arraySet(W.window,K,f-P,P,0),W.wnext=P,W.whave=W.wsize):(W.wnext+=ae,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=ae))),0}n.inflateReset=C,n.inflateReset2=E,n.inflateResetKeep=S,n.inflateInit=function(R){return L(R,15)},n.inflateInit2=L,n.inflate=function(R,K){var f,P,ae,W,ke,X,Te,j,q,Ie,_e,Ce,Je,ne,$e,Ze,at,ut,Bt,Ht,d,ue,te,V,B=0,J=new l.Buf8(4),he=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!R||!R.state||!R.output||!R.input&&0!==R.avail_in)return y;12===(f=R.state).mode&&(f.mode=13),ke=R.next_out,ae=R.output,W=R.next_in,P=R.input,j=f.hold,q=f.bits,Ie=X=R.avail_in,_e=Te=R.avail_out,ue=T;e:for(;;)switch(f.mode){case I:if(0===f.wrap){f.mode=13;break}for(;q<16;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}if(2&f.wrap&&35615===j){J[f.check=0]=255&j,J[1]=j>>>8&255,f.check=m(f.check,J,2,0),q=j=0,f.mode=2;break}if(f.flags=0,f.head&&(f.head.done=!1),!(1&f.wrap)||(((255&j)<<8)+(j>>8))%31){R.msg="incorrect header check",f.mode=30;break}if(8!=(15&j)){R.msg="unknown compression method",f.mode=30;break}if(q-=4,d=8+(15&(j>>>=4)),0===f.wbits)f.wbits=d;else if(d>f.wbits){R.msg="invalid window size",f.mode=30;break}f.dmax=1<<d,R.adler=f.check=1,f.mode=512&j?10:12,q=j=0;break;case 2:for(;q<16;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}if(f.flags=j,8!=(255&f.flags)){R.msg="unknown compression method",f.mode=30;break}if(57344&f.flags){R.msg="unknown header flags set",f.mode=30;break}f.head&&(f.head.text=j>>8&1),512&f.flags&&(J[0]=255&j,J[1]=j>>>8&255,f.check=m(f.check,J,2,0)),q=j=0,f.mode=3;case 3:for(;q<32;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}f.head&&(f.head.time=j),512&f.flags&&(J[0]=255&j,J[1]=j>>>8&255,J[2]=j>>>16&255,J[3]=j>>>24&255,f.check=m(f.check,J,4,0)),q=j=0,f.mode=4;case 4:for(;q<16;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}f.head&&(f.head.xflags=255&j,f.head.os=j>>8),512&f.flags&&(J[0]=255&j,J[1]=j>>>8&255,f.check=m(f.check,J,2,0)),q=j=0,f.mode=5;case 5:if(1024&f.flags){for(;q<16;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}f.length=j,f.head&&(f.head.extra_len=j),512&f.flags&&(J[0]=255&j,J[1]=j>>>8&255,f.check=m(f.check,J,2,0)),q=j=0}else f.head&&(f.head.extra=null);f.mode=6;case 6:if(1024&f.flags&&(X<(Ce=f.length)&&(Ce=X),Ce&&(f.head&&(d=f.head.extra_len-f.length,f.head.extra||(f.head.extra=new Array(f.head.extra_len)),l.arraySet(f.head.extra,P,W,Ce,d)),512&f.flags&&(f.check=m(f.check,P,Ce,W)),X-=Ce,W+=Ce,f.length-=Ce),f.length))break e;f.length=0,f.mode=7;case 7:if(2048&f.flags){if(0===X)break e;for(Ce=0;d=P[W+Ce++],f.head&&d&&f.length<65536&&(f.head.name+=String.fromCharCode(d)),d&&Ce<X;);if(512&f.flags&&(f.check=m(f.check,P,Ce,W)),X-=Ce,W+=Ce,d)break e}else f.head&&(f.head.name=null);f.length=0,f.mode=8;case 8:if(4096&f.flags){if(0===X)break e;for(Ce=0;d=P[W+Ce++],f.head&&d&&f.length<65536&&(f.head.comment+=String.fromCharCode(d)),d&&Ce<X;);if(512&f.flags&&(f.check=m(f.check,P,Ce,W)),X-=Ce,W+=Ce,d)break e}else f.head&&(f.head.comment=null);f.mode=9;case 9:if(512&f.flags){for(;q<16;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}if(j!==(65535&f.check)){R.msg="header crc mismatch",f.mode=30;break}q=j=0}f.head&&(f.head.hcrc=f.flags>>9&1,f.head.done=!0),R.adler=f.check=0,f.mode=12;break;case 10:for(;q<32;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}R.adler=f.check=v(j),q=j=0,f.mode=11;case 11:if(0===f.havedict)return R.next_out=ke,R.avail_out=Te,R.next_in=W,R.avail_in=X,f.hold=j,f.bits=q,2;R.adler=f.check=1,f.mode=12;case 12:if(5===K||6===K)break e;case 13:if(f.last){j>>>=7&q,q-=7&q,f.mode=27;break}for(;q<3;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}switch(f.last=1&j,q-=1,3&(j>>>=1)){case 0:f.mode=14;break;case 1:if(ve(f),f.mode=20,6!==K)break;j>>>=2,q-=2;break e;case 2:f.mode=17;break;case 3:R.msg="invalid block type",f.mode=30}j>>>=2,q-=2;break;case 14:for(j>>>=7&q,q-=7&q;q<32;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}if((65535&j)!=(j>>>16^65535)){R.msg="invalid stored block lengths",f.mode=30;break}if(f.length=65535&j,q=j=0,f.mode=15,6===K)break e;case 15:f.mode=16;case 16:if(Ce=f.length){if(X<Ce&&(Ce=X),Te<Ce&&(Ce=Te),0===Ce)break e;l.arraySet(ae,P,W,Ce,ke),X-=Ce,W+=Ce,Te-=Ce,ke+=Ce,f.length-=Ce;break}f.mode=12;break;case 17:for(;q<14;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}if(f.nlen=257+(31&j),q-=5,f.ndist=1+(31&(j>>>=5)),q-=5,f.ncode=4+(15&(j>>>=5)),j>>>=4,q-=4,286<f.nlen||30<f.ndist){R.msg="too many length or distance symbols",f.mode=30;break}f.have=0,f.mode=18;case 18:for(;f.have<f.ncode;){for(;q<3;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}f.lens[he[f.have++]]=7&j,j>>>=3,q-=3}for(;f.have<19;)f.lens[he[f.have++]]=0;if(f.lencode=f.lendyn,f.lenbits=7,ue=D(0,f.lens,0,19,f.lencode,0,f.work,te={bits:f.lenbits}),f.lenbits=te.bits,ue){R.msg="invalid code lengths set",f.mode=30;break}f.have=0,f.mode=19;case 19:for(;f.have<f.nlen+f.ndist;){for(;Ze=(B=f.lencode[j&(1<<f.lenbits)-1])>>>16&255,at=65535&B,!(($e=B>>>24)<=q);){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}if(at<16)j>>>=$e,q-=$e,f.lens[f.have++]=at;else{if(16===at){for(V=$e+2;q<V;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}if(j>>>=$e,q-=$e,0===f.have){R.msg="invalid bit length repeat",f.mode=30;break}d=f.lens[f.have-1],Ce=3+(3&j),j>>>=2,q-=2}else if(17===at){for(V=$e+3;q<V;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}q-=$e,d=0,Ce=3+(7&(j>>>=$e)),j>>>=3,q-=3}else{for(V=$e+7;q<V;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}q-=$e,d=0,Ce=11+(127&(j>>>=$e)),j>>>=7,q-=7}if(f.have+Ce>f.nlen+f.ndist){R.msg="invalid bit length repeat",f.mode=30;break}for(;Ce--;)f.lens[f.have++]=d}}if(30===f.mode)break;if(0===f.lens[256]){R.msg="invalid code -- missing end-of-block",f.mode=30;break}if(f.lenbits=9,ue=D(1,f.lens,0,f.nlen,f.lencode,0,f.work,te={bits:f.lenbits}),f.lenbits=te.bits,ue){R.msg="invalid literal/lengths set",f.mode=30;break}if(f.distbits=6,f.distcode=f.distdyn,ue=D(2,f.lens,f.nlen,f.ndist,f.distcode,0,f.work,te={bits:f.distbits}),f.distbits=te.bits,ue){R.msg="invalid distances set",f.mode=30;break}if(f.mode=20,6===K)break e;case 20:f.mode=21;case 21:if(6<=X&&258<=Te){R.next_out=ke,R.avail_out=Te,R.next_in=W,R.avail_in=X,f.hold=j,f.bits=q,_(R,_e),ke=R.next_out,ae=R.output,Te=R.avail_out,W=R.next_in,P=R.input,X=R.avail_in,j=f.hold,q=f.bits,12===f.mode&&(f.back=-1);break}for(f.back=0;Ze=(B=f.lencode[j&(1<<f.lenbits)-1])>>>16&255,at=65535&B,!(($e=B>>>24)<=q);){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}if(Ze&&!(240&Ze)){for(ut=$e,Bt=Ze,Ht=at;Ze=(B=f.lencode[Ht+((j&(1<<ut+Bt)-1)>>ut)])>>>16&255,at=65535&B,!(ut+($e=B>>>24)<=q);){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}j>>>=ut,q-=ut,f.back+=ut}if(j>>>=$e,q-=$e,f.back+=$e,f.length=at,0===Ze){f.mode=26;break}if(32&Ze){f.back=-1,f.mode=12;break}if(64&Ze){R.msg="invalid literal/length code",f.mode=30;break}f.extra=15&Ze,f.mode=22;case 22:if(f.extra){for(V=f.extra;q<V;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}f.length+=j&(1<<f.extra)-1,j>>>=f.extra,q-=f.extra,f.back+=f.extra}f.was=f.length,f.mode=23;case 23:for(;Ze=(B=f.distcode[j&(1<<f.distbits)-1])>>>16&255,at=65535&B,!(($e=B>>>24)<=q);){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}if(!(240&Ze)){for(ut=$e,Bt=Ze,Ht=at;Ze=(B=f.distcode[Ht+((j&(1<<ut+Bt)-1)>>ut)])>>>16&255,at=65535&B,!(ut+($e=B>>>24)<=q);){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}j>>>=ut,q-=ut,f.back+=ut}if(j>>>=$e,q-=$e,f.back+=$e,64&Ze){R.msg="invalid distance code",f.mode=30;break}f.offset=at,f.extra=15&Ze,f.mode=24;case 24:if(f.extra){for(V=f.extra;q<V;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}f.offset+=j&(1<<f.extra)-1,j>>>=f.extra,q-=f.extra,f.back+=f.extra}if(f.offset>f.dmax){R.msg="invalid distance too far back",f.mode=30;break}f.mode=25;case 25:if(0===Te)break e;if(f.offset>(Ce=_e-Te)){if((Ce=f.offset-Ce)>f.whave&&f.sane){R.msg="invalid distance too far back",f.mode=30;break}Je=Ce>f.wnext?f.wsize-(Ce-=f.wnext):f.wnext-Ce,Ce>f.length&&(Ce=f.length),ne=f.window}else ne=ae,Je=ke-f.offset,Ce=f.length;for(Te<Ce&&(Ce=Te),Te-=Ce,f.length-=Ce;ae[ke++]=ne[Je++],--Ce;);0===f.length&&(f.mode=21);break;case 26:if(0===Te)break e;ae[ke++]=f.length,Te--,f.mode=21;break;case 27:if(f.wrap){for(;q<32;){if(0===X)break e;X--,j|=P[W++]<<q,q+=8}if(R.total_out+=_e-=Te,f.total+=_e,_e&&(R.adler=f.check=f.flags?m(f.check,ae,_e,ke-_e):A(f.check,ae,_e,ke-_e)),_e=Te,(f.flags?j:v(j))!==f.check){R.msg="incorrect data check",f.mode=30;break}q=j=0}f.mode=28;case 28:if(f.wrap&&f.flags){for(;q<32;){if(0===X)break e;X--,j+=P[W++]<<q,q+=8}if(j!==(4294967295&f.total)){R.msg="incorrect length check",f.mode=30;break}q=j=0}f.mode=29;case 29:ue=1;break e;case 30:ue=-3;break e;case 31:return-4;default:return y}return R.next_out=ke,R.avail_out=Te,R.next_in=W,R.avail_in=X,f.hold=j,f.bits=q,(f.wsize||_e!==R.avail_out&&f.mode<30&&(f.mode<27||4!==K))&&Pe(R,R.output,R.next_out,_e-R.avail_out)?(f.mode=31,-4):(_e-=R.avail_out,R.total_in+=Ie-=R.avail_in,R.total_out+=_e,f.total+=_e,f.wrap&&_e&&(R.adler=f.check=f.flags?m(f.check,ae,_e,R.next_out-_e):A(f.check,ae,_e,R.next_out-_e)),R.data_type=f.bits+(f.last?64:0)+(12===f.mode?128:0)+(20===f.mode||15===f.mode?256:0),(0==Ie&&0===_e||4===K)&&ue===T&&(ue=-5),ue)},n.inflateEnd=function(R){if(!R||!R.state)return y;var K=R.state;return K.window&&(K.window=null),R.state=null,T},n.inflateGetHeader=function(R,K){var f;return R&&R.state&&2&(f=R.state).wrap?((f.head=K).done=!1,T):y},n.inflateSetDictionary=function(R,K){var f,P=K.length;return R&&R.state?0!==(f=R.state).wrap&&11!==f.mode?y:11===f.mode&&A(1,K,P,0)!==f.check?-3:Pe(R,K,P,P)?(f.mode=31,-4):(f.havedict=1,T):y},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(F,$,n){"use strict";var l=F("../utils/common"),A=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],m=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],_=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],D=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];$.exports=function(M,O,T,y,I,b,k,v){var p,S,C,E,L,ee,c,se,ve,Pe=v.bits,R=0,K=0,f=0,P=0,ae=0,W=0,ke=0,X=0,Te=0,j=0,q=null,Ie=0,_e=new l.Buf16(16),Ce=new l.Buf16(16),Je=null,ne=0;for(R=0;R<=15;R++)_e[R]=0;for(K=0;K<y;K++)_e[O[T+K]]++;for(ae=Pe,P=15;1<=P&&0===_e[P];P--);if(P<ae&&(ae=P),0===P)return I[b++]=20971520,I[b++]=20971520,v.bits=1,0;for(f=1;f<P&&0===_e[f];f++);for(ae<f&&(ae=f),R=X=1;R<=15;R++)if(X<<=1,(X-=_e[R])<0)return-1;if(0<X&&(0===M||1!==P))return-1;for(Ce[1]=0,R=1;R<15;R++)Ce[R+1]=Ce[R]+_e[R];for(K=0;K<y;K++)0!==O[T+K]&&(k[Ce[O[T+K]]++]=K);if(ee=0===M?(q=Je=k,19):1===M?(q=A,Ie-=257,Je=m,ne-=257,256):(q=_,Je=D,-1),R=f,L=b,ke=K=j=0,C=-1,E=(Te=1<<(W=ae))-1,1===M&&852<Te||2===M&&592<Te)return 1;for(;;){for(c=R-ke,ve=k[K]<ee?(se=0,k[K]):k[K]>ee?(se=Je[ne+k[K]],q[Ie+k[K]]):(se=96,0),p=1<<R-ke,f=S=1<<W;I[L+(j>>ke)+(S-=p)]=c<<24|se<<16|ve,0!==S;);for(p=1<<R-1;j&p;)p>>=1;if(0!==p?(j&=p-1,j+=p):j=0,K++,0==--_e[R]){if(R===P)break;R=O[T+k[K]]}if(ae<R&&(j&E)!==C){for(0===ke&&(ke=ae),L+=f,X=1<<(W=R-ke);W+ke<P&&!((X-=_e[W+ke])<=0);)W++,X<<=1;if(Te+=1<<W,1===M&&852<Te||2===M&&592<Te)return 1;I[C=j&E]=ae<<24|W<<16|L-b}}return 0!==j&&(I[L+j]=R-ke<<24|64<<16),v.bits=ae,0}},{"../utils/common":41}],51:[function(F,$,n){"use strict";$.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(F,$,n){"use strict";var l=F("../utils/common");function _(B){for(var J=B.length;0<=--J;)B[J]=0}var O=256,T=286,y=30,k=15,v=16,ee=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],c=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ve=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Pe=new Array(576);_(Pe);var R=new Array(60);_(R);var K=new Array(512);_(K);var f=new Array(256);_(f);var P=new Array(29);_(P);var ae,W,ke,X=new Array(y);function Te(B,J,he,ge,Y){this.static_tree=B,this.extra_bits=J,this.extra_base=he,this.elems=ge,this.max_length=Y,this.has_stree=B&&B.length}function j(B,J){this.dyn_tree=B,this.max_code=0,this.stat_desc=J}function q(B){return B<256?K[B]:K[256+(B>>>7)]}function Ie(B,J){B.pending_buf[B.pending++]=255&J,B.pending_buf[B.pending++]=J>>>8&255}function _e(B,J,he){B.bi_valid>v-he?(B.bi_buf|=J<<B.bi_valid&65535,Ie(B,B.bi_buf),B.bi_buf=J>>v-B.bi_valid,B.bi_valid+=he-v):(B.bi_buf|=J<<B.bi_valid&65535,B.bi_valid+=he)}function Ce(B,J,he){_e(B,he[2*J],he[2*J+1])}function Je(B,J){for(var he=0;he|=1&B,B>>>=1,he<<=1,0<--J;);return he>>>1}function ne(B,J,he){var ge,Y,Ee=new Array(k+1),Ne=0;for(ge=1;ge<=k;ge++)Ee[ge]=Ne=Ne+he[ge-1]<<1;for(Y=0;Y<=J;Y++){var Se=B[2*Y+1];0!==Se&&(B[2*Y]=Je(Ee[Se]++,Se))}}function $e(B){var J;for(J=0;J<T;J++)B.dyn_ltree[2*J]=0;for(J=0;J<y;J++)B.dyn_dtree[2*J]=0;for(J=0;J<19;J++)B.bl_tree[2*J]=0;B.dyn_ltree[512]=1,B.opt_len=B.static_len=0,B.last_lit=B.matches=0}function Ze(B){8<B.bi_valid?Ie(B,B.bi_buf):0<B.bi_valid&&(B.pending_buf[B.pending++]=B.bi_buf),B.bi_buf=0,B.bi_valid=0}function at(B,J,he,ge){var Y=2*J,Ee=2*he;return B[Y]<B[Ee]||B[Y]===B[Ee]&&ge[J]<=ge[he]}function ut(B,J,he){for(var ge=B.heap[he],Y=he<<1;Y<=B.heap_len&&(Y<B.heap_len&&at(J,B.heap[Y+1],B.heap[Y],B.depth)&&Y++,!at(J,ge,B.heap[Y],B.depth));)B.heap[he]=B.heap[Y],he=Y,Y<<=1;B.heap[he]=ge}function Bt(B,J,he){var ge,Y,Ee,Ne,Se=0;if(0!==B.last_lit)for(;ge=B.pending_buf[B.d_buf+2*Se]<<8|B.pending_buf[B.d_buf+2*Se+1],Y=B.pending_buf[B.l_buf+Se],Se++,0===ge?Ce(B,Y,J):(Ce(B,(Ee=f[Y])+O+1,J),0!==(Ne=ee[Ee])&&_e(B,Y-=P[Ee],Ne),Ce(B,Ee=q(--ge),he),0!==(Ne=c[Ee])&&_e(B,ge-=X[Ee],Ne)),Se<B.last_lit;);Ce(B,256,J)}function Ht(B,J){var he,ge,Y,Ee=J.dyn_tree,Ne=J.stat_desc.static_tree,Se=J.stat_desc.has_stree,Me=J.stat_desc.elems,tt=-1;for(B.heap_len=0,B.heap_max=573,he=0;he<Me;he++)0!==Ee[2*he]?(B.heap[++B.heap_len]=tt=he,B.depth[he]=0):Ee[2*he+1]=0;for(;B.heap_len<2;)Ee[2*(Y=B.heap[++B.heap_len]=tt<2?++tt:0)]=1,B.depth[Y]=0,B.opt_len--,Se&&(B.static_len-=Ne[2*Y+1]);for(J.max_code=tt,he=B.heap_len>>1;1<=he;he--)ut(B,Ee,he);for(Y=Me;he=B.heap[1],B.heap[1]=B.heap[B.heap_len--],ut(B,Ee,1),ge=B.heap[1],B.heap[--B.heap_max]=he,B.heap[--B.heap_max]=ge,Ee[2*Y]=Ee[2*he]+Ee[2*ge],B.depth[Y]=(B.depth[he]>=B.depth[ge]?B.depth[he]:B.depth[ge])+1,Ee[2*he+1]=Ee[2*ge+1]=Y,B.heap[1]=Y++,ut(B,Ee,1),2<=B.heap_len;);B.heap[--B.heap_max]=B.heap[1],function(Xe,Dt){var Ut,It,Ct,yt,Ur,Re,pt=Dt.dyn_tree,ha=Dt.max_code,eu=Dt.stat_desc.static_tree,tu=Dt.stat_desc.has_stree,Ol=Dt.stat_desc.extra_bits,Le=Dt.stat_desc.extra_base,Si=Dt.stat_desc.max_length,Yt=0;for(yt=0;yt<=k;yt++)Xe.bl_count[yt]=0;for(pt[2*Xe.heap[Xe.heap_max]+1]=0,Ut=Xe.heap_max+1;Ut<573;Ut++)Si<(yt=pt[2*pt[2*(It=Xe.heap[Ut])+1]+1]+1)&&(yt=Si,Yt++),pt[2*It+1]=yt,ha<It||(Xe.bl_count[yt]++,Ur=0,Le<=It&&(Ur=Ol[It-Le]),Xe.opt_len+=(Re=pt[2*It])*(yt+Ur),tu&&(Xe.static_len+=Re*(eu[2*It+1]+Ur)));if(0!==Yt){do{for(yt=Si-1;0===Xe.bl_count[yt];)yt--;Xe.bl_count[yt]--,Xe.bl_count[yt+1]+=2,Xe.bl_count[Si]--,Yt-=2}while(0<Yt);for(yt=Si;0!==yt;yt--)for(It=Xe.bl_count[yt];0!==It;)ha<(Ct=Xe.heap[--Ut])||(pt[2*Ct+1]!==yt&&(Xe.opt_len+=(yt-pt[2*Ct+1])*pt[2*Ct],pt[2*Ct+1]=yt),It--)}}(B,J),ne(Ee,tt,B.bl_count)}function d(B,J,he){var ge,Y,Ee=-1,Ne=J[1],Se=0,Me=7,tt=4;for(0===Ne&&(Me=138,tt=3),J[2*(he+1)+1]=65535,ge=0;ge<=he;ge++)Y=Ne,Ne=J[2*(ge+1)+1],++Se<Me&&Y===Ne||(Se<tt?B.bl_tree[2*Y]+=Se:0!==Y?(Y!==Ee&&B.bl_tree[2*Y]++,B.bl_tree[32]++):Se<=10?B.bl_tree[34]++:B.bl_tree[36]++,Ee=Y,tt=(Se=0)===Ne?(Me=138,3):Y===Ne?(Me=6,3):(Me=7,4))}function ue(B,J,he){var ge,Y,Ee=-1,Ne=J[1],Se=0,Me=7,tt=4;for(0===Ne&&(Me=138,tt=3),ge=0;ge<=he;ge++)if(Y=Ne,Ne=J[2*(ge+1)+1],!(++Se<Me&&Y===Ne)){if(Se<tt)for(;Ce(B,Y,B.bl_tree),0!=--Se;);else 0!==Y?(Y!==Ee&&(Ce(B,Y,B.bl_tree),Se--),Ce(B,16,B.bl_tree),_e(B,Se-3,2)):Se<=10?(Ce(B,17,B.bl_tree),_e(B,Se-3,3)):(Ce(B,18,B.bl_tree),_e(B,Se-11,7));Ee=Y,tt=(Se=0)===Ne?(Me=138,3):Y===Ne?(Me=6,3):(Me=7,4)}}_(X);var te=!1;function V(B,J,he,ge){var Y,Ee,Ne;_e(B,0+(ge?1:0),3),Ee=J,Ne=he,Ze(Y=B),Ie(Y,Ne),Ie(Y,~Ne),l.arraySet(Y.pending_buf,Y.window,Ee,Ne,Y.pending),Y.pending+=Ne}n._tr_init=function(B){te||(function(){var J,he,ge,Y,Ee,Ne=new Array(k+1);for(Y=ge=0;Y<28;Y++)for(P[Y]=ge,J=0;J<1<<ee[Y];J++)f[ge++]=Y;for(f[ge-1]=Y,Y=Ee=0;Y<16;Y++)for(X[Y]=Ee,J=0;J<1<<c[Y];J++)K[Ee++]=Y;for(Ee>>=7;Y<y;Y++)for(X[Y]=Ee<<7,J=0;J<1<<c[Y]-7;J++)K[256+Ee++]=Y;for(he=0;he<=k;he++)Ne[he]=0;for(J=0;J<=143;)Pe[2*J+1]=8,J++,Ne[8]++;for(;J<=255;)Pe[2*J+1]=9,J++,Ne[9]++;for(;J<=279;)Pe[2*J+1]=7,J++,Ne[7]++;for(;J<=287;)Pe[2*J+1]=8,J++,Ne[8]++;for(ne(Pe,287,Ne),J=0;J<y;J++)R[2*J+1]=5,R[2*J]=Je(J,5);ae=new Te(Pe,ee,257,T,k),W=new Te(R,c,0,y,k),ke=new Te(new Array(0),se,0,19,7)}(),te=!0),B.l_desc=new j(B.dyn_ltree,ae),B.d_desc=new j(B.dyn_dtree,W),B.bl_desc=new j(B.bl_tree,ke),B.bi_buf=0,B.bi_valid=0,$e(B)},n._tr_stored_block=V,n._tr_flush_block=function(B,J,he,ge){var Y,Ee,Ne=0;0<B.level?(2===B.strm.data_type&&(B.strm.data_type=function(Se){var Me,tt=4093624447;for(Me=0;Me<=31;Me++,tt>>>=1)if(1&tt&&0!==Se.dyn_ltree[2*Me])return 0;if(0!==Se.dyn_ltree[18]||0!==Se.dyn_ltree[20]||0!==Se.dyn_ltree[26])return 1;for(Me=32;Me<O;Me++)if(0!==Se.dyn_ltree[2*Me])return 1;return 0}(B)),Ht(B,B.l_desc),Ht(B,B.d_desc),Ne=function(Se){var Me;for(d(Se,Se.dyn_ltree,Se.l_desc.max_code),d(Se,Se.dyn_dtree,Se.d_desc.max_code),Ht(Se,Se.bl_desc),Me=18;3<=Me&&0===Se.bl_tree[2*ve[Me]+1];Me--);return Se.opt_len+=3*(Me+1)+5+5+4,Me}(B),(Ee=B.static_len+3+7>>>3)<=(Y=B.opt_len+3+7>>>3)&&(Y=Ee)):Y=Ee=he+5,he+4<=Y&&-1!==J?V(B,J,he,ge):4===B.strategy||Ee===Y?(_e(B,2+(ge?1:0),3),Bt(B,Pe,R)):(_e(B,4+(ge?1:0),3),function(Se,Me,tt,Xe){var Dt;for(_e(Se,Me-257,5),_e(Se,tt-1,5),_e(Se,Xe-4,4),Dt=0;Dt<Xe;Dt++)_e(Se,Se.bl_tree[2*ve[Dt]+1],3);ue(Se,Se.dyn_ltree,Me-1),ue(Se,Se.dyn_dtree,tt-1)}(B,B.l_desc.max_code+1,B.d_desc.max_code+1,Ne+1),Bt(B,B.dyn_ltree,B.dyn_dtree)),$e(B),ge&&Ze(B)},n._tr_tally=function(B,J,he){return B.pending_buf[B.d_buf+2*B.last_lit]=J>>>8&255,B.pending_buf[B.d_buf+2*B.last_lit+1]=255&J,B.pending_buf[B.l_buf+B.last_lit]=255&he,B.last_lit++,0===J?B.dyn_ltree[2*he]++:(B.matches++,J--,B.dyn_ltree[2*(f[he]+O+1)]++,B.dyn_dtree[2*q(J)]++),B.last_lit===B.lit_bufsize-1},n._tr_align=function(B){var J;_e(B,2,3),Ce(B,256,Pe),16===(J=B).bi_valid?(Ie(J,J.bi_buf),J.bi_buf=0,J.bi_valid=0):8<=J.bi_valid&&(J.pending_buf[J.pending++]=255&J.bi_buf,J.bi_buf>>=8,J.bi_valid-=8)}},{"../utils/common":41}],53:[function(F,$,n){"use strict";$.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(F,$,n){(function(l){!function(A,m){"use strict";if(!A.setImmediate){var _,D,M,O,T=1,y={},I=!1,b=A.document,k=Object.getPrototypeOf&&Object.getPrototypeOf(A);k=k&&k.setTimeout?k:A,_="[object process]"==={}.toString.call(A.process)?function(C){process.nextTick(function(){p(C)})}:function(){if(A.postMessage&&!A.importScripts){var C=!0,E=A.onmessage;return A.onmessage=function(){C=!1},A.postMessage("","*"),A.onmessage=E,C}}()?(O="setImmediate$"+Math.random()+"$",A.addEventListener?A.addEventListener("message",S,!1):A.attachEvent("onmessage",S),function(C){A.postMessage(O+C,"*")}):A.MessageChannel?((M=new MessageChannel).port1.onmessage=function(C){p(C.data)},function(C){M.port2.postMessage(C)}):b&&"onreadystatechange"in b.createElement("script")?(D=b.documentElement,function(C){var E=b.createElement("script");E.onreadystatechange=function(){p(C),E.onreadystatechange=null,D.removeChild(E),E=null},D.appendChild(E)}):function(C){setTimeout(p,0,C)},k.setImmediate=function(C){"function"!=typeof C&&(C=new Function(""+C));for(var E=new Array(arguments.length-1),L=0;L<E.length;L++)E[L]=arguments[L+1];return y[T]={callback:C,args:E},_(T),T++},k.clearImmediate=v}function v(C){delete y[C]}function p(C){if(I)setTimeout(p,0,C);else{var E=y[C];if(E){I=!0;try{!function(L){var ee=L.callback,c=L.args;switch(c.length){case 0:ee();break;case 1:ee(c[0]);break;case 2:ee(c[0],c[1]);break;case 3:ee(c[0],c[1],c[2]);break;default:ee.apply(m,c)}}(E)}finally{v(C),I=!1}}}}function S(C){C.source===A&&"string"==typeof C.data&&0===C.data.indexOf(O)&&p(+C.data.slice(O.length))}}(typeof self>"u"?void 0===l?this:l:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)},153:(_t,F)=>{"use strict";class l{static isArrayBuffer(v){return"[object ArrayBuffer]"===Object.prototype.toString.call(v)}static toArrayBuffer(v){return this.isArrayBuffer(v)?v:v.byteLength===v.buffer.byteLength||0===v.byteOffset&&v.byteLength===v.buffer.byteLength?v.buffer:this.toUint8Array(v.buffer).slice(v.byteOffset,v.byteOffset+v.byteLength).buffer}static toUint8Array(v){return this.toView(v,Uint8Array)}static toView(v,p){if(v.constructor===p)return v;if(this.isArrayBuffer(v))return new p(v);if(this.isArrayBufferView(v))return new p(v.buffer,v.byteOffset,v.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(v){return this.isArrayBufferView(v)||this.isArrayBuffer(v)}static isArrayBufferView(v){return ArrayBuffer.isView(v)||v&&this.isArrayBuffer(v.buffer)}static isEqual(v,p){const S=l.toUint8Array(v),C=l.toUint8Array(p);if(S.length!==C.byteLength)return!1;for(let E=0;E<S.length;E++)if(S[E]!==C[E])return!1;return!0}static concat(...v){let p;p=Array.isArray(v[0])&&!(v[1]instanceof Function)||Array.isArray(v[0])&&v[1]instanceof Function?v[0]:v[v.length-1]instanceof Function?v.slice(0,v.length-1):v;let S=0;for(const L of p)S+=L.byteLength;const C=new Uint8Array(S);let E=0;for(const L of p){const ee=this.toUint8Array(L);C.set(ee,E),E+=ee.length}return v[v.length-1]instanceof Function?this.toView(C,v[v.length-1]):C.buffer}}const A="string",m=/^[0-9a-f]+$/i,_=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,D=/^[a-zA-Z0-9-_]+$/;class M{static fromString(v){const p=unescape(encodeURIComponent(v)),S=new Uint8Array(p.length);for(let C=0;C<p.length;C++)S[C]=p.charCodeAt(C);return S.buffer}static toString(v){const p=l.toUint8Array(v);let S="";for(let E=0;E<p.length;E++)S+=String.fromCharCode(p[E]);return decodeURIComponent(escape(S))}}class O{static toString(v,p=!1){const S=l.toArrayBuffer(v),C=new DataView(S);let E="";for(let L=0;L<S.byteLength;L+=2){const ee=C.getUint16(L,p);E+=String.fromCharCode(ee)}return E}static fromString(v,p=!1){const S=new ArrayBuffer(2*v.length),C=new DataView(S);for(let E=0;E<v.length;E++)C.setUint16(2*E,v.charCodeAt(E),p);return S}}let T=(()=>{class k{static isHex(p){return typeof p===A&&m.test(p)}static isBase64(p){return typeof p===A&&_.test(p)}static isBase64Url(p){return typeof p===A&&D.test(p)}static ToString(p,S="utf8"){const C=l.toUint8Array(p);switch(S.toLowerCase()){case"utf8":return this.ToUtf8String(C);case"binary":return this.ToBinary(C);case"hex":return this.ToHex(C);case"base64":return this.ToBase64(C);case"base64url":return this.ToBase64Url(C);case"utf16le":return O.toString(C,!0);case"utf16":case"utf16be":return O.toString(C);default:throw new Error(`Unknown type of encoding '${S}'`)}}static FromString(p,S="utf8"){if(!p)return new ArrayBuffer(0);switch(S.toLowerCase()){case"utf8":return this.FromUtf8String(p);case"binary":return this.FromBinary(p);case"hex":return this.FromHex(p);case"base64":return this.FromBase64(p);case"base64url":return this.FromBase64Url(p);case"utf16le":return O.fromString(p,!0);case"utf16":case"utf16be":return O.fromString(p);default:throw new Error(`Unknown type of encoding '${S}'`)}}static ToBase64(p){const S=l.toUint8Array(p);if(typeof btoa<"u"){const C=this.ToString(S,"binary");return btoa(C)}return Buffer.from(S).toString("base64")}static FromBase64(p){const S=this.formatString(p);if(!S)return new ArrayBuffer(0);if(!k.isBase64(S))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(S)):new Uint8Array(Buffer.from(S,"base64")).buffer}static FromBase64Url(p){const S=this.formatString(p);if(!S)return new ArrayBuffer(0);if(!k.isBase64Url(S))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(S.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(p){return this.ToBase64(p).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(p,S=k.DEFAULT_UTF8_ENCODING){switch(S){case"ascii":return this.FromBinary(p);case"utf8":return M.fromString(p);case"utf16":case"utf16be":return O.fromString(p);case"utf16le":case"usc2":return O.fromString(p,!0);default:throw new Error(`Unknown type of encoding '${S}'`)}}static ToUtf8String(p,S=k.DEFAULT_UTF8_ENCODING){switch(S){case"ascii":return this.ToBinary(p);case"utf8":return M.toString(p);case"utf16":case"utf16be":return O.toString(p);case"utf16le":case"usc2":return O.toString(p,!0);default:throw new Error(`Unknown type of encoding '${S}'`)}}static FromBinary(p){const S=p.length,C=new Uint8Array(S);for(let E=0;E<S;E++)C[E]=p.charCodeAt(E);return C.buffer}static ToBinary(p){const S=l.toUint8Array(p);let C="";for(let E=0;E<S.length;E++)C+=String.fromCharCode(S[E]);return C}static ToHex(p){const S=l.toUint8Array(p);let C="";const E=S.length;for(let L=0;L<E;L++){const ee=S[L];ee<16&&(C+="0"),C+=ee.toString(16)}return C}static FromHex(p){let S=this.formatString(p);if(!S)return new ArrayBuffer(0);if(!k.isHex(S))throw new TypeError("Argument 'hexString' is not HEX encoded");S.length%2&&(S=`0${S}`);const C=new Uint8Array(S.length/2);for(let E=0;E<S.length;E+=2){const L=S.slice(E,E+2);C[E/2]=parseInt(L,16)}return C.buffer}static ToUtf16String(p,S=!1){return O.toString(p,S)}static FromUtf16String(p,S=!1){return O.fromString(p,S)}static Base64Padding(p){const S=4-p.length%4;if(S<4)for(let C=0;C<S;C++)p+="=";return p}static formatString(p){return p?.replace(/[\n\r\t ]/g,"")||""}}return k.DEFAULT_UTF8_ENCODING="utf8",k})();F._H=l,F.U$=T}}]);